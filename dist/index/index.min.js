/*!
 * @version 0.0.1
 * @date 2017-10-13
 */
(function(ee){function oe(ne){if(ie[ne])return ie[ne].exports;var se=ie[ne]={i:ne,l:!1,exports:{}};return ee[ne].call(se.exports,se,se.exports,oe),se.l=!0,se.exports}var ie={};return oe.m=ee,oe.c=ie,oe.d=function(ne,se,le){oe.o(ne,se)||Object.defineProperty(ne,se,{configurable:!1,enumerable:!0,get:le})},oe.n=function(ne){var se=ne&&ne.__esModule?function(){return ne['default']}:function(){return ne};return oe.d(se,'a',se),se},oe.o=function(ne,se){return Object.prototype.hasOwnProperty.call(ne,se)},oe.p='',oe(oe.s=1)})([function(ee){ee.exports=function(ie){return ie.webpackPolyfill||(ie.deprecate=function(){},ie.paths=[],!ie.children&&(ie.children=[]),Object.defineProperty(ie,'loaded',{enumerable:!0,get:function(){return ie.l}}),Object.defineProperty(ie,'id',{enumerable:!0,get:function(){return ie.i}}),ie.webpackPolyfill=1),ie}},function(ee,oe,ie){'use strict';Object.defineProperty(oe,'__esModule',{value:!0});var ne=ie(2),se=ie.n(ne),le=ie(4),pe=ie.n(le),ue=ie(5),fe=ie.n(ue),ge=ie(6),he=ie.n(ge),ye=ie(7),xe=ie.n(ye),_e=ie(8),ve=ie.n(_e),Ee=ie(9),Te=ie.n(Ee),Se=ie(10),Me=ie.n(Se),Ae=ie(11),Le=ie.n(Ae),Re=ie(12),Ce=ie.n(Re),we=ie(13),Pe=ie.n(we),Fe=ie(14),De=ie.n(Fe),Ie=ie(15),Be=ie.n(Ie),Ue=ie(16),Ne=ie.n(Ue),Ge=ie(17),Ve=ie.n(Ge),ze=ie(18),Oe=ie.n(ze),ke=ie(19),He=ie.n(ke),We=ie(20),je=ie.n(We),Xe=ie(21),qe=ie.n(Xe),Ye=ie(22),Ze=ie.n(Ye),Ke=ie(23),Qe=ie.n(Ke),Je=ie(24),$e=ie.n(Je),et=ie(25),tt=ie.n(et),rt=ie(26),ot=ie.n(rt),it=ie(27),nt=ie.n(it),st=ie(28),lt=ie.n(st),dt=ie(29),ct=ie.n(dt),ut=ie(30),mt=ie.n(ut),gt=ie(31),ht=ie.n(gt),yt=ie(32);document.write('\u5F53\u4F60\u770B\u5230\u8FD9\u53E5\u8BDD \u4F60\u7684\u73AF\u5883\u5DF2\u7ECF\u642D\u5EFA\u6210\u529F'),Object(yt.a)()},function(ee,oe,ie){(function(ne){var se,le,pe='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(ue){return typeof ue}:function(ue){return ue&&'function'==typeof Symbol&&ue.constructor===Symbol&&ue!==Symbol.prototype?'symbol':typeof ue};!function(ue,fe){'use strict';'object'==pe(ne)&&'object'==pe(ne.exports)?ne.exports=ue.document?fe(ue,!0):function(ge){if(!ge.document)throw new Error('jQuery requires a window with a document');return fe(ge)}:fe(ue)}('undefined'==typeof window?this:window,function(ue,fe){'use strict';function ge(xo,_o){_o=_o||_t;var vo=_o.createElement('script');vo.text=xo,_o.head.appendChild(vo).parentNode.removeChild(vo)}function he(xo){var _o=!!xo&&'length'in xo&&xo.length,vo=Dt.type(xo);return'function'!==vo&&!Dt.isWindow(xo)&&('array'===vo||0===_o||'number'==typeof _o&&0<_o&&_o-1 in xo)}function ye(xo,_o){return xo.nodeName&&xo.nodeName.toLowerCase()===_o.toLowerCase()}function xe(xo,_o,vo){return Dt.isFunction(_o)?Dt.grep(xo,function(bo,Eo){return!!_o.call(bo,Eo,bo)!==vo}):_o.nodeType?Dt.grep(xo,function(bo){return bo===_o!==vo}):'string'==typeof _o?Wt.test(_o)?Dt.filter(_o,xo,vo):(_o=Dt.filter(_o,xo),Dt.grep(xo,function(bo){return-1<Mt.call(_o,bo)!==vo&&1===bo.nodeType})):Dt.grep(xo,function(bo){return-1<Mt.call(_o,bo)!==vo})}function _e(xo,_o){for(;(xo=xo[_o])&&1!==xo.nodeType;);return xo}function ve(xo){var _o={};return Dt.each(xo.match(Kt)||[],function(vo,bo){_o[bo]=!0}),_o}function Ee(xo){return xo}function Te(xo){throw xo}function Se(xo,_o,vo,bo){var Eo;try{xo&&Dt.isFunction(Eo=xo.promise)?Eo.call(xo).done(_o).fail(vo):xo&&Dt.isFunction(Eo=xo.then)?Eo.call(xo,_o,vo):_o.apply(void 0,[xo].slice(bo))}catch(To){vo.apply(void 0,[To])}}function Me(){_t.removeEventListener('DOMContentLoaded',Me),ue.removeEventListener('load',Me),Dt.ready()}function Ae(){this.expando=Dt.expando+Ae.uid++}function Le(xo){return'true'===xo||'false'!==xo&&('null'===xo?null:xo===+xo+''?+xo:ar.test(xo)?JSON.parse(xo):xo)}function Re(xo,_o,vo){var bo;if(void 0===vo&&1===xo.nodeType)if(bo='data-'+_o.replace(or,'-$&').toLowerCase(),vo=xo.getAttribute(bo),'string'==typeof vo){try{vo=Le(vo)}catch(Eo){}rr.set(xo,_o,vo)}else vo=void 0;return vo}function Ce(xo,_o,vo,bo){var To=1,So=20,Mo=bo?function(){return bo.cur()}:function(){return Dt.css(xo,_o,'')},Ao=Mo(),Lo=vo&&vo[3]||(Dt.cssNumber[_o]?'':'px'),Ro=(Dt.cssNumber[_o]||'px'!==Lo&&+Ao)&&nr.exec(Dt.css(xo,_o)),Eo;if(Ro&&Ro[3]!==Lo){Lo=Lo||Ro[3],vo=vo||[],Ro=+Ao||1;do To=To||'.5',Ro/=To,Dt.style(xo,_o,Ro+Lo);while(To!=(To=Mo()/Ao)&&1!=To&&--So)}return vo&&(Ro=+Ro||+Ao||0,Eo=vo[1]?Ro+(vo[1]+1)*vo[2]:+vo[2],bo&&(bo.unit=Lo,bo.start=Ro,bo.end=Eo)),Eo}function we(xo){var vo=xo.ownerDocument,bo=xo.nodeName,Eo=cr[bo],_o;return Eo?Eo:(_o=vo.body.appendChild(vo.createElement(bo)),Eo=Dt.css(_o,'display'),_o.parentNode.removeChild(_o),'none'===Eo&&(Eo='block'),cr[bo]=Eo,Eo)}function Pe(xo,_o){for(var Eo=[],To=0,So=xo.length,vo,bo;To<So;To++)bo=xo[To],bo.style&&(vo=bo.style.display,_o?('none'===vo&&(Eo[To]=tr.get(bo,'display')||null,Eo[To]||(bo.style.display='')),''===bo.style.display&&dr(bo)&&(Eo[To]=we(bo))):'none'!==vo&&(Eo[To]='none',tr.set(bo,'display',vo)));for(To=0;To<So;To++)null!=Eo[To]&&(xo[To].style.display=Eo[To]);return xo}function Fe(xo,_o){var vo;return vo='undefined'==typeof xo.getElementsByTagName?'undefined'==typeof xo.querySelectorAll?[]:xo.querySelectorAll(_o||'*'):xo.getElementsByTagName(_o||'*'),void 0===_o||_o&&ye(xo,_o)?Dt.merge([xo],vo):vo}function De(xo,_o){for(var vo=0,bo=xo.length;vo<bo;vo++)tr.set(xo[vo],'globalEval',!_o||tr.get(_o[vo],'globalEval'))}function Ie(xo,_o,vo,bo,Eo){for(var Co=_o.createDocumentFragment(),wo=[],Po=0,Fo=xo.length,To,So,Mo,Ao,Lo,Ro;Po<Fo;Po++)if(To=xo[Po],To||0===To)if('object'===Dt.type(To))Dt.merge(wo,To.nodeType?[To]:To);else if(hr.test(To)){for(So=So||Co.appendChild(_o.createElement('div')),Mo=(mr.exec(To)||['',''])[1].toLowerCase(),Ao=gr[Mo]||gr._default,So.innerHTML=Ao[1]+Dt.htmlPrefilter(To)+Ao[2],Ro=Ao[0];Ro--;)So=So.lastChild;Dt.merge(wo,So.childNodes),So=Co.firstChild,So.textContent=''}else wo.push(_o.createTextNode(To));for(Co.textContent='',Po=0;To=wo[Po++];)if(bo&&-1<Dt.inArray(To,bo))Eo&&Eo.push(To);else if(Lo=Dt.contains(To.ownerDocument,To),So=Fe(Co.appendChild(To),'script'),Lo&&De(So),vo)for(Ro=0;To=So[Ro++];)fr.test(To.type||'')&&vo.push(To);return Co}function Be(){return!0}function Ue(){return!1}function Ne(){try{return _t.activeElement}catch(xo){}}function Ge(xo,_o,vo,bo,Eo,To){var So,Mo;if('object'==('undefined'==typeof _o?'undefined':pe(_o))){for(Mo in'string'!=typeof vo&&(bo=bo||vo,vo=void 0),_o)Ge(xo,Mo,vo,bo,_o[Mo],To);return xo}if(null==bo&&null==Eo?(Eo=vo,bo=vo=void 0):null==Eo&&('string'==typeof vo?(Eo=bo,bo=void 0):(Eo=bo,bo=vo,vo=void 0)),!1===Eo)Eo=Ue;else if(!Eo)return xo;return 1===To&&(So=Eo,Eo=function(Lo){return Dt().off(Lo),So.apply(this,arguments)},Eo.guid=So.guid||(So.guid=Dt.guid++)),xo.each(function(){Dt.event.add(this,_o,Eo,bo,vo)})}function Ve(xo,_o){return ye(xo,'table')&&ye(11===_o.nodeType?_o.firstChild:_o,'tr')?Dt('>tbody',xo)[0]||xo:xo}function ze(xo){return xo.type=(null!==xo.getAttribute('type'))+'/'+xo.type,xo}function Oe(xo){var _o=Sr.exec(xo.type);return _o?xo.type=_o[1]:xo.removeAttribute('type'),xo}function ke(xo,_o){var vo,bo,Eo,To,So,Mo,Ao,Lo;if(1===_o.nodeType){if(tr.hasData(xo)&&(To=tr.access(xo),So=tr.set(_o,To),Lo=To.events))for(Eo in delete So.handle,So.events={},Lo)for(vo=0,bo=Lo[Eo].length;vo<bo;vo++)Dt.event.add(_o,Eo,Lo[Eo][vo]);rr.hasData(xo)&&(Mo=rr.access(xo),Ao=Dt.extend({},Mo),rr.set(_o,Ao))}}function He(xo,_o){var vo=_o.nodeName.toLowerCase();'input'===vo&&ur.test(xo.type)?_o.checked=xo.checked:'input'!==vo&&'textarea'!==vo||(_o.defaultValue=xo.defaultValue)}function We(xo,_o,vo,bo){_o=Tt.apply([],_o);var Ro=0,Co=xo.length,Po=_o[0],Fo=Dt.isFunction(Po),Eo,To,So,Mo,Ao,Lo;if(Fo||1<Co&&'string'==typeof Po&&!Pt.checkClone&&Tr.test(Po))return xo.each(function(Do){var Io=xo.eq(Do);Fo&&(_o[0]=Po.call(this,Do,Io.html())),We(Io,_o,vo,bo)});if(Co&&(Eo=Ie(_o,xo[0].ownerDocument,!1,xo,bo),To=Eo.firstChild,1===Eo.childNodes.length&&(Eo=To),To||bo)){for(So=Dt.map(Fe(Eo,'script'),ze),Mo=So.length;Ro<Co;Ro++)Ao=Eo,Ro!=Co-1&&(Ao=Dt.clone(Ao,!0,!0),Mo&&Dt.merge(So,Fe(Ao,'script'))),vo.call(xo[Ro],Ao,Ro);if(Mo)for(Lo=So[So.length-1].ownerDocument,Dt.map(So,Oe),Ro=0;Ro<Mo;Ro++)Ao=So[Ro],fr.test(Ao.type||'')&&!tr.access(Ao,'globalEval')&&Dt.contains(Lo,Ao)&&(Ao.src?Dt._evalUrl&&Dt._evalUrl(Ao.src):ge(Ao.textContent.replace(Mr,''),Lo))}return xo}function je(xo,_o,vo){for(var Eo=_o?Dt.filter(_o,xo):xo,To=0,bo;null!=(bo=Eo[To]);To++)vo||1!==bo.nodeType||Dt.cleanData(Fe(bo)),bo.parentNode&&(vo&&Dt.contains(bo.ownerDocument,bo)&&De(Fe(bo,'script')),bo.parentNode.removeChild(bo));return xo}function Xe(xo,_o,vo){var Mo=xo.style,bo,Eo,To,So;return vo=vo||Rr(xo),vo&&(So=vo.getPropertyValue(_o)||vo[_o],''!==So||Dt.contains(xo.ownerDocument,xo)||(So=Dt.style(xo,_o)),!Pt.pixelMarginRight()&&Lr.test(So)&&Ar.test(_o)&&(bo=Mo.width,Eo=Mo.minWidth,To=Mo.maxWidth,Mo.minWidth=Mo.maxWidth=Mo.width=So,So=vo.width,Mo.width=bo,Mo.minWidth=Eo,Mo.maxWidth=To)),void 0===So?So:So+''}function qe(xo,_o){return{get:function(){return xo()?void delete this.get:(this.get=_o).apply(this,arguments)}}}function Ye(xo){if(xo in Ir)return xo;for(var _o=xo[0].toUpperCase()+xo.slice(1),vo=Dr.length;vo--;)if(xo=Dr[vo]+_o,xo in Ir)return xo}function Ze(xo){var _o=Dt.cssProps[xo];return _o||(_o=Dt.cssProps[xo]=Ye(xo)||xo),_o}function Ke(xo,_o,vo){var bo=nr.exec(_o);return bo?Math.max(0,bo[2]-(vo||0))+(bo[3]||'px'):_o}function Qe(xo,_o,vo,bo,Eo){var So=0,To;for(To=vo===(bo?'border':'content')?4:'width'===_o?1:0;4>To;To+=2)'margin'===vo&&(So+=Dt.css(xo,vo+sr[To],!0,Eo)),bo?('content'===vo&&(So-=Dt.css(xo,'padding'+sr[To],!0,Eo)),'margin'!==vo&&(So-=Dt.css(xo,'border'+sr[To]+'Width',!0,Eo))):(So+=Dt.css(xo,'padding'+sr[To],!0,Eo),'padding'!==vo&&(So+=Dt.css(xo,'border'+sr[To]+'Width',!0,Eo)));return So}function Je(xo,_o,vo){var Eo=Rr(xo),To=Xe(xo,_o,Eo),So='border-box'===Dt.css(xo,'boxSizing',!1,Eo),bo;return Lr.test(To)?To:(bo=So&&(Pt.boxSizingReliable()||To===xo.style[_o]),'auto'===To&&(To=xo['offset'+_o[0].toUpperCase()+_o.slice(1)]),To=parseFloat(To)||0,To+Qe(xo,_o,vo||(So?'border':'content'),bo,Eo)+'px')}function $e(xo,_o,vo,bo,Eo){return new $e.prototype.init(xo,_o,vo,bo,Eo)}function et(){Ur&&(!1===_t.hidden&&ue.requestAnimationFrame?ue.requestAnimationFrame(et):ue.setTimeout(et,Dt.fx.interval),Dt.fx.tick())}function tt(){return ue.setTimeout(function(){Br=void 0}),Br=Dt.now()}function rt(xo,_o){var bo=0,Eo={height:xo},vo;for(_o=_o?1:0;4>bo;bo+=2-_o)vo=sr[bo],Eo['margin'+vo]=Eo['padding'+vo]=xo;return _o&&(Eo.opacity=Eo.width=xo),Eo}function ot(xo,_o,vo){for(var Eo=(st.tweeners[_o]||[]).concat(st.tweeners['*']),To=0,So=Eo.length,bo;To<So;To++)if(bo=Eo[To].call(vo,_o,xo))return bo}function nt(xo,_o){var vo,bo,Eo,To,So;for(vo in xo)if(bo=Dt.camelCase(vo),Eo=_o[bo],To=xo[vo],Array.isArray(To)&&(Eo=To[1],To=xo[vo]=To[0]),vo!==bo&&(xo[bo]=To,delete xo[vo]),So=Dt.cssHooks[bo],So&&'expand'in So)for(vo in To=So.expand(To),delete xo[bo],To)vo in xo||(xo[vo]=To[vo],_o[vo]=Eo);else _o[bo]=Eo}function st(xo,_o,vo){var To=0,So=st.prefilters.length,Mo=Dt.Deferred().always(function(){delete Ao.elem}),Ao=function(){if(Eo)return!1;for(var wo=Br||tt(),Po=Math.max(0,Lo.startTime+Lo.duration-wo),Fo=Po/Lo.duration||0,Do=1-Fo,Io=0,Co=Lo.tweens.length;Io<Co;Io++)Lo.tweens[Io].run(Do);return Mo.notifyWith(xo,[Lo,Do,Po]),1>Do&&Co?Po:(Co||Mo.notifyWith(xo,[Lo,1,0]),Mo.resolveWith(xo,[Lo]),!1)},Lo=Mo.promise({elem:xo,props:Dt.extend({},_o),opts:Dt.extend(!0,{specialEasing:{},easing:Dt.easing._default},vo),originalProperties:_o,originalOptions:vo,startTime:Br||tt(),duration:vo.duration,tweens:[],createTween:function(wo,Po){var Fo=Dt.Tween(xo,Lo.opts,wo,Po,Lo.opts.specialEasing[wo]||Lo.opts.easing);return Lo.tweens.push(Fo),Fo},stop:function(wo){var Po=0,Fo=wo?Lo.tweens.length:0;if(Eo)return this;for(Eo=!0;Po<Fo;Po++)Lo.tweens[Po].run(1);return wo?(Mo.notifyWith(xo,[Lo,1,0]),Mo.resolveWith(xo,[Lo,wo])):Mo.rejectWith(xo,[Lo,wo]),this}}),Ro=Lo.props,bo,Eo;for(nt(Ro,Lo.opts.specialEasing);To<So;To++)if(bo=st.prefilters[To].call(Lo,xo,Ro,Lo.opts))return Dt.isFunction(bo.stop)&&(Dt._queueHooks(Lo.elem,Lo.opts.queue).stop=Dt.proxy(bo.stop,bo)),bo;return Dt.map(Ro,ot,Lo),Dt.isFunction(Lo.opts.start)&&Lo.opts.start.call(xo,Lo),Lo.progress(Lo.opts.progress).done(Lo.opts.done,Lo.opts.complete).fail(Lo.opts.fail).always(Lo.opts.always),Dt.fx.timer(Dt.extend(Ao,{elem:xo,anim:Lo,queue:Lo.opts.queue})),Lo}function lt(xo){var _o=xo.match(Kt)||[];return _o.join(' ')}function dt(xo){return xo.getAttribute&&xo.getAttribute('class')||''}function ct(xo,_o,vo,bo){if(Array.isArray(_o))Dt.each(_o,function(To,So){vo||Yr.test(xo)?bo(xo,So):ct(xo+'['+('object'==('undefined'==typeof So?'undefined':pe(So))&&null!=So?To:'')+']',So,vo,bo)});else if(vo||'object'!==Dt.type(_o))bo(xo,_o);else for(var Eo in _o)ct(xo+'['+Eo+']',_o[Eo],vo,bo)}function ut(xo){return function(_o,vo){'string'!=typeof _o&&(vo=_o,_o='*');var Eo=0,To=_o.toLowerCase().match(Kt)||[],bo;if(Dt.isFunction(vo))for(;bo=To[Eo++];)'+'===bo[0]?(bo=bo.slice(1)||'*',(xo[bo]=xo[bo]||[]).unshift(vo)):(xo[bo]=xo[bo]||[]).push(vo)}}function mt(xo,_o,vo,bo){function Eo(Mo){var Ao;return To[Mo]=!0,Dt.each(xo[Mo]||[],function(Lo,Ro){var Co=Ro(_o,vo,bo);return'string'!=typeof Co||So||To[Co]?So?!(Ao=Co):void 0:(_o.dataTypes.unshift(Co),Eo(Co),!1)}),Ao}var To={},So=xo===so;return Eo(_o.dataTypes[0])||!To['*']&&Eo('*')}function gt(xo,_o){var Eo=Dt.ajaxSettings.flatOptions||{},vo,bo;for(vo in _o)void 0!==_o[vo]&&((Eo[vo]?xo:bo||(bo={}))[vo]=_o[vo]);return bo&&Dt.extend(!0,xo,bo),xo}function ht(xo,_o,vo){for(var Mo=xo.contents,Ao=xo.dataTypes,bo,Eo,To,So;'*'===Ao[0];)Ao.shift(),void 0==bo&&(bo=xo.mimeType||_o.getResponseHeader('Content-Type'));if(bo)for(Eo in Mo)if(Mo[Eo]&&Mo[Eo].test(bo)){Ao.unshift(Eo);break}if(Ao[0]in vo)To=Ao[0];else{for(Eo in vo){if(!Ao[0]||xo.converters[Eo+' '+Ao[0]]){To=Eo;break}So||(So=Eo)}To=To||So}return To?(To!==Ao[0]&&Ao.unshift(To),vo[To]):void 0}function yt(xo,_o,vo,bo){var Lo={},Ro=xo.dataTypes.slice(),Eo,To,So,Mo,Ao;if(Ro[1])for(So in xo.converters)Lo[So.toLowerCase()]=xo.converters[So];for(To=Ro.shift();To;)if(xo.responseFields[To]&&(vo[xo.responseFields[To]]=_o),!Ao&&bo&&xo.dataFilter&&(_o=xo.dataFilter(_o,xo.dataType)),Ao=To,To=Ro.shift())if('*'===To)To=Ao;else if('*'!==Ao&&Ao!==To){if(So=Lo[Ao+' '+To]||Lo['* '+To],!So)for(Eo in Lo)if(Mo=Eo.split(' '),Mo[1]===To&&(So=Lo[Ao+' '+Mo[0]]||Lo['* '+Mo[0]])){!0===So?So=Lo[Eo]:!0!==Lo[Eo]&&(To=Mo[0],Ro.unshift(Mo[1]));break}if(!0!==So)if(So&&xo.throws)_o=So(_o);else try{_o=So(_o)}catch(Co){return{state:'parsererror',error:So?Co:'No conversion from '+Ao+' to '+To}}}return{state:'success',data:_o}}var xt=[],_t=ue.document,vt=Object.getPrototypeOf,Et=xt.slice,Tt=xt.concat,St=xt.push,Mt=xt.indexOf,At={},Lt=At.toString,Rt=At.hasOwnProperty,Ct=Rt.toString,wt=Ct.call(Object),Pt={},Ft='3.2.1',Dt=function xo(_o,vo){return new xo.fn.init(_o,vo)},It=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Bt=/^-ms-/,Ut=/-([a-z])/g,Nt=function(_o,vo){return vo.toUpperCase()};Dt.fn=Dt.prototype={jquery:Ft,constructor:Dt,length:0,toArray:function(){return Et.call(this)},get:function(_o){return null==_o?Et.call(this):0>_o?this[_o+this.length]:this[_o]},pushStack:function(_o){var vo=Dt.merge(this.constructor(),_o);return vo.prevObject=this,vo},each:function(_o){return Dt.each(this,_o)},map:function(_o){return this.pushStack(Dt.map(this,function(vo,bo){return _o.call(vo,bo,vo)}))},slice:function(){return this.pushStack(Et.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(_o){var vo=this.length,bo=+_o+(0>_o?vo:0);return this.pushStack(0<=bo&&bo<vo?[this[bo]]:[])},end:function(){return this.prevObject||this.constructor()},push:St,sort:xt.sort,splice:xt.splice},Dt.extend=Dt.fn.extend=function(){var So=arguments[0]||{},Mo=1,Ao=arguments.length,Lo=!1,xo,_o,vo,bo,Eo,To;for('boolean'==typeof So&&(Lo=So,So=arguments[Mo]||{},Mo++),'object'==('undefined'==typeof So?'undefined':pe(So))||Dt.isFunction(So)||(So={}),Mo===Ao&&(So=this,Mo--);Mo<Ao;Mo++)if(null!=(xo=arguments[Mo]))for(_o in xo)vo=So[_o],bo=xo[_o],So!==bo&&(Lo&&bo&&(Dt.isPlainObject(bo)||(Eo=Array.isArray(bo)))?(Eo?(Eo=!1,To=vo&&Array.isArray(vo)?vo:[]):To=vo&&Dt.isPlainObject(vo)?vo:{},So[_o]=Dt.extend(Lo,To,bo)):void 0!==bo&&(So[_o]=bo));return So},Dt.extend({expando:'jQuery'+(Ft+Math.random()).replace(/\D/g,''),isReady:!0,error:function(_o){throw new Error(_o)},noop:function(){},isFunction:function(_o){return'function'===Dt.type(_o)},isWindow:function(_o){return null!=_o&&_o===_o.window},isNumeric:function(_o){var vo=Dt.type(_o);return('number'===vo||'string'===vo)&&!isNaN(_o-parseFloat(_o))},isPlainObject:function(_o){var vo,bo;return _o&&'[object Object]'===Lt.call(_o)&&(!(vo=vt(_o))||(bo=Rt.call(vo,'constructor')&&vo.constructor,'function'==typeof bo&&Ct.call(bo)===wt))},isEmptyObject:function(_o){for(var vo in _o)return!1;return!0},type:function(_o){return null==_o?_o+'':'object'==('undefined'==typeof _o?'undefined':pe(_o))||'function'==typeof _o?At[Lt.call(_o)]||'object':'undefined'==typeof _o?'undefined':pe(_o)},globalEval:function(_o){ge(_o)},camelCase:function(_o){return _o.replace(Bt,'ms-').replace(Ut,Nt)},each:function(_o,vo){var Eo=0,bo;if(he(_o))for(bo=_o.length;Eo<bo&&!1!==vo.call(_o[Eo],Eo,_o[Eo]);Eo++);else for(Eo in _o)if(!1===vo.call(_o[Eo],Eo,_o[Eo]))break;return _o},trim:function(_o){return null==_o?'':(_o+'').replace(It,'')},makeArray:function(_o,vo){var bo=vo||[];return null!=_o&&(he(Object(_o))?Dt.merge(bo,'string'==typeof _o?[_o]:_o):St.call(bo,_o)),bo},inArray:function(_o,vo,bo){return null==vo?-1:Mt.call(vo,_o,bo)},merge:function(_o,vo){for(var bo=+vo.length,Eo=0,To=_o.length;Eo<bo;Eo++)_o[To++]=vo[Eo];return _o.length=To,_o},grep:function(_o,vo,bo){for(var To=[],So=0,Mo=_o.length,Eo;So<Mo;So++)Eo=!vo(_o[So],So),Eo!==!bo&&To.push(_o[So]);return To},map:function(_o,vo,bo){var So=0,Mo=[],Eo,To;if(he(_o))for(Eo=_o.length;So<Eo;So++)To=vo(_o[So],So,bo),null!=To&&Mo.push(To);else for(So in _o)To=vo(_o[So],So,bo),null!=To&&Mo.push(To);return Tt.apply([],Mo)},guid:1,proxy:function(_o,vo){var bo,Eo,To;if('string'==typeof vo&&(bo=_o[vo],vo=_o,_o=bo),Dt.isFunction(_o))return Eo=Et.call(arguments,2),To=function(){return _o.apply(vo||this,Eo.concat(Et.call(arguments)))},To.guid=_o.guid=_o.guid||Dt.guid++,To},now:Date.now,support:Pt}),'function'==typeof Symbol&&(Dt.fn[Symbol.iterator]=xt[Symbol.iterator]),Dt.each('Boolean Number String Function Array Date RegExp Object Error Symbol'.split(' '),function(xo,_o){At['[object '+_o+']']=_o.toLowerCase()});var Gt=function(xo){function _o(Xi,qi,Yi,Zi){var an=qi&&qi.ownerDocument,nn=qi?qi.nodeType:9,Ki,Qi,Ji,$i,en,tn,rn;if(Yi=Yi||[],'string'!=typeof Xi||!Xi||1!==nn&&9!==nn&&11!==nn)return Yi;if(!Zi&&((qi?qi.ownerDocument||qi:ni)!==Qo&&Ko(qi),qi=qi||Qo,$o)){if(11!==nn&&(en=Gi.exec(Xi)))if(!(Ki=en[1])){if(en[2])return _i.apply(Yi,qi.getElementsByTagName(Xi)),Yi;if((Ki=en[3])&&zo.getElementsByClassName&&qi.getElementsByClassName)return _i.apply(Yi,qi.getElementsByClassName(Ki)),Yi}else if(9===nn){if(!(Ji=qi.getElementById(Ki)))return Yi;if(Ji.id===Ki)return Yi.push(Ji),Yi}else if(an&&(Ji=an.getElementById(Ki))&&ai(qi,Ji)&&Ji.id===Ki)return Yi.push(Ji),Yi;if(zo.qsa&&!ui[Xi+' ']&&(!ei||!ei.test(Xi))){if(1!==nn)an=qi,rn=Xi;else if('object'!==qi.nodeName.toLowerCase()){for(($i=qi.getAttribute('id'))?$i=$i.replace(ki,Hi):qi.setAttribute('id',$i=oi),tn=Wo(Xi),Qi=tn.length;Qi--;)tn[Qi]='#'+$i+' '+Po(tn[Qi]);rn=tn.join(','),an=Vi.test(Xi)&&Co(qi.parentNode)||qi}if(rn)try{return _i.apply(Yi,an.querySelectorAll(rn)),Yi}catch(sn){}finally{$i===oi&&qi.removeAttribute('id')}}}return Xo(Xi.replace(Ri,'$1'),qi,Yi,Zi)}function vo(){function Xi(Yi,Zi){return qi.push(Yi+' ')>Oo.cacheLength&&delete Xi[qi.shift()],Xi[Yi+' ']=Zi}var qi=[];return Xi}function bo(Xi){return Xi[oi]=!0,Xi}function Eo(Xi){var qi=Qo.createElement('fieldset');try{return!!Xi(qi)}catch(Yi){return!1}finally{qi.parentNode&&qi.parentNode.removeChild(qi),qi=null}}function To(Xi,qi){for(var Yi=Xi.split('|'),Zi=Yi.length;Zi--;)Oo.attrHandle[Yi[Zi]]=qi}function So(Xi,qi){var Yi=qi&&Xi,Zi=Yi&&1===Xi.nodeType&&1===qi.nodeType&&Xi.sourceIndex-qi.sourceIndex;if(Zi)return Zi;if(Yi)for(;Yi=Yi.nextSibling;)if(Yi===qi)return-1;return Xi?1:-1}function Mo(Xi){return function(qi){var Yi=qi.nodeName.toLowerCase();return'input'===Yi&&qi.type===Xi}}function Ao(Xi){return function(qi){var Yi=qi.nodeName.toLowerCase();return('input'===Yi||'button'===Yi)&&qi.type===Xi}}function Lo(Xi){return function(qi){return'form'in qi?qi.parentNode&&!1===qi.disabled?'label'in qi?'label'in qi.parentNode?qi.parentNode.disabled===Xi:qi.disabled===Xi:qi.isDisabled===Xi||qi.isDisabled!==!Xi&&ji(qi)===Xi:qi.disabled===Xi:'label'in qi&&qi.disabled===Xi}}function Ro(Xi){return bo(function(qi){return qi=+qi,bo(function(Yi,Zi){for(var Qi=Xi([],Yi.length,qi),Ji=Qi.length,Ki;Ji--;)Yi[Ki=Qi[Ji]]&&(Yi[Ki]=!(Zi[Ki]=Yi[Ki]))})})}function Co(Xi){return Xi&&'undefined'!=typeof Xi.getElementsByTagName&&Xi}function wo(){}function Po(Xi){for(var qi=0,Yi=Xi.length,Zi='';qi<Yi;qi++)Zi+=Xi[qi].value;return Zi}function Fo(Xi,qi,Yi){var Zi=qi.dir,Ki=qi.next,Qi=Ki||Zi,Ji=Yi&&'parentNode'===Qi,$i=li++;return qi.first?function(en,tn,rn){for(;en=en[Zi];)if(1===en.nodeType||Ji)return Xi(en,tn,rn);return!1}:function(en,tn,rn){var ln=[si,$i],an,nn,sn;if(rn){for(;en=en[Zi];)if((1===en.nodeType||Ji)&&Xi(en,tn,rn))return!0;}else for(;en=en[Zi];)if(1===en.nodeType||Ji)if(sn=en[oi]||(en[oi]={}),nn=sn[en.uniqueID]||(sn[en.uniqueID]={}),Ki&&Ki===en.nodeName.toLowerCase())en=en[Zi]||en;else{if((an=nn[Qi])&&an[0]===si&&an[1]===$i)return ln[2]=an[2];if(nn[Qi]=ln,ln[2]=Xi(en,tn,rn))return!0}return!1}}function Do(Xi){return 1<Xi.length?function(qi,Yi,Zi){for(var Ki=Xi.length;Ki--;)if(!Xi[Ki](qi,Yi,Zi))return!1;return!0}:Xi[0]}function Io(Xi,qi,Yi){for(var Zi=0,Ki=qi.length;Zi<Ki;Zi++)_o(Xi,qi[Zi],Yi);return Yi}function Bo(Xi,qi,Yi,Zi,Ki){for(var Ji=[],$i=0,en=Xi.length,Qi;$i<en;$i++)(Qi=Xi[$i])&&(Yi&&!Yi(Qi,Zi,Ki)||(Ji.push(Qi),null!=qi&&qi.push($i)));return Ji}function Uo(Xi,qi,Yi,Zi,Ki,Qi){return Zi&&!Zi[oi]&&(Zi=Uo(Zi)),Ki&&!Ki[oi]&&(Ki=Uo(Ki,Qi)),bo(function(Ji,$i,en,tn){var sn=[],ln=[],dn=$i.length,pn=Ji||Io(qi||'*',en.nodeType?[en]:en,[]),cn=Xi&&(Ji||!qi)?Bo(pn,sn,Xi,en,tn):pn,un=Yi?Ki||(Ji?Xi:dn||Zi)?[]:$i:cn,rn,an,nn;if(Yi&&Yi(cn,un,en,tn),Zi)for(rn=Bo(un,ln),Zi(rn,[],en,tn),an=rn.length;an--;)(nn=rn[an])&&(un[ln[an]]=!(cn[ln[an]]=nn));if(!Ji)un=Bo(un===$i?un.splice(dn,un.length):un),Ki?Ki(null,$i,un,tn):_i.apply($i,un);else if(Ki||Xi){if(Ki){for(rn=[],an=un.length;an--;)(nn=un[an])&&rn.push(cn[an]=nn);Ki(null,un=[],rn,tn)}for(an=un.length;an--;)(nn=un[an])&&-1<(rn=Ki?bi(Ji,nn):sn[an])&&(Ji[rn]=!($i[rn]=nn))}})}function No(Xi){for(var Ki=Xi.length,Qi=Oo.relative[Xi[0].type],Ji=Qi||Oo.relative[' '],$i=Qi?1:0,en=Fo(function(an){return an===qi},Ji,!0),tn=Fo(function(an){return-1<bi(qi,an)},Ji,!0),rn=[function(an,nn,sn){var ln=!Qi&&(sn||nn!==qo)||((qi=nn).nodeType?en(an,nn,sn):tn(an,nn,sn));return qi=null,ln}],qi,Yi,Zi;$i<Ki;$i++)if(Yi=Oo.relative[Xi[$i].type])rn=[Fo(Do(rn),Yi)];else{if(Yi=Oo.filter[Xi[$i].type].apply(null,Xi[$i].matches),Yi[oi]){for(Zi=++$i;Zi<Ki&&!Oo.relative[Xi[Zi].type];Zi++);return Uo(1<$i&&Do(rn),1<$i&&Po(Xi.slice(0,$i-1).concat({value:' '===Xi[$i-2].type?'*':''})).replace(Ri,'$1'),Yi,$i<Zi&&No(Xi.slice($i,Zi)),Zi<Ki&&No(Xi=Xi.slice(Zi)),Zi<Ki&&Po(Xi))}rn.push(Yi)}return Do(rn)}function Go(Xi,qi){var Yi=0<qi.length,Zi=0<Xi.length,Ki=function(Ji,$i,en,tn,rn){var ln=0,dn='0',pn=Ji&&[],cn=[],un=qo,mn=Ji||Zi&&Oo.find.TAG('*',rn),gn=si+=null==un?1:Math.random()||.1,hn=mn.length,an,nn,sn;for(rn&&(qo=$i===Qo||$i||rn);dn!==hn&&null!=(an=mn[dn]);dn++){if(Zi&&an){for(nn=0,$i||an.ownerDocument===Qo||(Ko(an),en=!$o);sn=Xi[nn++];)if(sn(an,$i||Qo,en)){tn.push(an);break}rn&&(si=gn)}Yi&&((an=!sn&&an)&&ln--,Ji&&pn.push(an))}if(ln+=dn,Yi&&dn!==ln){for(nn=0;sn=qi[nn++];)sn(pn,cn,$i,en);if(Ji){if(0<ln)for(;dn--;)pn[dn]||cn[dn]||(cn[dn]=yi.call(tn));cn=Bo(cn)}_i.apply(tn,cn),rn&&!Ji&&0<cn.length&&1<ln+qi.length&&_o.uniqueSort(tn)}return rn&&(si=gn,qo=un),pn};return Yi?bo(Ki):Ki}var oi='sizzle'+1*new Date,ni=xo.document,si=0,li=0,di=vo(),ci=vo(),ui=vo(),mi=function(qi,Yi){return qi===Yi&&(Zo=!0),0},gi={}.hasOwnProperty,hi=[],yi=hi.pop,xi=hi.push,_i=hi.push,vi=hi.slice,bi=function(qi,Yi){for(var Zi=0,Ki=qi.length;Zi<Ki;Zi++)if(qi[Zi]===Yi)return Zi;return-1},Ei='checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped',Ti='[\\x20\\t\\r\\n\\f]',Si='(?:\\\\.|[\\w-]|[^\0-\\xa0])+',Li=/[\x20\t\r\n\f]+/g,Ri=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,Ci=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,wi=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,Pi=/=[\x20\t\r\n\f]*([^\]'"]*?)[\x20\t\r\n\f]*\]/g,Fi=/:((?:\\.|[\w-]|[^ -\xa0])+)(?:\((('((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)")|((?:\\.|[^\\()[\]]|\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^ -\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^ -\xa0])+))|)[\x20\t\r\n\f]*\])*)|.*)\)|)/,Di=/^(?:\\.|[\w-]|[^ -\xa0])+$/,Ii={ID:/^#((?:\\.|[\w-]|[^ -\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^ -\xa0])+)/,TAG:/^((?:\\.|[\w-]|[^ -\xa0])+|[*])/,ATTR:/^\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^ -\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^ -\xa0])+))|)[\x20\t\r\n\f]*\]/,PSEUDO:/^:((?:\\.|[\w-]|[^ -\xa0])+)(?:\((('((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)")|((?:\\.|[^\\()[\]]|\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^ -\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^ -\xa0])+))|)[\x20\t\r\n\f]*\])*)|.*)\)|)/,CHILD:/^:(only|first|last|nth|nth-last)-(child|of-type)(?:\([\x20\t\r\n\f]*(even|odd|(([+-]|)(\d*)n|)[\x20\t\r\n\f]*(?:([+-]|)[\x20\t\r\n\f]*(\d+)|))[\x20\t\r\n\f]*\)|)/i,bool:/^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$/i,needsContext:/^[\x20\t\r\n\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i},Bi=/^(?:input|select|textarea|button)$/i,Ui=/^h\d$/i,Ni=/^[^{]+\{\s*\[native \w/,Gi=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Vi=/[+~]/,zi=/\\([\da-f]{1,6}[\x20\t\r\n\f]?|([\x20\t\r\n\f])|.)/ig,Oi=function(qi,Yi,Zi){var Ki='0x'+Yi-65536;return Ki!=Ki||Zi?Yi:0>Ki?String.fromCharCode(Ki+65536):String.fromCharCode(55296|Ki>>10,56320|1023&Ki)},ki=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Hi=function(qi,Yi){return Yi?'\0'===qi?'\uFFFD':qi.slice(0,-1)+'\\'+qi.charCodeAt(qi.length-1).toString(16)+' ':'\\'+qi},Wi=function(){Ko()},ji=Fo(function(Xi){return!0===Xi.disabled&&('form'in Xi||'label'in Xi)},{dir:'parentNode',next:'legend'}),Vo,zo,Oo,ko,Ho,Wo,jo,Xo,qo,Yo,Zo,Ko,Qo,Jo,$o,ei,ti,ri,ai;try{_i.apply(hi=vi.call(ni.childNodes),ni.childNodes),hi[ni.childNodes.length].nodeType}catch(Xi){_i={apply:hi.length?function(qi,Yi){xi.apply(qi,vi.call(Yi))}:function(qi,Yi){for(var Zi=qi.length,Ki=0;qi[Zi++]=Yi[Ki++];);qi.length=Zi-1}}}for(Vo in zo=_o.support={},Ho=_o.isXML=function(Xi){var qi=Xi&&(Xi.ownerDocument||Xi).documentElement;return!!qi&&'HTML'!==qi.nodeName},Ko=_o.setDocument=function(Xi){var Zi=Xi?Xi.ownerDocument||Xi:ni,qi,Yi;return Zi!==Qo&&9===Zi.nodeType&&Zi.documentElement?(Qo=Zi,Jo=Qo.documentElement,$o=!Ho(Qo),ni!==Qo&&(Yi=Qo.defaultView)&&Yi.top!==Yi&&(Yi.addEventListener?Yi.addEventListener('unload',Wi,!1):Yi.attachEvent&&Yi.attachEvent('onunload',Wi)),zo.attributes=Eo(function(Ki){return Ki.className='i',!Ki.getAttribute('className')}),zo.getElementsByTagName=Eo(function(Ki){return Ki.appendChild(Qo.createComment('')),!Ki.getElementsByTagName('*').length}),zo.getElementsByClassName=Ni.test(Qo.getElementsByClassName),zo.getById=Eo(function(Ki){return Jo.appendChild(Ki).id=oi,!Qo.getElementsByName||!Qo.getElementsByName(oi).length}),zo.getById?(Oo.filter.ID=function(Ki){var Qi=Ki.replace(zi,Oi);return function(Ji){return Ji.getAttribute('id')===Qi}},Oo.find.ID=function(Ki,Qi){if('undefined'!=typeof Qi.getElementById&&$o){var Ji=Qi.getElementById(Ki);return Ji?[Ji]:[]}}):(Oo.filter.ID=function(Ki){var Qi=Ki.replace(zi,Oi);return function(Ji){var $i='undefined'!=typeof Ji.getAttributeNode&&Ji.getAttributeNode('id');return $i&&$i.value===Qi}},Oo.find.ID=function(Ki,Qi){if('undefined'!=typeof Qi.getElementById&&$o){var tn=Qi.getElementById(Ki),Ji,$i,en;if(tn){if(Ji=tn.getAttributeNode('id'),Ji&&Ji.value===Ki)return[tn];for(en=Qi.getElementsByName(Ki),$i=0;tn=en[$i++];)if(Ji=tn.getAttributeNode('id'),Ji&&Ji.value===Ki)return[tn]}return[]}}),Oo.find.TAG=zo.getElementsByTagName?function(Ki,Qi){return'undefined'==typeof Qi.getElementsByTagName?zo.qsa?Qi.querySelectorAll(Ki):void 0:Qi.getElementsByTagName(Ki)}:function(Ki,Qi){var $i=[],en=0,tn=Qi.getElementsByTagName(Ki),Ji;if('*'===Ki){for(;Ji=tn[en++];)1===Ji.nodeType&&$i.push(Ji);return $i}return tn},Oo.find.CLASS=zo.getElementsByClassName&&function(Ki,Qi){if('undefined'!=typeof Qi.getElementsByClassName&&$o)return Qi.getElementsByClassName(Ki)},ti=[],ei=[],(zo.qsa=Ni.test(Qo.querySelectorAll))&&(Eo(function(Ki){Jo.appendChild(Ki).innerHTML='<a id=\''+oi+'\'></a><select id=\''+oi+'-\r\\\' msallowcapture=\'\'><option selected=\'\'></option></select>',Ki.querySelectorAll('[msallowcapture^=\'\']').length&&ei.push('[*^$]='+Ti+'*(?:\'\'|"")'),Ki.querySelectorAll('[selected]').length||ei.push('\\['+Ti+'*(?:value|'+Ei+')'),Ki.querySelectorAll('[id~='+oi+'-]').length||ei.push('~='),Ki.querySelectorAll(':checked').length||ei.push(':checked'),Ki.querySelectorAll('a#'+oi+'+*').length||ei.push('.#.+[+~]')}),Eo(function(Ki){Ki.innerHTML='<a href=\'\' disabled=\'disabled\'></a><select disabled=\'disabled\'><option/></select>';var Qi=Qo.createElement('input');Qi.setAttribute('type','hidden'),Ki.appendChild(Qi).setAttribute('name','D'),Ki.querySelectorAll('[name=d]').length&&ei.push('name'+Ti+'*[*^$|!~]?='),2!==Ki.querySelectorAll(':enabled').length&&ei.push(':enabled',':disabled'),Jo.appendChild(Ki).disabled=!0,2!==Ki.querySelectorAll(':disabled').length&&ei.push(':enabled',':disabled'),Ki.querySelectorAll('*,:x'),ei.push(',.*:')})),(zo.matchesSelector=Ni.test(ri=Jo.matches||Jo.webkitMatchesSelector||Jo.mozMatchesSelector||Jo.oMatchesSelector||Jo.msMatchesSelector))&&Eo(function(Ki){zo.disconnectedMatch=ri.call(Ki,'*'),ri.call(Ki,'[s!=\'\']:x'),ti.push('!=',':('+Si+')(?:\\(((\'((?:\\\\.|[^\\\\\'])*)\'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|'+('\\['+Ti+'*('+Si+')(?:'+Ti+'*([*^$|!~]?=)'+Ti+'*(?:\'((?:\\\\.|[^\\\\\'])*)\'|"((?:\\\\.|[^\\\\"])*)"|('+Si+'))|)'+Ti+'*\\]')+')*)|.*)\\)|)')}),ei=ei.length&&new RegExp(ei.join('|')),ti=ti.length&&new RegExp(ti.join('|')),qi=Ni.test(Jo.compareDocumentPosition),ai=qi||Ni.test(Jo.contains)?function(Ki,Qi){var Ji=9===Ki.nodeType?Ki.documentElement:Ki,$i=Qi&&Qi.parentNode;return Ki===$i||$i&&1===$i.nodeType&&(Ji.contains?Ji.contains($i):Ki.compareDocumentPosition&&16&Ki.compareDocumentPosition($i))}:function(Ki,Qi){if(Qi)for(;Qi=Qi.parentNode;)if(Qi===Ki)return!0;return!1},mi=qi?function(Ki,Qi){if(Ki===Qi)return Zo=!0,0;var Ji=!Ki.compareDocumentPosition-!Qi.compareDocumentPosition;return Ji?Ji:(Ji=(Ki.ownerDocument||Ki)===(Qi.ownerDocument||Qi)?Ki.compareDocumentPosition(Qi):1,1&Ji||!zo.sortDetached&&Qi.compareDocumentPosition(Ki)===Ji?Ki===Qo||Ki.ownerDocument===ni&&ai(ni,Ki)?-1:Qi===Qo||Qi.ownerDocument===ni&&ai(ni,Qi)?1:Yo?bi(Yo,Ki)-bi(Yo,Qi):0:4&Ji?-1:1)}:function(Ki,Qi){if(Ki===Qi)return Zo=!0,0;var $i=0,en=Ki.parentNode,tn=Qi.parentNode,rn=[Ki],an=[Qi],Ji;if(!en||!tn)return Ki===Qo?-1:Qi===Qo?1:en?-1:tn?1:Yo?bi(Yo,Ki)-bi(Yo,Qi):0;if(en===tn)return So(Ki,Qi);for(Ji=Ki;Ji=Ji.parentNode;)rn.unshift(Ji);for(Ji=Qi;Ji=Ji.parentNode;)an.unshift(Ji);for(;rn[$i]===an[$i];)$i++;return $i?So(rn[$i],an[$i]):rn[$i]===ni?-1:an[$i]===ni?1:0},Qo):Qo},_o.matches=function(Xi,qi){return _o(Xi,null,null,qi)},_o.matchesSelector=function(Xi,qi){if((Xi.ownerDocument||Xi)!==Qo&&Ko(Xi),qi=qi.replace(Pi,'=\'$1\']'),zo.matchesSelector&&$o&&!ui[qi+' ']&&(!ti||!ti.test(qi))&&(!ei||!ei.test(qi)))try{var Yi=ri.call(Xi,qi);if(Yi||zo.disconnectedMatch||Xi.document&&11!==Xi.document.nodeType)return Yi}catch(Zi){}return 0<_o(qi,Qo,null,[Xi]).length},_o.contains=function(Xi,qi){return(Xi.ownerDocument||Xi)!==Qo&&Ko(Xi),ai(Xi,qi)},_o.attr=function(Xi,qi){(Xi.ownerDocument||Xi)!==Qo&&Ko(Xi);var Yi=Oo.attrHandle[qi.toLowerCase()],Zi=Yi&&gi.call(Oo.attrHandle,qi.toLowerCase())?Yi(Xi,qi,!$o):void 0;return void 0===Zi?zo.attributes||!$o?Xi.getAttribute(qi):(Zi=Xi.getAttributeNode(qi))&&Zi.specified?Zi.value:null:Zi},_o.escape=function(Xi){return(Xi+'').replace(ki,Hi)},_o.error=function(Xi){throw new Error('Syntax error, unrecognized expression: '+Xi)},_o.uniqueSort=function(Xi){var Yi=[],Zi=0,Ki=0,qi;if(Zo=!zo.detectDuplicates,Yo=!zo.sortStable&&Xi.slice(0),Xi.sort(mi),Zo){for(;qi=Xi[Ki++];)qi===Xi[Ki]&&(Zi=Yi.push(Ki));for(;Zi--;)Xi.splice(Yi[Zi],1)}return Yo=null,Xi},ko=_o.getText=function(Xi){var Yi='',Zi=0,Ki=Xi.nodeType,qi;if(!Ki)for(;qi=Xi[Zi++];)Yi+=ko(qi);else if(1===Ki||9===Ki||11===Ki){if('string'==typeof Xi.textContent)return Xi.textContent;for(Xi=Xi.firstChild;Xi;Xi=Xi.nextSibling)Yi+=ko(Xi)}else if(3===Ki||4===Ki)return Xi.nodeValue;return Yi},Oo=_o.selectors={cacheLength:50,createPseudo:bo,match:Ii,attrHandle:{},find:{},relative:{">":{dir:'parentNode',first:!0}," ":{dir:'parentNode'},"+":{dir:'previousSibling',first:!0},"~":{dir:'previousSibling'}},preFilter:{ATTR:function(qi){return qi[1]=qi[1].replace(zi,Oi),qi[3]=(qi[3]||qi[4]||qi[5]||'').replace(zi,Oi),'~='===qi[2]&&(qi[3]=' '+qi[3]+' '),qi.slice(0,4)},CHILD:function(qi){return qi[1]=qi[1].toLowerCase(),'nth'===qi[1].slice(0,3)?(qi[3]||_o.error(qi[0]),qi[4]=+(qi[4]?qi[5]+(qi[6]||1):2*('even'===qi[3]||'odd'===qi[3])),qi[5]=+(qi[7]+qi[8]||'odd'===qi[3])):qi[3]&&_o.error(qi[0]),qi},PSEUDO:function(qi){var Zi=!qi[6]&&qi[2],Yi;return Ii.CHILD.test(qi[0])?null:(qi[3]?qi[2]=qi[4]||qi[5]||'':Zi&&Fi.test(Zi)&&(Yi=Wo(Zi,!0))&&(Yi=Zi.indexOf(')',Zi.length-Yi)-Zi.length)&&(qi[0]=qi[0].slice(0,Yi),qi[2]=Zi.slice(0,Yi)),qi.slice(0,3))}},filter:{TAG:function(qi){var Yi=qi.replace(zi,Oi).toLowerCase();return'*'===qi?function(){return!0}:function(Zi){return Zi.nodeName&&Zi.nodeName.toLowerCase()===Yi}},CLASS:function(qi){var Yi=di[qi+' '];return Yi||(Yi=new RegExp('(^|'+Ti+')'+qi+'('+Ti+'|$)'))&&di(qi,function(Zi){return Yi.test('string'==typeof Zi.className&&Zi.className||'undefined'!=typeof Zi.getAttribute&&Zi.getAttribute('class')||'')})},ATTR:function(qi,Yi,Zi){return function(Ki){var Qi=_o.attr(Ki,qi);return null==Qi?'!='===Yi:!Yi||(Qi+='','='===Yi?Qi===Zi:'!='===Yi?Qi!==Zi:'^='===Yi?Zi&&0===Qi.indexOf(Zi):'*='===Yi?Zi&&-1<Qi.indexOf(Zi):'$='===Yi?Zi&&Qi.slice(-Zi.length)===Zi:'~='===Yi?-1<(' '+Qi.replace(Li,' ')+' ').indexOf(Zi):'|='==Yi&&(Qi===Zi||Qi.slice(0,Zi.length+1)===Zi+'-'))}},CHILD:function(qi,Yi,Zi,Ki,Qi){var Ji='nth'!==qi.slice(0,3),$i='last'!==qi.slice(-4),en='of-type'===Yi;return 1===Ki&&0===Qi?function(tn){return!!tn.parentNode}:function(tn,rn,an){var un=Ji==$i?'previousSibling':'nextSibling',mn=tn.parentNode,gn=en&&tn.nodeName.toLowerCase(),hn=!an&&!en,yn=!1,nn,sn,ln,dn,pn,cn;if(mn){if(Ji){for(;un;){for(dn=tn;dn=dn[un];)if(en?dn.nodeName.toLowerCase()===gn:1===dn.nodeType)return!1;cn=un='only'===qi&&!cn&&'nextSibling'}return!0}if(cn=[$i?mn.firstChild:mn.lastChild],$i&&hn){for(dn=mn,ln=dn[oi]||(dn[oi]={}),sn=ln[dn.uniqueID]||(ln[dn.uniqueID]={}),nn=sn[qi]||[],pn=nn[0]===si&&nn[1],yn=pn&&nn[2],dn=pn&&mn.childNodes[pn];dn=++pn&&dn&&dn[un]||(yn=pn=0)||cn.pop();)if(1===dn.nodeType&&++yn&&dn===tn){sn[qi]=[si,pn,yn];break}}else if(hn&&(dn=tn,ln=dn[oi]||(dn[oi]={}),sn=ln[dn.uniqueID]||(ln[dn.uniqueID]={}),nn=sn[qi]||[],pn=nn[0]===si&&nn[1],yn=pn),!1===yn)for(;(dn=++pn&&dn&&dn[un]||(yn=pn=0)||cn.pop())&&!((en?dn.nodeName.toLowerCase()===gn:1===dn.nodeType)&&++yn&&(hn&&(ln=dn[oi]||(dn[oi]={}),sn=ln[dn.uniqueID]||(ln[dn.uniqueID]={}),sn[qi]=[si,yn]),dn===tn)););return yn-=Qi,yn===Ki||0==yn%Ki&&0<=yn/Ki}}},PSEUDO:function(qi,Yi){var Ki=Oo.pseudos[qi]||Oo.setFilters[qi.toLowerCase()]||_o.error('unsupported pseudo: '+qi),Zi;return Ki[oi]?Ki(Yi):1<Ki.length?(Zi=[qi,qi,'',Yi],Oo.setFilters.hasOwnProperty(qi.toLowerCase())?bo(function(Qi,Ji){for(var en=Ki(Qi,Yi),tn=en.length,$i;tn--;)$i=bi(Qi,en[tn]),Qi[$i]=!(Ji[$i]=en[tn])}):function(Qi){return Ki(Qi,0,Zi)}):Ki}},pseudos:{not:bo(function(Xi){var qi=[],Yi=[],Zi=jo(Xi.replace(Ri,'$1'));return Zi[oi]?bo(function(Ki,Qi,Ji,$i){for(var tn=Zi(Ki,null,$i,[]),rn=Ki.length,en;rn--;)(en=tn[rn])&&(Ki[rn]=!(Qi[rn]=en))}):function(Ki,Qi,Ji){return qi[0]=Ki,Zi(qi,null,Ji,Yi),qi[0]=null,!Yi.pop()}}),has:bo(function(Xi){return function(qi){return 0<_o(Xi,qi).length}}),contains:bo(function(Xi){return Xi=Xi.replace(zi,Oi),function(qi){return-1<(qi.textContent||qi.innerText||ko(qi)).indexOf(Xi)}}),lang:bo(function(Xi){return Di.test(Xi||'')||_o.error('unsupported lang: '+Xi),Xi=Xi.replace(zi,Oi).toLowerCase(),function(qi){var Yi;do if(Yi=$o?qi.lang:qi.getAttribute('xml:lang')||qi.getAttribute('lang'))return Yi=Yi.toLowerCase(),Yi===Xi||0===Yi.indexOf(Xi+'-');while((qi=qi.parentNode)&&1===qi.nodeType);return!1}}),target:function(qi){var Yi=xo.location&&xo.location.hash;return Yi&&Yi.slice(1)===qi.id},root:function(qi){return qi===Jo},focus:function(qi){return qi===Qo.activeElement&&(!Qo.hasFocus||Qo.hasFocus())&&!!(qi.type||qi.href||~qi.tabIndex)},enabled:Lo(!1),disabled:Lo(!0),checked:function(qi){var Yi=qi.nodeName.toLowerCase();return'input'===Yi&&!!qi.checked||'option'===Yi&&!!qi.selected},selected:function(qi){return qi.parentNode&&qi.parentNode.selectedIndex,!0===qi.selected},empty:function(qi){for(qi=qi.firstChild;qi;qi=qi.nextSibling)if(6>qi.nodeType)return!1;return!0},parent:function(qi){return!Oo.pseudos.empty(qi)},header:function(qi){return Ui.test(qi.nodeName)},input:function(qi){return Bi.test(qi.nodeName)},button:function(qi){var Yi=qi.nodeName.toLowerCase();return'input'===Yi&&'button'===qi.type||'button'===Yi},text:function(qi){var Yi;return'input'===qi.nodeName.toLowerCase()&&'text'===qi.type&&(null==(Yi=qi.getAttribute('type'))||'text'===Yi.toLowerCase())},first:Ro(function(){return[0]}),last:Ro(function(Xi,qi){return[qi-1]}),eq:Ro(function(Xi,qi,Yi){return[0>Yi?Yi+qi:Yi]}),even:Ro(function(Xi,qi){for(var Yi=0;Yi<qi;Yi+=2)Xi.push(Yi);return Xi}),odd:Ro(function(Xi,qi){for(var Yi=1;Yi<qi;Yi+=2)Xi.push(Yi);return Xi}),lt:Ro(function(Xi,qi,Yi){for(var Zi=0>Yi?Yi+qi:Yi;0<=--Zi;)Xi.push(Zi);return Xi}),gt:Ro(function(Xi,qi,Yi){for(var Zi=0>Yi?Yi+qi:Yi;++Zi<qi;)Xi.push(Zi);return Xi})}},Oo.pseudos.nth=Oo.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Oo.pseudos[Vo]=Mo(Vo);for(Vo in{submit:!0,reset:!0})Oo.pseudos[Vo]=Ao(Vo);return wo.prototype=Oo.filters=Oo.pseudos,Oo.setFilters=new wo,Wo=_o.tokenize=function(Xi,qi){var tn=ci[Xi+' '],Yi,Zi,Ki,Qi,Ji,$i,en;if(tn)return qi?0:tn.slice(0);for(Ji=Xi,$i=[],en=Oo.preFilter;Ji;){for(Qi in Yi&&!(Zi=Ci.exec(Ji))||(Zi&&(Ji=Ji.slice(Zi[0].length)||Ji),$i.push(Ki=[])),Yi=!1,(Zi=wi.exec(Ji))&&(Yi=Zi.shift(),Ki.push({value:Yi,type:Zi[0].replace(Ri,' ')}),Ji=Ji.slice(Yi.length)),Oo.filter)(Zi=Ii[Qi].exec(Ji))&&(!en[Qi]||(Zi=en[Qi](Zi)))&&(Yi=Zi.shift(),Ki.push({value:Yi,type:Qi,matches:Zi}),Ji=Ji.slice(Yi.length));if(!Yi)break}return qi?Ji.length:Ji?_o.error(Xi):ci(Xi,$i).slice(0)},(jo=_o.compile=function(Xi,qi){var Zi=[],Ki=[],Qi=ui[Xi+' '],Yi;if(!Qi){for(qi||(qi=Wo(Xi)),Yi=qi.length;Yi--;)Qi=No(qi[Yi]),Qi[oi]?Zi.push(Qi):Ki.push(Qi);Qi=ui(Xi,Go(Ki,Zi)),Qi.selector=Xi}return Qi},Xo=_o.select=function(Xi,qi,Yi,Zi){var tn='function'==typeof Xi&&Xi,rn=!Zi&&Wo(Xi=tn.selector||Xi),Ki,Qi,Ji,$i,en;if(Yi=Yi||[],1===rn.length){if(Qi=rn[0]=rn[0].slice(0),2<Qi.length&&'ID'===(Ji=Qi[0]).type&&9===qi.nodeType&&$o&&Oo.relative[Qi[1].type]){if(qi=(Oo.find.ID(Ji.matches[0].replace(zi,Oi),qi)||[])[0],!qi)return Yi;tn&&(qi=qi.parentNode),Xi=Xi.slice(Qi.shift().value.length)}for(Ki=Ii.needsContext.test(Xi)?0:Qi.length;Ki--&&(Ji=Qi[Ki],!Oo.relative[$i=Ji.type]);)if((en=Oo.find[$i])&&(Zi=en(Ji.matches[0].replace(zi,Oi),Vi.test(Qi[0].type)&&Co(qi.parentNode)||qi))){if(Qi.splice(Ki,1),Xi=Zi.length&&Po(Qi),!Xi)return _i.apply(Yi,Zi),Yi;break}}return(tn||jo(Xi,rn))(Zi,qi,!$o,Yi,!qi||Vi.test(Xi)&&Co(qi.parentNode)||qi),Yi},zo.sortStable=oi.split('').sort(mi).join('')===oi,zo.detectDuplicates=!!Zo,Ko(),zo.sortDetached=Eo(function(Xi){return 1&Xi.compareDocumentPosition(Qo.createElement('fieldset'))}),Eo(function(Xi){return Xi.innerHTML='<a href=\'#\'></a>','#'===Xi.firstChild.getAttribute('href')})||To('type|href|height|width',function(Xi,qi,Yi){if(!Yi)return Xi.getAttribute(qi,'type'===qi.toLowerCase()?1:2)}),zo.attributes&&Eo(function(Xi){return Xi.innerHTML='<input/>',Xi.firstChild.setAttribute('value',''),''===Xi.firstChild.getAttribute('value')})||To('value',function(Xi,qi,Yi){if(!Yi&&'input'===Xi.nodeName.toLowerCase())return Xi.defaultValue}),Eo(function(Xi){return null==Xi.getAttribute('disabled')})||To(Ei,function(Xi,qi,Yi){var Zi;if(!Yi)return!0===Xi[qi]?qi.toLowerCase():(Zi=Xi.getAttributeNode(qi))&&Zi.specified?Zi.value:null}),_o)}(ue);Dt.find=Gt,Dt.expr=Gt.selectors,Dt.expr[':']=Dt.expr.pseudos,Dt.uniqueSort=Dt.unique=Gt.uniqueSort,Dt.text=Gt.getText,Dt.isXMLDoc=Gt.isXML,Dt.contains=Gt.contains,Dt.escapeSelector=Gt.escape;var Vt=function(_o,vo,bo){for(var Eo=[];(_o=_o[vo])&&9!==_o.nodeType;)if(1===_o.nodeType){if(void 0!==bo&&Dt(_o).is(bo))break;Eo.push(_o)}return Eo},zt=function(_o,vo){for(var bo=[];_o;_o=_o.nextSibling)1===_o.nodeType&&_o!==vo&&bo.push(_o);return bo},Ot=Dt.expr.match.needsContext,Ht=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,Wt=/^.[^:#\[\.,]*$/;Dt.filter=function(xo,_o,vo){var bo=_o[0];return vo&&(xo=':not('+xo+')'),1===_o.length&&1===bo.nodeType?Dt.find.matchesSelector(bo,xo)?[bo]:[]:Dt.find.matches(xo,Dt.grep(_o,function(Eo){return 1===Eo.nodeType}))},Dt.fn.extend({find:function(_o){var Eo=this.length,To=this,vo,bo;if('string'!=typeof _o)return this.pushStack(Dt(_o).filter(function(){for(vo=0;vo<Eo;vo++)if(Dt.contains(To[vo],this))return!0}));for(bo=this.pushStack([]),vo=0;vo<Eo;vo++)Dt.find(_o,To[vo],bo);return 1<Eo?Dt.uniqueSort(bo):bo},filter:function(_o){return this.pushStack(xe(this,_o||[],!1))},not:function(_o){return this.pushStack(xe(this,_o||[],!0))},is:function(_o){return!!xe(this,'string'==typeof _o&&Ot.test(_o)?Dt(_o):_o||[],!1).length}});var Xt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,qt=Dt.fn.init=function(xo,_o,vo){var bo,Eo;if(!xo)return this;if(vo=vo||jt,'string'==typeof xo){if(bo='<'===xo[0]&&'>'===xo[xo.length-1]&&3<=xo.length?[null,xo,null]:Xt.exec(xo),!bo||!bo[1]&&_o)return!_o||_o.jquery?(_o||vo).find(xo):this.constructor(_o).find(xo);if(bo[1]){if(_o=_o instanceof Dt?_o[0]:_o,Dt.merge(this,Dt.parseHTML(bo[1],_o&&_o.nodeType?_o.ownerDocument||_o:_t,!0)),Ht.test(bo[1])&&Dt.isPlainObject(_o))for(bo in _o)Dt.isFunction(this[bo])?this[bo](_o[bo]):this.attr(bo,_o[bo]);return this}return Eo=_t.getElementById(bo[2]),Eo&&(this[0]=Eo,this.length=1),this}return xo.nodeType?(this[0]=xo,this.length=1,this):Dt.isFunction(xo)?void 0===vo.ready?xo(Dt):vo.ready(xo):Dt.makeArray(xo,this)},jt;qt.prototype=Dt.fn,jt=Dt(_t);var Yt=/^(?:parents|prev(?:Until|All))/,Zt={children:!0,contents:!0,next:!0,prev:!0};Dt.fn.extend({has:function(_o){var vo=Dt(_o,this),bo=vo.length;return this.filter(function(){for(var Eo=0;Eo<bo;Eo++)if(Dt.contains(this,vo[Eo]))return!0})},closest:function(_o,vo){var Eo=0,To=this.length,So=[],Mo='string'!=typeof _o&&Dt(_o),bo;if(!Ot.test(_o))for(;Eo<To;Eo++)for(bo=this[Eo];bo&&bo!==vo;bo=bo.parentNode)if(11>bo.nodeType&&(Mo?-1<Mo.index(bo):1===bo.nodeType&&Dt.find.matchesSelector(bo,_o))){So.push(bo);break}return this.pushStack(1<So.length?Dt.uniqueSort(So):So)},index:function(_o){return _o?'string'==typeof _o?Mt.call(Dt(_o),this[0]):Mt.call(this,_o.jquery?_o[0]:_o):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(_o,vo){return this.pushStack(Dt.uniqueSort(Dt.merge(this.get(),Dt(_o,vo))))},addBack:function(_o){return this.add(null==_o?this.prevObject:this.prevObject.filter(_o))}}),Dt.each({parent:function(_o){var vo=_o.parentNode;return vo&&11!==vo.nodeType?vo:null},parents:function(_o){return Vt(_o,'parentNode')},parentsUntil:function(_o,vo,bo){return Vt(_o,'parentNode',bo)},next:function(_o){return _e(_o,'nextSibling')},prev:function(_o){return _e(_o,'previousSibling')},nextAll:function(_o){return Vt(_o,'nextSibling')},prevAll:function(_o){return Vt(_o,'previousSibling')},nextUntil:function(_o,vo,bo){return Vt(_o,'nextSibling',bo)},prevUntil:function(_o,vo,bo){return Vt(_o,'previousSibling',bo)},siblings:function(_o){return zt((_o.parentNode||{}).firstChild,_o)},children:function(_o){return zt(_o.firstChild)},contents:function(_o){return ye(_o,'iframe')?_o.contentDocument:(ye(_o,'template')&&(_o=_o.content||_o),Dt.merge([],_o.childNodes))}},function(xo,_o){Dt.fn[xo]=function(vo,bo){var Eo=Dt.map(this,_o,vo);return'Until'!==xo.slice(-5)&&(bo=vo),bo&&'string'==typeof bo&&(Eo=Dt.filter(bo,Eo)),1<this.length&&(Zt[xo]||Dt.uniqueSort(Eo),Yt.test(xo)&&Eo.reverse()),this.pushStack(Eo)}});var Kt=/[^\x20\t\r\n\f]+/g;Dt.Callbacks=function(xo){xo='string'==typeof xo?ve(xo):Dt.extend({},xo);var To=[],So=[],Mo=-1,Ao=function(){for(Eo=Eo||xo.once,bo=_o=!0;So.length;Mo=-1)for(vo=So.shift();++Mo<To.length;)!1===To[Mo].apply(vo[0],vo[1])&&xo.stopOnFalse&&(Mo=To.length,vo=!1);xo.memory||(vo=!1),_o=!1,Eo&&(To=vo?[]:'')},Lo={add:function(){return To&&(vo&&!_o&&(Mo=To.length-1,So.push(vo)),function Co(wo){Dt.each(wo,function(Po,Fo){Dt.isFunction(Fo)?xo.unique&&Lo.has(Fo)||To.push(Fo):Fo&&Fo.length&&'string'!==Dt.type(Fo)&&Co(Fo)})}(arguments),vo&&!_o&&Ao()),this},remove:function(){return Dt.each(arguments,function(Co,wo){for(var Po;-1<(Po=Dt.inArray(wo,To,Po));)To.splice(Po,1),Po<=Mo&&Mo--}),this},has:function(Co){return Co?-1<Dt.inArray(Co,To):0<To.length},empty:function(){return To&&(To=[]),this},disable:function(){return Eo=So=[],To=vo='',this},disabled:function(){return!To},lock:function(){return Eo=So=[],vo||_o||(To=vo=''),this},locked:function(){return!!Eo},fireWith:function(Co,wo){return Eo||(wo=wo||[],wo=[Co,wo.slice?wo.slice():wo],So.push(wo),_o||Ao()),this},fire:function(){return Lo.fireWith(this,arguments),this},fired:function(){return!!bo}},_o,vo,bo,Eo;return Lo},Dt.extend({Deferred:function(_o){var vo=[['notify','progress',Dt.Callbacks('memory'),Dt.Callbacks('memory'),2],['resolve','done',Dt.Callbacks('once memory'),Dt.Callbacks('once memory'),0,'resolved'],['reject','fail',Dt.Callbacks('once memory'),Dt.Callbacks('once memory'),1,'rejected']],bo='pending',Eo={state:function(){return bo},always:function(){return To.done(arguments).fail(arguments),this},catch:function(Mo){return Eo.then(null,Mo)},pipe:function(){var Mo=arguments;return Dt.Deferred(function(Ao){Dt.each(vo,function(Lo,Ro){var Co=Dt.isFunction(Mo[Ro[4]])&&Mo[Ro[4]];To[Ro[1]](function(){var wo=Co&&Co.apply(this,arguments);wo&&Dt.isFunction(wo.promise)?wo.promise().progress(Ao.notify).done(Ao.resolve).fail(Ao.reject):Ao[Ro[0]+'With'](this,Co?[wo]:arguments)})}),Mo=null}).promise()},then:function(Mo,Ao,Lo){function Ro(wo,Po,Fo,Do){return function(){var Io=this,Bo=arguments,Uo=function(){var Vo,Go;if(!(wo<Co)){if(Vo=Fo.apply(Io,Bo),Vo===Po.promise())throw new TypeError('Thenable self-resolution');Go=Vo&&('object'==('undefined'==typeof Vo?'undefined':pe(Vo))||'function'==typeof Vo)&&Vo.then,Dt.isFunction(Go)?Do?Go.call(Vo,Ro(Co,Po,Ee,Do),Ro(Co,Po,Te,Do)):(Co++,Go.call(Vo,Ro(Co,Po,Ee,Do),Ro(Co,Po,Te,Do),Ro(Co,Po,Ee,Po.notifyWith))):(Fo!==Ee&&(Io=void 0,Bo=[Vo]),(Do||Po.resolveWith)(Io,Bo))}},No=Do?Uo:function(){try{Uo()}catch(Go){Dt.Deferred.exceptionHook&&Dt.Deferred.exceptionHook(Go,No.stackTrace),wo+1>=Co&&(Fo!==Te&&(Io=void 0,Bo=[Go]),Po.rejectWith(Io,Bo))}};wo?No():(Dt.Deferred.getStackHook&&(No.stackTrace=Dt.Deferred.getStackHook()),ue.setTimeout(No))}}var Co=0;return Dt.Deferred(function(wo){vo[0][3].add(Ro(0,wo,Dt.isFunction(Lo)?Lo:Ee,wo.notifyWith)),vo[1][3].add(Ro(0,wo,Dt.isFunction(Mo)?Mo:Ee)),vo[2][3].add(Ro(0,wo,Dt.isFunction(Ao)?Ao:Te))}).promise()},promise:function(Mo){return null==Mo?Eo:Dt.extend(Mo,Eo)}},To={};return Dt.each(vo,function(So,Mo){var Ao=Mo[2],Lo=Mo[5];Eo[Mo[1]]=Ao.add,Lo&&Ao.add(function(){bo=Lo},vo[3-So][2].disable,vo[0][2].lock),Ao.add(Mo[3].fire),To[Mo[0]]=function(){return To[Mo[0]+'With'](this===To?void 0:this,arguments),this},To[Mo[0]+'With']=Ao.fireWith}),Eo.promise(To),_o&&_o.call(To,To),To},when:function(_o){var vo=arguments.length,bo=vo,Eo=Array(bo),To=Et.call(arguments),So=Dt.Deferred(),Mo=function(Lo){return function(Ro){Eo[Lo]=this,To[Lo]=1<arguments.length?Et.call(arguments):Ro,--vo||So.resolveWith(Eo,To)}};if(1>=vo&&(Se(_o,So.done(Mo(bo)).resolve,So.reject,!vo),'pending'===So.state()||Dt.isFunction(To[bo]&&To[bo].then)))return So.then();for(;bo--;)Se(To[bo],Mo(bo),So.reject);return So.promise()}});var Qt=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;Dt.Deferred.exceptionHook=function(xo,_o){ue.console&&ue.console.warn&&xo&&Qt.test(xo.name)&&ue.console.warn('jQuery.Deferred exception: '+xo.message,xo.stack,_o)},Dt.readyException=function(xo){ue.setTimeout(function(){throw xo})};var Jt=Dt.Deferred();Dt.fn.ready=function(xo){return Jt.then(xo)['catch'](function(_o){Dt.readyException(_o)}),this},Dt.extend({isReady:!1,readyWait:1,ready:function(_o){(!0===_o?--Dt.readyWait:Dt.isReady)||(Dt.isReady=!0,!0!==_o&&0<--Dt.readyWait||Jt.resolveWith(_t,[Dt]))}}),Dt.ready.then=Jt.then,'complete'!==_t.readyState&&('loading'===_t.readyState||_t.documentElement.doScroll)?(_t.addEventListener('DOMContentLoaded',Me),ue.addEventListener('load',Me)):ue.setTimeout(Dt.ready);var $t=function xo(_o,vo,bo,Eo,To,So,Mo){var Ao=0,Lo=_o.length,Ro=null==bo;if('object'===Dt.type(bo))for(Ao in To=!0,bo)xo(_o,vo,Ao,bo[Ao],!0,So,Mo);else if(void 0!==Eo&&(To=!0,Dt.isFunction(Eo)||(Mo=!0),Ro&&(Mo?(vo.call(_o,Eo),vo=null):(Ro=vo,vo=function(wo,Po,Fo){return Ro.call(Dt(wo),Fo)})),vo))for(;Ao<Lo;Ao++)vo(_o[Ao],bo,Mo?Eo:Eo.call(_o[Ao],Ao,vo(_o[Ao],bo)));return To?_o:Ro?vo.call(_o):Lo?vo(_o[0],bo):So},er=function(_o){return 1===_o.nodeType||9===_o.nodeType||!+_o.nodeType};Ae.uid=1,Ae.prototype={cache:function(_o){var vo=_o[this.expando];return vo||(vo={},er(_o)&&(_o.nodeType?_o[this.expando]=vo:Object.defineProperty(_o,this.expando,{value:vo,configurable:!0}))),vo},set:function(_o,vo,bo){var To=this.cache(_o),Eo;if('string'==typeof vo)To[Dt.camelCase(vo)]=bo;else for(Eo in vo)To[Dt.camelCase(Eo)]=vo[Eo];return To},get:function(_o,vo){return void 0===vo?this.cache(_o):_o[this.expando]&&_o[this.expando][Dt.camelCase(vo)]},access:function(_o,vo,bo){return void 0===vo||vo&&'string'==typeof vo&&void 0===bo?this.get(_o,vo):(this.set(_o,vo,bo),void 0===bo?vo:bo)},remove:function(_o,vo){var Eo=_o[this.expando],bo;if(void 0!==Eo){if(void 0!==vo)for(Array.isArray(vo)?vo=vo.map(Dt.camelCase):(vo=Dt.camelCase(vo),vo=(vo in Eo)?[vo]:vo.match(Kt)||[]),bo=vo.length;bo--;)delete Eo[vo[bo]];(void 0===vo||Dt.isEmptyObject(Eo))&&(_o.nodeType?_o[this.expando]=void 0:delete _o[this.expando])}},hasData:function(_o){var vo=_o[this.expando];return void 0!==vo&&!Dt.isEmptyObject(vo)}};var tr=new Ae,rr=new Ae,ar=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,or=/[A-Z]/g;Dt.extend({hasData:function(_o){return rr.hasData(_o)||tr.hasData(_o)},data:function(_o,vo,bo){return rr.access(_o,vo,bo)},removeData:function(_o,vo){rr.remove(_o,vo)},_data:function(_o,vo,bo){return tr.access(_o,vo,bo)},_removeData:function(_o,vo){tr.remove(_o,vo)}}),Dt.fn.extend({data:function(_o,vo){var So=this[0],Mo=So&&So.attributes,bo,Eo,To;if(void 0===_o){if(this.length&&(To=rr.get(So),1===So.nodeType&&!tr.get(So,'hasDataAttrs'))){for(bo=Mo.length;bo--;)Mo[bo]&&(Eo=Mo[bo].name,0===Eo.indexOf('data-')&&(Eo=Dt.camelCase(Eo.slice(5)),Re(So,Eo,To[Eo])));tr.set(So,'hasDataAttrs',!0)}return To}return'object'==('undefined'==typeof _o?'undefined':pe(_o))?this.each(function(){rr.set(this,_o)}):$t(this,function(Ao){var Lo;if(So&&void 0===Ao){if(Lo=rr.get(So,_o),void 0!==Lo)return Lo;if(Lo=Re(So,_o),void 0!==Lo)return Lo}else this.each(function(){rr.set(this,_o,Ao)})},null,vo,1<arguments.length,null,!0)},removeData:function(_o){return this.each(function(){rr.remove(this,_o)})}}),Dt.extend({queue:function(_o,vo,bo){var Eo;if(_o)return vo=(vo||'fx')+'queue',Eo=tr.get(_o,vo),bo&&(!Eo||Array.isArray(bo)?Eo=tr.access(_o,vo,Dt.makeArray(bo)):Eo.push(bo)),Eo||[]},dequeue:function(_o,vo){vo=vo||'fx';var bo=Dt.queue(_o,vo),Eo=bo.length,To=bo.shift(),So=Dt._queueHooks(_o,vo);'inprogress'===To&&(To=bo.shift(),Eo--),To&&('fx'===vo&&bo.unshift('inprogress'),delete So.stop,To.call(_o,function(){Dt.dequeue(_o,vo)},So)),!Eo&&So&&So.empty.fire()},_queueHooks:function(_o,vo){var bo=vo+'queueHooks';return tr.get(_o,bo)||tr.access(_o,bo,{empty:Dt.Callbacks('once memory').add(function(){tr.remove(_o,[vo+'queue',bo])})})}}),Dt.fn.extend({queue:function(_o,vo){var bo=2;return'string'!=typeof _o&&(vo=_o,_o='fx',bo--),arguments.length<bo?Dt.queue(this[0],_o):void 0===vo?this:this.each(function(){var Eo=Dt.queue(this,_o,vo);Dt._queueHooks(this,_o),'fx'===_o&&'inprogress'!==Eo[0]&&Dt.dequeue(this,_o)})},dequeue:function(_o){return this.each(function(){Dt.dequeue(this,_o)})},clearQueue:function(_o){return this.queue(_o||'fx',[])},promise:function(_o,vo){var Eo=1,To=Dt.Deferred(),So=this,Mo=this.length,Ao=function(){--Eo||To.resolveWith(So,[So])},bo;for('string'!=typeof _o&&(vo=_o,_o=void 0),_o=_o||'fx';Mo--;)bo=tr.get(So[Mo],_o+'queueHooks'),bo&&bo.empty&&(Eo++,bo.empty.add(Ao));return Ao(),To.promise(vo)}});var ir=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,nr=new RegExp('^(?:([+-])=|)('+ir+')([a-z%]*)$','i'),sr=['Top','Right','Bottom','Left'],dr=function(_o,vo){return _o=vo||_o,'none'===_o.style.display||''===_o.style.display&&Dt.contains(_o.ownerDocument,_o)&&'none'===Dt.css(_o,'display')},pr=function(_o,vo,bo,Eo){var Mo={},To,So;for(So in vo)Mo[So]=_o.style[So],_o.style[So]=vo[So];for(So in To=bo.apply(_o,Eo||[]),vo)_o.style[So]=Mo[So];return To},cr={};Dt.fn.extend({show:function(){return Pe(this,!0)},hide:function(){return Pe(this)},toggle:function(_o){return'boolean'==typeof _o?_o?this.show():this.hide():this.each(function(){dr(this)?Dt(this).show():Dt(this).hide()})}});var ur=/^(?:checkbox|radio)$/i,mr=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,fr=/^$|\/(?:java|ecma)script/i,gr={option:[1,'<select multiple=\'multiple\'>','</select>'],thead:[1,'<table>','</table>'],col:[2,'<table><colgroup>','</colgroup></table>'],tr:[2,'<table><tbody>','</tbody></table>'],td:[3,'<table><tbody><tr>','</tr></tbody></table>'],_default:[0,'','']};gr.optgroup=gr.option,gr.tbody=gr.tfoot=gr.colgroup=gr.caption=gr.thead,gr.th=gr.td;var hr=/<|&#?\w+;/;!function(){var xo=_t.createDocumentFragment(),_o=xo.appendChild(_t.createElement('div')),vo=_t.createElement('input');vo.setAttribute('type','radio'),vo.setAttribute('checked','checked'),vo.setAttribute('name','t'),_o.appendChild(vo),Pt.checkClone=_o.cloneNode(!0).cloneNode(!0).lastChild.checked,_o.innerHTML='<textarea>x</textarea>',Pt.noCloneChecked=!!_o.cloneNode(!0).lastChild.defaultValue}();var yr=_t.documentElement,xr=/^key/,_r=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,vr=/^([^.]*)(?:\.(.+)|)/;Dt.event={global:{},add:function(_o,vo,bo,Eo,To){var Bo=tr.get(_o),So,Mo,Ao,Lo,Ro,Co,wo,Po,Fo,Do,Io;if(Bo)for(bo.handler&&(So=bo,bo=So.handler,To=So.selector),To&&Dt.find.matchesSelector(yr,To),bo.guid||(bo.guid=Dt.guid++),(Lo=Bo.events)||(Lo=Bo.events={}),(Mo=Bo.handle)||(Mo=Bo.handle=function(Uo){return'undefined'!=typeof Dt&&Dt.event.triggered!==Uo.type?Dt.event.dispatch.apply(_o,arguments):void 0}),vo=(vo||'').match(Kt)||[''],Ro=vo.length;Ro--;)Ao=vr.exec(vo[Ro])||[],Fo=Io=Ao[1],Do=(Ao[2]||'').split('.').sort(),Fo&&(wo=Dt.event.special[Fo]||{},Fo=(To?wo.delegateType:wo.bindType)||Fo,wo=Dt.event.special[Fo]||{},Co=Dt.extend({type:Fo,origType:Io,data:Eo,handler:bo,guid:bo.guid,selector:To,needsContext:To&&Dt.expr.match.needsContext.test(To),namespace:Do.join('.')},So),(Po=Lo[Fo])||(Po=Lo[Fo]=[],Po.delegateCount=0,wo.setup&&!1!==wo.setup.call(_o,Eo,Do,Mo)||_o.addEventListener&&_o.addEventListener(Fo,Mo)),wo.add&&(wo.add.call(_o,Co),Co.handler.guid||(Co.handler.guid=bo.guid)),To?Po.splice(Po.delegateCount++,0,Co):Po.push(Co),Dt.event.global[Fo]=!0)},remove:function(_o,vo,bo,Eo,To){var Bo=tr.hasData(_o)&&tr.get(_o),So,Mo,Ao,Lo,Ro,Co,wo,Po,Fo,Do,Io;if(Bo&&(Lo=Bo.events)){for(vo=(vo||'').match(Kt)||[''],Ro=vo.length;Ro--;)if(Ao=vr.exec(vo[Ro])||[],Fo=Io=Ao[1],Do=(Ao[2]||'').split('.').sort(),Fo){for(wo=Dt.event.special[Fo]||{},Fo=(Eo?wo.delegateType:wo.bindType)||Fo,Po=Lo[Fo]||[],Ao=Ao[2]&&new RegExp('(^|\\.)'+Do.join('\\.(?:.*\\.|)')+'(\\.|$)'),Mo=So=Po.length;So--;)Co=Po[So],!To&&Io!==Co.origType||bo&&bo.guid!==Co.guid||Ao&&!Ao.test(Co.namespace)||Eo&&Eo!==Co.selector&&('**'!==Eo||!Co.selector)||(Po.splice(So,1),Co.selector&&Po.delegateCount--,wo.remove&&wo.remove.call(_o,Co));Mo&&!Po.length&&(wo.teardown&&!1!==wo.teardown.call(_o,Do,Bo.handle)||Dt.removeEvent(_o,Fo,Bo.handle),delete Lo[Fo])}else for(Fo in Lo)Dt.event.remove(_o,Fo+vo[Ro],bo,Eo,!0);Dt.isEmptyObject(Lo)&&tr.remove(_o,'handle events')}},dispatch:function(_o){var vo=Dt.event.fix(_o),Lo=Array(arguments.length),Ro=(tr.get(this,'events')||{})[vo.type]||[],Co=Dt.event.special[vo.type]||{},bo,Eo,To,So,Mo,Ao;for(Lo[0]=vo,bo=1;bo<arguments.length;bo++)Lo[bo]=arguments[bo];if(vo.delegateTarget=this,!Co.preDispatch||!1!==Co.preDispatch.call(this,vo)){for(Ao=Dt.event.handlers.call(this,vo,Ro),bo=0;(So=Ao[bo++])&&!vo.isPropagationStopped();)for(vo.currentTarget=So.elem,Eo=0;(Mo=So.handlers[Eo++])&&!vo.isImmediatePropagationStopped();)vo.rnamespace&&!vo.rnamespace.test(Mo.namespace)||(vo.handleObj=Mo,vo.data=Mo.data,To=((Dt.event.special[Mo.origType]||{}).handle||Mo.handler).apply(So.elem,Lo),void 0!==To&&!1===(vo.result=To)&&(vo.preventDefault(),vo.stopPropagation()));return Co.postDispatch&&Co.postDispatch.call(this,vo),vo.result}},handlers:function(_o,vo){var Ao=[],Lo=vo.delegateCount,Ro=_o.target,bo,Eo,To,So,Mo;if(Lo&&Ro.nodeType&&!('click'===_o.type&&1<=_o.button))for(;Ro!==this;Ro=Ro.parentNode||this)if(1===Ro.nodeType&&('click'!==_o.type||!0!==Ro.disabled)){for(So=[],Mo={},bo=0;bo<Lo;bo++)Eo=vo[bo],To=Eo.selector+' ',void 0===Mo[To]&&(Mo[To]=Eo.needsContext?-1<Dt(To,this).index(Ro):Dt.find(To,this,null,[Ro]).length),Mo[To]&&So.push(Eo);So.length&&Ao.push({elem:Ro,handlers:So})}return Ro=this,Lo<vo.length&&Ao.push({elem:Ro,handlers:vo.slice(Lo)}),Ao},addProp:function(_o,vo){Object.defineProperty(Dt.Event.prototype,_o,{enumerable:!0,configurable:!0,get:Dt.isFunction(vo)?function(){if(this.originalEvent)return vo(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[_o]},set:function(Eo){Object.defineProperty(this,_o,{enumerable:!0,configurable:!0,writable:!0,value:Eo})}})},fix:function(_o){return _o[Dt.expando]?_o:new Dt.Event(_o)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Ne()&&this.focus)return this.focus(),!1},delegateType:'focusin'},blur:{trigger:function(){if(this===Ne()&&this.blur)return this.blur(),!1},delegateType:'focusout'},click:{trigger:function(){if('checkbox'===this.type&&this.click&&ye(this,'input'))return this.click(),!1},_default:function(_o){return ye(_o.target,'a')}},beforeunload:{postDispatch:function(_o){void 0!==_o.result&&_o.originalEvent&&(_o.originalEvent.returnValue=_o.result)}}}},Dt.removeEvent=function(xo,_o,vo){xo.removeEventListener&&xo.removeEventListener(_o,vo)},Dt.Event=function(xo,_o){return this instanceof Dt.Event?(xo&&xo.type?(this.originalEvent=xo,this.type=xo.type,this.isDefaultPrevented=xo.defaultPrevented||void 0===xo.defaultPrevented&&!1===xo.returnValue?Be:Ue,this.target=xo.target&&3===xo.target.nodeType?xo.target.parentNode:xo.target,this.currentTarget=xo.currentTarget,this.relatedTarget=xo.relatedTarget):this.type=xo,_o&&Dt.extend(this,_o),this.timeStamp=xo&&xo.timeStamp||Dt.now(),void(this[Dt.expando]=!0)):new Dt.Event(xo,_o)},Dt.Event.prototype={constructor:Dt.Event,isDefaultPrevented:Ue,isPropagationStopped:Ue,isImmediatePropagationStopped:Ue,isSimulated:!1,preventDefault:function(){var _o=this.originalEvent;this.isDefaultPrevented=Be,_o&&!this.isSimulated&&_o.preventDefault()},stopPropagation:function(){var _o=this.originalEvent;this.isPropagationStopped=Be,_o&&!this.isSimulated&&_o.stopPropagation()},stopImmediatePropagation:function(){var _o=this.originalEvent;this.isImmediatePropagationStopped=Be,_o&&!this.isSimulated&&_o.stopImmediatePropagation(),this.stopPropagation()}},Dt.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(_o){var vo=_o.button;return null==_o.which&&xr.test(_o.type)?null==_o.charCode?_o.keyCode:_o.charCode:!_o.which&&void 0!==vo&&_r.test(_o.type)?1&vo?1:2&vo?3:4&vo?2:0:_o.which}},Dt.event.addProp),Dt.each({mouseenter:'mouseover',mouseleave:'mouseout',pointerenter:'pointerover',pointerleave:'pointerout'},function(xo,_o){Dt.event.special[xo]={delegateType:_o,bindType:_o,handle:function(bo){var To=this,So=bo.relatedTarget,Mo=bo.handleObj,Eo;return So&&(So===To||Dt.contains(To,So))||(bo.type=Mo.origType,Eo=Mo.handler.apply(this,arguments),bo.type=_o),Eo}}}),Dt.fn.extend({on:function(_o,vo,bo,Eo){return Ge(this,_o,vo,bo,Eo)},one:function(_o,vo,bo,Eo){return Ge(this,_o,vo,bo,Eo,1)},off:function(_o,vo,bo){var Eo,To;if(_o&&_o.preventDefault&&_o.handleObj)return Eo=_o.handleObj,Dt(_o.delegateTarget).off(Eo.namespace?Eo.origType+'.'+Eo.namespace:Eo.origType,Eo.selector,Eo.handler),this;if('object'==('undefined'==typeof _o?'undefined':pe(_o))){for(To in _o)this.off(To,vo,_o[To]);return this}return!1!==vo&&'function'!=typeof vo||(bo=vo,vo=void 0),!1===bo&&(bo=Ue),this.each(function(){Dt.event.remove(this,_o,bo,vo)})}});var br=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Er=/<script|<style|<link/i,Tr=/checked\s*(?:[^=]|=\s*.checked.)/i,Sr=/^true\/(.*)/,Mr=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;Dt.extend({htmlPrefilter:function(_o){return _o.replace(br,'<$1></$2>')},clone:function(_o,vo,bo){var Ao=_o.cloneNode(!0),Lo=Dt.contains(_o.ownerDocument,_o),Eo,To,So,Mo;if(!(Pt.noCloneChecked||1!==_o.nodeType&&11!==_o.nodeType||Dt.isXMLDoc(_o)))for(Mo=Fe(Ao),So=Fe(_o),Eo=0,To=So.length;Eo<To;Eo++)He(So[Eo],Mo[Eo]);if(vo)if(bo)for(So=So||Fe(_o),Mo=Mo||Fe(Ao),Eo=0,To=So.length;Eo<To;Eo++)ke(So[Eo],Mo[Eo]);else ke(_o,Ao);return Mo=Fe(Ao,'script'),0<Mo.length&&De(Mo,!Lo&&Fe(_o,'script')),Ao},cleanData:function(_o){for(var To=Dt.event.special,So=0,vo,bo,Eo;void 0!==(bo=_o[So]);So++)if(er(bo)){if(vo=bo[tr.expando]){if(vo.events)for(Eo in vo.events)To[Eo]?Dt.event.remove(bo,Eo):Dt.removeEvent(bo,Eo,vo.handle);bo[tr.expando]=void 0}bo[rr.expando]&&(bo[rr.expando]=void 0)}}}),Dt.fn.extend({detach:function(_o){return je(this,_o,!0)},remove:function(_o){return je(this,_o)},text:function(_o){return $t(this,function(vo){return void 0===vo?Dt.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=vo)})},null,_o,arguments.length)},append:function(){return We(this,arguments,function(_o){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var vo=Ve(this,_o);vo.appendChild(_o)}})},prepend:function(){return We(this,arguments,function(_o){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var vo=Ve(this,_o);vo.insertBefore(_o,vo.firstChild)}})},before:function(){return We(this,arguments,function(_o){this.parentNode&&this.parentNode.insertBefore(_o,this)})},after:function(){return We(this,arguments,function(_o){this.parentNode&&this.parentNode.insertBefore(_o,this.nextSibling)})},empty:function(){for(var vo=0,_o;null!=(_o=this[vo]);vo++)1===_o.nodeType&&(Dt.cleanData(Fe(_o,!1)),_o.textContent='');return this},clone:function(_o,vo){return _o=null!=_o&&_o,vo=null==vo?_o:vo,this.map(function(){return Dt.clone(this,_o,vo)})},html:function(_o){return $t(this,function(vo){var bo=this[0]||{},Eo=0,To=this.length;if(void 0===vo&&1===bo.nodeType)return bo.innerHTML;if('string'==typeof vo&&!Er.test(vo)&&!gr[(mr.exec(vo)||['',''])[1].toLowerCase()]){vo=Dt.htmlPrefilter(vo);try{for(;Eo<To;Eo++)bo=this[Eo]||{},1===bo.nodeType&&(Dt.cleanData(Fe(bo,!1)),bo.innerHTML=vo);bo=0}catch(So){}}bo&&this.empty().append(vo)},null,_o,arguments.length)},replaceWith:function(){var _o=[];return We(this,arguments,function(vo){var bo=this.parentNode;0>Dt.inArray(this,_o)&&(Dt.cleanData(Fe(this)),bo&&bo.replaceChild(vo,this))},_o)}}),Dt.each({appendTo:'append',prependTo:'prepend',insertBefore:'before',insertAfter:'after',replaceAll:'replaceWith'},function(xo,_o){Dt.fn[xo]=function(vo){for(var Eo=[],To=Dt(vo),So=To.length-1,Mo=0,bo;Mo<=So;Mo++)bo=Mo===So?this:this.clone(!0),Dt(To[Mo])[_o](bo),St.apply(Eo,bo.get());return this.pushStack(Eo)}});var Ar=/^margin/,Lr=new RegExp('^('+ir+')(?!px)[a-z%]+$','i'),Rr=function(_o){var vo=_o.ownerDocument.defaultView;return vo&&vo.opener||(vo=ue),vo.getComputedStyle(_o)};!function(){function xo(){if(So){So.style.cssText='box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%',So.innerHTML='',yr.appendChild(To);var Mo=ue.getComputedStyle(So);_o='1%'!==Mo.top,Eo='2px'===Mo.marginLeft,vo='4px'===Mo.width,So.style.marginRight='50%',bo='4px'===Mo.marginRight,yr.removeChild(To),So=null}}var To=_t.createElement('div'),So=_t.createElement('div'),_o,vo,bo,Eo;So.style&&(So.style.backgroundClip='content-box',So.cloneNode(!0).style.backgroundClip='',Pt.clearCloneStyle='content-box'===So.style.backgroundClip,To.style.cssText='border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute',To.appendChild(So),Dt.extend(Pt,{pixelPosition:function(){return xo(),_o},boxSizingReliable:function(){return xo(),vo},pixelMarginRight:function(){return xo(),bo},reliableMarginLeft:function(){return xo(),Eo}}))}();var Cr=/^(none|table(?!-c[ea]).+)/,wr=/^--/,Pr={position:'absolute',visibility:'hidden',display:'block'},Fr={letterSpacing:'0',fontWeight:'400'},Dr=['Webkit','Moz','ms'],Ir=_t.createElement('div').style;Dt.extend({cssHooks:{opacity:{get:function(_o,vo){if(vo){var bo=Xe(_o,'opacity');return''===bo?'1':bo}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:'cssFloat'},style:function(_o,vo,bo,Eo){if(_o&&3!==_o.nodeType&&8!==_o.nodeType&&_o.style){var Ao=Dt.camelCase(vo),Lo=wr.test(vo),Ro=_o.style,To,So,Mo;return Lo||(vo=Ze(Ao)),Mo=Dt.cssHooks[vo]||Dt.cssHooks[Ao],void 0===bo?Mo&&'get'in Mo&&void 0!==(To=Mo.get(_o,!1,Eo))?To:Ro[vo]:(So='undefined'==typeof bo?'undefined':pe(bo),'string'===So&&(To=nr.exec(bo))&&To[1]&&(bo=Ce(_o,vo,To),So='number'),null!=bo&&bo==bo&&('number'===So&&(bo+=To&&To[3]||(Dt.cssNumber[Ao]?'':'px')),Pt.clearCloneStyle||''!==bo||0!==vo.indexOf('background')||(Ro[vo]='inherit'),Mo&&'set'in Mo&&void 0===(bo=Mo.set(_o,bo,Eo))||(Lo?Ro.setProperty(vo,bo):Ro[vo]=bo)),void 0)}},css:function(_o,vo,bo,Eo){var Ao=Dt.camelCase(vo),Lo=wr.test(vo),To,So,Mo;return Lo||(vo=Ze(Ao)),Mo=Dt.cssHooks[vo]||Dt.cssHooks[Ao],Mo&&'get'in Mo&&(To=Mo.get(_o,!0,bo)),void 0===To&&(To=Xe(_o,vo,Eo)),'normal'===To&&vo in Fr&&(To=Fr[vo]),''===bo||bo?(So=parseFloat(To),!0===bo||isFinite(So)?So||0:To):To}}),Dt.each(['height','width'],function(xo,_o){Dt.cssHooks[_o]={get:function(bo,Eo,To){if(Eo)return!Cr.test(Dt.css(bo,'display'))||bo.getClientRects().length&&bo.getBoundingClientRect().width?Je(bo,_o,To):pr(bo,Pr,function(){return Je(bo,_o,To)})},set:function(bo,Eo,To){var Mo=To&&Rr(bo),Ao=To&&Qe(bo,_o,To,'border-box'===Dt.css(bo,'boxSizing',!1,Mo),Mo),So;return Ao&&(So=nr.exec(Eo))&&'px'!==(So[3]||'px')&&(bo.style[_o]=Eo,Eo=Dt.css(bo,_o)),Ke(bo,Eo,Ao)}}}),Dt.cssHooks.marginLeft=qe(Pt.reliableMarginLeft,function(xo,_o){if(_o)return(parseFloat(Xe(xo,'marginLeft'))||xo.getBoundingClientRect().left-pr(xo,{marginLeft:0},function(){return xo.getBoundingClientRect().left}))+'px'}),Dt.each({margin:'',padding:'',border:'Width'},function(xo,_o){Dt.cssHooks[xo+_o]={expand:function(bo){for(var Eo=0,To={},So='string'==typeof bo?bo.split(' '):[bo];4>Eo;Eo++)To[xo+sr[Eo]+_o]=So[Eo]||So[Eo-2]||So[0];return To}},Ar.test(xo)||(Dt.cssHooks[xo+_o].set=Ke)}),Dt.fn.extend({css:function(_o,vo){return $t(this,function(bo,Eo,To){var Ao={},Lo=0,So,Mo;if(Array.isArray(Eo)){for(So=Rr(bo),Mo=Eo.length;Lo<Mo;Lo++)Ao[Eo[Lo]]=Dt.css(bo,Eo[Lo],!1,So);return Ao}return void 0===To?Dt.css(bo,Eo):Dt.style(bo,Eo,To)},_o,vo,1<arguments.length)}}),Dt.Tween=$e,$e.prototype={constructor:$e,init:function(_o,vo,bo,Eo,To,So){this.elem=_o,this.prop=bo,this.easing=To||Dt.easing._default,this.options=vo,this.start=this.now=this.cur(),this.end=Eo,this.unit=So||(Dt.cssNumber[bo]?'':'px')},cur:function(){var _o=$e.propHooks[this.prop];return _o&&_o.get?_o.get(this):$e.propHooks._default.get(this)},run:function(_o){var bo=$e.propHooks[this.prop],vo;return this.pos=this.options.duration?vo=Dt.easing[this.easing](_o,this.options.duration*_o,0,1,this.options.duration):vo=_o,this.now=(this.end-this.start)*vo+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),bo&&bo.set?bo.set(this):$e.propHooks._default.set(this),this}},$e.prototype.init.prototype=$e.prototype,$e.propHooks={_default:{get:function(_o){var vo;return 1!==_o.elem.nodeType||null!=_o.elem[_o.prop]&&null==_o.elem.style[_o.prop]?_o.elem[_o.prop]:(vo=Dt.css(_o.elem,_o.prop,''),vo&&'auto'!==vo?vo:0)},set:function(_o){Dt.fx.step[_o.prop]?Dt.fx.step[_o.prop](_o):1===_o.elem.nodeType&&(null!=_o.elem.style[Dt.cssProps[_o.prop]]||Dt.cssHooks[_o.prop])?Dt.style(_o.elem,_o.prop,_o.now+_o.unit):_o.elem[_o.prop]=_o.now}}},$e.propHooks.scrollTop=$e.propHooks.scrollLeft={set:function(_o){_o.elem.nodeType&&_o.elem.parentNode&&(_o.elem[_o.prop]=_o.now)}},Dt.easing={linear:function(_o){return _o},swing:function(_o){return .5-Math.cos(_o*Math.PI)/2},_default:'swing'},Dt.fx=$e.prototype.init,Dt.fx.step={};var Nr=/^(?:toggle|show|hide)$/,Gr=/queueHooks$/,Br,Ur;Dt.Animation=Dt.extend(st,{tweeners:{"*":[function(xo,_o){var vo=this.createTween(xo,_o);return Ce(vo.elem,xo,nr.exec(_o),vo),vo}]},tweener:function(_o,vo){Dt.isFunction(_o)?(vo=_o,_o=['*']):_o=_o.match(Kt);for(var Eo=0,To=_o.length,bo;Eo<To;Eo++)bo=_o[Eo],st.tweeners[bo]=st.tweeners[bo]||[],st.tweeners[bo].unshift(vo)},prefilters:[function(xo,_o,vo){var wo=this,Po={},Fo=xo.style,Do=xo.nodeType&&dr(xo),Io=tr.get(xo,'fxshow'),bo,Eo,To,So,Mo,Ao,Lo,Ro;for(bo in vo.queue||(So=Dt._queueHooks(xo,'fx'),null==So.unqueued&&(So.unqueued=0,Mo=So.empty.fire,So.empty.fire=function(){So.unqueued||Mo()}),So.unqueued++,wo.always(function(){wo.always(function(){So.unqueued--,Dt.queue(xo,'fx').length||So.empty.fire()})})),_o)if(Eo=_o[bo],Nr.test(Eo)){if(delete _o[bo],To=To||'toggle'===Eo,Eo===(Do?'hide':'show')){if('show'!==Eo||!Io||void 0===Io[bo])continue;Do=!0}Po[bo]=Io&&Io[bo]||Dt.style(xo,bo)}if(Ao=!Dt.isEmptyObject(_o),Ao||!Dt.isEmptyObject(Po))for(bo in('width'in _o||'height'in _o)&&1===xo.nodeType&&(vo.overflow=[Fo.overflow,Fo.overflowX,Fo.overflowY],Lo=Io&&Io.display,null==Lo&&(Lo=tr.get(xo,'display')),Ro=Dt.css(xo,'display'),'none'===Ro&&(Lo?Ro=Lo:(Pe([xo],!0),Lo=xo.style.display||Lo,Ro=Dt.css(xo,'display'),Pe([xo]))),('inline'===Ro||'inline-block'===Ro&&null!=Lo)&&'none'===Dt.css(xo,'float')&&(Ao||(wo.done(function(){Fo.display=Lo}),null==Lo&&(Ro=Fo.display,Lo='none'===Ro?'':Ro)),Fo.display='inline-block')),vo.overflow&&(Fo.overflow='hidden',wo.always(function(){Fo.overflow=vo.overflow[0],Fo.overflowX=vo.overflow[1],Fo.overflowY=vo.overflow[2]})),Ao=!1,Po)Ao||(Io?'hidden'in Io&&(Do=Io.hidden):Io=tr.access(xo,'fxshow',{display:Lo}),To&&(Io.hidden=!Do),Do&&Pe([xo],!0),wo.done(function(){for(bo in Do||Pe([xo]),tr.remove(xo,'fxshow'),Po)Dt.style(xo,bo,Po[bo])})),Ao=ot(Do?Io[bo]:0,bo,wo),bo in Io||(Io[bo]=Ao.start,Do&&(Ao.end=Ao.start,Ao.start=0))}],prefilter:function(_o,vo){vo?st.prefilters.unshift(_o):st.prefilters.push(_o)}}),Dt.speed=function(xo,_o,vo){var bo=xo&&'object'==('undefined'==typeof xo?'undefined':pe(xo))?Dt.extend({},xo):{complete:vo||!vo&&_o||Dt.isFunction(xo)&&xo,duration:xo,easing:vo&&_o||_o&&!Dt.isFunction(_o)&&_o};return Dt.fx.off?bo.duration=0:'number'!=typeof bo.duration&&(bo.duration in Dt.fx.speeds?bo.duration=Dt.fx.speeds[bo.duration]:bo.duration=Dt.fx.speeds._default),null!=bo.queue&&!0!==bo.queue||(bo.queue='fx'),bo.old=bo.complete,bo.complete=function(){Dt.isFunction(bo.old)&&bo.old.call(this),bo.queue&&Dt.dequeue(this,bo.queue)},bo},Dt.fn.extend({fadeTo:function(_o,vo,bo,Eo){return this.filter(dr).css('opacity',0).show().end().animate({opacity:vo},_o,bo,Eo)},animate:function(_o,vo,bo,Eo){var To=Dt.isEmptyObject(_o),So=Dt.speed(vo,bo,Eo),Mo=function(){var Lo=st(this,Dt.extend({},_o),So);(To||tr.get(this,'finish'))&&Lo.stop(!0)};return Mo.finish=Mo,To||!1===So.queue?this.each(Mo):this.queue(So.queue,Mo)},stop:function(_o,vo,bo){var Eo=function(So){var Mo=So.stop;delete So.stop,Mo(bo)};return'string'!=typeof _o&&(bo=vo,vo=_o,_o=void 0),vo&&!1!==_o&&this.queue(_o||'fx',[]),this.each(function(){var To=!0,So=null!=_o&&_o+'queueHooks',Mo=Dt.timers,Ao=tr.get(this);if(So)Ao[So]&&Ao[So].stop&&Eo(Ao[So]);else for(So in Ao)Ao[So]&&Ao[So].stop&&Gr.test(So)&&Eo(Ao[So]);for(So=Mo.length;So--;)Mo[So].elem!==this||null!=_o&&Mo[So].queue!==_o||(Mo[So].anim.stop(bo),To=!1,Mo.splice(So,1));!To&&bo||Dt.dequeue(this,_o)})},finish:function(_o){return!1!==_o&&(_o=_o||'fx'),this.each(function(){var bo=tr.get(this),Eo=bo[_o+'queue'],To=bo[_o+'queueHooks'],So=Dt.timers,Mo=Eo?Eo.length:0,vo;for(bo.finish=!0,Dt.queue(this,_o,[]),To&&To.stop&&To.stop.call(this,!0),vo=So.length;vo--;)So[vo].elem===this&&So[vo].queue===_o&&(So[vo].anim.stop(!0),So.splice(vo,1));for(vo=0;vo<Mo;vo++)Eo[vo]&&Eo[vo].finish&&Eo[vo].finish.call(this);delete bo.finish})}}),Dt.each(['toggle','show','hide'],function(xo,_o){var vo=Dt.fn[_o];Dt.fn[_o]=function(bo,Eo,To){return null==bo||'boolean'==typeof bo?vo.apply(this,arguments):this.animate(rt(_o,!0),bo,Eo,To)}}),Dt.each({slideDown:rt('show'),slideUp:rt('hide'),slideToggle:rt('toggle'),fadeIn:{opacity:'show'},fadeOut:{opacity:'hide'},fadeToggle:{opacity:'toggle'}},function(xo,_o){Dt.fn[xo]=function(vo,bo,Eo){return this.animate(_o,vo,bo,Eo)}}),Dt.timers=[],Dt.fx.tick=function(){var _o=0,vo=Dt.timers,xo;for(Br=Dt.now();_o<vo.length;_o++)xo=vo[_o],xo()||vo[_o]!==xo||vo.splice(_o--,1);vo.length||Dt.fx.stop(),Br=void 0},Dt.fx.timer=function(xo){Dt.timers.push(xo),Dt.fx.start()},Dt.fx.interval=13,Dt.fx.start=function(){Ur||(Ur=!0,et())},Dt.fx.stop=function(){Ur=null},Dt.fx.speeds={slow:600,fast:200,_default:400},Dt.fn.delay=function(xo,_o){return xo=Dt.fx?Dt.fx.speeds[xo]||xo:xo,_o=_o||'fx',this.queue(_o,function(vo,bo){var Eo=ue.setTimeout(vo,xo);bo.stop=function(){ue.clearTimeout(Eo)}})},function(){var xo=_t.createElement('input'),_o=_t.createElement('select'),vo=_o.appendChild(_t.createElement('option'));xo.type='checkbox',Pt.checkOn=''!==xo.value,Pt.optSelected=vo.selected,xo=_t.createElement('input'),xo.value='t',xo.type='radio',Pt.radioValue='t'===xo.value}();var zr=Dt.expr.attrHandle,Vr;Dt.fn.extend({attr:function(_o,vo){return $t(this,Dt.attr,_o,vo,1<arguments.length)},removeAttr:function(_o){return this.each(function(){Dt.removeAttr(this,_o)})}}),Dt.extend({attr:function(_o,vo,bo){var So=_o.nodeType,Eo,To;if(3!==So&&8!==So&&2!==So)return'undefined'==typeof _o.getAttribute?Dt.prop(_o,vo,bo):(1===So&&Dt.isXMLDoc(_o)||(To=Dt.attrHooks[vo.toLowerCase()]||(Dt.expr.match.bool.test(vo)?Vr:void 0)),void 0===bo?To&&'get'in To&&null!==(Eo=To.get(_o,vo))?Eo:(Eo=Dt.find.attr(_o,vo),null==Eo?void 0:Eo):null===bo?void Dt.removeAttr(_o,vo):To&&'set'in To&&void 0!==(Eo=To.set(_o,bo,vo))?Eo:(_o.setAttribute(vo,bo+''),bo))},attrHooks:{type:{set:function(_o,vo){if(!Pt.radioValue&&'radio'===vo&&ye(_o,'input')){var bo=_o.value;return _o.setAttribute('type',vo),bo&&(_o.value=bo),vo}}}},removeAttr:function(_o,vo){var Eo=0,To=vo&&vo.match(Kt),bo;if(To&&1===_o.nodeType)for(;bo=To[Eo++];)_o.removeAttribute(bo)}}),Vr={set:function(_o,vo,bo){return!1===vo?Dt.removeAttr(_o,bo):_o.setAttribute(bo,bo),bo}},Dt.each(Dt.expr.match.bool.source.match(/\w+/g),function(xo,_o){var vo=zr[_o]||Dt.find.attr;zr[_o]=function(bo,Eo,To){var Ao=Eo.toLowerCase(),So,Mo;return To||(Mo=zr[Ao],zr[Ao]=So,So=null==vo(bo,Eo,To)?null:Ao,zr[Ao]=Mo),So}});var Or=/^(?:input|select|textarea|button)$/i,kr=/^(?:a|area)$/i;Dt.fn.extend({prop:function(_o,vo){return $t(this,Dt.prop,_o,vo,1<arguments.length)},removeProp:function(_o){return this.each(function(){delete this[Dt.propFix[_o]||_o]})}}),Dt.extend({prop:function(_o,vo,bo){var So=_o.nodeType,Eo,To;if(3!==So&&8!==So&&2!==So)return 1===So&&Dt.isXMLDoc(_o)||(vo=Dt.propFix[vo]||vo,To=Dt.propHooks[vo]),void 0===bo?To&&'get'in To&&null!==(Eo=To.get(_o,vo))?Eo:_o[vo]:To&&'set'in To&&void 0!==(Eo=To.set(_o,bo,vo))?Eo:_o[vo]=bo},propHooks:{tabIndex:{get:function(_o){var vo=Dt.find.attr(_o,'tabindex');return vo?parseInt(vo,10):Or.test(_o.nodeName)||kr.test(_o.nodeName)&&_o.href?0:-1}}},propFix:{for:'htmlFor',class:'className'}}),Pt.optSelected||(Dt.propHooks.selected={get:function(_o){var vo=_o.parentNode;return vo&&vo.parentNode&&vo.parentNode.selectedIndex,null},set:function(_o){var vo=_o.parentNode;vo&&(vo.selectedIndex,vo.parentNode&&vo.parentNode.selectedIndex)}}),Dt.each(['tabIndex','readOnly','maxLength','cellSpacing','cellPadding','rowSpan','colSpan','useMap','frameBorder','contentEditable'],function(){Dt.propFix[this.toLowerCase()]=this}),Dt.fn.extend({addClass:function(_o){var Lo=0,vo,bo,Eo,To,So,Mo,Ao;if(Dt.isFunction(_o))return this.each(function(Ro){Dt(this).addClass(_o.call(this,Ro,dt(this)))});if('string'==typeof _o&&_o)for(vo=_o.match(Kt)||[];bo=this[Lo++];)if(To=dt(bo),Eo=1===bo.nodeType&&' '+lt(To)+' '){for(Mo=0;So=vo[Mo++];)0>Eo.indexOf(' '+So+' ')&&(Eo+=So+' ');Ao=lt(Eo),To!==Ao&&bo.setAttribute('class',Ao)}return this},removeClass:function(_o){var Lo=0,vo,bo,Eo,To,So,Mo,Ao;if(Dt.isFunction(_o))return this.each(function(Ro){Dt(this).removeClass(_o.call(this,Ro,dt(this)))});if(!arguments.length)return this.attr('class','');if('string'==typeof _o&&_o)for(vo=_o.match(Kt)||[];bo=this[Lo++];)if(To=dt(bo),Eo=1===bo.nodeType&&' '+lt(To)+' '){for(Mo=0;So=vo[Mo++];)for(;-1<Eo.indexOf(' '+So+' ');)Eo=Eo.replace(' '+So+' ',' ');Ao=lt(Eo),To!==Ao&&bo.setAttribute('class',Ao)}return this},toggleClass:function(_o,vo){var bo='undefined'==typeof _o?'undefined':pe(_o);return'boolean'==typeof vo&&'string'===bo?vo?this.addClass(_o):this.removeClass(_o):Dt.isFunction(_o)?this.each(function(Eo){Dt(this).toggleClass(_o.call(this,Eo,dt(this),vo),vo)}):this.each(function(){var Eo,To,So,Mo;if('string'===bo)for(To=0,So=Dt(this),Mo=_o.match(Kt)||[];Eo=Mo[To++];)So.hasClass(Eo)?So.removeClass(Eo):So.addClass(Eo);else void 0!==_o&&'boolean'!==bo||(Eo=dt(this),Eo&&tr.set(this,'__className__',Eo),this.setAttribute&&this.setAttribute('class',Eo||!1===_o?'':tr.get(this,'__className__')||''))})},hasClass:function(_o){var Eo=0,vo,bo;for(vo=' '+_o+' ';bo=this[Eo++];)if(1===bo.nodeType&&-1<(' '+lt(dt(bo))+' ').indexOf(vo))return!0;return!1}});var Hr=/\r/g;Dt.fn.extend({val:function(_o){var To=this[0],vo,bo,Eo;{if(arguments.length)return Eo=Dt.isFunction(_o),this.each(function(So){var Mo;1===this.nodeType&&(Mo=Eo?_o.call(this,So,Dt(this).val()):_o,null==Mo?Mo='':'number'==typeof Mo?Mo+='':Array.isArray(Mo)&&(Mo=Dt.map(Mo,function(Ao){return null==Ao?'':Ao+''})),vo=Dt.valHooks[this.type]||Dt.valHooks[this.nodeName.toLowerCase()],vo&&'set'in vo&&void 0!==vo.set(this,Mo,'value')||(this.value=Mo))});if(To)return vo=Dt.valHooks[To.type]||Dt.valHooks[To.nodeName.toLowerCase()],vo&&'get'in vo&&void 0!==(bo=vo.get(To,'value'))?bo:(bo=To.value,'string'==typeof bo?bo.replace(Hr,''):null==bo?'':bo)}}}),Dt.extend({valHooks:{option:{get:function(_o){var vo=Dt.find.attr(_o,'value');return null==vo?lt(Dt.text(_o)):vo}},select:{get:function(_o){var To=_o.options,So=_o.selectedIndex,Mo='select-one'===_o.type,Ao=Mo?null:[],Lo=Mo?So+1:To.length,vo,bo,Eo;for(Eo=0>So?Lo:Mo?So:0;Eo<Lo;Eo++)if(bo=To[Eo],(bo.selected||Eo===So)&&!bo.disabled&&(!bo.parentNode.disabled||!ye(bo.parentNode,'optgroup'))){if(vo=Dt(bo).val(),Mo)return vo;Ao.push(vo)}return Ao},set:function(_o,vo){for(var To=_o.options,So=Dt.makeArray(vo),Mo=To.length,bo,Eo;Mo--;)Eo=To[Mo],(Eo.selected=-1<Dt.inArray(Dt.valHooks.option.get(Eo),So))&&(bo=!0);return bo||(_o.selectedIndex=-1),So}}}}),Dt.each(['radio','checkbox'],function(){Dt.valHooks[this]={set:function(_o,vo){if(Array.isArray(vo))return _o.checked=-1<Dt.inArray(Dt(_o).val(),vo)}},Pt.checkOn||(Dt.valHooks[this].get=function(xo){return null===xo.getAttribute('value')?'on':xo.value})});var Wr=/^(?:focusinfocus|focusoutblur)$/;Dt.extend(Dt.event,{trigger:function(_o,vo,bo,Eo){var wo=[bo||_t],Po=Rt.call(_o,'type')?_o.type:_o,Fo=Rt.call(_o,'namespace')?_o.namespace.split('.'):[],To,So,Mo,Ao,Lo,Ro,Co;if(So=Mo=bo=bo||_t,3!==bo.nodeType&&8!==bo.nodeType&&!Wr.test(Po+Dt.event.triggered)&&(-1<Po.indexOf('.')&&(Fo=Po.split('.'),Po=Fo.shift(),Fo.sort()),Lo=0>Po.indexOf(':')&&'on'+Po,_o=_o[Dt.expando]?_o:new Dt.Event(Po,'object'==('undefined'==typeof _o?'undefined':pe(_o))&&_o),_o.isTrigger=Eo?2:3,_o.namespace=Fo.join('.'),_o.rnamespace=_o.namespace?new RegExp('(^|\\.)'+Fo.join('\\.(?:.*\\.|)')+'(\\.|$)'):null,_o.result=void 0,_o.target||(_o.target=bo),vo=null==vo?[_o]:Dt.makeArray(vo,[_o]),Co=Dt.event.special[Po]||{},Eo||!Co.trigger||!1!==Co.trigger.apply(bo,vo))){if(!Eo&&!Co.noBubble&&!Dt.isWindow(bo)){for(Ao=Co.delegateType||Po,Wr.test(Ao+Po)||(So=So.parentNode);So;So=So.parentNode)wo.push(So),Mo=So;Mo===(bo.ownerDocument||_t)&&wo.push(Mo.defaultView||Mo.parentWindow||ue)}for(To=0;(So=wo[To++])&&!_o.isPropagationStopped();)_o.type=1<To?Ao:Co.bindType||Po,Ro=(tr.get(So,'events')||{})[_o.type]&&tr.get(So,'handle'),Ro&&Ro.apply(So,vo),Ro=Lo&&So[Lo],Ro&&Ro.apply&&er(So)&&(_o.result=Ro.apply(So,vo),!1===_o.result&&_o.preventDefault());return _o.type=Po,Eo||_o.isDefaultPrevented()||Co._default&&!1!==Co._default.apply(wo.pop(),vo)||!er(bo)||Lo&&Dt.isFunction(bo[Po])&&!Dt.isWindow(bo)&&(Mo=bo[Lo],Mo&&(bo[Lo]=null),Dt.event.triggered=Po,bo[Po](),Dt.event.triggered=void 0,Mo&&(bo[Lo]=Mo)),_o.result}},simulate:function(_o,vo,bo){var Eo=Dt.extend(new Dt.Event,bo,{type:_o,isSimulated:!0});Dt.event.trigger(Eo,null,vo)}}),Dt.fn.extend({trigger:function(_o,vo){return this.each(function(){Dt.event.trigger(_o,vo,this)})},triggerHandler:function(_o,vo){var bo=this[0];if(bo)return Dt.event.trigger(_o,vo,bo,!0)}}),Dt.each('blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu'.split(' '),function(xo,_o){Dt.fn[_o]=function(vo,bo){return 0<arguments.length?this.on(_o,null,vo,bo):this.trigger(_o)}}),Dt.fn.extend({hover:function(_o,vo){return this.mouseenter(_o).mouseleave(vo||_o)}}),Pt.focusin='onfocusin'in ue,Pt.focusin||Dt.each({focus:'focusin',blur:'focusout'},function(xo,_o){var vo=function(Eo){Dt.event.simulate(_o,Eo.target,Dt.event.fix(Eo))};Dt.event.special[_o]={setup:function(){var Eo=this.ownerDocument||this,To=tr.access(Eo,_o);To||Eo.addEventListener(xo,vo,!0),tr.access(Eo,_o,(To||0)+1)},teardown:function(){var Eo=this.ownerDocument||this,To=tr.access(Eo,_o)-1;To?tr.access(Eo,_o,To):(Eo.removeEventListener(xo,vo,!0),tr.remove(Eo,_o))}}});var jr=ue.location,Xr=Dt.now(),qr=/\?/;Dt.parseXML=function(xo){var _o;if(!xo||'string'!=typeof xo)return null;try{_o=new ue.DOMParser().parseFromString(xo,'text/xml')}catch(vo){_o=void 0}return _o&&!_o.getElementsByTagName('parsererror').length||Dt.error('Invalid XML: '+xo),_o};var Yr=/\[\]$/,Zr=/\r?\n/g,Kr=/^(?:submit|button|image|reset|file)$/i,Qr=/^(?:input|select|textarea|keygen)/i;Dt.param=function(xo,_o){var bo=[],Eo=function(So,Mo){var Ao=Dt.isFunction(Mo)?Mo():Mo;bo[bo.length]=encodeURIComponent(So)+'='+encodeURIComponent(null==Ao?'':Ao)},vo;if(Array.isArray(xo)||xo.jquery&&!Dt.isPlainObject(xo))Dt.each(xo,function(){Eo(this.name,this.value)});else for(vo in xo)ct(vo,xo[vo],_o,Eo);return bo.join('&')},Dt.fn.extend({serialize:function(){return Dt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var _o=Dt.prop(this,'elements');return _o?Dt.makeArray(_o):this}).filter(function(){var _o=this.type;return this.name&&!Dt(this).is(':disabled')&&Qr.test(this.nodeName)&&!Kr.test(_o)&&(this.checked||!ur.test(_o))}).map(function(_o,vo){var bo=Dt(this).val();return null==bo?null:Array.isArray(bo)?Dt.map(bo,function(Eo){return{name:vo.name,value:Eo.replace(Zr,'\r\n')}}):{name:vo.name,value:bo.replace(Zr,'\r\n')}}).get()}});var Jr=/%20/g,$r=/#.*$/,eo=/([?&])_=[^&]*/,ro=/^(.*?):[ \t]*([^\r\n]*)$/gm,ao=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,oo=/^(?:GET|HEAD)$/,io=/^\/\//,no={},so={},lo='*/'.concat('*'),po=_t.createElement('a');po.href=jr.href,Dt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:jr.href,type:'GET',isLocal:ao.test(jr.protocol),global:!0,processData:!0,async:!0,contentType:'application/x-www-form-urlencoded; charset=UTF-8',accepts:{"*":lo,text:'text/plain',html:'text/html',xml:'application/xml, text/xml',json:'application/json, text/javascript'},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:'responseXML',text:'responseText',json:'responseJSON'},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":Dt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(_o,vo){return vo?gt(gt(_o,Dt.ajaxSettings),vo):gt(Dt.ajaxSettings,_o)},ajaxPrefilter:ut(no),ajaxTransport:ut(so),ajax:function(_o,vo){function bo(ko,Ho,Wo,jo){var Qo=Ho,Xo,qo,Yo,Zo,Ko;Ro||(Ro=!0,Ao&&ue.clearTimeout(Ao),Eo=void 0,So=jo||'',Oo.readyState=0<ko?4:0,Xo=200<=ko&&300>ko||304===ko,Wo&&(Zo=ht(Fo,Oo,Wo)),Zo=yt(Fo,Zo,Oo,Xo),Xo?(Fo.ifModified&&(Ko=Oo.getResponseHeader('Last-Modified'),Ko&&(Dt.lastModified[To]=Ko),Ko=Oo.getResponseHeader('etag'),Ko&&(Dt.etag[To]=Ko)),204===ko||'HEAD'===Fo.type?Qo='nocontent':304===ko?Qo='notmodified':(Qo=Zo.state,qo=Zo.data,Yo=Zo.error,Xo=!Yo)):(Yo=Qo,!ko&&Qo||(Qo='error',0>ko&&(ko=0))),Oo.status=ko,Oo.statusText=(Ho||Qo)+'',Xo?Bo.resolveWith(Do,[qo,Qo,Oo]):Bo.rejectWith(Do,[Oo,Qo,Yo]),Oo.statusCode(No),No=void 0,Co&&Io.trigger(Xo?'ajaxSuccess':'ajaxError',[Oo,Fo,Xo?qo:Yo]),Uo.fireWith(Do,[Oo,Qo]),Co&&(Io.trigger('ajaxComplete',[Oo,Fo]),--Dt.active||Dt.event.trigger('ajaxStop')))}'object'==('undefined'==typeof _o?'undefined':pe(_o))&&(vo=_o,_o=void 0),vo=vo||{};var Fo=Dt.ajaxSetup({},vo),Do=Fo.context||Fo,Io=Fo.context&&(Do.nodeType||Do.jquery)?Dt(Do):Dt.event,Bo=Dt.Deferred(),Uo=Dt.Callbacks('once memory'),No=Fo.statusCode||{},Go={},Vo={},zo='canceled',Oo={readyState:0,getResponseHeader:function(Ho){var Wo;if(Ro){if(!Mo)for(Mo={};Wo=ro.exec(So);)Mo[Wo[1].toLowerCase()]=Wo[2];Wo=Mo[Ho.toLowerCase()]}return null==Wo?null:Wo},getAllResponseHeaders:function(){return Ro?So:null},setRequestHeader:function(Ho,Wo){return null==Ro&&(Ho=Vo[Ho.toLowerCase()]=Vo[Ho.toLowerCase()]||Ho,Go[Ho]=Wo),this},overrideMimeType:function(Ho){return null==Ro&&(Fo.mimeType=Ho),this},statusCode:function(Ho){if(Ho)if(Ro)Oo.always(Ho[Oo.status]);else for(var Wo in Ho)No[Wo]=[No[Wo],Ho[Wo]];return this},abort:function(Ho){var Wo=Ho||zo;return Eo&&Eo.abort(Wo),bo(0,Wo),this}},Eo,To,So,Mo,Ao,Lo,Ro,Co,wo,Po;if(Bo.promise(Oo),Fo.url=((_o||Fo.url||jr.href)+'').replace(io,jr.protocol+'//'),Fo.type=vo.method||vo.type||Fo.method||Fo.type,Fo.dataTypes=(Fo.dataType||'*').toLowerCase().match(Kt)||[''],null==Fo.crossDomain){Lo=_t.createElement('a');try{Lo.href=Fo.url,Lo.href=Lo.href,Fo.crossDomain=po.protocol+'//'+po.host!=Lo.protocol+'//'+Lo.host}catch(ko){Fo.crossDomain=!0}}if(Fo.data&&Fo.processData&&'string'!=typeof Fo.data&&(Fo.data=Dt.param(Fo.data,Fo.traditional)),mt(no,Fo,vo,Oo),Ro)return Oo;for(wo in Co=Dt.event&&Fo.global,Co&&0==Dt.active++&&Dt.event.trigger('ajaxStart'),Fo.type=Fo.type.toUpperCase(),Fo.hasContent=!oo.test(Fo.type),To=Fo.url.replace($r,''),Fo.hasContent?Fo.data&&Fo.processData&&0===(Fo.contentType||'').indexOf('application/x-www-form-urlencoded')&&(Fo.data=Fo.data.replace(Jr,'+')):(Po=Fo.url.slice(To.length),Fo.data&&(To+=(qr.test(To)?'&':'?')+Fo.data,delete Fo.data),!1===Fo.cache&&(To=To.replace(eo,'$1'),Po=(qr.test(To)?'&':'?')+'_='+Xr++ +Po),Fo.url=To+Po),Fo.ifModified&&(Dt.lastModified[To]&&Oo.setRequestHeader('If-Modified-Since',Dt.lastModified[To]),Dt.etag[To]&&Oo.setRequestHeader('If-None-Match',Dt.etag[To])),(Fo.data&&Fo.hasContent&&!1!==Fo.contentType||vo.contentType)&&Oo.setRequestHeader('Content-Type',Fo.contentType),Oo.setRequestHeader('Accept',Fo.dataTypes[0]&&Fo.accepts[Fo.dataTypes[0]]?Fo.accepts[Fo.dataTypes[0]]+('*'===Fo.dataTypes[0]?'':', '+lo+'; q=0.01'):Fo.accepts['*']),Fo.headers)Oo.setRequestHeader(wo,Fo.headers[wo]);if(Fo.beforeSend&&(!1===Fo.beforeSend.call(Do,Oo,Fo)||Ro))return Oo.abort();if(zo='abort',Uo.add(Fo.complete),Oo.done(Fo.success),Oo.fail(Fo.error),Eo=mt(so,Fo,vo,Oo)){if(Oo.readyState=1,Co&&Io.trigger('ajaxSend',[Oo,Fo]),Ro)return Oo;Fo.async&&0<Fo.timeout&&(Ao=ue.setTimeout(function(){Oo.abort('timeout')},Fo.timeout));try{Ro=!1,Eo.send(Go,bo)}catch(ko){if(Ro)throw ko;bo(-1,ko)}}else bo(-1,'No Transport');return Oo},getJSON:function(_o,vo,bo){return Dt.get(_o,vo,bo,'json')},getScript:function(_o,vo){return Dt.get(_o,void 0,vo,'script')}}),Dt.each(['get','post'],function(xo,_o){Dt[_o]=function(vo,bo,Eo,To){return Dt.isFunction(bo)&&(To=To||Eo,Eo=bo,bo=void 0),Dt.ajax(Dt.extend({url:vo,type:_o,dataType:To,data:bo,success:Eo},Dt.isPlainObject(vo)&&vo))}}),Dt._evalUrl=function(xo){return Dt.ajax({url:xo,type:'GET',dataType:'script',cache:!0,async:!1,global:!1,throws:!0})},Dt.fn.extend({wrapAll:function(_o){var vo;return this[0]&&(Dt.isFunction(_o)&&(_o=_o.call(this[0])),vo=Dt(_o,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&vo.insertBefore(this[0]),vo.map(function(){for(var bo=this;bo.firstElementChild;)bo=bo.firstElementChild;return bo}).append(this)),this},wrapInner:function(_o){return Dt.isFunction(_o)?this.each(function(vo){Dt(this).wrapInner(_o.call(this,vo))}):this.each(function(){var vo=Dt(this),bo=vo.contents();bo.length?bo.wrapAll(_o):vo.append(_o)})},wrap:function(_o){var vo=Dt.isFunction(_o);return this.each(function(bo){Dt(this).wrapAll(vo?_o.call(this,bo):_o)})},unwrap:function(_o){return this.parent(_o).not('body').each(function(){Dt(this).replaceWith(this.childNodes)}),this}}),Dt.expr.pseudos.hidden=function(xo){return!Dt.expr.pseudos.visible(xo)},Dt.expr.pseudos.visible=function(xo){return!!(xo.offsetWidth||xo.offsetHeight||xo.getClientRects().length)},Dt.ajaxSettings.xhr=function(){try{return new ue.XMLHttpRequest}catch(xo){}};var co={0:200,1223:204},uo=Dt.ajaxSettings.xhr();Pt.cors=!!uo&&'withCredentials'in uo,Pt.ajax=uo=!!uo,Dt.ajaxTransport(function(xo){var _o,vo;if(Pt.cors||uo&&!xo.crossDomain)return{send:function(Eo,To){var Mo=xo.xhr(),So;if(Mo.open(xo.type,xo.url,xo.async,xo.username,xo.password),xo.xhrFields)for(So in xo.xhrFields)Mo[So]=xo.xhrFields[So];for(So in xo.mimeType&&Mo.overrideMimeType&&Mo.overrideMimeType(xo.mimeType),xo.crossDomain||Eo['X-Requested-With']||(Eo['X-Requested-With']='XMLHttpRequest'),Eo)Mo.setRequestHeader(So,Eo[So]);_o=function(Lo){return function(){_o&&(_o=vo=Mo.onload=Mo.onerror=Mo.onabort=Mo.onreadystatechange=null,'abort'===Lo?Mo.abort():'error'===Lo?'number'==typeof Mo.status?To(Mo.status,Mo.statusText):To(0,'error'):To(co[Mo.status]||Mo.status,Mo.statusText,'text'!==(Mo.responseType||'text')||'string'!=typeof Mo.responseText?{binary:Mo.response}:{text:Mo.responseText},Mo.getAllResponseHeaders()))}},Mo.onload=_o(),vo=Mo.onerror=_o('error'),void 0===Mo.onabort?Mo.onreadystatechange=function(){4===Mo.readyState&&ue.setTimeout(function(){_o&&vo()})}:Mo.onabort=vo,_o=_o('abort');try{Mo.send(xo.hasContent&&xo.data||null)}catch(Ao){if(_o)throw Ao}},abort:function(){_o&&_o()}}}),Dt.ajaxPrefilter(function(xo){xo.crossDomain&&(xo.contents.script=!1)}),Dt.ajaxSetup({accepts:{script:'text/javascript, application/javascript, application/ecmascript, application/x-ecmascript'},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(_o){return Dt.globalEval(_o),_o}}}),Dt.ajaxPrefilter('script',function(xo){void 0===xo.cache&&(xo.cache=!1),xo.crossDomain&&(xo.type='GET')}),Dt.ajaxTransport('script',function(xo){if(xo.crossDomain){var _o,vo;return{send:function(Eo,To){_o=Dt('<script>').prop({charset:xo.scriptCharset,src:xo.url}).on('load error',vo=function(Mo){_o.remove(),vo=null,Mo&&To('error'===Mo.type?404:200,Mo.type)}),_t.head.appendChild(_o[0])},abort:function(){vo&&vo()}}}});var mo=[],fo=/(=)\?(?=&|$)|\?\?/;Dt.ajaxSetup({jsonp:'callback',jsonpCallback:function(){var _o=mo.pop()||Dt.expando+'_'+Xr++;return this[_o]=!0,_o}}),Dt.ajaxPrefilter('json jsonp',function(xo,_o,vo){var So=!1!==xo.jsonp&&(fo.test(xo.url)?'url':'string'==typeof xo.data&&0===(xo.contentType||'').indexOf('application/x-www-form-urlencoded')&&fo.test(xo.data)&&'data'),bo,Eo,To;if(So||'jsonp'===xo.dataTypes[0])return bo=xo.jsonpCallback=Dt.isFunction(xo.jsonpCallback)?xo.jsonpCallback():xo.jsonpCallback,So?xo[So]=xo[So].replace(fo,'$1'+bo):!1!==xo.jsonp&&(xo.url+=(qr.test(xo.url)?'&':'?')+xo.jsonp+'='+bo),xo.converters['script json']=function(){return To||Dt.error(bo+' was not called'),To[0]},xo.dataTypes[0]='json',Eo=ue[bo],ue[bo]=function(){To=arguments},vo.always(function(){void 0===Eo?Dt(ue).removeProp(bo):ue[bo]=Eo,xo[bo]&&(xo.jsonpCallback=_o.jsonpCallback,mo.push(bo)),To&&Dt.isFunction(Eo)&&Eo(To[0]),To=Eo=void 0}),'script'}),Pt.createHTMLDocument=function(){var xo=_t.implementation.createHTMLDocument('').body;return xo.innerHTML='<form></form><form></form>',2===xo.childNodes.length}(),Dt.parseHTML=function(xo,_o,vo){if('string'!=typeof xo)return[];'boolean'==typeof _o&&(vo=_o,_o=!1);var bo,Eo,To;return _o||(Pt.createHTMLDocument?(_o=_t.implementation.createHTMLDocument(''),bo=_o.createElement('base'),bo.href=_t.location.href,_o.head.appendChild(bo)):_o=_t),Eo=Ht.exec(xo),To=!vo&&[],Eo?[_o.createElement(Eo[1])]:(Eo=Ie([xo],_o,To),To&&To.length&&Dt(To).remove(),Dt.merge([],Eo.childNodes))},Dt.fn.load=function(xo,_o,vo){var So=this,Mo=xo.indexOf(' '),bo,Eo,To;return-1<Mo&&(bo=lt(xo.slice(Mo)),xo=xo.slice(0,Mo)),Dt.isFunction(_o)?(vo=_o,_o=void 0):_o&&'object'==('undefined'==typeof _o?'undefined':pe(_o))&&(Eo='POST'),0<So.length&&Dt.ajax({url:xo,type:Eo||'GET',dataType:'html',data:_o}).done(function(Ao){To=arguments,So.html(bo?Dt('<div>').append(Dt.parseHTML(Ao)).find(bo):Ao)}).always(vo&&function(Ao,Lo){So.each(function(){vo.apply(this,To||[Ao.responseText,Lo,Ao])})}),this},Dt.each(['ajaxStart','ajaxStop','ajaxComplete','ajaxError','ajaxSuccess','ajaxSend'],function(xo,_o){Dt.fn[_o]=function(vo){return this.on(_o,vo)}}),Dt.expr.pseudos.animated=function(xo){return Dt.grep(Dt.timers,function(_o){return xo===_o.elem}).length},Dt.offset={setOffset:function(_o,vo,bo){var Co=Dt.css(_o,'position'),wo=Dt(_o),Po={},Eo,To,So,Mo,Ao,Lo,Ro;'static'===Co&&(_o.style.position='relative'),Ao=wo.offset(),So=Dt.css(_o,'top'),Lo=Dt.css(_o,'left'),Ro=('absolute'===Co||'fixed'===Co)&&-1<(So+Lo).indexOf('auto'),Ro?(Eo=wo.position(),Mo=Eo.top,To=Eo.left):(Mo=parseFloat(So)||0,To=parseFloat(Lo)||0),Dt.isFunction(vo)&&(vo=vo.call(_o,bo,Dt.extend({},Ao))),null!=vo.top&&(Po.top=vo.top-Ao.top+Mo),null!=vo.left&&(Po.left=vo.left-Ao.left+To),'using'in vo?vo.using.call(_o,Po):wo.css(Po)}},Dt.fn.extend({offset:function(_o){if(arguments.length)return void 0===_o?this:this.each(function(Mo){Dt.offset.setOffset(this,_o,Mo)});var So=this[0],vo,bo,Eo,To;if(So)return So.getClientRects().length?(Eo=So.getBoundingClientRect(),vo=So.ownerDocument,bo=vo.documentElement,To=vo.defaultView,{top:Eo.top+To.pageYOffset-bo.clientTop,left:Eo.left+To.pageXOffset-bo.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var bo=this[0],Eo={top:0,left:0},_o,vo;return'fixed'===Dt.css(bo,'position')?vo=bo.getBoundingClientRect():(_o=this.offsetParent(),vo=this.offset(),ye(_o[0],'html')||(Eo=_o.offset()),Eo={top:Eo.top+Dt.css(_o[0],'borderTopWidth',!0),left:Eo.left+Dt.css(_o[0],'borderLeftWidth',!0)}),{top:vo.top-Eo.top-Dt.css(bo,'marginTop',!0),left:vo.left-Eo.left-Dt.css(bo,'marginLeft',!0)}}},offsetParent:function(){return this.map(function(){for(var _o=this.offsetParent;_o&&'static'===Dt.css(_o,'position');)_o=_o.offsetParent;return _o||yr})}}),Dt.each({scrollLeft:'pageXOffset',scrollTop:'pageYOffset'},function(xo,_o){var vo='pageYOffset'===_o;Dt.fn[xo]=function(bo){return $t(this,function(Eo,To,So){var Mo;return Dt.isWindow(Eo)?Mo=Eo:9===Eo.nodeType&&(Mo=Eo.defaultView),void 0===So?Mo?Mo[_o]:Eo[To]:void(Mo?Mo.scrollTo(vo?Mo.pageXOffset:So,vo?So:Mo.pageYOffset):Eo[To]=So)},xo,bo,arguments.length)}}),Dt.each(['top','left'],function(xo,_o){Dt.cssHooks[_o]=qe(Pt.pixelPosition,function(vo,bo){if(bo)return bo=Xe(vo,_o),Lr.test(bo)?Dt(vo).position()[_o]+'px':bo})}),Dt.each({Height:'height',Width:'width'},function(xo,_o){Dt.each({padding:'inner'+xo,content:_o,"":'outer'+xo},function(vo,bo){Dt.fn[bo]=function(Eo,To){var So=arguments.length&&(vo||'boolean'!=typeof Eo),Mo=vo||(!0===Eo||!0===To?'margin':'border');return $t(this,function(Ao,Lo,Ro){var Co;return Dt.isWindow(Ao)?0===bo.indexOf('outer')?Ao['inner'+xo]:Ao.document.documentElement['client'+xo]:9===Ao.nodeType?(Co=Ao.documentElement,Math.max(Ao.body['scroll'+xo],Co['scroll'+xo],Ao.body['offset'+xo],Co['offset'+xo],Co['client'+xo])):void 0===Ro?Dt.css(Ao,Lo,Mo):Dt.style(Ao,Lo,Ro,Mo)},_o,So?Eo:void 0,So)}})}),Dt.fn.extend({bind:function(_o,vo,bo){return this.on(_o,null,vo,bo)},unbind:function(_o,vo){return this.off(_o,null,vo)},delegate:function(_o,vo,bo,Eo){return this.on(vo,_o,bo,Eo)},undelegate:function(_o,vo,bo){return 1===arguments.length?this.off(_o,'**'):this.off(vo,_o||'**',bo)}}),Dt.holdReady=function(xo){xo?Dt.readyWait++:Dt.ready(!0)},Dt.isArray=Array.isArray,Dt.parseJSON=JSON.parse,Dt.nodeName=ye,!ie(3)||(se=[],le=function(){return Dt}.apply(oe,se),le!==void 0&&(ne.exports=le));var go=ue.jQuery,yo=ue.$;return Dt.noConflict=function(xo){return ue.$===Dt&&(ue.$=yo),xo&&ue.jQuery===Dt&&(ue.jQuery=go),Dt},fe||(ue.jQuery=ue.$=Dt),Dt})}).call(oe,ie(0)(ee))},function(ee,oe){(function(ie){ee.exports=ie}).call(oe,{})},function(ee,oe,ie){var ne;(function(se,le,pe){'use strict';'undefined'!=typeof ee&&ee.exports?ee.exports=pe(le,se):(ne=function(){return pe(le,se)}.call(oe,ie,oe,ee),!(ne!==void 0&&(ee.exports=ne)))})(window,'detectZoom',function(){var se=function(){return window.devicePixelRatio||1},le=function(){return{zoom:1,devicePxPerCssPx:1}},pe=function(){var Me=Math.round(100*(screen.deviceXDPI/screen.logicalXDPI))/100;return{zoom:Me,devicePxPerCssPx:Me*se()}},ue=function(){var Me=Math.round(100*(document.documentElement.offsetHeight/window.innerHeight))/100;return{zoom:Me,devicePxPerCssPx:Me*se()}},fe=function(){var Me=Math.round(100*(window.outerWidth/window.innerWidth))/100;return{zoom:Me,devicePxPerCssPx:Me*se()}},ge=function(){var Me=Math.round(100*(document.documentElement.clientWidth/window.innerWidth))/100;return{zoom:Me,devicePxPerCssPx:Me*se()}},he=function(){var Me=90==Math.abs(window.orientation)?screen.height:screen.width,Ae=Me/window.innerWidth;return{zoom:Ae,devicePxPerCssPx:Ae*se()}},ye=function(){var Me=function(we){return we.replace(/;/g,' !important;')},Ae=document.createElement('div');Ae.innerHTML='1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>0',Ae.setAttribute('style',Me('font: 100px/1em sans-serif; -webkit-text-size-adjust: none; text-size-adjust: none; height: auto; width: 1em; padding: 0; overflow: visible;'));var Le=document.createElement('div');Le.setAttribute('style',Me('width:0; height:0; overflow:hidden; visibility:hidden; position: absolute;')),Le.appendChild(Ae),document.body.appendChild(Le);var Re=1e3/Ae.clientHeight;return Re=Math.round(100*Re)/100,document.body.removeChild(Le),{zoom:Re,devicePxPerCssPx:Re*se()}},xe=function(){var Me=Ee('min--moz-device-pixel-ratio','',0,10,20,1e-4);return Me=Math.round(100*Me)/100,{zoom:Me,devicePxPerCssPx:Me}},_e=function(){return{zoom:xe().zoom,devicePxPerCssPx:se()}},ve=function(){var Me=window.top.outerWidth/window.top.innerWidth;return Me=Math.round(100*Me)/100,{zoom:Me,devicePxPerCssPx:Me*se()}},Ee=function(Me,Ae,Le,Re,Ce,we){function Pe(Ne,Ge,Ve){var ze=(Ne+Ge)/2;if(0>=Ve||Ge-Ne<we)return ze;return Fe('('+Me+':'+ze+Ae+')').matches?Pe(ze,Ge,Ve-1):Pe(Ne,ze,Ve-1)}var Fe,De,Ie,Be;window.matchMedia?Fe=window.matchMedia:(De=document.getElementsByTagName('head')[0],Ie=document.createElement('style'),De.appendChild(Ie),Be=document.createElement('div'),Be.className='mediaQueryBinarySearch',Be.style.display='none',document.body.appendChild(Be),Fe=function(Ge){Ie.sheet.insertRule('@media '+Ge+'{.mediaQueryBinarySearch {text-decoration: underline} }',0);var Ve='underline'==getComputedStyle(Be,null).textDecoration;return Ie.sheet.deleteRule(0),{matches:Ve}});var Ue=Pe(Le,Re,Ce);return Be&&(De.removeChild(Ie),document.body.removeChild(Be)),Ue},Te=function(){var Se=le;return isNaN(screen.logicalXDPI)||isNaN(screen.systemXDPI)?window.navigator.msMaxTouchPoints?Se=ue:!window.chrome||window.opera||0<=navigator.userAgent.indexOf(' Opera')?0<Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor')?Se=ge:'orientation'in window&&'webkitRequestAnimationFrame'in window?Se=he:'webkitRequestAnimationFrame'in window?Se=ye:0<=navigator.userAgent.indexOf('Opera')?Se=ve:window.devicePixelRatio?Se=_e:1e-3<xe().zoom&&(Se=xe):Se=fe:Se=pe,Se}();return{zoom:function(){return Te().zoom},device:function(){return Te().devicePxPerCssPx}}})},function(ee,oe){(function(){var ie,ne,se;ne='undefined'!=typeof oe&&null!==oe?oe:this,se=function(pe){try{return JSON.parse(pe)}catch(ue){return!1}},ie=function(){function le(){this.names=se('[ "Latin", "Chinese", "Arabic", "Devanagari", "Cyrillic", "Bengali/Assamese", "Kana", "Gurmukhi", "Javanese", "Hangul", "Telugu", "Tamil", "Malayalam", "Burmese", "Thai", "Sundanese", "Kannada", "Gujarati", "Lao", "Odia", "Ge-ez", "Sinhala", "Armenian", "Khmer", "Greek", "Lontara", "Hebrew", "Tibetan", "Georgian", "Modern Yi", "Mongolian", "Tifinagh", "Syriac", "Thaana", "Inuktitut", "Cherokee" ]'),this.codes=se('[[76,97,116,105,110], [27721,23383], [1575,1604,1593,1585,1576,1610,1577], [2342,2375,2357,2344,2366,2327,2352,2368], [1050,1080,1088,1080,1083,1080,1094,1072], [2476,2494,2434,2482,2494,32,47,32,2437,2488,2478,2496,2479,2492,2494], [20206,21517], [2583,2625,2608,2606,2625,2582,2624], [43415,43438], [54620,44544], [3108,3142,3122,3137,3095,3137], [2980,2990,3007,2996,3021], [3374,3378,3375,3390,3379,3330], [4121,4156,4116,4154,4121,4140], [3652,3607,3618], [7070,7077,7060,7082,7059], [3221,3240,3277,3240,3233], [2711,2753,2716,2736,2750,2724,2752], [3749,3762,3751], [2825,2852,2893,2837,2867], [4877,4821,4829], [3523,3538,3458,3524,3517], [1344,1377,1397,1400,1409], [6017,6098,6040,6082,6042], [917,955,955,951,957,953,954,972], [6674,6682,6664,6673], [1488,1500,1508,1489,1497,1514], [3926,3964,3921,3851], [4325,4304,4320,4311,4323,4314,4312], [41352,41760], [6190,6179,6185,6189,6179,6191], [11612,11593,11580,11593,11599,11568,11606], [1808,1834,1825,1821,1808], [1931,1960,1928,1964,1920,1960], [5123,5316,5251,5198,5200,5222], [5091,5043,5033], [55295, 7077]]'),this.fontSize=9,this.fontFace='Verdana',this.extraHeigth=15,this.results=[]}return le.prototype.begin=function(){var pe,ue,fe,ge,he,ye,xe,_e,ve,Ee,Te,Se,Me,Ae,Le,Re,Ce,we,Pe,Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze;for(Ne=0,this.widths=[],this.heights=[],this.support=[],this.test_div=document.createElement('div'),document.body.appendChild(this.test_div),this.test_div.id='WritingTest',De=this.codes,(he=0,ve=De.length);he<ve;he++){for(ue=De[he],this.height=[],this.width=[],this.div=document.createElement('div'),this.test_div.appendChild(this.div),Ne+=1,this.div.id=Ne,this.div.style.display='inline-block',(ye=0,Ee=ue.length);ye<Ee;ye++)pe=ue[ye],this.div.innerHTML='<font face = \''+this.fontFace+'\' size = '+this.fontSize+'>&#'+pe+'</font>',this.height.push(document.getElementById(Ne).clientHeight),this.width.push(document.getElementById(Ne).clientWidth);for(this.div.innerHTML='',xe=0,Te=ue.length;xe<Te;xe++)pe=ue[xe],this.div.innerHTML+='<font face = \''+this.fontFace+'\' size = '+this.fontSize+'>&#'+pe+'</font>';this.test_div.innerHTML+=this.height+';'+this.width+'<br>',this.heights.push(this.height),this.widths.push(this.width)}for(this.tw=this.widths.pop(),this.sw1=this.tw[0],this.sw2=this.tw[1],this.sh=this.heights.pop()[0],Ie=this.heights,(_e=0,Se=Ie.length);_e<Se;_e++){for(ge=Ie[_e],this.passed=0,(Ce=0,Me=ge.length);Ce<Me;Ce++)if(fe=ge[Ce],fe!==this.sh){this.support.push(!0),this.passed=1;break}0===this.passed&&this.support.push(!1)}for(this.writing_scripts_index=0,Be=this.widths,(we=0,Ae=Be.length);we<Ae;we++){for(ze=Be[we],Pe=0,Le=ze.length;Pe<Le;Pe++)Ve=ze[Pe],!1===this.support[this.writing_scripts_index]&&Ve!==this.sw1&&Ve!==this.sw2&&(this.support[this.writing_scripts_index]=!0);this.writing_scripts_index+=1}for(this.res=[],this.writing_scripts_index=0,Ue=this.support,(Fe=0,Re=Ue.length);Fe<Re;Fe++)Ge=Ue[Fe],this.test_div.innerHTML+=this.names[this.writing_scripts_index]+': '+Ge+' <br>',!0===Ge&&this.res.push(this.names[this.writing_scripts_index]),this.writing_scripts_index+=1;return this.test_div.remove(),this.res},le}(),ne.get_writing_scripts=function(){var le;return le=new ie,this.res=le.begin()}}).call(this)},function(){},function(){getCanvas=function(ue){var fe=$('#'+ue);return fe[0]?fe=$('#'+ue)[0]:$('<canvas id=\''+ue+'\' width=\'256\' height=\'256\'></canvas>')[0]},getGLAA=function(ue){for(var fe=null,ge=0;4>ge&&(fe=ue.getContext(['webgl','experimental-webgl','moz-webgl','webkit-3d'][ge],{antialias:!0,preserveDrawingBuffer:!0,willReadFrequently:!1,depth:!0}),!fe);++ge);return fe||alert('Your browser does not support WebGL'),fe},getGL=function(ue){for(var fe=null,ge=0;4>ge&&(fe=ue.getContext(['webgl','experimental-webgl','moz-webgl','webkit-3d'][ge],{antialias:!1,preserveDrawingBuffer:!0,willReadFrequently:!1,depth:!0}),!fe);++ge);return fe||alert('Your browser does not support WebGL'),fe},computeKernelWeight=function(ue){var fe=ue.reduce(function(ge,he){return ge+he});return 0>=fe?1:fe};var ne=function(ue,fe,ge){var he=new XMLHttpRequest;he.open('GET',ue+'?please-dont-cache='+Math.random(),!0),he.onload=function(){200>he.status||299<he.status?fe('Error: HTTP Status '+he.status+' on resource '+ue):fe(null,he.responseText,ge)},he.send()}},function(ee,oe){},function(ee,oe,ie){(function(ne){var se,le,pe='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(ue){return typeof ue}:function(ue){return ue&&'function'==typeof Symbol&&ue.constructor===Symbol&&ue!==Symbol.prototype?'symbol':typeof ue};(function(fe,ge){if('object'===pe(oe)&&'object'===pe(ne))ne.exports=ge();else{se=ge,le='function'==typeof se?se.call(oe,ie,oe,ne):se,!(void 0!==le&&(ne.exports=le))}})(this,function(){return function(ue){function fe(he){if(ge[he])return ge[he].exports;var ye=ge[he]={exports:{},id:he,loaded:!1};return ue[he].call(ye.exports,ye,ye.exports,fe),ye.loaded=!0,ye.exports}var ge={};return fe.m=ue,fe.c=ge,fe.p='',fe(0)}([function(ue,fe,ge){fe.glMatrix=ge(1),fe.mat2=ge(2),fe.mat2d=ge(3),fe.mat3=ge(4),fe.mat4=ge(5),fe.quat=ge(6),fe.vec2=ge(9),fe.vec3=ge(7),fe.vec4=ge(8)},function(ue){var ge={};ge.EPSILON=1e-6,ge.ARRAY_TYPE='undefined'==typeof Float32Array?Array:Float32Array,ge.RANDOM=Math.random,ge.ENABLE_SIMD=!1,ge.SIMD_AVAILABLE=ge.ARRAY_TYPE===Float32Array&&'SIMD'in this,ge.USE_SIMD=ge.ENABLE_SIMD&&ge.SIMD_AVAILABLE,ge.setMatrixArrayType=function(ye){ge.ARRAY_TYPE=ye};var he=Math.PI/180;ge.toRadian=function(ye){return ye*he},ue.exports=ge},function(ue,fe,ge){var he=ge(1),ye={};ye.create=function(){var xe=new he.ARRAY_TYPE(4);return xe[0]=1,xe[1]=0,xe[2]=0,xe[3]=1,xe},ye.clone=function(xe){var _e=new he.ARRAY_TYPE(4);return _e[0]=xe[0],_e[1]=xe[1],_e[2]=xe[2],_e[3]=xe[3],_e},ye.copy=function(xe,_e){return xe[0]=_e[0],xe[1]=_e[1],xe[2]=_e[2],xe[3]=_e[3],xe},ye.identity=function(xe){return xe[0]=1,xe[1]=0,xe[2]=0,xe[3]=1,xe},ye.transpose=function(xe,_e){if(xe===_e){var ve=_e[1];xe[1]=_e[2],xe[2]=ve}else xe[0]=_e[0],xe[1]=_e[2],xe[2]=_e[1],xe[3]=_e[3];return xe},ye.invert=function(xe,_e){var ve=_e[0],Ee=_e[1],Te=_e[2],Se=_e[3],Me=ve*Se-Te*Ee;return Me?(Me=1/Me,xe[0]=Se*Me,xe[1]=-Ee*Me,xe[2]=-Te*Me,xe[3]=ve*Me,xe):null},ye.adjoint=function(xe,_e){var ve=_e[0];return xe[0]=_e[3],xe[1]=-_e[1],xe[2]=-_e[2],xe[3]=ve,xe},ye.determinant=function(xe){return xe[0]*xe[3]-xe[2]*xe[1]},ye.multiply=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=_e[3],Ae=ve[0],Le=ve[1],Re=ve[2],Ce=ve[3];return xe[0]=Ee*Ae+Se*Le,xe[1]=Te*Ae+Me*Le,xe[2]=Ee*Re+Se*Ce,xe[3]=Te*Re+Me*Ce,xe},ye.mul=ye.multiply,ye.rotate=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=_e[3],Ae=Math.sin(ve),Le=Math.cos(ve);return xe[0]=Ee*Le+Se*Ae,xe[1]=Te*Le+Me*Ae,xe[2]=Ee*-Ae+Se*Le,xe[3]=Te*-Ae+Me*Le,xe},ye.scale=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=_e[3],Ae=ve[0],Le=ve[1];return xe[0]=Ee*Ae,xe[1]=Te*Ae,xe[2]=Se*Le,xe[3]=Me*Le,xe},ye.fromRotation=function(xe,_e){var ve=Math.sin(_e),Ee=Math.cos(_e);return xe[0]=Ee,xe[1]=ve,xe[2]=-ve,xe[3]=Ee,xe},ye.fromScaling=function(xe,_e){return xe[0]=_e[0],xe[1]=0,xe[2]=0,xe[3]=_e[1],xe},ye.str=function(xe){return'mat2('+xe[0]+', '+xe[1]+', '+xe[2]+', '+xe[3]+')'},ye.frob=function(xe){return Math.sqrt(Math.pow(xe[0],2)+Math.pow(xe[1],2)+Math.pow(xe[2],2)+Math.pow(xe[3],2))},ye.LDU=function(xe,_e,ve,Ee){return xe[2]=Ee[2]/Ee[0],ve[0]=Ee[0],ve[1]=Ee[1],ve[3]=Ee[3]-xe[2]*ve[1],[xe,_e,ve]},ue.exports=ye},function(ue,fe,ge){var he=ge(1),ye={};ye.create=function(){var xe=new he.ARRAY_TYPE(6);return xe[0]=1,xe[1]=0,xe[2]=0,xe[3]=1,xe[4]=0,xe[5]=0,xe},ye.clone=function(xe){var _e=new he.ARRAY_TYPE(6);return _e[0]=xe[0],_e[1]=xe[1],_e[2]=xe[2],_e[3]=xe[3],_e[4]=xe[4],_e[5]=xe[5],_e},ye.copy=function(xe,_e){return xe[0]=_e[0],xe[1]=_e[1],xe[2]=_e[2],xe[3]=_e[3],xe[4]=_e[4],xe[5]=_e[5],xe},ye.identity=function(xe){return xe[0]=1,xe[1]=0,xe[2]=0,xe[3]=1,xe[4]=0,xe[5]=0,xe},ye.invert=function(xe,_e){var ve=_e[0],Ee=_e[1],Te=_e[2],Se=_e[3],Me=_e[4],Ae=_e[5],Le=ve*Se-Ee*Te;return Le?(Le=1/Le,xe[0]=Se*Le,xe[1]=-Ee*Le,xe[2]=-Te*Le,xe[3]=ve*Le,xe[4]=(Te*Ae-Se*Me)*Le,xe[5]=(Ee*Me-ve*Ae)*Le,xe):null},ye.determinant=function(xe){return xe[0]*xe[3]-xe[1]*xe[2]},ye.multiply=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=_e[3],Ae=_e[4],Le=_e[5],Re=ve[0],Ce=ve[1],we=ve[2],Pe=ve[3],Fe=ve[4],De=ve[5];return xe[0]=Ee*Re+Se*Ce,xe[1]=Te*Re+Me*Ce,xe[2]=Ee*we+Se*Pe,xe[3]=Te*we+Me*Pe,xe[4]=Ee*Fe+Se*De+Ae,xe[5]=Te*Fe+Me*De+Le,xe},ye.mul=ye.multiply,ye.rotate=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=_e[3],Ae=_e[4],Le=_e[5],Re=Math.sin(ve),Ce=Math.cos(ve);return xe[0]=Ee*Ce+Se*Re,xe[1]=Te*Ce+Me*Re,xe[2]=Ee*-Re+Se*Ce,xe[3]=Te*-Re+Me*Ce,xe[4]=Ae,xe[5]=Le,xe},ye.scale=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=_e[3],Ae=_e[4],Le=_e[5],Re=ve[0],Ce=ve[1];return xe[0]=Ee*Re,xe[1]=Te*Re,xe[2]=Se*Ce,xe[3]=Me*Ce,xe[4]=Ae,xe[5]=Le,xe},ye.translate=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=_e[3],Ae=_e[4],Le=_e[5],Re=ve[0],Ce=ve[1];return xe[0]=Ee,xe[1]=Te,xe[2]=Se,xe[3]=Me,xe[4]=Ee*Re+Se*Ce+Ae,xe[5]=Te*Re+Me*Ce+Le,xe},ye.fromRotation=function(xe,_e){var ve=Math.sin(_e),Ee=Math.cos(_e);return xe[0]=Ee,xe[1]=ve,xe[2]=-ve,xe[3]=Ee,xe[4]=0,xe[5]=0,xe},ye.fromScaling=function(xe,_e){return xe[0]=_e[0],xe[1]=0,xe[2]=0,xe[3]=_e[1],xe[4]=0,xe[5]=0,xe},ye.fromTranslation=function(xe,_e){return xe[0]=1,xe[1]=0,xe[2]=0,xe[3]=1,xe[4]=_e[0],xe[5]=_e[1],xe},ye.str=function(xe){return'mat2d('+xe[0]+', '+xe[1]+', '+xe[2]+', '+xe[3]+', '+xe[4]+', '+xe[5]+')'},ye.frob=function(xe){return Math.sqrt(Math.pow(xe[0],2)+Math.pow(xe[1],2)+Math.pow(xe[2],2)+Math.pow(xe[3],2)+Math.pow(xe[4],2)+Math.pow(xe[5],2)+1)},ue.exports=ye},function(ue,fe,ge){var he=ge(1),ye={};ye.create=function(){var xe=new he.ARRAY_TYPE(9);return xe[0]=1,xe[1]=0,xe[2]=0,xe[3]=0,xe[4]=1,xe[5]=0,xe[6]=0,xe[7]=0,xe[8]=1,xe},ye.fromMat4=function(xe,_e){return xe[0]=_e[0],xe[1]=_e[1],xe[2]=_e[2],xe[3]=_e[4],xe[4]=_e[5],xe[5]=_e[6],xe[6]=_e[8],xe[7]=_e[9],xe[8]=_e[10],xe},ye.clone=function(xe){var _e=new he.ARRAY_TYPE(9);return _e[0]=xe[0],_e[1]=xe[1],_e[2]=xe[2],_e[3]=xe[3],_e[4]=xe[4],_e[5]=xe[5],_e[6]=xe[6],_e[7]=xe[7],_e[8]=xe[8],_e},ye.copy=function(xe,_e){return xe[0]=_e[0],xe[1]=_e[1],xe[2]=_e[2],xe[3]=_e[3],xe[4]=_e[4],xe[5]=_e[5],xe[6]=_e[6],xe[7]=_e[7],xe[8]=_e[8],xe},ye.identity=function(xe){return xe[0]=1,xe[1]=0,xe[2]=0,xe[3]=0,xe[4]=1,xe[5]=0,xe[6]=0,xe[7]=0,xe[8]=1,xe},ye.transpose=function(xe,_e){if(xe===_e){var ve=_e[1],Ee=_e[2],Te=_e[5];xe[1]=_e[3],xe[2]=_e[6],xe[3]=ve,xe[5]=_e[7],xe[6]=Ee,xe[7]=Te}else xe[0]=_e[0],xe[1]=_e[3],xe[2]=_e[6],xe[3]=_e[1],xe[4]=_e[4],xe[5]=_e[7],xe[6]=_e[2],xe[7]=_e[5],xe[8]=_e[8];return xe},ye.invert=function(xe,_e){var ve=_e[0],Ee=_e[1],Te=_e[2],Se=_e[3],Me=_e[4],Ae=_e[5],Le=_e[6],Re=_e[7],Ce=_e[8],we=Ce*Me-Ae*Re,Pe=-Ce*Se+Ae*Le,Fe=Re*Se-Me*Le,De=ve*we+Ee*Pe+Te*Fe;return De?(De=1/De,xe[0]=we*De,xe[1]=(-Ce*Ee+Te*Re)*De,xe[2]=(Ae*Ee-Te*Me)*De,xe[3]=Pe*De,xe[4]=(Ce*ve-Te*Le)*De,xe[5]=(-Ae*ve+Te*Se)*De,xe[6]=Fe*De,xe[7]=(-Re*ve+Ee*Le)*De,xe[8]=(Me*ve-Ee*Se)*De,xe):null},ye.adjoint=function(xe,_e){var ve=_e[0],Ee=_e[1],Te=_e[2],Se=_e[3],Me=_e[4],Ae=_e[5],Le=_e[6],Re=_e[7],Ce=_e[8];return xe[0]=Me*Ce-Ae*Re,xe[1]=Te*Re-Ee*Ce,xe[2]=Ee*Ae-Te*Me,xe[3]=Ae*Le-Se*Ce,xe[4]=ve*Ce-Te*Le,xe[5]=Te*Se-ve*Ae,xe[6]=Se*Re-Me*Le,xe[7]=Ee*Le-ve*Re,xe[8]=ve*Me-Ee*Se,xe},ye.determinant=function(xe){var _e=xe[0],ve=xe[1],Ee=xe[2],Te=xe[3],Se=xe[4],Me=xe[5],Ae=xe[6],Le=xe[7],Re=xe[8];return _e*(Re*Se-Me*Le)+ve*(-Re*Te+Me*Ae)+Ee*(Le*Te-Se*Ae)},ye.multiply=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=_e[3],Ae=_e[4],Le=_e[5],Re=_e[6],Ce=_e[7],we=_e[8],Pe=ve[0],Fe=ve[1],De=ve[2],Ie=ve[3],Be=ve[4],Ue=ve[5],Ne=ve[6],Ge=ve[7],Ve=ve[8];return xe[0]=Pe*Ee+Fe*Me+De*Re,xe[1]=Pe*Te+Fe*Ae+De*Ce,xe[2]=Pe*Se+Fe*Le+De*we,xe[3]=Ie*Ee+Be*Me+Ue*Re,xe[4]=Ie*Te+Be*Ae+Ue*Ce,xe[5]=Ie*Se+Be*Le+Ue*we,xe[6]=Ne*Ee+Ge*Me+Ve*Re,xe[7]=Ne*Te+Ge*Ae+Ve*Ce,xe[8]=Ne*Se+Ge*Le+Ve*we,xe},ye.mul=ye.multiply,ye.translate=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=_e[3],Ae=_e[4],Le=_e[5],Re=_e[6],Ce=_e[7],we=_e[8],Pe=ve[0],Fe=ve[1];return xe[0]=Ee,xe[1]=Te,xe[2]=Se,xe[3]=Me,xe[4]=Ae,xe[5]=Le,xe[6]=Pe*Ee+Fe*Me+Re,xe[7]=Pe*Te+Fe*Ae+Ce,xe[8]=Pe*Se+Fe*Le+we,xe},ye.rotate=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=_e[3],Ae=_e[4],Le=_e[5],Re=_e[6],Ce=_e[7],we=_e[8],Pe=Math.sin(ve),Fe=Math.cos(ve);return xe[0]=Fe*Ee+Pe*Me,xe[1]=Fe*Te+Pe*Ae,xe[2]=Fe*Se+Pe*Le,xe[3]=Fe*Me-Pe*Ee,xe[4]=Fe*Ae-Pe*Te,xe[5]=Fe*Le-Pe*Se,xe[6]=Re,xe[7]=Ce,xe[8]=we,xe},ye.scale=function(xe,_e,ve){var Ee=ve[0],Te=ve[1];return xe[0]=Ee*_e[0],xe[1]=Ee*_e[1],xe[2]=Ee*_e[2],xe[3]=Te*_e[3],xe[4]=Te*_e[4],xe[5]=Te*_e[5],xe[6]=_e[6],xe[7]=_e[7],xe[8]=_e[8],xe},ye.fromTranslation=function(xe,_e){return xe[0]=1,xe[1]=0,xe[2]=0,xe[3]=0,xe[4]=1,xe[5]=0,xe[6]=_e[0],xe[7]=_e[1],xe[8]=1,xe},ye.fromRotation=function(xe,_e){var ve=Math.sin(_e),Ee=Math.cos(_e);return xe[0]=Ee,xe[1]=ve,xe[2]=0,xe[3]=-ve,xe[4]=Ee,xe[5]=0,xe[6]=0,xe[7]=0,xe[8]=1,xe},ye.fromScaling=function(xe,_e){return xe[0]=_e[0],xe[1]=0,xe[2]=0,xe[3]=0,xe[4]=_e[1],xe[5]=0,xe[6]=0,xe[7]=0,xe[8]=1,xe},ye.fromMat2d=function(xe,_e){return xe[0]=_e[0],xe[1]=_e[1],xe[2]=0,xe[3]=_e[2],xe[4]=_e[3],xe[5]=0,xe[6]=_e[4],xe[7]=_e[5],xe[8]=1,xe},ye.fromQuat=function(xe,_e){var ve=_e[0],Ee=_e[1],Te=_e[2],Se=_e[3],Me=ve+ve,Ae=Ee+Ee,Le=Te+Te,Re=ve*Me,Ce=Ee*Me,we=Ee*Ae,Pe=Te*Me,Fe=Te*Ae,De=Te*Le,Ie=Se*Me,Be=Se*Ae,Ue=Se*Le;return xe[0]=1-we-De,xe[3]=Ce-Ue,xe[6]=Pe+Be,xe[1]=Ce+Ue,xe[4]=1-Re-De,xe[7]=Fe-Ie,xe[2]=Pe-Be,xe[5]=Fe+Ie,xe[8]=1-Re-we,xe},ye.normalFromMat4=function(xe,_e){var ve=_e[0],Ee=_e[1],Te=_e[2],Se=_e[3],Me=_e[4],Ae=_e[5],Le=_e[6],Re=_e[7],Ce=_e[8],we=_e[9],Pe=_e[10],Fe=_e[11],De=_e[12],Ie=_e[13],Be=_e[14],Ue=_e[15],Ne=ve*Ae-Ee*Me,Ge=ve*Le-Te*Me,Ve=ve*Re-Se*Me,ze=Ee*Le-Te*Ae,Oe=Ee*Re-Se*Ae,ke=Te*Re-Se*Le,He=Ce*Ie-we*De,We=Ce*Be-Pe*De,je=Ce*Ue-Fe*De,Xe=we*Be-Pe*Ie,qe=we*Ue-Fe*Ie,Ye=Pe*Ue-Fe*Be,Ze=Ne*Ye-Ge*qe+Ve*Xe+ze*je-Oe*We+ke*He;return Ze?(Ze=1/Ze,xe[0]=(Ae*Ye-Le*qe+Re*Xe)*Ze,xe[1]=(Le*je-Me*Ye-Re*We)*Ze,xe[2]=(Me*qe-Ae*je+Re*He)*Ze,xe[3]=(Te*qe-Ee*Ye-Se*Xe)*Ze,xe[4]=(ve*Ye-Te*je+Se*We)*Ze,xe[5]=(Ee*je-ve*qe-Se*He)*Ze,xe[6]=(Ie*ke-Be*Oe+Ue*ze)*Ze,xe[7]=(Be*Ve-De*ke-Ue*Ge)*Ze,xe[8]=(De*Oe-Ie*Ve+Ue*Ne)*Ze,xe):null},ye.str=function(xe){return'mat3('+xe[0]+', '+xe[1]+', '+xe[2]+', '+xe[3]+', '+xe[4]+', '+xe[5]+', '+xe[6]+', '+xe[7]+', '+xe[8]+')'},ye.frob=function(xe){return Math.sqrt(Math.pow(xe[0],2)+Math.pow(xe[1],2)+Math.pow(xe[2],2)+Math.pow(xe[3],2)+Math.pow(xe[4],2)+Math.pow(xe[5],2)+Math.pow(xe[6],2)+Math.pow(xe[7],2)+Math.pow(xe[8],2))},ue.exports=ye},function(ue,fe,ge){var he=ge(1),ye={scalar:{},SIMD:{}};ye.create=function(){var xe=new he.ARRAY_TYPE(16);return xe[0]=1,xe[1]=0,xe[2]=0,xe[3]=0,xe[4]=0,xe[5]=1,xe[6]=0,xe[7]=0,xe[8]=0,xe[9]=0,xe[10]=1,xe[11]=0,xe[12]=0,xe[13]=0,xe[14]=0,xe[15]=1,xe},ye.clone=function(xe){var _e=new he.ARRAY_TYPE(16);return _e[0]=xe[0],_e[1]=xe[1],_e[2]=xe[2],_e[3]=xe[3],_e[4]=xe[4],_e[5]=xe[5],_e[6]=xe[6],_e[7]=xe[7],_e[8]=xe[8],_e[9]=xe[9],_e[10]=xe[10],_e[11]=xe[11],_e[12]=xe[12],_e[13]=xe[13],_e[14]=xe[14],_e[15]=xe[15],_e},ye.copy=function(xe,_e){return xe[0]=_e[0],xe[1]=_e[1],xe[2]=_e[2],xe[3]=_e[3],xe[4]=_e[4],xe[5]=_e[5],xe[6]=_e[6],xe[7]=_e[7],xe[8]=_e[8],xe[9]=_e[9],xe[10]=_e[10],xe[11]=_e[11],xe[12]=_e[12],xe[13]=_e[13],xe[14]=_e[14],xe[15]=_e[15],xe},ye.identity=function(xe){return xe[0]=1,xe[1]=0,xe[2]=0,xe[3]=0,xe[4]=0,xe[5]=1,xe[6]=0,xe[7]=0,xe[8]=0,xe[9]=0,xe[10]=1,xe[11]=0,xe[12]=0,xe[13]=0,xe[14]=0,xe[15]=1,xe},ye.scalar.transpose=function(xe,_e){if(xe===_e){var ve=_e[1],Ee=_e[2],Te=_e[3],Se=_e[6],Me=_e[7],Ae=_e[11];xe[1]=_e[4],xe[2]=_e[8],xe[3]=_e[12],xe[4]=ve,xe[6]=_e[9],xe[7]=_e[13],xe[8]=Ee,xe[9]=Se,xe[11]=_e[14],xe[12]=Te,xe[13]=Me,xe[14]=Ae}else xe[0]=_e[0],xe[1]=_e[4],xe[2]=_e[8],xe[3]=_e[12],xe[4]=_e[1],xe[5]=_e[5],xe[6]=_e[9],xe[7]=_e[13],xe[8]=_e[2],xe[9]=_e[6],xe[10]=_e[10],xe[11]=_e[14],xe[12]=_e[3],xe[13]=_e[7],xe[14]=_e[11],xe[15]=_e[15];return xe},ye.SIMD.transpose=function(xe,_e){var ve,Ee,Te,Se,Me,Ae,Le,Re,Ce,we;return ve=SIMD.Float32x4.load(_e,0),Ee=SIMD.Float32x4.load(_e,4),Te=SIMD.Float32x4.load(_e,8),Se=SIMD.Float32x4.load(_e,12),Me=SIMD.Float32x4.shuffle(ve,Ee,0,1,4,5),Ae=SIMD.Float32x4.shuffle(Te,Se,0,1,4,5),Le=SIMD.Float32x4.shuffle(Me,Ae,0,2,4,6),Re=SIMD.Float32x4.shuffle(Me,Ae,1,3,5,7),SIMD.Float32x4.store(xe,0,Le),SIMD.Float32x4.store(xe,4,Re),Me=SIMD.Float32x4.shuffle(ve,Ee,2,3,6,7),Ae=SIMD.Float32x4.shuffle(Te,Se,2,3,6,7),Ce=SIMD.Float32x4.shuffle(Me,Ae,0,2,4,6),we=SIMD.Float32x4.shuffle(Me,Ae,1,3,5,7),SIMD.Float32x4.store(xe,8,Ce),SIMD.Float32x4.store(xe,12,we),xe},ye.transpose=he.USE_SIMD?ye.SIMD.transpose:ye.scalar.transpose,ye.scalar.invert=function(xe,_e){var ve=_e[0],Ee=_e[1],Te=_e[2],Se=_e[3],Me=_e[4],Ae=_e[5],Le=_e[6],Re=_e[7],Ce=_e[8],we=_e[9],Pe=_e[10],Fe=_e[11],De=_e[12],Ie=_e[13],Be=_e[14],Ue=_e[15],Ne=ve*Ae-Ee*Me,Ge=ve*Le-Te*Me,Ve=ve*Re-Se*Me,ze=Ee*Le-Te*Ae,Oe=Ee*Re-Se*Ae,ke=Te*Re-Se*Le,He=Ce*Ie-we*De,We=Ce*Be-Pe*De,je=Ce*Ue-Fe*De,Xe=we*Be-Pe*Ie,qe=we*Ue-Fe*Ie,Ye=Pe*Ue-Fe*Be,Ze=Ne*Ye-Ge*qe+Ve*Xe+ze*je-Oe*We+ke*He;return Ze?(Ze=1/Ze,xe[0]=(Ae*Ye-Le*qe+Re*Xe)*Ze,xe[1]=(Te*qe-Ee*Ye-Se*Xe)*Ze,xe[2]=(Ie*ke-Be*Oe+Ue*ze)*Ze,xe[3]=(Pe*Oe-we*ke-Fe*ze)*Ze,xe[4]=(Le*je-Me*Ye-Re*We)*Ze,xe[5]=(ve*Ye-Te*je+Se*We)*Ze,xe[6]=(Be*Ve-De*ke-Ue*Ge)*Ze,xe[7]=(Ce*ke-Pe*Ve+Fe*Ge)*Ze,xe[8]=(Me*qe-Ae*je+Re*He)*Ze,xe[9]=(Ee*je-ve*qe-Se*He)*Ze,xe[10]=(De*Oe-Ie*Ve+Ue*Ne)*Ze,xe[11]=(we*Ve-Ce*Oe-Fe*Ne)*Ze,xe[12]=(Ae*We-Me*Xe-Le*He)*Ze,xe[13]=(ve*Xe-Ee*We+Te*He)*Ze,xe[14]=(Ie*Ge-De*ze-Be*Ne)*Ze,xe[15]=(Ce*ze-we*Ge+Pe*Ne)*Ze,xe):null},ye.SIMD.invert=function(xe,_e){var Pe=SIMD.Float32x4.load(_e,0),Fe=SIMD.Float32x4.load(_e,4),De=SIMD.Float32x4.load(_e,8),Ie=SIMD.Float32x4.load(_e,12),ve,Ee,Te,Se,Me,Ae,Le,Re,Ce,we;return(Me=SIMD.Float32x4.shuffle(Pe,Fe,0,1,4,5),Ee=SIMD.Float32x4.shuffle(De,Ie,0,1,4,5),ve=SIMD.Float32x4.shuffle(Me,Ee,0,2,4,6),Ee=SIMD.Float32x4.shuffle(Ee,Me,1,3,5,7),Me=SIMD.Float32x4.shuffle(Pe,Fe,2,3,6,7),Se=SIMD.Float32x4.shuffle(De,Ie,2,3,6,7),Te=SIMD.Float32x4.shuffle(Me,Se,0,2,4,6),Se=SIMD.Float32x4.shuffle(Se,Me,1,3,5,7),Me=SIMD.Float32x4.mul(Te,Se),Me=SIMD.Float32x4.swizzle(Me,1,0,3,2),Ae=SIMD.Float32x4.mul(Ee,Me),Le=SIMD.Float32x4.mul(ve,Me),Me=SIMD.Float32x4.swizzle(Me,2,3,0,1),Ae=SIMD.Float32x4.sub(SIMD.Float32x4.mul(Ee,Me),Ae),Le=SIMD.Float32x4.sub(SIMD.Float32x4.mul(ve,Me),Le),Le=SIMD.Float32x4.swizzle(Le,2,3,0,1),Me=SIMD.Float32x4.mul(Ee,Te),Me=SIMD.Float32x4.swizzle(Me,1,0,3,2),Ae=SIMD.Float32x4.add(SIMD.Float32x4.mul(Se,Me),Ae),Ce=SIMD.Float32x4.mul(ve,Me),Me=SIMD.Float32x4.swizzle(Me,2,3,0,1),Ae=SIMD.Float32x4.sub(Ae,SIMD.Float32x4.mul(Se,Me)),Ce=SIMD.Float32x4.sub(SIMD.Float32x4.mul(ve,Me),Ce),Ce=SIMD.Float32x4.swizzle(Ce,2,3,0,1),Me=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(Ee,2,3,0,1),Se),Me=SIMD.Float32x4.swizzle(Me,1,0,3,2),Te=SIMD.Float32x4.swizzle(Te,2,3,0,1),Ae=SIMD.Float32x4.add(SIMD.Float32x4.mul(Te,Me),Ae),Re=SIMD.Float32x4.mul(ve,Me),Me=SIMD.Float32x4.swizzle(Me,2,3,0,1),Ae=SIMD.Float32x4.sub(Ae,SIMD.Float32x4.mul(Te,Me)),Re=SIMD.Float32x4.sub(SIMD.Float32x4.mul(ve,Me),Re),Re=SIMD.Float32x4.swizzle(Re,2,3,0,1),Me=SIMD.Float32x4.mul(ve,Ee),Me=SIMD.Float32x4.swizzle(Me,1,0,3,2),Re=SIMD.Float32x4.add(SIMD.Float32x4.mul(Se,Me),Re),Ce=SIMD.Float32x4.sub(SIMD.Float32x4.mul(Te,Me),Ce),Me=SIMD.Float32x4.swizzle(Me,2,3,0,1),Re=SIMD.Float32x4.sub(SIMD.Float32x4.mul(Se,Me),Re),Ce=SIMD.Float32x4.sub(Ce,SIMD.Float32x4.mul(Te,Me)),Me=SIMD.Float32x4.mul(ve,Se),Me=SIMD.Float32x4.swizzle(Me,1,0,3,2),Le=SIMD.Float32x4.sub(Le,SIMD.Float32x4.mul(Te,Me)),Re=SIMD.Float32x4.add(SIMD.Float32x4.mul(Ee,Me),Re),Me=SIMD.Float32x4.swizzle(Me,2,3,0,1),Le=SIMD.Float32x4.add(SIMD.Float32x4.mul(Te,Me),Le),Re=SIMD.Float32x4.sub(Re,SIMD.Float32x4.mul(Ee,Me)),Me=SIMD.Float32x4.mul(ve,Te),Me=SIMD.Float32x4.swizzle(Me,1,0,3,2),Le=SIMD.Float32x4.add(SIMD.Float32x4.mul(Se,Me),Le),Ce=SIMD.Float32x4.sub(Ce,SIMD.Float32x4.mul(Ee,Me)),Me=SIMD.Float32x4.swizzle(Me,2,3,0,1),Le=SIMD.Float32x4.sub(Le,SIMD.Float32x4.mul(Se,Me)),Ce=SIMD.Float32x4.add(SIMD.Float32x4.mul(Ee,Me),Ce),we=SIMD.Float32x4.mul(ve,Ae),we=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(we,2,3,0,1),we),we=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(we,1,0,3,2),we),Me=SIMD.Float32x4.reciprocalApproximation(we),we=SIMD.Float32x4.sub(SIMD.Float32x4.add(Me,Me),SIMD.Float32x4.mul(we,SIMD.Float32x4.mul(Me,Me))),we=SIMD.Float32x4.swizzle(we,0,0,0,0),!we)?null:(SIMD.Float32x4.store(xe,0,SIMD.Float32x4.mul(we,Ae)),SIMD.Float32x4.store(xe,4,SIMD.Float32x4.mul(we,Le)),SIMD.Float32x4.store(xe,8,SIMD.Float32x4.mul(we,Re)),SIMD.Float32x4.store(xe,12,SIMD.Float32x4.mul(we,Ce)),xe)},ye.invert=he.USE_SIMD?ye.SIMD.invert:ye.scalar.invert,ye.scalar.adjoint=function(xe,_e){var ve=_e[0],Ee=_e[1],Te=_e[2],Se=_e[3],Me=_e[4],Ae=_e[5],Le=_e[6],Re=_e[7],Ce=_e[8],we=_e[9],Pe=_e[10],Fe=_e[11],De=_e[12],Ie=_e[13],Be=_e[14],Ue=_e[15];return xe[0]=Ae*(Pe*Ue-Fe*Be)-we*(Le*Ue-Re*Be)+Ie*(Le*Fe-Re*Pe),xe[1]=-(Ee*(Pe*Ue-Fe*Be)-we*(Te*Ue-Se*Be)+Ie*(Te*Fe-Se*Pe)),xe[2]=Ee*(Le*Ue-Re*Be)-Ae*(Te*Ue-Se*Be)+Ie*(Te*Re-Se*Le),xe[3]=-(Ee*(Le*Fe-Re*Pe)-Ae*(Te*Fe-Se*Pe)+we*(Te*Re-Se*Le)),xe[4]=-(Me*(Pe*Ue-Fe*Be)-Ce*(Le*Ue-Re*Be)+De*(Le*Fe-Re*Pe)),xe[5]=ve*(Pe*Ue-Fe*Be)-Ce*(Te*Ue-Se*Be)+De*(Te*Fe-Se*Pe),xe[6]=-(ve*(Le*Ue-Re*Be)-Me*(Te*Ue-Se*Be)+De*(Te*Re-Se*Le)),xe[7]=ve*(Le*Fe-Re*Pe)-Me*(Te*Fe-Se*Pe)+Ce*(Te*Re-Se*Le),xe[8]=Me*(we*Ue-Fe*Ie)-Ce*(Ae*Ue-Re*Ie)+De*(Ae*Fe-Re*we),xe[9]=-(ve*(we*Ue-Fe*Ie)-Ce*(Ee*Ue-Se*Ie)+De*(Ee*Fe-Se*we)),xe[10]=ve*(Ae*Ue-Re*Ie)-Me*(Ee*Ue-Se*Ie)+De*(Ee*Re-Se*Ae),xe[11]=-(ve*(Ae*Fe-Re*we)-Me*(Ee*Fe-Se*we)+Ce*(Ee*Re-Se*Ae)),xe[12]=-(Me*(we*Be-Pe*Ie)-Ce*(Ae*Be-Le*Ie)+De*(Ae*Pe-Le*we)),xe[13]=ve*(we*Be-Pe*Ie)-Ce*(Ee*Be-Te*Ie)+De*(Ee*Pe-Te*we),xe[14]=-(ve*(Ae*Be-Le*Ie)-Me*(Ee*Be-Te*Ie)+De*(Ee*Le-Te*Ae)),xe[15]=ve*(Ae*Pe-Le*we)-Me*(Ee*Pe-Te*we)+Ce*(Ee*Le-Te*Ae),xe},ye.SIMD.adjoint=function(xe,_e){var ve=SIMD.Float32x4.load(_e,0),Ee=SIMD.Float32x4.load(_e,4),Te=SIMD.Float32x4.load(_e,8),Se=SIMD.Float32x4.load(_e,12),ve,Ee,Te,Se,Me,Ae,Le,Re,Ce,we,Pe,Fe,De;return Ce=SIMD.Float32x4.shuffle(ve,Ee,0,1,4,5),Ae=SIMD.Float32x4.shuffle(Te,Se,0,1,4,5),Me=SIMD.Float32x4.shuffle(Ce,Ae,0,2,4,6),Ae=SIMD.Float32x4.shuffle(Ae,Ce,1,3,5,7),Ce=SIMD.Float32x4.shuffle(ve,Ee,2,3,6,7),Re=SIMD.Float32x4.shuffle(Te,Se,2,3,6,7),Le=SIMD.Float32x4.shuffle(Ce,Re,0,2,4,6),Re=SIMD.Float32x4.shuffle(Re,Ce,1,3,5,7),Ce=SIMD.Float32x4.mul(Le,Re),Ce=SIMD.Float32x4.swizzle(Ce,1,0,3,2),we=SIMD.Float32x4.mul(Ae,Ce),Pe=SIMD.Float32x4.mul(Me,Ce),Ce=SIMD.Float32x4.swizzle(Ce,2,3,0,1),we=SIMD.Float32x4.sub(SIMD.Float32x4.mul(Ae,Ce),we),Pe=SIMD.Float32x4.sub(SIMD.Float32x4.mul(Me,Ce),Pe),Pe=SIMD.Float32x4.swizzle(Pe,2,3,0,1),Ce=SIMD.Float32x4.mul(Ae,Le),Ce=SIMD.Float32x4.swizzle(Ce,1,0,3,2),we=SIMD.Float32x4.add(SIMD.Float32x4.mul(Re,Ce),we),De=SIMD.Float32x4.mul(Me,Ce),Ce=SIMD.Float32x4.swizzle(Ce,2,3,0,1),we=SIMD.Float32x4.sub(we,SIMD.Float32x4.mul(Re,Ce)),De=SIMD.Float32x4.sub(SIMD.Float32x4.mul(Me,Ce),De),De=SIMD.Float32x4.swizzle(De,2,3,0,1),Ce=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(Ae,2,3,0,1),Re),Ce=SIMD.Float32x4.swizzle(Ce,1,0,3,2),Le=SIMD.Float32x4.swizzle(Le,2,3,0,1),we=SIMD.Float32x4.add(SIMD.Float32x4.mul(Le,Ce),we),Fe=SIMD.Float32x4.mul(Me,Ce),Ce=SIMD.Float32x4.swizzle(Ce,2,3,0,1),we=SIMD.Float32x4.sub(we,SIMD.Float32x4.mul(Le,Ce)),Fe=SIMD.Float32x4.sub(SIMD.Float32x4.mul(Me,Ce),Fe),Fe=SIMD.Float32x4.swizzle(Fe,2,3,0,1),Ce=SIMD.Float32x4.mul(Me,Ae),Ce=SIMD.Float32x4.swizzle(Ce,1,0,3,2),Fe=SIMD.Float32x4.add(SIMD.Float32x4.mul(Re,Ce),Fe),De=SIMD.Float32x4.sub(SIMD.Float32x4.mul(Le,Ce),De),Ce=SIMD.Float32x4.swizzle(Ce,2,3,0,1),Fe=SIMD.Float32x4.sub(SIMD.Float32x4.mul(Re,Ce),Fe),De=SIMD.Float32x4.sub(De,SIMD.Float32x4.mul(Le,Ce)),Ce=SIMD.Float32x4.mul(Me,Re),Ce=SIMD.Float32x4.swizzle(Ce,1,0,3,2),Pe=SIMD.Float32x4.sub(Pe,SIMD.Float32x4.mul(Le,Ce)),Fe=SIMD.Float32x4.add(SIMD.Float32x4.mul(Ae,Ce),Fe),Ce=SIMD.Float32x4.swizzle(Ce,2,3,0,1),Pe=SIMD.Float32x4.add(SIMD.Float32x4.mul(Le,Ce),Pe),Fe=SIMD.Float32x4.sub(Fe,SIMD.Float32x4.mul(Ae,Ce)),Ce=SIMD.Float32x4.mul(Me,Le),Ce=SIMD.Float32x4.swizzle(Ce,1,0,3,2),Pe=SIMD.Float32x4.add(SIMD.Float32x4.mul(Re,Ce),Pe),De=SIMD.Float32x4.sub(De,SIMD.Float32x4.mul(Ae,Ce)),Ce=SIMD.Float32x4.swizzle(Ce,2,3,0,1),Pe=SIMD.Float32x4.sub(Pe,SIMD.Float32x4.mul(Re,Ce)),De=SIMD.Float32x4.add(SIMD.Float32x4.mul(Ae,Ce),De),SIMD.Float32x4.store(xe,0,we),SIMD.Float32x4.store(xe,4,Pe),SIMD.Float32x4.store(xe,8,Fe),SIMD.Float32x4.store(xe,12,De),xe},ye.adjoint=he.USE_SIMD?ye.SIMD.adjoint:ye.scalar.adjoint,ye.determinant=function(xe){var _e=xe[0],ve=xe[1],Ee=xe[2],Te=xe[3],Se=xe[4],Me=xe[5],Ae=xe[6],Le=xe[7],Re=xe[8],Ce=xe[9],we=xe[10],Pe=xe[11],Fe=xe[12],De=xe[13],Ie=xe[14],Be=xe[15];return(_e*Me-ve*Se)*(we*Be-Pe*Ie)-(_e*Ae-Ee*Se)*(Ce*Be-Pe*De)+(_e*Le-Te*Se)*(Ce*Ie-we*De)+(ve*Ae-Ee*Me)*(Re*Be-Pe*Fe)-(ve*Le-Te*Me)*(Re*Ie-we*Fe)+(Ee*Le-Te*Ae)*(Re*De-Ce*Fe)},ye.SIMD.multiply=function(xe,_e,ve){var Ee=SIMD.Float32x4.load(_e,0),Te=SIMD.Float32x4.load(_e,4),Se=SIMD.Float32x4.load(_e,8),Me=SIMD.Float32x4.load(_e,12),Ae=SIMD.Float32x4.load(ve,0),Le=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(Ae,0,0,0,0),Ee),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(Ae,1,1,1,1),Te),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(Ae,2,2,2,2),Se),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(Ae,3,3,3,3),Me))));SIMD.Float32x4.store(xe,0,Le);var Re=SIMD.Float32x4.load(ve,4),Ce=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(Re,0,0,0,0),Ee),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(Re,1,1,1,1),Te),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(Re,2,2,2,2),Se),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(Re,3,3,3,3),Me))));SIMD.Float32x4.store(xe,4,Ce);var we=SIMD.Float32x4.load(ve,8),Pe=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(we,0,0,0,0),Ee),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(we,1,1,1,1),Te),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(we,2,2,2,2),Se),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(we,3,3,3,3),Me))));SIMD.Float32x4.store(xe,8,Pe);var Fe=SIMD.Float32x4.load(ve,12),De=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(Fe,0,0,0,0),Ee),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(Fe,1,1,1,1),Te),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(Fe,2,2,2,2),Se),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(Fe,3,3,3,3),Me))));return SIMD.Float32x4.store(xe,12,De),xe},ye.scalar.multiply=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=_e[3],Ae=_e[4],Le=_e[5],Re=_e[6],Ce=_e[7],we=_e[8],Pe=_e[9],Fe=_e[10],De=_e[11],Ie=_e[12],Be=_e[13],Ue=_e[14],Ne=_e[15],Ge=ve[0],Ve=ve[1],ze=ve[2],Oe=ve[3];return xe[0]=Ge*Ee+Ve*Ae+ze*we+Oe*Ie,xe[1]=Ge*Te+Ve*Le+ze*Pe+Oe*Be,xe[2]=Ge*Se+Ve*Re+ze*Fe+Oe*Ue,xe[3]=Ge*Me+Ve*Ce+ze*De+Oe*Ne,Ge=ve[4],Ve=ve[5],ze=ve[6],Oe=ve[7],xe[4]=Ge*Ee+Ve*Ae+ze*we+Oe*Ie,xe[5]=Ge*Te+Ve*Le+ze*Pe+Oe*Be,xe[6]=Ge*Se+Ve*Re+ze*Fe+Oe*Ue,xe[7]=Ge*Me+Ve*Ce+ze*De+Oe*Ne,Ge=ve[8],Ve=ve[9],ze=ve[10],Oe=ve[11],xe[8]=Ge*Ee+Ve*Ae+ze*we+Oe*Ie,xe[9]=Ge*Te+Ve*Le+ze*Pe+Oe*Be,xe[10]=Ge*Se+Ve*Re+ze*Fe+Oe*Ue,xe[11]=Ge*Me+Ve*Ce+ze*De+Oe*Ne,Ge=ve[12],Ve=ve[13],ze=ve[14],Oe=ve[15],xe[12]=Ge*Ee+Ve*Ae+ze*we+Oe*Ie,xe[13]=Ge*Te+Ve*Le+ze*Pe+Oe*Be,xe[14]=Ge*Se+Ve*Re+ze*Fe+Oe*Ue,xe[15]=Ge*Me+Ve*Ce+ze*De+Oe*Ne,xe},ye.multiply=he.USE_SIMD?ye.SIMD.multiply:ye.scalar.multiply,ye.mul=ye.multiply,ye.scalar.translate=function(xe,_e,ve){var Ee=ve[0],Te=ve[1],Se=ve[2],Me,Ae,Le,Re,Ce,we,Pe,Fe,De,Ie,Be,Ue;return _e===xe?(xe[12]=_e[0]*Ee+_e[4]*Te+_e[8]*Se+_e[12],xe[13]=_e[1]*Ee+_e[5]*Te+_e[9]*Se+_e[13],xe[14]=_e[2]*Ee+_e[6]*Te+_e[10]*Se+_e[14],xe[15]=_e[3]*Ee+_e[7]*Te+_e[11]*Se+_e[15]):(Me=_e[0],Ae=_e[1],Le=_e[2],Re=_e[3],Ce=_e[4],we=_e[5],Pe=_e[6],Fe=_e[7],De=_e[8],Ie=_e[9],Be=_e[10],Ue=_e[11],xe[0]=Me,xe[1]=Ae,xe[2]=Le,xe[3]=Re,xe[4]=Ce,xe[5]=we,xe[6]=Pe,xe[7]=Fe,xe[8]=De,xe[9]=Ie,xe[10]=Be,xe[11]=Ue,xe[12]=Me*Ee+Ce*Te+De*Se+_e[12],xe[13]=Ae*Ee+we*Te+Ie*Se+_e[13],xe[14]=Le*Ee+Pe*Te+Be*Se+_e[14],xe[15]=Re*Ee+Fe*Te+Ue*Se+_e[15]),xe},ye.SIMD.translate=function(xe,_e,ve){var Ee=SIMD.Float32x4.load(_e,0),Te=SIMD.Float32x4.load(_e,4),Se=SIMD.Float32x4.load(_e,8),Me=SIMD.Float32x4.load(_e,12),Ae=SIMD.Float32x4(ve[0],ve[1],ve[2],0);_e!==xe&&(xe[0]=_e[0],xe[1]=_e[1],xe[2]=_e[2],xe[3]=_e[3],xe[4]=_e[4],xe[5]=_e[5],xe[6]=_e[6],xe[7]=_e[7],xe[8]=_e[8],xe[9]=_e[9],xe[10]=_e[10],xe[11]=_e[11]),Ee=SIMD.Float32x4.mul(Ee,SIMD.Float32x4.swizzle(Ae,0,0,0,0)),Te=SIMD.Float32x4.mul(Te,SIMD.Float32x4.swizzle(Ae,1,1,1,1)),Se=SIMD.Float32x4.mul(Se,SIMD.Float32x4.swizzle(Ae,2,2,2,2));var Le=SIMD.Float32x4.add(Ee,SIMD.Float32x4.add(Te,SIMD.Float32x4.add(Se,Me)));return SIMD.Float32x4.store(xe,12,Le),xe},ye.translate=he.USE_SIMD?ye.SIMD.translate:ye.scalar.translate,ye.scalar.scale=function(xe,_e,ve){var Ee=ve[0],Te=ve[1],Se=ve[2];return xe[0]=_e[0]*Ee,xe[1]=_e[1]*Ee,xe[2]=_e[2]*Ee,xe[3]=_e[3]*Ee,xe[4]=_e[4]*Te,xe[5]=_e[5]*Te,xe[6]=_e[6]*Te,xe[7]=_e[7]*Te,xe[8]=_e[8]*Se,xe[9]=_e[9]*Se,xe[10]=_e[10]*Se,xe[11]=_e[11]*Se,xe[12]=_e[12],xe[13]=_e[13],xe[14]=_e[14],xe[15]=_e[15],xe},ye.SIMD.scale=function(xe,_e,ve){var Me=SIMD.Float32x4(ve[0],ve[1],ve[2],0),Ee,Te,Se;return Ee=SIMD.Float32x4.load(_e,0),SIMD.Float32x4.store(xe,0,SIMD.Float32x4.mul(Ee,SIMD.Float32x4.swizzle(Me,0,0,0,0))),Te=SIMD.Float32x4.load(_e,4),SIMD.Float32x4.store(xe,4,SIMD.Float32x4.mul(Te,SIMD.Float32x4.swizzle(Me,1,1,1,1))),Se=SIMD.Float32x4.load(_e,8),SIMD.Float32x4.store(xe,8,SIMD.Float32x4.mul(Se,SIMD.Float32x4.swizzle(Me,2,2,2,2))),xe[12]=_e[12],xe[13]=_e[13],xe[14]=_e[14],xe[15]=_e[15],xe},ye.scale=he.USE_SIMD?ye.SIMD.scale:ye.scalar.scale,ye.rotate=function(xe,_e,ve,Ee){var Te=Ee[0],Se=Ee[1],Me=Ee[2],Ae=Math.sqrt(Te*Te+Se*Se+Me*Me),Le,Re,Ce,we,Pe,Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe,ke,He,We,je,Xe,qe,Ye,Ze,Ke;return Math.abs(Ae)<he.EPSILON?null:(Ae=1/Ae,Te*=Ae,Se*=Ae,Me*=Ae,Le=Math.sin(ve),Re=Math.cos(ve),Ce=1-Re,we=_e[0],Pe=_e[1],Fe=_e[2],De=_e[3],Ie=_e[4],Be=_e[5],Ue=_e[6],Ne=_e[7],Ge=_e[8],Ve=_e[9],ze=_e[10],Oe=_e[11],ke=Te*Te*Ce+Re,He=Se*Te*Ce+Me*Le,We=Me*Te*Ce-Se*Le,je=Te*Se*Ce-Me*Le,Xe=Se*Se*Ce+Re,qe=Me*Se*Ce+Te*Le,Ye=Te*Me*Ce+Se*Le,Ze=Se*Me*Ce-Te*Le,Ke=Me*Me*Ce+Re,xe[0]=we*ke+Ie*He+Ge*We,xe[1]=Pe*ke+Be*He+Ve*We,xe[2]=Fe*ke+Ue*He+ze*We,xe[3]=De*ke+Ne*He+Oe*We,xe[4]=we*je+Ie*Xe+Ge*qe,xe[5]=Pe*je+Be*Xe+Ve*qe,xe[6]=Fe*je+Ue*Xe+ze*qe,xe[7]=De*je+Ne*Xe+Oe*qe,xe[8]=we*Ye+Ie*Ze+Ge*Ke,xe[9]=Pe*Ye+Be*Ze+Ve*Ke,xe[10]=Fe*Ye+Ue*Ze+ze*Ke,xe[11]=De*Ye+Ne*Ze+Oe*Ke,_e!==xe&&(xe[12]=_e[12],xe[13]=_e[13],xe[14]=_e[14],xe[15]=_e[15]),xe)},ye.scalar.rotateX=function(xe,_e,ve){var Ee=Math.sin(ve),Te=Math.cos(ve),Se=_e[4],Me=_e[5],Ae=_e[6],Le=_e[7],Re=_e[8],Ce=_e[9],we=_e[10],Pe=_e[11];return _e!==xe&&(xe[0]=_e[0],xe[1]=_e[1],xe[2]=_e[2],xe[3]=_e[3],xe[12]=_e[12],xe[13]=_e[13],xe[14]=_e[14],xe[15]=_e[15]),xe[4]=Se*Te+Re*Ee,xe[5]=Me*Te+Ce*Ee,xe[6]=Ae*Te+we*Ee,xe[7]=Le*Te+Pe*Ee,xe[8]=Re*Te-Se*Ee,xe[9]=Ce*Te-Me*Ee,xe[10]=we*Te-Ae*Ee,xe[11]=Pe*Te-Le*Ee,xe},ye.SIMD.rotateX=function(xe,_e,ve){var Ee=SIMD.Float32x4.splat(Math.sin(ve)),Te=SIMD.Float32x4.splat(Math.cos(ve));_e!==xe&&(xe[0]=_e[0],xe[1]=_e[1],xe[2]=_e[2],xe[3]=_e[3],xe[12]=_e[12],xe[13]=_e[13],xe[14]=_e[14],xe[15]=_e[15]);var Se=SIMD.Float32x4.load(_e,4),Me=SIMD.Float32x4.load(_e,8);return SIMD.Float32x4.store(xe,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(Se,Te),SIMD.Float32x4.mul(Me,Ee))),SIMD.Float32x4.store(xe,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(Me,Te),SIMD.Float32x4.mul(Se,Ee))),xe},ye.rotateX=he.USE_SIMD?ye.SIMD.rotateX:ye.scalar.rotateX,ye.scalar.rotateY=function(xe,_e,ve){var Ee=Math.sin(ve),Te=Math.cos(ve),Se=_e[0],Me=_e[1],Ae=_e[2],Le=_e[3],Re=_e[8],Ce=_e[9],we=_e[10],Pe=_e[11];return _e!==xe&&(xe[4]=_e[4],xe[5]=_e[5],xe[6]=_e[6],xe[7]=_e[7],xe[12]=_e[12],xe[13]=_e[13],xe[14]=_e[14],xe[15]=_e[15]),xe[0]=Se*Te-Re*Ee,xe[1]=Me*Te-Ce*Ee,xe[2]=Ae*Te-we*Ee,xe[3]=Le*Te-Pe*Ee,xe[8]=Se*Ee+Re*Te,xe[9]=Me*Ee+Ce*Te,xe[10]=Ae*Ee+we*Te,xe[11]=Le*Ee+Pe*Te,xe},ye.SIMD.rotateY=function(xe,_e,ve){var Ee=SIMD.Float32x4.splat(Math.sin(ve)),Te=SIMD.Float32x4.splat(Math.cos(ve));_e!==xe&&(xe[4]=_e[4],xe[5]=_e[5],xe[6]=_e[6],xe[7]=_e[7],xe[12]=_e[12],xe[13]=_e[13],xe[14]=_e[14],xe[15]=_e[15]);var Se=SIMD.Float32x4.load(_e,0),Me=SIMD.Float32x4.load(_e,8);return SIMD.Float32x4.store(xe,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(Se,Te),SIMD.Float32x4.mul(Me,Ee))),SIMD.Float32x4.store(xe,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(Se,Ee),SIMD.Float32x4.mul(Me,Te))),xe},ye.rotateY=he.USE_SIMD?ye.SIMD.rotateY:ye.scalar.rotateY,ye.scalar.rotateZ=function(xe,_e,ve){var Ee=Math.sin(ve),Te=Math.cos(ve),Se=_e[0],Me=_e[1],Ae=_e[2],Le=_e[3],Re=_e[4],Ce=_e[5],we=_e[6],Pe=_e[7];return _e!==xe&&(xe[8]=_e[8],xe[9]=_e[9],xe[10]=_e[10],xe[11]=_e[11],xe[12]=_e[12],xe[13]=_e[13],xe[14]=_e[14],xe[15]=_e[15]),xe[0]=Se*Te+Re*Ee,xe[1]=Me*Te+Ce*Ee,xe[2]=Ae*Te+we*Ee,xe[3]=Le*Te+Pe*Ee,xe[4]=Re*Te-Se*Ee,xe[5]=Ce*Te-Me*Ee,xe[6]=we*Te-Ae*Ee,xe[7]=Pe*Te-Le*Ee,xe},ye.SIMD.rotateZ=function(xe,_e,ve){var Ee=SIMD.Float32x4.splat(Math.sin(ve)),Te=SIMD.Float32x4.splat(Math.cos(ve));_e!==xe&&(xe[8]=_e[8],xe[9]=_e[9],xe[10]=_e[10],xe[11]=_e[11],xe[12]=_e[12],xe[13]=_e[13],xe[14]=_e[14],xe[15]=_e[15]);var Se=SIMD.Float32x4.load(_e,0),Me=SIMD.Float32x4.load(_e,4);return SIMD.Float32x4.store(xe,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(Se,Te),SIMD.Float32x4.mul(Me,Ee))),SIMD.Float32x4.store(xe,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(Me,Te),SIMD.Float32x4.mul(Se,Ee))),xe},ye.rotateZ=he.USE_SIMD?ye.SIMD.rotateZ:ye.scalar.rotateZ,ye.fromTranslation=function(xe,_e){return xe[0]=1,xe[1]=0,xe[2]=0,xe[3]=0,xe[4]=0,xe[5]=1,xe[6]=0,xe[7]=0,xe[8]=0,xe[9]=0,xe[10]=1,xe[11]=0,xe[12]=_e[0],xe[13]=_e[1],xe[14]=_e[2],xe[15]=1,xe},ye.fromScaling=function(xe,_e){return xe[0]=_e[0],xe[1]=0,xe[2]=0,xe[3]=0,xe[4]=0,xe[5]=_e[1],xe[6]=0,xe[7]=0,xe[8]=0,xe[9]=0,xe[10]=_e[2],xe[11]=0,xe[12]=0,xe[13]=0,xe[14]=0,xe[15]=1,xe},ye.fromRotation=function(xe,_e,ve){var Ee=ve[0],Te=ve[1],Se=ve[2],Me=Math.sqrt(Ee*Ee+Te*Te+Se*Se),Ae,Le,Re;return Math.abs(Me)<he.EPSILON?null:(Me=1/Me,Ee*=Me,Te*=Me,Se*=Me,Ae=Math.sin(_e),Le=Math.cos(_e),Re=1-Le,xe[0]=Ee*Ee*Re+Le,xe[1]=Te*Ee*Re+Se*Ae,xe[2]=Se*Ee*Re-Te*Ae,xe[3]=0,xe[4]=Ee*Te*Re-Se*Ae,xe[5]=Te*Te*Re+Le,xe[6]=Se*Te*Re+Ee*Ae,xe[7]=0,xe[8]=Ee*Se*Re+Te*Ae,xe[9]=Te*Se*Re-Ee*Ae,xe[10]=Se*Se*Re+Le,xe[11]=0,xe[12]=0,xe[13]=0,xe[14]=0,xe[15]=1,xe)},ye.fromXRotation=function(xe,_e){var ve=Math.sin(_e),Ee=Math.cos(_e);return xe[0]=1,xe[1]=0,xe[2]=0,xe[3]=0,xe[4]=0,xe[5]=Ee,xe[6]=ve,xe[7]=0,xe[8]=0,xe[9]=-ve,xe[10]=Ee,xe[11]=0,xe[12]=0,xe[13]=0,xe[14]=0,xe[15]=1,xe},ye.fromYRotation=function(xe,_e){var ve=Math.sin(_e),Ee=Math.cos(_e);return xe[0]=Ee,xe[1]=0,xe[2]=-ve,xe[3]=0,xe[4]=0,xe[5]=1,xe[6]=0,xe[7]=0,xe[8]=ve,xe[9]=0,xe[10]=Ee,xe[11]=0,xe[12]=0,xe[13]=0,xe[14]=0,xe[15]=1,xe},ye.fromZRotation=function(xe,_e){var ve=Math.sin(_e),Ee=Math.cos(_e);return xe[0]=Ee,xe[1]=ve,xe[2]=0,xe[3]=0,xe[4]=-ve,xe[5]=Ee,xe[6]=0,xe[7]=0,xe[8]=0,xe[9]=0,xe[10]=1,xe[11]=0,xe[12]=0,xe[13]=0,xe[14]=0,xe[15]=1,xe},ye.fromRotationTranslation=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=_e[3],Ae=Ee+Ee,Le=Te+Te,Re=Se+Se,Ce=Ee*Ae,we=Ee*Le,Pe=Ee*Re,Fe=Te*Le,De=Te*Re,Ie=Se*Re,Be=Me*Ae,Ue=Me*Le,Ne=Me*Re;return xe[0]=1-(Fe+Ie),xe[1]=we+Ne,xe[2]=Pe-Ue,xe[3]=0,xe[4]=we-Ne,xe[5]=1-(Ce+Ie),xe[6]=De+Be,xe[7]=0,xe[8]=Pe+Ue,xe[9]=De-Be,xe[10]=1-(Ce+Fe),xe[11]=0,xe[12]=ve[0],xe[13]=ve[1],xe[14]=ve[2],xe[15]=1,xe},ye.fromRotationTranslationScale=function(xe,_e,ve,Ee){var Te=_e[0],Se=_e[1],Me=_e[2],Ae=_e[3],Le=Te+Te,Re=Se+Se,Ce=Me+Me,we=Te*Le,Pe=Te*Re,Fe=Te*Ce,De=Se*Re,Ie=Se*Ce,Be=Me*Ce,Ue=Ae*Le,Ne=Ae*Re,Ge=Ae*Ce,Ve=Ee[0],ze=Ee[1],Oe=Ee[2];return xe[0]=(1-(De+Be))*Ve,xe[1]=(Pe+Ge)*Ve,xe[2]=(Fe-Ne)*Ve,xe[3]=0,xe[4]=(Pe-Ge)*ze,xe[5]=(1-(we+Be))*ze,xe[6]=(Ie+Ue)*ze,xe[7]=0,xe[8]=(Fe+Ne)*Oe,xe[9]=(Ie-Ue)*Oe,xe[10]=(1-(we+De))*Oe,xe[11]=0,xe[12]=ve[0],xe[13]=ve[1],xe[14]=ve[2],xe[15]=1,xe},ye.fromRotationTranslationScaleOrigin=function(xe,_e,ve,Ee,Te){var Se=_e[0],Me=_e[1],Ae=_e[2],Le=_e[3],Re=Se+Se,Ce=Me+Me,we=Ae+Ae,Pe=Se*Re,Fe=Se*Ce,De=Se*we,Ie=Me*Ce,Be=Me*we,Ue=Ae*we,Ne=Le*Re,Ge=Le*Ce,Ve=Le*we,ze=Ee[0],Oe=Ee[1],ke=Ee[2],He=Te[0],We=Te[1],je=Te[2];return xe[0]=(1-(Ie+Ue))*ze,xe[1]=(Fe+Ve)*ze,xe[2]=(De-Ge)*ze,xe[3]=0,xe[4]=(Fe-Ve)*Oe,xe[5]=(1-(Pe+Ue))*Oe,xe[6]=(Be+Ne)*Oe,xe[7]=0,xe[8]=(De+Ge)*ke,xe[9]=(Be-Ne)*ke,xe[10]=(1-(Pe+Ie))*ke,xe[11]=0,xe[12]=ve[0]+He-(xe[0]*He+xe[4]*We+xe[8]*je),xe[13]=ve[1]+We-(xe[1]*He+xe[5]*We+xe[9]*je),xe[14]=ve[2]+je-(xe[2]*He+xe[6]*We+xe[10]*je),xe[15]=1,xe},ye.fromQuat=function(xe,_e){var ve=_e[0],Ee=_e[1],Te=_e[2],Se=_e[3],Me=ve+ve,Ae=Ee+Ee,Le=Te+Te,Re=ve*Me,Ce=Ee*Me,we=Ee*Ae,Pe=Te*Me,Fe=Te*Ae,De=Te*Le,Ie=Se*Me,Be=Se*Ae,Ue=Se*Le;return xe[0]=1-we-De,xe[1]=Ce+Ue,xe[2]=Pe-Be,xe[3]=0,xe[4]=Ce-Ue,xe[5]=1-Re-De,xe[6]=Fe+Ie,xe[7]=0,xe[8]=Pe+Be,xe[9]=Fe-Ie,xe[10]=1-Re-we,xe[11]=0,xe[12]=0,xe[13]=0,xe[14]=0,xe[15]=1,xe},ye.frustum=function(xe,_e,ve,Ee,Te,Se,Me){var Ae=1/(ve-_e),Le=1/(Te-Ee),Re=1/(Se-Me);return xe[0]=2*Se*Ae,xe[1]=0,xe[2]=0,xe[3]=0,xe[4]=0,xe[5]=2*Se*Le,xe[6]=0,xe[7]=0,xe[8]=(ve+_e)*Ae,xe[9]=(Te+Ee)*Le,xe[10]=(Me+Se)*Re,xe[11]=-1,xe[12]=0,xe[13]=0,xe[14]=2*(Me*Se)*Re,xe[15]=0,xe},ye.perspective=function(xe,_e,ve,Ee,Te){var Se=1/Math.tan(_e/2),Me=1/(Ee-Te);return xe[0]=Se/ve,xe[1]=0,xe[2]=0,xe[3]=0,xe[4]=0,xe[5]=Se,xe[6]=0,xe[7]=0,xe[8]=0,xe[9]=0,xe[10]=(Te+Ee)*Me,xe[11]=-1,xe[12]=0,xe[13]=0,xe[14]=2*Te*Ee*Me,xe[15]=0,xe},ye.perspectiveFromFieldOfView=function(xe,_e,ve,Ee){var Te=Math.tan(_e.upDegrees*Math.PI/180),Se=Math.tan(_e.downDegrees*Math.PI/180),Me=Math.tan(_e.leftDegrees*Math.PI/180),Ae=Math.tan(_e.rightDegrees*Math.PI/180),Le=2/(Me+Ae),Re=2/(Te+Se);return xe[0]=Le,xe[1]=0,xe[2]=0,xe[3]=0,xe[4]=0,xe[5]=Re,xe[6]=0,xe[7]=0,xe[8]=-(0.5*((Me-Ae)*Le)),xe[9]=0.5*((Te-Se)*Re),xe[10]=Ee/(ve-Ee),xe[11]=-1,xe[12]=0,xe[13]=0,xe[14]=Ee*ve/(ve-Ee),xe[15]=0,xe},ye.ortho=function(xe,_e,ve,Ee,Te,Se,Me){var Ae=1/(_e-ve),Le=1/(Ee-Te),Re=1/(Se-Me);return xe[0]=-2*Ae,xe[1]=0,xe[2]=0,xe[3]=0,xe[4]=0,xe[5]=-2*Le,xe[6]=0,xe[7]=0,xe[8]=0,xe[9]=0,xe[10]=2*Re,xe[11]=0,xe[12]=(_e+ve)*Ae,xe[13]=(Te+Ee)*Le,xe[14]=(Me+Se)*Re,xe[15]=1,xe},ye.lookAt=function(xe,_e,ve,Ee){var De=_e[0],Ie=_e[1],Be=_e[2],Ue=Ee[0],Ne=Ee[1],Ge=Ee[2],Ve=ve[0],ze=ve[1],Oe=ve[2],Te,Se,Me,Ae,Le,Re,Ce,we,Pe,Fe;return Math.abs(De-Ve)<he.EPSILON&&Math.abs(Ie-ze)<he.EPSILON&&Math.abs(Be-Oe)<he.EPSILON?ye.identity(xe):(Ce=De-Ve,we=Ie-ze,Pe=Be-Oe,Fe=1/Math.sqrt(Ce*Ce+we*we+Pe*Pe),Ce*=Fe,we*=Fe,Pe*=Fe,Te=Ne*Pe-Ge*we,Se=Ge*Ce-Ue*Pe,Me=Ue*we-Ne*Ce,Fe=Math.sqrt(Te*Te+Se*Se+Me*Me),Fe?(Fe=1/Fe,Te*=Fe,Se*=Fe,Me*=Fe):(Te=0,Se=0,Me=0),Ae=we*Me-Pe*Se,Le=Pe*Te-Ce*Me,Re=Ce*Se-we*Te,Fe=Math.sqrt(Ae*Ae+Le*Le+Re*Re),Fe?(Fe=1/Fe,Ae*=Fe,Le*=Fe,Re*=Fe):(Ae=0,Le=0,Re=0),xe[0]=Te,xe[1]=Ae,xe[2]=Ce,xe[3]=0,xe[4]=Se,xe[5]=Le,xe[6]=we,xe[7]=0,xe[8]=Me,xe[9]=Re,xe[10]=Pe,xe[11]=0,xe[12]=-(Te*De+Se*Ie+Me*Be),xe[13]=-(Ae*De+Le*Ie+Re*Be),xe[14]=-(Ce*De+we*Ie+Pe*Be),xe[15]=1,xe)},ye.str=function(xe){return'mat4('+xe[0]+', '+xe[1]+', '+xe[2]+', '+xe[3]+', '+xe[4]+', '+xe[5]+', '+xe[6]+', '+xe[7]+', '+xe[8]+', '+xe[9]+', '+xe[10]+', '+xe[11]+', '+xe[12]+', '+xe[13]+', '+xe[14]+', '+xe[15]+')'},ye.frob=function(xe){return Math.sqrt(Math.pow(xe[0],2)+Math.pow(xe[1],2)+Math.pow(xe[2],2)+Math.pow(xe[3],2)+Math.pow(xe[4],2)+Math.pow(xe[5],2)+Math.pow(xe[6],2)+Math.pow(xe[7],2)+Math.pow(xe[8],2)+Math.pow(xe[9],2)+Math.pow(xe[10],2)+Math.pow(xe[11],2)+Math.pow(xe[12],2)+Math.pow(xe[13],2)+Math.pow(xe[14],2)+Math.pow(xe[15],2))},ue.exports=ye},function(ue,fe,ge){var he=ge(1),ye=ge(4),xe=ge(7),_e=ge(8),ve={};ve.create=function(){var Ee=new he.ARRAY_TYPE(4);return Ee[0]=0,Ee[1]=0,Ee[2]=0,Ee[3]=1,Ee},ve.rotationTo=function(){var Ee=xe.create(),Te=xe.fromValues(1,0,0),Se=xe.fromValues(0,1,0);return function(Me,Ae,Le){var Re=xe.dot(Ae,Le);return-0.999999>Re?(xe.cross(Ee,Te,Ae),1e-6>xe.length(Ee)&&xe.cross(Ee,Se,Ae),xe.normalize(Ee,Ee),ve.setAxisAngle(Me,Ee,Math.PI),Me):0.999999<Re?(Me[0]=0,Me[1]=0,Me[2]=0,Me[3]=1,Me):(xe.cross(Ee,Ae,Le),Me[0]=Ee[0],Me[1]=Ee[1],Me[2]=Ee[2],Me[3]=1+Re,ve.normalize(Me,Me))}}(),ve.setAxes=function(){var Ee=ye.create();return function(Te,Se,Me,Ae){return Ee[0]=Me[0],Ee[3]=Me[1],Ee[6]=Me[2],Ee[1]=Ae[0],Ee[4]=Ae[1],Ee[7]=Ae[2],Ee[2]=-Se[0],Ee[5]=-Se[1],Ee[8]=-Se[2],ve.normalize(Te,ve.fromMat3(Te,Ee))}}(),ve.clone=_e.clone,ve.fromValues=_e.fromValues,ve.copy=_e.copy,ve.set=_e.set,ve.identity=function(Ee){return Ee[0]=0,Ee[1]=0,Ee[2]=0,Ee[3]=1,Ee},ve.setAxisAngle=function(Ee,Te,Se){Se*=0.5;var Me=Math.sin(Se);return Ee[0]=Me*Te[0],Ee[1]=Me*Te[1],Ee[2]=Me*Te[2],Ee[3]=Math.cos(Se),Ee},ve.add=_e.add,ve.multiply=function(Ee,Te,Se){var Me=Te[0],Ae=Te[1],Le=Te[2],Re=Te[3],Ce=Se[0],we=Se[1],Pe=Se[2],Fe=Se[3];return Ee[0]=Me*Fe+Re*Ce+Ae*Pe-Le*we,Ee[1]=Ae*Fe+Re*we+Le*Ce-Me*Pe,Ee[2]=Le*Fe+Re*Pe+Me*we-Ae*Ce,Ee[3]=Re*Fe-Me*Ce-Ae*we-Le*Pe,Ee},ve.mul=ve.multiply,ve.scale=_e.scale,ve.rotateX=function(Ee,Te,Se){Se*=0.5;var Me=Te[0],Ae=Te[1],Le=Te[2],Re=Te[3],Ce=Math.sin(Se),we=Math.cos(Se);return Ee[0]=Me*we+Re*Ce,Ee[1]=Ae*we+Le*Ce,Ee[2]=Le*we-Ae*Ce,Ee[3]=Re*we-Me*Ce,Ee},ve.rotateY=function(Ee,Te,Se){Se*=0.5;var Me=Te[0],Ae=Te[1],Le=Te[2],Re=Te[3],Ce=Math.sin(Se),we=Math.cos(Se);return Ee[0]=Me*we-Le*Ce,Ee[1]=Ae*we+Re*Ce,Ee[2]=Le*we+Me*Ce,Ee[3]=Re*we-Ae*Ce,Ee},ve.rotateZ=function(Ee,Te,Se){Se*=0.5;var Me=Te[0],Ae=Te[1],Le=Te[2],Re=Te[3],Ce=Math.sin(Se),we=Math.cos(Se);return Ee[0]=Me*we+Ae*Ce,Ee[1]=Ae*we-Me*Ce,Ee[2]=Le*we+Re*Ce,Ee[3]=Re*we-Le*Ce,Ee},ve.calculateW=function(Ee,Te){var Se=Te[0],Me=Te[1],Ae=Te[2];return Ee[0]=Se,Ee[1]=Me,Ee[2]=Ae,Ee[3]=Math.sqrt(Math.abs(1-Se*Se-Me*Me-Ae*Ae)),Ee},ve.dot=_e.dot,ve.lerp=_e.lerp,ve.slerp=function(Ee,Te,Se,Me){var Ae=Te[0],Le=Te[1],Re=Te[2],Ce=Te[3],we=Se[0],Pe=Se[1],Fe=Se[2],De=Se[3],Ie,Be,Ue,Ne,Ge;return Be=Ae*we+Le*Pe+Re*Fe+Ce*De,0>Be&&(Be=-Be,we=-we,Pe=-Pe,Fe=-Fe,De=-De),1e-6<1-Be?(Ie=Math.acos(Be),Ue=Math.sin(Ie),Ne=Math.sin((1-Me)*Ie)/Ue,Ge=Math.sin(Me*Ie)/Ue):(Ne=1-Me,Ge=Me),Ee[0]=Ne*Ae+Ge*we,Ee[1]=Ne*Le+Ge*Pe,Ee[2]=Ne*Re+Ge*Fe,Ee[3]=Ne*Ce+Ge*De,Ee},ve.sqlerp=function(){var Ee=ve.create(),Te=ve.create();return function(Se,Me,Ae,Le,Re,Ce){return ve.slerp(Ee,Me,Re,Ce),ve.slerp(Te,Ae,Le,Ce),ve.slerp(Se,Ee,Te,2*Ce*(1-Ce)),Se}}(),ve.invert=function(Ee,Te){var Se=Te[0],Me=Te[1],Ae=Te[2],Le=Te[3],Re=Se*Se+Me*Me+Ae*Ae+Le*Le,Ce=Re?1/Re:0;return Ee[0]=-Se*Ce,Ee[1]=-Me*Ce,Ee[2]=-Ae*Ce,Ee[3]=Le*Ce,Ee},ve.conjugate=function(Ee,Te){return Ee[0]=-Te[0],Ee[1]=-Te[1],Ee[2]=-Te[2],Ee[3]=Te[3],Ee},ve.length=_e.length,ve.len=ve.length,ve.squaredLength=_e.squaredLength,ve.sqrLen=ve.squaredLength,ve.normalize=_e.normalize,ve.fromMat3=function(Ee,Te){var Se=Te[0]+Te[4]+Te[8],Me;if(0<Se)Me=Math.sqrt(Se+1),Ee[3]=0.5*Me,Me=0.5/Me,Ee[0]=(Te[5]-Te[7])*Me,Ee[1]=(Te[6]-Te[2])*Me,Ee[2]=(Te[1]-Te[3])*Me;else{var Ae=0;Te[4]>Te[0]&&(Ae=1),Te[8]>Te[3*Ae+Ae]&&(Ae=2);var Le=(Ae+1)%3,Re=(Ae+2)%3;Me=Math.sqrt(Te[3*Ae+Ae]-Te[3*Le+Le]-Te[3*Re+Re]+1),Ee[Ae]=0.5*Me,Me=0.5/Me,Ee[3]=(Te[3*Le+Re]-Te[3*Re+Le])*Me,Ee[Le]=(Te[3*Le+Ae]+Te[3*Ae+Le])*Me,Ee[Re]=(Te[3*Re+Ae]+Te[3*Ae+Re])*Me}return Ee},ve.str=function(Ee){return'quat('+Ee[0]+', '+Ee[1]+', '+Ee[2]+', '+Ee[3]+')'},ue.exports=ve},function(ue,fe,ge){var he=ge(1),ye={};ye.create=function(){var xe=new he.ARRAY_TYPE(3);return xe[0]=0,xe[1]=0,xe[2]=0,xe},ye.clone=function(xe){var _e=new he.ARRAY_TYPE(3);return _e[0]=xe[0],_e[1]=xe[1],_e[2]=xe[2],_e},ye.fromValues=function(xe,_e,ve){var Ee=new he.ARRAY_TYPE(3);return Ee[0]=xe,Ee[1]=_e,Ee[2]=ve,Ee},ye.copy=function(xe,_e){return xe[0]=_e[0],xe[1]=_e[1],xe[2]=_e[2],xe},ye.set=function(xe,_e,ve,Ee){return xe[0]=_e,xe[1]=ve,xe[2]=Ee,xe},ye.add=function(xe,_e,ve){return xe[0]=_e[0]+ve[0],xe[1]=_e[1]+ve[1],xe[2]=_e[2]+ve[2],xe},ye.subtract=function(xe,_e,ve){return xe[0]=_e[0]-ve[0],xe[1]=_e[1]-ve[1],xe[2]=_e[2]-ve[2],xe},ye.sub=ye.subtract,ye.multiply=function(xe,_e,ve){return xe[0]=_e[0]*ve[0],xe[1]=_e[1]*ve[1],xe[2]=_e[2]*ve[2],xe},ye.mul=ye.multiply,ye.divide=function(xe,_e,ve){return xe[0]=_e[0]/ve[0],xe[1]=_e[1]/ve[1],xe[2]=_e[2]/ve[2],xe},ye.div=ye.divide,ye.min=function(xe,_e,ve){return xe[0]=Math.min(_e[0],ve[0]),xe[1]=Math.min(_e[1],ve[1]),xe[2]=Math.min(_e[2],ve[2]),xe},ye.max=function(xe,_e,ve){return xe[0]=Math.max(_e[0],ve[0]),xe[1]=Math.max(_e[1],ve[1]),xe[2]=Math.max(_e[2],ve[2]),xe},ye.scale=function(xe,_e,ve){return xe[0]=_e[0]*ve,xe[1]=_e[1]*ve,xe[2]=_e[2]*ve,xe},ye.scaleAndAdd=function(xe,_e,ve,Ee){return xe[0]=_e[0]+ve[0]*Ee,xe[1]=_e[1]+ve[1]*Ee,xe[2]=_e[2]+ve[2]*Ee,xe},ye.distance=function(xe,_e){var ve=_e[0]-xe[0],Ee=_e[1]-xe[1],Te=_e[2]-xe[2];return Math.sqrt(ve*ve+Ee*Ee+Te*Te)},ye.dist=ye.distance,ye.squaredDistance=function(xe,_e){var ve=_e[0]-xe[0],Ee=_e[1]-xe[1],Te=_e[2]-xe[2];return ve*ve+Ee*Ee+Te*Te},ye.sqrDist=ye.squaredDistance,ye.length=function(xe){var _e=xe[0],ve=xe[1],Ee=xe[2];return Math.sqrt(_e*_e+ve*ve+Ee*Ee)},ye.len=ye.length,ye.squaredLength=function(xe){var _e=xe[0],ve=xe[1],Ee=xe[2];return _e*_e+ve*ve+Ee*Ee},ye.sqrLen=ye.squaredLength,ye.negate=function(xe,_e){return xe[0]=-_e[0],xe[1]=-_e[1],xe[2]=-_e[2],xe},ye.inverse=function(xe,_e){return xe[0]=1/_e[0],xe[1]=1/_e[1],xe[2]=1/_e[2],xe},ye.normalize=function(xe,_e){var ve=_e[0],Ee=_e[1],Te=_e[2],Se=ve*ve+Ee*Ee+Te*Te;return 0<Se&&(Se=1/Math.sqrt(Se),xe[0]=_e[0]*Se,xe[1]=_e[1]*Se,xe[2]=_e[2]*Se),xe},ye.dot=function(xe,_e){return xe[0]*_e[0]+xe[1]*_e[1]+xe[2]*_e[2]},ye.cross=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=ve[0],Ae=ve[1],Le=ve[2];return xe[0]=Te*Le-Se*Ae,xe[1]=Se*Me-Ee*Le,xe[2]=Ee*Ae-Te*Me,xe},ye.lerp=function(xe,_e,ve,Ee){var Te=_e[0],Se=_e[1],Me=_e[2];return xe[0]=Te+Ee*(ve[0]-Te),xe[1]=Se+Ee*(ve[1]-Se),xe[2]=Me+Ee*(ve[2]-Me),xe},ye.hermite=function(xe,_e,ve,Ee,Te,Se){var Me=Se*Se,Ae=Me*(2*Se-3)+1,Le=Me*(Se-2)+Se,Re=Me*(Se-1),Ce=Me*(3-2*Se);return xe[0]=_e[0]*Ae+ve[0]*Le+Ee[0]*Re+Te[0]*Ce,xe[1]=_e[1]*Ae+ve[1]*Le+Ee[1]*Re+Te[1]*Ce,xe[2]=_e[2]*Ae+ve[2]*Le+Ee[2]*Re+Te[2]*Ce,xe},ye.bezier=function(xe,_e,ve,Ee,Te,Se){var Me=1-Se,Ae=Me*Me,Le=Se*Se,Re=Ae*Me,Ce=3*Se*Ae,we=3*Le*Me,Pe=Le*Se;return xe[0]=_e[0]*Re+ve[0]*Ce+Ee[0]*we+Te[0]*Pe,xe[1]=_e[1]*Re+ve[1]*Ce+Ee[1]*we+Te[1]*Pe,xe[2]=_e[2]*Re+ve[2]*Ce+Ee[2]*we+Te[2]*Pe,xe},ye.random=function(xe,_e){_e=_e||1;var ve=2*he.RANDOM()*Math.PI,Ee=2*he.RANDOM()-1,Te=Math.sqrt(1-Ee*Ee)*_e;return xe[0]=Math.cos(ve)*Te,xe[1]=Math.sin(ve)*Te,xe[2]=Ee*_e,xe},ye.transformMat4=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=ve[3]*Ee+ve[7]*Te+ve[11]*Se+ve[15];return Me=Me||1,xe[0]=(ve[0]*Ee+ve[4]*Te+ve[8]*Se+ve[12])/Me,xe[1]=(ve[1]*Ee+ve[5]*Te+ve[9]*Se+ve[13])/Me,xe[2]=(ve[2]*Ee+ve[6]*Te+ve[10]*Se+ve[14])/Me,xe},ye.transformMat3=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2];return xe[0]=Ee*ve[0]+Te*ve[3]+Se*ve[6],xe[1]=Ee*ve[1]+Te*ve[4]+Se*ve[7],xe[2]=Ee*ve[2]+Te*ve[5]+Se*ve[8],xe},ye.transformQuat=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=ve[0],Ae=ve[1],Le=ve[2],Re=ve[3],Ce=Re*Ee+Ae*Se-Le*Te,we=Re*Te+Le*Ee-Me*Se,Pe=Re*Se+Me*Te-Ae*Ee,Fe=-Me*Ee-Ae*Te-Le*Se;return xe[0]=Ce*Re+Fe*-Me+we*-Le-Pe*-Ae,xe[1]=we*Re+Fe*-Ae+Pe*-Me-Ce*-Le,xe[2]=Pe*Re+Fe*-Le+Ce*-Ae-we*-Me,xe},ye.rotateX=function(xe,_e,ve,Ee){var Te=[],Se=[];return Te[0]=_e[0]-ve[0],Te[1]=_e[1]-ve[1],Te[2]=_e[2]-ve[2],Se[0]=Te[0],Se[1]=Te[1]*Math.cos(Ee)-Te[2]*Math.sin(Ee),Se[2]=Te[1]*Math.sin(Ee)+Te[2]*Math.cos(Ee),xe[0]=Se[0]+ve[0],xe[1]=Se[1]+ve[1],xe[2]=Se[2]+ve[2],xe},ye.rotateY=function(xe,_e,ve,Ee){var Te=[],Se=[];return Te[0]=_e[0]-ve[0],Te[1]=_e[1]-ve[1],Te[2]=_e[2]-ve[2],Se[0]=Te[2]*Math.sin(Ee)+Te[0]*Math.cos(Ee),Se[1]=Te[1],Se[2]=Te[2]*Math.cos(Ee)-Te[0]*Math.sin(Ee),xe[0]=Se[0]+ve[0],xe[1]=Se[1]+ve[1],xe[2]=Se[2]+ve[2],xe},ye.rotateZ=function(xe,_e,ve,Ee){var Te=[],Se=[];return Te[0]=_e[0]-ve[0],Te[1]=_e[1]-ve[1],Te[2]=_e[2]-ve[2],Se[0]=Te[0]*Math.cos(Ee)-Te[1]*Math.sin(Ee),Se[1]=Te[0]*Math.sin(Ee)+Te[1]*Math.cos(Ee),Se[2]=Te[2],xe[0]=Se[0]+ve[0],xe[1]=Se[1]+ve[1],xe[2]=Se[2]+ve[2],xe},ye.forEach=function(){var xe=ye.create();return function(_e,ve,Ee,Te,Se,Me){var Ae,Le;for(ve||(ve=3),Ee||(Ee=0),Le=Te?Math.min(Te*ve+Ee,_e.length):_e.length,Ae=Ee;Ae<Le;Ae+=ve)xe[0]=_e[Ae],xe[1]=_e[Ae+1],xe[2]=_e[Ae+2],Se(xe,xe,Me),_e[Ae]=xe[0],_e[Ae+1]=xe[1],_e[Ae+2]=xe[2];return _e}}(),ye.angle=function(xe,_e){var ve=ye.fromValues(xe[0],xe[1],xe[2]),Ee=ye.fromValues(_e[0],_e[1],_e[2]);ye.normalize(ve,ve),ye.normalize(Ee,Ee);var Te=ye.dot(ve,Ee);return 1<Te?0:Math.acos(Te)},ye.str=function(xe){return'vec3('+xe[0]+', '+xe[1]+', '+xe[2]+')'},ue.exports=ye},function(ue,fe,ge){var he=ge(1),ye={};ye.create=function(){var xe=new he.ARRAY_TYPE(4);return xe[0]=0,xe[1]=0,xe[2]=0,xe[3]=0,xe},ye.clone=function(xe){var _e=new he.ARRAY_TYPE(4);return _e[0]=xe[0],_e[1]=xe[1],_e[2]=xe[2],_e[3]=xe[3],_e},ye.fromValues=function(xe,_e,ve,Ee){var Te=new he.ARRAY_TYPE(4);return Te[0]=xe,Te[1]=_e,Te[2]=ve,Te[3]=Ee,Te},ye.copy=function(xe,_e){return xe[0]=_e[0],xe[1]=_e[1],xe[2]=_e[2],xe[3]=_e[3],xe},ye.set=function(xe,_e,ve,Ee,Te){return xe[0]=_e,xe[1]=ve,xe[2]=Ee,xe[3]=Te,xe},ye.add=function(xe,_e,ve){return xe[0]=_e[0]+ve[0],xe[1]=_e[1]+ve[1],xe[2]=_e[2]+ve[2],xe[3]=_e[3]+ve[3],xe},ye.subtract=function(xe,_e,ve){return xe[0]=_e[0]-ve[0],xe[1]=_e[1]-ve[1],xe[2]=_e[2]-ve[2],xe[3]=_e[3]-ve[3],xe},ye.sub=ye.subtract,ye.multiply=function(xe,_e,ve){return xe[0]=_e[0]*ve[0],xe[1]=_e[1]*ve[1],xe[2]=_e[2]*ve[2],xe[3]=_e[3]*ve[3],xe},ye.mul=ye.multiply,ye.divide=function(xe,_e,ve){return xe[0]=_e[0]/ve[0],xe[1]=_e[1]/ve[1],xe[2]=_e[2]/ve[2],xe[3]=_e[3]/ve[3],xe},ye.div=ye.divide,ye.min=function(xe,_e,ve){return xe[0]=Math.min(_e[0],ve[0]),xe[1]=Math.min(_e[1],ve[1]),xe[2]=Math.min(_e[2],ve[2]),xe[3]=Math.min(_e[3],ve[3]),xe},ye.max=function(xe,_e,ve){return xe[0]=Math.max(_e[0],ve[0]),xe[1]=Math.max(_e[1],ve[1]),xe[2]=Math.max(_e[2],ve[2]),xe[3]=Math.max(_e[3],ve[3]),xe},ye.scale=function(xe,_e,ve){return xe[0]=_e[0]*ve,xe[1]=_e[1]*ve,xe[2]=_e[2]*ve,xe[3]=_e[3]*ve,xe},ye.scaleAndAdd=function(xe,_e,ve,Ee){return xe[0]=_e[0]+ve[0]*Ee,xe[1]=_e[1]+ve[1]*Ee,xe[2]=_e[2]+ve[2]*Ee,xe[3]=_e[3]+ve[3]*Ee,xe},ye.distance=function(xe,_e){var ve=_e[0]-xe[0],Ee=_e[1]-xe[1],Te=_e[2]-xe[2],Se=_e[3]-xe[3];return Math.sqrt(ve*ve+Ee*Ee+Te*Te+Se*Se)},ye.dist=ye.distance,ye.squaredDistance=function(xe,_e){var ve=_e[0]-xe[0],Ee=_e[1]-xe[1],Te=_e[2]-xe[2],Se=_e[3]-xe[3];return ve*ve+Ee*Ee+Te*Te+Se*Se},ye.sqrDist=ye.squaredDistance,ye.length=function(xe){var _e=xe[0],ve=xe[1],Ee=xe[2],Te=xe[3];return Math.sqrt(_e*_e+ve*ve+Ee*Ee+Te*Te)},ye.len=ye.length,ye.squaredLength=function(xe){var _e=xe[0],ve=xe[1],Ee=xe[2],Te=xe[3];return _e*_e+ve*ve+Ee*Ee+Te*Te},ye.sqrLen=ye.squaredLength,ye.negate=function(xe,_e){return xe[0]=-_e[0],xe[1]=-_e[1],xe[2]=-_e[2],xe[3]=-_e[3],xe},ye.inverse=function(xe,_e){return xe[0]=1/_e[0],xe[1]=1/_e[1],xe[2]=1/_e[2],xe[3]=1/_e[3],xe},ye.normalize=function(xe,_e){var ve=_e[0],Ee=_e[1],Te=_e[2],Se=_e[3],Me=ve*ve+Ee*Ee+Te*Te+Se*Se;return 0<Me&&(Me=1/Math.sqrt(Me),xe[0]=ve*Me,xe[1]=Ee*Me,xe[2]=Te*Me,xe[3]=Se*Me),xe},ye.dot=function(xe,_e){return xe[0]*_e[0]+xe[1]*_e[1]+xe[2]*_e[2]+xe[3]*_e[3]},ye.lerp=function(xe,_e,ve,Ee){var Te=_e[0],Se=_e[1],Me=_e[2],Ae=_e[3];return xe[0]=Te+Ee*(ve[0]-Te),xe[1]=Se+Ee*(ve[1]-Se),xe[2]=Me+Ee*(ve[2]-Me),xe[3]=Ae+Ee*(ve[3]-Ae),xe},ye.random=function(xe,_e){return _e=_e||1,xe[0]=he.RANDOM(),xe[1]=he.RANDOM(),xe[2]=he.RANDOM(),xe[3]=he.RANDOM(),ye.normalize(xe,xe),ye.scale(xe,xe,_e),xe},ye.transformMat4=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=_e[3];return xe[0]=ve[0]*Ee+ve[4]*Te+ve[8]*Se+ve[12]*Me,xe[1]=ve[1]*Ee+ve[5]*Te+ve[9]*Se+ve[13]*Me,xe[2]=ve[2]*Ee+ve[6]*Te+ve[10]*Se+ve[14]*Me,xe[3]=ve[3]*Ee+ve[7]*Te+ve[11]*Se+ve[15]*Me,xe},ye.transformQuat=function(xe,_e,ve){var Ee=_e[0],Te=_e[1],Se=_e[2],Me=ve[0],Ae=ve[1],Le=ve[2],Re=ve[3],Ce=Re*Ee+Ae*Se-Le*Te,we=Re*Te+Le*Ee-Me*Se,Pe=Re*Se+Me*Te-Ae*Ee,Fe=-Me*Ee-Ae*Te-Le*Se;return xe[0]=Ce*Re+Fe*-Me+we*-Le-Pe*-Ae,xe[1]=we*Re+Fe*-Ae+Pe*-Me-Ce*-Le,xe[2]=Pe*Re+Fe*-Le+Ce*-Ae-we*-Me,xe[3]=_e[3],xe},ye.forEach=function(){var xe=ye.create();return function(_e,ve,Ee,Te,Se,Me){var Ae,Le;for(ve||(ve=4),Ee||(Ee=0),Le=Te?Math.min(Te*ve+Ee,_e.length):_e.length,Ae=Ee;Ae<Le;Ae+=ve)xe[0]=_e[Ae],xe[1]=_e[Ae+1],xe[2]=_e[Ae+2],xe[3]=_e[Ae+3],Se(xe,xe,Me),_e[Ae]=xe[0],_e[Ae+1]=xe[1],_e[Ae+2]=xe[2],_e[Ae+3]=xe[3];return _e}}(),ye.str=function(xe){return'vec4('+xe[0]+', '+xe[1]+', '+xe[2]+', '+xe[3]+')'},ue.exports=ye},function(ue,fe,ge){var he=ge(1),ye={};ye.create=function(){var xe=new he.ARRAY_TYPE(2);return xe[0]=0,xe[1]=0,xe},ye.clone=function(xe){var _e=new he.ARRAY_TYPE(2);return _e[0]=xe[0],_e[1]=xe[1],_e},ye.fromValues=function(xe,_e){var ve=new he.ARRAY_TYPE(2);return ve[0]=xe,ve[1]=_e,ve},ye.copy=function(xe,_e){return xe[0]=_e[0],xe[1]=_e[1],xe},ye.set=function(xe,_e,ve){return xe[0]=_e,xe[1]=ve,xe},ye.add=function(xe,_e,ve){return xe[0]=_e[0]+ve[0],xe[1]=_e[1]+ve[1],xe},ye.subtract=function(xe,_e,ve){return xe[0]=_e[0]-ve[0],xe[1]=_e[1]-ve[1],xe},ye.sub=ye.subtract,ye.multiply=function(xe,_e,ve){return xe[0]=_e[0]*ve[0],xe[1]=_e[1]*ve[1],xe},ye.mul=ye.multiply,ye.divide=function(xe,_e,ve){return xe[0]=_e[0]/ve[0],xe[1]=_e[1]/ve[1],xe},ye.div=ye.divide,ye.min=function(xe,_e,ve){return xe[0]=Math.min(_e[0],ve[0]),xe[1]=Math.min(_e[1],ve[1]),xe},ye.max=function(xe,_e,ve){return xe[0]=Math.max(_e[0],ve[0]),xe[1]=Math.max(_e[1],ve[1]),xe},ye.scale=function(xe,_e,ve){return xe[0]=_e[0]*ve,xe[1]=_e[1]*ve,xe},ye.scaleAndAdd=function(xe,_e,ve,Ee){return xe[0]=_e[0]+ve[0]*Ee,xe[1]=_e[1]+ve[1]*Ee,xe},ye.distance=function(xe,_e){var ve=_e[0]-xe[0],Ee=_e[1]-xe[1];return Math.sqrt(ve*ve+Ee*Ee)},ye.dist=ye.distance,ye.squaredDistance=function(xe,_e){var ve=_e[0]-xe[0],Ee=_e[1]-xe[1];return ve*ve+Ee*Ee},ye.sqrDist=ye.squaredDistance,ye.length=function(xe){var _e=xe[0],ve=xe[1];return Math.sqrt(_e*_e+ve*ve)},ye.len=ye.length,ye.squaredLength=function(xe){var _e=xe[0],ve=xe[1];return _e*_e+ve*ve},ye.sqrLen=ye.squaredLength,ye.negate=function(xe,_e){return xe[0]=-_e[0],xe[1]=-_e[1],xe},ye.inverse=function(xe,_e){return xe[0]=1/_e[0],xe[1]=1/_e[1],xe},ye.normalize=function(xe,_e){var ve=_e[0],Ee=_e[1],Te=ve*ve+Ee*Ee;return 0<Te&&(Te=1/Math.sqrt(Te),xe[0]=_e[0]*Te,xe[1]=_e[1]*Te),xe},ye.dot=function(xe,_e){return xe[0]*_e[0]+xe[1]*_e[1]},ye.cross=function(xe,_e,ve){var Ee=_e[0]*ve[1]-_e[1]*ve[0];return xe[0]=xe[1]=0,xe[2]=Ee,xe},ye.lerp=function(xe,_e,ve,Ee){var Te=_e[0],Se=_e[1];return xe[0]=Te+Ee*(ve[0]-Te),xe[1]=Se+Ee*(ve[1]-Se),xe},ye.random=function(xe,_e){_e=_e||1;var ve=2*he.RANDOM()*Math.PI;return xe[0]=Math.cos(ve)*_e,xe[1]=Math.sin(ve)*_e,xe},ye.transformMat2=function(xe,_e,ve){var Ee=_e[0],Te=_e[1];return xe[0]=ve[0]*Ee+ve[2]*Te,xe[1]=ve[1]*Ee+ve[3]*Te,xe},ye.transformMat2d=function(xe,_e,ve){var Ee=_e[0],Te=_e[1];return xe[0]=ve[0]*Ee+ve[2]*Te+ve[4],xe[1]=ve[1]*Ee+ve[3]*Te+ve[5],xe},ye.transformMat3=function(xe,_e,ve){var Ee=_e[0],Te=_e[1];return xe[0]=ve[0]*Ee+ve[3]*Te+ve[6],xe[1]=ve[1]*Ee+ve[4]*Te+ve[7],xe},ye.transformMat4=function(xe,_e,ve){var Ee=_e[0],Te=_e[1];return xe[0]=ve[0]*Ee+ve[4]*Te+ve[12],xe[1]=ve[1]*Ee+ve[5]*Te+ve[13],xe},ye.forEach=function(){var xe=ye.create();return function(_e,ve,Ee,Te,Se,Me){var Ae,Le;for(ve||(ve=2),Ee||(Ee=0),Le=Te?Math.min(Te*ve+Ee,_e.length):_e.length,Ae=Ee;Ae<Le;Ae+=ve)xe[0]=_e[Ae],xe[1]=_e[Ae+1],Se(xe,xe,Me),_e[Ae]=xe[0],_e[Ae+1]=xe[1];return _e}}(),ye.str=function(xe){return'vec2('+xe[0]+', '+xe[1]+')'},ue.exports=ye}])})}).call(oe,ie(0)(ee))},function(){var ie=['precision mediump float;','','attribute vec3 vertPosition;','attribute vec3 vertColor;','varying vec3 fragColor;','uniform mat4 mWorld;','uniform mat4 mView;','uniform mat4 mProj;','','void main()','{','  fragColor = vertColor;','  gl_Position = mProj * mView * mWorld * vec4(vertPosition, 1.0);','}'].join('\n'),ne=['precision mediump float;','','varying vec3 fragColor;','void main()','{','  gl_FragColor = vec4(fragColor, 1.0);','}'].join('\n')},function(){var ie=['precision mediump float;','','attribute vec3 vertPosition;','attribute vec3 vertColor;','varying vec3 fragColor;','uniform mat4 mWorld;','uniform mat4 mView;','uniform mat4 mProj;','','void main()','{','  fragColor = vertColor;','  gl_Position = mProj * mView * mWorld * vec4(vertPosition, 1.0);','}'].join('\n'),ne=['precision mediump float;','','varying vec3 fragColor;','void main()','{','  gl_FragColor = vec4(fragColor, 1.0);','}'].join('\n')},function(){},function(){},function(){},function(){},function(){},function(){},function(){(function(){var Me=function(Ce,we){function Pe(){this.constructor=Ce}for(var Fe in we)Ae.call(we,Fe)&&(Ce[Fe]=we[Fe]);return Pe.prototype=we.prototype,Ce.prototype=new Pe,Ce.__super__=we.prototype,Ce},Ae={}.hasOwnProperty,Le=function(Ce,we){return function(){return Ce.apply(we,arguments)}},ie,ne,se,le,pe,ue,fe,ge,he,ye,xe,_e,ve,Ee,Te,Se;ve=Math.PI,Ee=2*ve,xe=360/Ee,ye=Ee/360,le=function(){function Re(Ce){this.data=Ce,null==this.data&&(this.data=new Float32Array(9)),this.ident()}return Re.prototype.ident=function(){var Ce;return Ce=this.data,Ce[0]=1,Ce[1]=0,Ce[2]=0,Ce[3]=0,Ce[4]=1,Ce[5]=0,Ce[6]=0,Ce[7]=0,Ce[8]=1,this},Re.prototype.transpose=function(){var Ce,we,Pe,Fe;return Fe=this.data,Ce=Fe[1],we=Fe[2],Pe=Fe[5],Fe[1]=Fe[3],Fe[2]=Fe[6],Fe[3]=Ce,Fe[5]=Fe[7],Fe[6]=we,Fe[7]=Pe,this},Re.prototype.mulVec3=function(Ce,we){return null==we&&(we=Ce),this.mulVal3(Ce.x,Ce.y,Ce.z,we),we},Re.prototype.mulVal3=function(Ce,we,Pe,Fe){var De;return Fe=Fe.data,De=this.data,Fe[0]=De[0]*Ce+De[3]*we+De[6]*Pe,Fe[1]=De[1]*Ce+De[4]*we+De[7]*Pe,Fe[2]=De[2]*Ce+De[5]*we+De[8]*Pe,this},Re.prototype.rotatex=function(Ce){var we,Pe;return Pe=Math.sin(Ce*ye),we=Math.cos(Ce*ye),this.amul(1,0,0,0,we,Pe,0,-Pe,we)},Re.prototype.rotatey=function(Ce){var we,Pe;return Pe=Math.sin(Ce*ye),we=Math.cos(Ce*ye),this.amul(we,0,-Pe,0,1,0,Pe,0,we)},Re.prototype.rotatez=function(Ce){var we,Pe;return Pe=Math.sin(Ce*ye),we=Math.cos(Ce*ye),this.amul(we,Pe,0,-Pe,we,0,0,0,1)},Re.prototype.amul=function(Ce,we,Pe,Fe,De,Ie,Be,Ue,Ne){var Oe,ke,He,We,je,Xe,qe,Ye,Ze,Ke;return Oe=this.data,ke=Oe[0],je=Oe[1],Ye=Oe[2],He=Oe[3],Xe=Oe[4],Ze=Oe[5],We=Oe[6],qe=Oe[7],Ke=Oe[8],Oe[0]=ke*Ce+He*we+We*Pe,Oe[1]=je*Ce+Xe*we+qe*Pe,Oe[2]=Ye*Ce+Ze*we+Ke*Pe,Oe[3]=ke*Fe+He*De+We*Ie,Oe[4]=je*Fe+Xe*De+qe*Ie,Oe[5]=Ye*Fe+Ze*De+Ke*Ie,Oe[6]=ke*Be+He*Ue+We*Ne,Oe[7]=je*Be+Xe*Ue+qe*Ne,Oe[8]=Ye*Be+Ze*Ue+Ke*Ne,this},Re.prototype.fromMat4Rot=function(Ce){return Ce.toMat3Rot(this)},Re.prototype.log=function(){var Ce;return Ce=this.data,console.log('%f, %f, %f,\n%f, %f, %f, \n%f, %f, %f, ',Ce[0],Ce[1],Ce[2],Ce[3],Ce[4],Ce[5],Ce[6],Ce[7],Ce[8])},Re}(),pe=function(){function Re(Ce){this.data=Ce,null==this.data&&(this.data=new Float32Array(16)),this.ident()}return Re.prototype.ident=function(){var Ce;return Ce=this.data,Ce[0]=1,Ce[1]=0,Ce[2]=0,Ce[3]=0,Ce[4]=0,Ce[5]=1,Ce[6]=0,Ce[7]=0,Ce[8]=0,Ce[9]=0,Ce[10]=1,Ce[11]=0,Ce[12]=0,Ce[13]=0,Ce[14]=0,Ce[15]=1,this},Re.prototype.zero=function(){var Ce;return Ce=this.data,Ce[0]=0,Ce[1]=0,Ce[2]=0,Ce[3]=0,Ce[4]=0,Ce[5]=0,Ce[6]=0,Ce[7]=0,Ce[8]=0,Ce[9]=0,Ce[10]=0,Ce[11]=0,Ce[12]=0,Ce[13]=0,Ce[14]=0,Ce[15]=0,this},Re.prototype.copy=function(Ce){var we,Pe;return Pe=this.data,we=Ce.data,we[0]=Pe[0],we[1]=Pe[1],we[2]=Pe[2],we[3]=Pe[3],we[4]=Pe[4],we[5]=Pe[5],we[6]=Pe[6],we[7]=Pe[7],we[8]=Pe[8],we[9]=Pe[9],we[10]=Pe[10],we[11]=Pe[11],we[12]=Pe[12],we[13]=Pe[13],we[14]=Pe[14],we[15]=Pe[15],Ce},Re.prototype.toMat3=function(Ce){var we,Pe;return Pe=this.data,we=Ce.data,we[0]=Pe[0],we[1]=Pe[1],we[2]=Pe[2],we[3]=Pe[4],we[4]=Pe[5],we[5]=Pe[6],we[6]=Pe[8],we[7]=Pe[9],we[8]=Pe[10],Ce},Re.prototype.toMat3Rot=function(Ce){var we,Pe,Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe,ke,He,We,je;return He=Ce.data,je=this.data,we=je[0],Pe=je[1],Fe=je[2],De=je[4],Ie=je[5],Be=je[6],Ue=je[8],Ne=je[9],Ge=je[10],Ve=Ge*Ie-Be*Ne,ze=-Ge*De+Be*Ue,Oe=Ne*De-Ie*Ue,ke=we*Ve+Pe*ze+Fe*Oe,We=1/ke,He[0]=Ve*We,He[3]=(-Ge*Pe+Fe*Ne)*We,He[6]=(Be*Pe-Fe*Ie)*We,He[1]=ze*We,He[4]=(Ge*we-Fe*Ue)*We,He[7]=(-Be*we+Fe*De)*We,He[2]=Oe*We,He[5]=(-Ne*we+Pe*Ue)*We,He[8]=(Ie*we-Pe*De)*We,Ce},Re.prototype.perspective=function(Ce){var we,Pe,Fe,De,Ie,Be,Ue,Ne,Ge;return Ie=Ce.fov,we=Ce.aspect,Ue=Ce.near,De=Ce.far,null==Ie&&(Ie=60),null==we&&(we=1),null==Ue&&(Ue=0.01),null==De&&(De=100),this.zero(),Fe=this.data,Ge=Ue*Math.tan(Ie*Math.PI/360),Ne=Ge*we,Be=-Ne,Pe=-Ge,Fe[0]=2*Ue/(Ne-Be),Fe[5]=2*Ue/(Ge-Pe),Fe[8]=(Ne+Be)/(Ne-Be),Fe[9]=(Ge+Pe)/(Ge-Pe),Fe[10]=-(De+Ue)/(De-Ue),Fe[11]=-1,Fe[14]=-(2*De*Ue)/(De-Ue),this},Re.prototype.inversePerspective=function(Ce,we,Pe,Fe){var De,Ie,Be,Ue,Ne;return this.zero(),Ie=this.data,Ne=Pe*Math.tan(Ce*Math.PI/360),Ue=Ne*we,Be=-Ue,De=-Ne,Ie[0]=(Ue-Be)/(2*Pe),Ie[5]=(Ne-De)/(2*Pe),Ie[11]=-(Fe-Pe)/(2*Fe*Pe),Ie[12]=(Ue+Be)/(2*Pe),Ie[13]=(Ne+De)/(2*Pe),Ie[14]=-1,Ie[15]=(Fe+Pe)/(2*Fe*Pe),this},Re.prototype.ortho=function(Ce,we,Pe,Fe,De,Ie){var Be,Ue,Ne;return null==Ce&&(Ce=-1),null==we&&(we=1),null==Pe&&(Pe=-1),null==Fe&&(Fe=1),null==De&&(De=-1),null==Ie&&(Ie=1),Ue=Ie-De,Ne=Pe-Fe,Be=we-Ce,this.set(2/Ue,0,0,-(De+Ie)/Ue,0,2/Ne,0,-(Pe+Fe)/Ne,0,0,-2/Be,-(we+Ce)/Be,0,0,0,1)},Re.prototype.inverseOrtho=function(Ce,we,Pe,Fe,De,Ie){var Be,Ue,Ne,Ge,Ve,ze,Oe;return null==Ce&&(Ce=-1),null==we&&(we=1),null==Pe&&(Pe=-1),null==Fe&&(Fe=1),null==De&&(De=-1),null==Ie&&(Ie=1),Be=(Ie-De)/2,Ue=(Ie+De)/2,Ne=(Pe-Fe)/2,Ge=(Pe+Fe)/2,Ve=(we-Ce)/-2,ze=(Ce+we)/2,Oe=1,this.set(Be,0,0,Ue,0,Ne,0,Ge,0,0,Ve,ze,0,0,0,Oe)},Re.prototype.fromRotationTranslation=function(Ce,we){var Pe,Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe,ke,He,We,je,Xe,qe;return Ue=Ce.x,Oe=Ce.y,je=Ce.z,Fe=Ce.w,Ne=Ue+Ue,ke=Oe+Oe,Xe=je+je,Ge=Ue*Ne,Ve=Ue*ke,ze=Ue*Xe,He=Oe*ke,We=Oe*Xe,qe=je*Xe,De=Fe*Ne,Ie=Fe*ke,Be=Fe*Xe,Pe=this.data,Pe[0]=1-(He+qe),Pe[1]=Ve+Be,Pe[2]=ze-Ie,Pe[3]=0,Pe[4]=Ve-Be,Pe[5]=1-(Ge+qe),Pe[6]=We+De,Pe[7]=0,Pe[8]=ze+Ie,Pe[9]=We-De,Pe[10]=1-(Ge+He),Pe[11]=0,Pe[12]=we.x,Pe[13]=we.y,Pe[14]=we.z,Pe[15]=1,this},Re.prototype.trans=function(Ce,we,Pe){var Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe,ke,He,We;return We=this.data,Fe=We[0],De=We[1],Ie=We[2],Be=We[3],Ue=We[4],Ne=We[5],Ge=We[6],Ve=We[7],ze=We[8],Oe=We[9],ke=We[10],He=We[11],We[12]=Fe*Ce+Ue*we+ze*Pe+We[12],We[13]=De*Ce+Ne*we+Oe*Pe+We[13],We[14]=Ie*Ce+Ge*we+ke*Pe+We[14],We[15]=Be*Ce+Ve*we+He*Pe+We[15],this},Re.prototype.rotatex=function(Ce){var we,Pe,Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe;return Ve=this.data,ze=Ee*(Ce/360),Oe=Math.sin(ze),Ge=Math.cos(ze),we=Ve[4],Pe=Ve[5],Fe=Ve[6],De=Ve[7],Ie=Ve[8],Be=Ve[9],Ue=Ve[10],Ne=Ve[11],Ve[4]=we*Ge+Ie*Oe,Ve[5]=Pe*Ge+Be*Oe,Ve[6]=Fe*Ge+Ue*Oe,Ve[7]=De*Ge+Ne*Oe,Ve[8]=we*-Oe+Ie*Ge,Ve[9]=Pe*-Oe+Be*Ge,Ve[10]=Fe*-Oe+Ue*Ge,Ve[11]=De*-Oe+Ne*Ge,this},Re.prototype.rotatey=function(Ce){var we,Pe,Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe;return Ve=this.data,ze=Ee*(Ce/360),Oe=Math.sin(ze),Ge=Math.cos(ze),we=Ve[0],Pe=Ve[1],Fe=Ve[2],De=Ve[3],Ie=Ve[8],Be=Ve[9],Ue=Ve[10],Ne=Ve[11],Ve[0]=we*Ge+Ie*-Oe,Ve[1]=Pe*Ge+Be*-Oe,Ve[2]=Fe*Ge+Ue*-Oe,Ve[3]=De*Ge+Ne*-Oe,Ve[8]=we*Oe+Ie*Ge,Ve[9]=Pe*Oe+Be*Ge,Ve[10]=Fe*Oe+Ue*Ge,Ve[11]=De*Oe+Ne*Ge,this},Re.prototype.rotatez=function(Ce){var we,Pe,Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe;return Ve=this.data,ze=Ee*(Ce/360),Oe=Math.sin(ze),Ge=Math.cos(ze),we=Ve[0],Pe=Ve[1],Fe=Ve[2],De=Ve[3],Ie=Ve[4],Be=Ve[5],Ue=Ve[6],Ne=Ve[7],Ve[0]=we*Ge+Ie*Oe,Ve[1]=Pe*Ge+Be*Oe,Ve[2]=Fe*Ge+Ue*Oe,Ve[3]=De*Ge+Ne*Oe,Ve[4]=we*-Oe+Ie*Ge,Ve[5]=Pe*-Oe+Be*Ge,Ve[6]=Fe*-Oe+Ue*Ge,Ve[7]=De*-Oe+Ne*Ge,this},Re.prototype.scale=function(Ce){var we,Pe,Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe,ke;return ke=this.data,we=ke[0],Pe=ke[1],Fe=ke[2],De=ke[3],Ie=ke[4],Be=ke[5],Ue=ke[6],Ne=ke[7],Ge=ke[8],Ve=ke[9],ze=ke[10],Oe=ke[11],ke[0]=we*Ce,ke[1]=Pe*Ce,ke[2]=Fe*Ce,ke[3]=De*Ce,ke[4]=Ie*Ce,ke[5]=Be*Ce,ke[6]=Ue*Ce,ke[7]=Ne*Ce,ke[8]=Ge*Ce,ke[9]=Ve*Ce,ke[10]=ze*Ce,ke[11]=Oe*Ce,this},Re.prototype.mulMat4=function(Ce,we){var Pe,Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe,ke,He,We,je,Xe,qe,Ye,Ze,Ke,Qe,Je,$e;return null==we&&(we=this),Qe=we.data,Je=this.data,$e=Ce.data,Pe=Je[0],Fe=Je[1],De=Je[2],Ie=Je[3],Be=Je[4],Ue=Je[5],Ne=Je[6],Ge=Je[7],Ve=Je[8],ze=Je[9],Oe=Je[10],ke=Je[11],He=Je[12],We=Je[13],je=Je[14],Xe=Je[15],qe=$e[0],Ye=$e[1],Ze=$e[2],Ke=$e[3],Qe[0]=qe*Pe+Ye*Be+Ze*Ve+Ke*He,Qe[1]=qe*Fe+Ye*Ue+Ze*ze+Ke*We,Qe[2]=qe*De+Ye*Ne+Ze*Oe+Ke*je,Qe[3]=qe*Ie+Ye*Ge+Ze*ke+Ke*Xe,qe=$e[4],Ye=$e[5],Ze=$e[6],Ke=$e[7],Qe[4]=qe*Pe+Ye*Be+Ze*Ve+Ke*He,Qe[5]=qe*Fe+Ye*Ue+Ze*ze+Ke*We,Qe[6]=qe*De+Ye*Ne+Ze*Oe+Ke*je,Qe[7]=qe*Ie+Ye*Ge+Ze*ke+Ke*Xe,qe=$e[8],Ye=$e[9],Ze=$e[10],Ke=$e[11],Qe[8]=qe*Pe+Ye*Be+Ze*Ve+Ke*He,Qe[9]=qe*Fe+Ye*Ue+Ze*ze+Ke*We,Qe[10]=qe*De+Ye*Ne+Ze*Oe+Ke*je,Qe[11]=qe*Ie+Ye*Ge+Ze*ke+Ke*Xe,qe=$e[12],Ye=$e[13],Ze=$e[14],Ke=$e[15],Qe[12]=qe*Pe+Ye*Be+Ze*Ve+Ke*He,Qe[13]=qe*Fe+Ye*Ue+Ze*ze+Ke*We,Qe[14]=qe*De+Ye*Ne+Ze*Oe+Ke*je,Qe[15]=qe*Ie+Ye*Ge+Ze*ke+Ke*Xe,we},Re.prototype.mulVec3=function(Ce,we){return null==we&&(we=Ce),this.mulVal3(Ce.x,Ce.y,Ce.z,we)},Re.prototype.mulVal3=function(Ce,we,Pe,Fe){var De;return Fe=Fe.data,De=this.data,Fe[0]=De[0]*Ce+De[4]*we+De[8]*Pe,Fe[1]=De[1]*Ce+De[5]*we+De[9]*Pe,Fe[2]=De[2]*Ce+De[6]*we+De[10]*Pe,Fe},Re.prototype.mulVec4=function(Ce,we){return null==we&&(we=Ce),this.mulVal4(Ce.x,Ce.y,Ce.z,Ce.w,we)},Re.prototype.mulVal4=function(Ce,we,Pe,Fe,De){var Ie;return De=De.data,Ie=this.data,De[0]=Ie[0]*Ce+Ie[4]*we+Ie[8]*Pe+Ie[12]*Fe,De[1]=Ie[1]*Ce+Ie[5]*we+Ie[9]*Pe+Ie[13]*Fe,De[2]=Ie[2]*Ce+Ie[6]*we+Ie[10]*Pe+Ie[14]*Fe,De[3]=Ie[3]*Ce+Ie[7]*we+Ie[11]*Pe+Ie[15]*Fe,De},Re.prototype.invert=function(Ce){var we,Pe,Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe,ke,He,We,je,Xe,qe,Ye,Ze,Ke,Qe,Je,$e,et,tt,rt,ot,it,nt,st,lt;if(null==Ce&&(Ce=this),lt=this.data,nt=Ce.data,we=lt[0],Pe=lt[1],Fe=lt[2],De=lt[3],Ie=lt[4],Be=lt[5],Ue=lt[6],Ne=lt[7],Ge=lt[8],Ve=lt[9],ze=lt[10],Oe=lt[11],ke=lt[12],He=lt[13],We=lt[14],je=lt[15],Xe=we*Be-Pe*Ie,qe=we*Ue-Fe*Ie,Ye=we*Ne-De*Ie,Ze=Pe*Ue-Fe*Be,Ke=Pe*Ne-De*Be,Qe=Fe*Ne-De*Ue,Je=Ge*He-Ve*ke,$e=Ge*We-ze*ke,et=Ge*je-Oe*ke,tt=Ve*We-ze*He,rt=Ve*je-Oe*He,ot=ze*je-Oe*We,it=Xe*ot-qe*rt+Ye*tt+Ze*et-Ke*$e+Qe*Je,0!==it)return st=1/it,nt[0]=(Be*ot-Ue*rt+Ne*tt)*st,nt[1]=(-Pe*ot+Fe*rt-De*tt)*st,nt[2]=(He*Qe-We*Ke+je*Ze)*st,nt[3]=(-Ve*Qe+ze*Ke-Oe*Ze)*st,nt[4]=(-Ie*ot+Ue*et-Ne*$e)*st,nt[5]=(we*ot-Fe*et+De*$e)*st,nt[6]=(-ke*Qe+We*Ye-je*qe)*st,nt[7]=(Ge*Qe-ze*Ye+Oe*qe)*st,nt[8]=(Ie*rt-Be*et+Ne*Je)*st,nt[9]=(-we*rt+Pe*et-De*Je)*st,nt[10]=(ke*Ke-He*Ye+je*Xe)*st,nt[11]=(-Ge*Ke+Ve*Ye-Oe*Xe)*st,nt[12]=(-Ie*tt+Be*$e-Ue*Je)*st,nt[13]=(we*tt-Pe*$e+Fe*Je)*st,nt[14]=(-ke*Ze+He*qe-We*Xe)*st,nt[15]=(Ge*Ze-Ve*qe+ze*Xe)*st,Ce},Re.prototype.set=function(Ce,we,Pe,Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe,ke,He,We){var je;return je=this.data,je[0]=Ce,je[4]=we,je[8]=Pe,je[12]=Fe,je[1]=De,je[5]=Ie,je[9]=Be,je[13]=Ue,je[2]=Ne,je[6]=Ge,je[10]=Ve,je[14]=ze,je[3]=Oe,je[7]=ke,je[11]=He,je[15]=We,this},Re}(),fe=function(){function Re(we,Pe){var Fe,De,Ie;this.framework=we,Fe=Pe.common,Ie=Pe.vertex,De=Pe.fragment,this.gl=this.framework.gl,this.program=this.gl.createProgram(),this.vs=this.gl.createShader(this.gl.VERTEX_SHADER),this.fs=this.gl.createShader(this.gl.FRAGMENT_SHADER),this.gl.attachShader(this.program,this.vs),this.gl.attachShader(this.program,this.fs),null==Fe&&(Fe=''),this.compileShader(this.vs,[Fe,Ie].join('\n')),this.compileShader(this.fs,[Fe,De].join('\n')),this.link(),this.uniformCache={},this.attributeCache={},this.samplers={},this.unitCounter=0}var Ce;return Ce='#ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp int;\n    precision highp float;\n#else\n    precision mediump int;\n    precision mediump float;\n#endif\n#define PI 3.141592653589793\n#define TAU 6.283185307179586\n#define PIH 1.5707963267948966',Re.prototype.compileShader=function(we,Pe){var Fe,De,Ie;if(Pe=[Ce,Pe].join('\n'),Ie=this.preprocess(Pe),Pe=Ie[0],De=Ie[1],this.gl.shaderSource(we,Pe),this.gl.compileShader(we),!this.gl.getShaderParameter(we,this.gl.COMPILE_STATUS))throw Fe=this.gl.getShaderInfoLog(we),this.translateError(Fe,De)},Re.prototype.preprocess=function(we){var Pe,Fe,De,Ie,Be,Ue,Ne,Ge,Ve;for(Ue=[],Ve=[],Pe='no file',Be=1,Ge=we.split('\n'),(Fe=0,De=Ge.length);Fe<De;Fe++)Ie=Ge[Fe],Ne=Ie.match(/#line (\d+) (.*)/),Ne?(Be=parseInt(Ne[1],10)+1,Pe=Ne[2]):(Ue.push({source:Ie,lineno:Be,filename:Pe}),Ve.push(Ie),Be+=1);return[Ve.join('\n'),Ue]},Re.prototype.translateError=function(we,Pe){var Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe;for(ze=['Shader Compile Error'],Ve=we.split('\n'),(Fe=De=0,Ie=Ve.length);De<Ie;Fe=++De)Be=Ve[Fe],Ne=Be.match(/ERROR: \d+:(\d+): (.*)/),Ne?(Ue=parseFloat(Ne[1])-1,Ge=Ne[2],Oe=Pe[Ue],ze.push('File "'+Oe.filename+'", Line '+Oe.lineno+', '+Ge),ze.push('   '+Oe.source)):ze.push(Be);return ze.join('\n')},Re.prototype.link=function(){if(this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))throw'Shader Link Error: '+this.gl.getProgramInfoLog(this.program)},Re.prototype.attributeLocation=function(we){var Pe;return Pe=this.attributeCache[we],void 0===Pe&&(Pe=this.attributeCache[we]=this.gl.getAttribLocation(this.program,we)),Pe},Re.prototype.uniformLocation=function(we){var Pe;return Pe=this.uniformCache[we],void 0===Pe&&(Pe=this.uniformCache[we]=this.gl.getUniformLocation(this.program,we)),Pe},Re.prototype.use=function(){return this.framework.currentShader!==this&&(this.framework.currentShader=this,this.gl.useProgram(this.program)),this},Re.prototype.draw=function(we){return we.setPointersForShader(this).draw(),this},Re.prototype.int=function(we,Pe){var Fe;return Fe=this.uniformLocation(we),Fe&&this.gl.uniform1i(Fe,Pe),this},Re.prototype.sampler=function(we,Pe){var Fe;return Fe=this.samplers[we],void 0===Fe&&(Fe=this.samplers[we]=this.unitCounter++),Pe.bind(Fe),this.int(we,Fe),this},Re.prototype.vec2=function(we,Pe,Fe){var De;return De=this.uniformLocation(we),De&&this.gl.uniform2f(De,Pe,Fe),this},Re.prototype.vec3=function(we,Pe,Fe){var Ie;return Ie=this.uniformLocation(we),Ie&&this.gl.uniform3f(Ie,Pe,Fe,f),this},Re.prototype.mat4=function(we,Pe){var Fe;return Fe=this.uniformLocation(we),Fe&&(Pe instanceof pe?this.gl.uniformMatrix4fv(Fe,this.gl.FALSE,Pe.data):this.gl.uniformMatrix4fv(Fe,this.gl.FALSE,Pe)),this},Re.prototype.mat3=function(we,Pe){var Fe;return Fe=this.uniformLocation(we),Fe&&(Pe instanceof le?this.gl.uniformMatrix3fv(Fe,this.gl.FALSE,Pe.data):this.gl.uniformMatrix3fv(Fe,this.gl.FALSE,Pe)),this},Re.prototype.float=function(we,Pe){var Fe;return Fe=this.uniformLocation(we),Fe&&this.gl.uniform1f(Fe,Pe),this},Re}(),ne=function(){function Re(we,Pe){var Fe,De,Ie,Be,Ue;for(this.framework=we,this.pointers=Pe.pointers,Ue=Pe.vertices,this.mode=Pe.mode,this.gl=this.framework.gl,this.buffer=this.gl.createBuffer(),null==this.mode&&(this.mode=this.gl.TRIANGLES),this.vertexSize=0,Be=this.pointers,(Fe=0,De=Be.length);Fe<De;Fe++)Ie=Be[Fe],this.vertexSize+=Ie.size;this.upload(Ue)}var Ce;return Ce=Float32Array.BYTES_PER_ELEMENT,Re.prototype.upload=function(we){var Pe;return Pe=we instanceof Array?new Float32Array(we):we,this.size=Pe.length/this.vertexSize,this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,Pe,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)},Re.prototype.setPointer=function(we,Pe,Fe){var De,Ie;return De=we.attributeLocation(Pe.name),0<=De&&(Ie=this.framework.vertexUnits[De],!Ie.enabled&&(Ie.enabled=!0,this.gl.enableVertexAttribArray(De)),(Ie.drawable!==this||Ie.idx!==Fe)&&(Ie.idx=Fe,Ie.drawable=this,this.gl.vertexAttribPointer(De,Pe.size,this.gl.FLOAT,!1,Pe.stride*Ce,Pe.offset*Ce))),this},Re.prototype.setPointersForShader=function(we){var Pe,Fe,De,Ie,Be;for(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer),Be=this.pointers,(Pe=Fe=0,De=Be.length);Fe<De;Pe=++Fe)Ie=Be[Pe],this.setPointer(we,Ie,Pe);return this},Re.prototype.draw=function(we,Pe,Fe){return null==we&&(we=0),null==Pe&&(Pe=this.size),null==Fe&&(Fe=this.mode),this.gl.drawArrays(Fe,we,Pe),this},Re}(),ge=function(){function Re(Ce,we){var Pe,Fe;this.framework=Ce,null==we&&(we={}),this.gl=this.framework.gl,this.channels=this.gl[(null==(Pe=we.channels)?'rgb':Pe).toUpperCase()],this.type='number'==typeof we.type?we.type:this.gl[(null==(Fe=we.type)?'unsigned_byte':Fe).toUpperCase()],this.target=this.gl.TEXTURE_2D,this.handle=this.gl.createTexture()}return Re.prototype.destroy=function(){return this.gl.deleteTexture(this.handle)},Re.prototype.bind=function(Ce){if(null==Ce&&(Ce=0),15<Ce)throw'Texture unit too large: '+Ce;return this.gl.activeTexture(this.gl.TEXTURE0+Ce),this.gl.bindTexture(this.target,this.handle),this},Re.prototype.setSize=function(Ce,we){return this.width=Ce,this.height=we,this.gl.texImage2D(this.target,0,this.channels,this.width,this.height,0,this.channels,this.type,null),this},Re.prototype.linear=function(){return this.gl.texParameteri(this.target,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.target,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this},Re.prototype.nearest=function(){return this.gl.texParameteri(this.target,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.target,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this},Re.prototype.clampToEdge=function(){return this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this},Re.prototype.repeat=function(){return this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this},Re}(),se=function(){function Re(Ce){this.framework=Ce,this.gl=this.framework.gl,this.buffer=this.gl.createFramebuffer(),this.ownDepth=!1}return Re.prototype.destroy=function(){return this.gl.deleteFRamebuffer(this.buffer)},Re.prototype.bind=function(){return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.buffer),this},Re.prototype.unbind=function(){return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this},Re.prototype.check=function(){var Ce;switch(Ce=this.gl.checkFramebufferStatus(this.gl.FRAMEBUFFER),Ce){case this.gl.FRAMEBUFFER_UNSUPPORTED:throw'Framebuffer is unsupported';break;case this.gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw'Framebuffer incomplete attachment';break;case this.gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw'Framebuffer incomplete dimensions';break;case this.gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw'Framebuffer incomplete missing attachment';}return this},Re.prototype.color=function(Ce){return this.colorTexture=Ce,this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.colorTexture.target,this.colorTexture.handle,0),this.check(),this},Re.prototype.depth=function(Ce){if(this.depthBuffer=Ce,void 0===this.depthBuffer)if(void 0===this.colorTexture)throw'Cannot create implicit depth buffer without a color texture';else this.ownDepth=!0,this.depthBuffer=this.framework.depthbuffer().bind().setSize(this.colorTexture.width,this.colorTexture.height);return this.gl.framebufferRenderbuffer(this.gl.FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.RENDERBUFFER,this.depthBuffer.id),this.check(),this},Re.prototype.destroy=function(){if(this.gl.deleteFramebuffer(this.buffer),this.ownDepth)return this.depthBuffer.destroy()},Re}(),ue=function(){function Re(Ce){this.framework=Ce,this.gl=this.framework.gl,this.id=this.gl.createRenderbuffer()}return Re.prototype.bind=function(){return this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,this.id),this},Re.prototype.setSize=function(Ce,we){return this.width=Ce,this.height=we,this.bind(),this.gl.renderbufferStorage(this.gl.RENDERBUFFER,this.gl[this.format],this.width,this.height),this.unbind()},Re.prototype.unbind=function(){return this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,null),this},Re.prototype.destroy=function(){return this.gl.deleteRenderbuffer(this.id)},Re}(),ie=function(Re){function Ce(){return Ce.__super__.constructor.apply(this,arguments)}return Me(Ce,Re),Ce.prototype.format='DEPTH_COMPONENT16',Ce}(ue),window.raf=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame,window.caf=window.cancelAnimationFrame||window.mozcancelAnimationFrame||window.webkitcancelAnimationFrame||window.ocancelAnimationFrame,window.performance.now=performance.now||performance.mozNow||performance.webkitNow||performance.oNow||Date.now,window.WebGLFramework=he=function(){function Re(Ce,we){var Pe,Fe,Ie,Be;this.canvas=Ce,this.animationInterval=Le(this.animationInterval,this);try{if(this.gl=this.canvas.getContext('webgl',we),null===this.gl&&(this.gl=this.canvas.getContext('experimental-webgl',we),null===this.gl))throw'WebGL not supported'}catch(Ue){throw Fe=Ue,'WebGL not supported'}for(this.textureUnits=[],Pe=Ie=0;16>Ie;Pe=++Ie)this.textureUnits.push(null);for(this.vertexUnits=[],Pe=Be=0;16>Be;Pe=++Be)this.vertexUnits.push({enabled:!1,drawable:null,idx:null});this.currentShader=null}return Re.prototype.shader=function(Ce){return new fe(this,Ce)},Re.prototype.drawable=function(Ce){return new ne(this,Ce)},Re.prototype.texture=function(Ce){return new ge(this,Ce)},Re.prototype.framebuffer=function(){return new se(this)},Re.prototype.depthbuffer=function(){return new ie(this)},Re.prototype.mat3=function(Ce){return new le(Ce)},Re.prototype.mat4=function(Ce){return new pe(Ce)},Re.prototype.clearColor=function(Ce,we,Pe,Fe){return null==Ce&&(Ce=0),null==we&&(we=0),null==Pe&&(Pe=0),null==Fe&&(Fe=1),this.gl.clearColor(Ce,we,Pe,Fe),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this},Re.prototype.clearDepth=function(Ce){return null==Ce&&(Ce=1),this.gl.clearDepth(Ce),this.gl.clear(this.gl.DEPTH_BUFFER_BIT),this},Re.prototype.adjustSize=function(){var Ce,we;return we=this.canvas.width,Ce=this.canvas.height,(this.width!==we||this.height!==Ce)&&(this.canvas.width=we,this.canvas.height=Ce,this.width=we,this.height=Ce,this.aspect=this.width/this.height),this},Re.prototype.viewport=function(Ce,we,Pe,Fe){return null==Ce&&(Ce=0),null==we&&(we=0),null==Pe&&(Pe=this.width),null==Fe&&(Fe=this.height),this.gl.viewport(Ce,we,Pe,Fe),this},Re.prototype.depthTest=function(Ce){return null==Ce&&(Ce=!0),Ce?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this},Re.prototype.animationInterval=function(Ce){var we;return we=function(){var Fe;if(Fe=raf(we),Ce)return Ce(Fe)},raf(we)},Re.prototype.now=function(){return performance.now()/1e3},Re.prototype.getExt=function(Ce,we){var Pe;if(null==we&&(we=!0),Pe=this.gl.getExtension(Ce),!Pe&&we)throw'WebGL Extension not supported: '+Ce;return Pe},Re.prototype.requestFullscreen=function(Ce){return null==Ce&&(Ce=this.canvas),Ce.mozRequestFullScreen?Ce.mozRequestFullScreen():Ce.webkitRequestFullScreen?Ce.webkitRequestFullScreen():Ce.oRequestFullScreen&&Ce.oRequestFullScreen(),this},Re.prototype.isFullscreen=function(){var Ce,we;return Ce=_e(document,'fullscreenElement'),we=_e(document,'fullScreenElement'),Ce||we},Re.prototype.onFullscreenChange=function(Ce){var we,Pe,Fe,De;for(we=function(Ie){return function(){return Ce(Ie.isFullscreen())}}(this),Pe=0,Fe=Se.length;Pe<Fe;Pe++)De=Se[Pe],document.addEventListener(De+'fullscreenchange',we,!1);return this},Re.prototype.exitFullscreen=function(){return document.cancelFullscreen(),this},Re.prototype.toggleFullscreen=function(Ce){return null==Ce&&(Ce=this.canvas),this.isFullscreen()?this.exitFullscreen():this.requestFullscreen(Ce)},Re.prototype.getFloatExtension=function(Ce){return this.gl.getFloatExtension(Ce)},Re.prototype.cullFace=function(Ce){return null==Ce&&(Ce='back'),Ce?(this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl[Ce.toUpperCase()])):this.gl.disable(this.gl.CULL_FACE),this},Re.prototype.getContext=function(){return this.gl},Re}(),Se=[null,'webkit','apple','moz','o','xv','ms','khtml','atsc','wap','prince','ah','hp','ro','rim','tc'],Te=function(Ce,we){return null===we?Ce:we+Ce[0].toUpperCase()+Ce.substr(1)},_e=function(Ce,we,Pe){var Fe,De,Ie,Be,Ue;if(Ce)for(Ie=0,Be=Se.length;Ie<Be;Ie++)if(Ue=Se[Ie],De=Te(we,Ue),Fe=Ce[De],void 0!==Fe)return Fe;return Pe},document.fullscreenEnabled=_e(document,'fullscreenEnabled'),document.cancelFullscreen=_e(document,'cancelFullScreen')}).call(this)},function(){(function(){var ie;ie=[{name:'position',size:3,offset:0,stride:6},{name:'normal',size:3,offset:3,stride:6}],window.meshes={quad:{pointers:[{name:'position',size:2,offset:0,stride:2}],vertices:[-1,-1,1,-1,1,1,-1,1,-1,-1,1,1]},plane:function(se){return{pointers:ie,vertices:[-se,0,-se,0,1,0,-se,0,se,0,1,0,se,0,se,0,1,0,se,0,-se,0,1,0,-se,0,-se,0,1,0,se,0,se,0,1,0]}},cube:{pointers:ie,vertices:[-1,-1,-1,0,0,-1,-1,1,-1,0,0,-1,1,1,-1,0,0,-1,1,-1,-1,0,0,-1,-1,-1,-1,0,0,-1,1,1,-1,0,0,-1,1,1,1,0,0,1,-1,1,1,0,0,1,-1,-1,1,0,0,1,1,1,1,0,0,1,-1,-1,1,0,0,1,1,-1,1,0,0,1,-1,1,-1,0,1,0,-1,1,1,0,1,0,1,1,1,0,1,0,1,1,-1,0,1,0,-1,1,-1,0,1,0,1,1,1,0,1,0,1,-1,1,0,-1,0,-1,-1,1,0,-1,0,-1,-1,-1,0,-1,0,1,-1,1,0,-1,0,-1,-1,-1,0,-1,0,1,-1,-1,0,-1,0,-1,-1,-1,-1,0,0,-1,-1,1,-1,0,0,-1,1,1,-1,0,0,-1,1,-1,-1,0,0,-1,-1,-1,-1,0,0,-1,1,1,-1,0,0,1,1,1,1,0,0,1,-1,1,1,0,0,1,-1,-1,1,0,0,1,1,1,1,0,0,1,-1,-1,1,0,0,1,1,-1,1,0,0]}}}).call(this)},function(){(function(){var Te=[].indexOf||function(Se){for(var Me=0,Ae=this.length;Me<Ae;Me++)if(Me in this&&this[Me]===Se)return Me;return-1},ie,ne,se,le,pe,ue,fe,ge,he,ye,xe,_e,ve,Ee;if(pe=function(){var Me,Ae,Le;return Me=document.createElement('canvas'),Me.width=2,Me.height=2,Ae=Me.getContext('2d'),Le=Ae.getImageData(0,0,2,2),Le.data.set(new Uint8ClampedArray([0,0,0,0,255,255,255,255,0,0,0,0,255,255,255,255])),Ae.putImageData(Le,0,0),Me},pe(),ne=function(Me,Ae){var Le,Re,Ce,we,Pe,Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze;if(Fe=Me.createProgram(),Ve=Me.createShader(Me.VERTEX_SHADER),Me.attachShader(Fe,Ve),Me.shaderSource(Ve,'attribute vec2 position;\nvoid main(){\n    gl_Position = vec4(position, 0.0, 1.0);\n}'),Me.compileShader(Ve),!Me.getShaderParameter(Ve,Me.COMPILE_STATUS))throw Me.getShaderInfoLog(Ve);if(Ce=Me.createShader(Me.FRAGMENT_SHADER),Me.attachShader(Fe,Ce),Me.shaderSource(Ce,'uniform sampler2D source;\nvoid main(){\n    gl_FragColor = texture2D(source, vec2(1.0, 1.0));\n}'),Me.compileShader(Ce),!Me.getShaderParameter(Ce,Me.COMPILE_STATUS))throw Me.getShaderInfoLog(Ce);if(Me.linkProgram(Fe),!Me.getProgramParameter(Fe,Me.LINK_STATUS))throw Me.getProgramInfoLog(Fe);return Me.useProgram(Fe),Re=function(){return Me.deleteShader(Ce),Me.deleteShader(Ve),Me.deleteProgram(Fe),Me.deleteBuffer(Le),Me.deleteTexture(Be),Me.deleteTexture(Ge),Me.deleteFramebuffer(we),Me.bindBuffer(Me.ARRAY_BUFFER,null),Me.useProgram(null),Me.bindTexture(Me.TEXTURE_2D,null),Me.bindFramebuffer(Me.FRAMEBUFFER,null)},Ge=Me.createTexture(),Me.bindTexture(Me.TEXTURE_2D,Ge),Me.texImage2D(Me.TEXTURE_2D,0,Me.RGBA,2,2,0,Me.RGBA,Me.UNSIGNED_BYTE,null),Me.texParameteri(Me.TEXTURE_2D,Me.TEXTURE_MAG_FILTER,Me.LINEAR),Me.texParameteri(Me.TEXTURE_2D,Me.TEXTURE_MIN_FILTER,Me.LINEAR),we=Me.createFramebuffer(),Me.bindFramebuffer(Me.FRAMEBUFFER,we),Me.framebufferTexture2D(Me.FRAMEBUFFER,Me.COLOR_ATTACHMENT0,Me.TEXTURE_2D,Ge,0),Ue=pe(),Be=Me.createTexture(),Me.bindTexture(Me.TEXTURE_2D,Be),Me.texImage2D(Me.TEXTURE_2D,0,Me.RGBA,Me.RGBA,Ae,Ue),Me.texParameteri(Me.TEXTURE_2D,Me.TEXTURE_MAG_FILTER,Me.LINEAR),Me.texParameteri(Me.TEXTURE_2D,Me.TEXTURE_MIN_FILTER,Me.LINEAR),ze=new Float32Array([1,1,-1,1,-1,-1,1,1,-1,-1,1,-1]),Le=Me.createBuffer(),Me.bindBuffer(Me.ARRAY_BUFFER,Le),Me.bufferData(Me.ARRAY_BUFFER,ze,Me.STATIC_DRAW),Pe=Me.getAttribLocation(Fe,'position'),Ne=Me.getUniformLocation(Fe,'source'),Me.enableVertexAttribArray(Pe),Me.vertexAttribPointer(Pe,2,Me.FLOAT,!1,0,0),Me.uniform1i(Ne,0),Me.drawArrays(Me.TRIANGLES,0,6),De=new Uint8Array(16),Me.readPixels(0,0,2,2,Me.RGBA,Me.UNSIGNED_BYTE,De),Ie=10>Math.abs(De[0]-127),Re(),Ie},le=function(Me,Ae){var Le;return Le=Me.createTexture(),Me.bindTexture(Me.TEXTURE_2D,Le),Me.texImage2D(Me.TEXTURE_2D,0,Me.RGBA,2,2,0,Me.RGBA,Ae,null),0===Me.getError()?(Me.deleteTexture(Le),!0):(Me.deleteTexture(Le),!1)},ie=function(Me,Ae){var Le,Re,Ce;return Ce=Me.createTexture(),Me.bindTexture(Me.TEXTURE_2D,Ce),Me.texImage2D(Me.TEXTURE_2D,0,Me.RGBA,2,2,0,Me.RGBA,Ae,null),Re=Me.createFramebuffer(),Me.bindFramebuffer(Me.FRAMEBUFFER,Re),Me.framebufferTexture2D(Me.FRAMEBUFFER,Me.COLOR_ATTACHMENT0,Me.TEXTURE_2D,Ce,0),Le=Me.checkFramebufferStatus(Me.FRAMEBUFFER),Me.deleteTexture(Ce),Me.deleteFramebuffer(Re),Me.bindTexture(Me.TEXTURE_2D,null),Me.bindFramebuffer(Me.FRAMEBUFFER,null),Le===Me.FRAMEBUFFER_COMPLETE},xe=[],_e={},ve=[],se=function(){var Me,Ae,Le,Re,Ce,we,Pe;Me=document.createElement('canvas'),Le=null;try{Le=Me.getContext('experimental-webgl'),null===Le&&(Le=Me.getContext('webgl'))}catch(Fe){}if(null!=Le&&(we=Le.getExtension('OES_texture_float'),null===we?le(Le,Le.FLOAT)?(Pe=!0,xe.push('OES_texture_float'),_e.OES_texture_float={shim:!0}):(Pe=!1,ve.push('OES_texture_float')):le(Le,Le.FLOAT)?(Pe=!0,xe.push('OES_texture_float')):(Pe=!1,ve.push('OES_texture_float')),Pe&&(Ae=Le.getExtension('WEBGL_color_buffer_float'),null===Ae?ie(Le,Le.FLOAT)?(xe.push('WEBGL_color_buffer_float'),_e.WEBGL_color_buffer_float={shim:!0,RGBA32F_EXT:34836,RGB32F_EXT:34837,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863}):ve.push('WEBGL_color_buffer_float'):ie(Le,Le.FLOAT)?xe.push('WEBGL_color_buffer_float'):ve.push('WEBGL_color_buffer_float'),Ae=Le.getExtension('OES_texture_float_linear'),null===Ae?ne(Le,Le.FLOAT)?(xe.push('OES_texture_float_linear'),_e.OES_texture_float_linear={shim:!0}):ve.push('OES_texture_float_linear'):ne(Le,Le.FLOAT)?xe.push('OES_texture_float_linear'):ve.push('OES_texture_float_linear')),Re=Le.getExtension('OES_texture_half_float'),null===Re?le(Le,36193)?(Ce=!0,xe.push('OES_texture_half_float'),Re=_e.OES_texture_half_float={HALF_FLOAT_OES:36193,shim:!0}):(Ce=!1,ve.push('OES_texture_half_float')):le(Le,Re.HALF_FLOAT_OES)?(Ce=!0,xe.push('OES_texture_half_float')):(Ce=!1,ve.push('OES_texture_half_float')),Ce))return Ae=Le.getExtension('EXT_color_buffer_half_float'),null===Ae?ie(Le,Re.HALF_FLOAT_OES)?(xe.push('EXT_color_buffer_half_float'),_e.EXT_color_buffer_half_float={shim:!0,RGBA16F_EXT:34842,RGB16F_EXT:34843,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863}):ve.push('EXT_color_buffer_half_float'):ie(Le,Re.HALF_FLOAT_OES)?xe.push('EXT_color_buffer_half_float'):ve.push('EXT_color_buffer_half_float'),Ae=Le.getExtension('OES_texture_half_float_linear'),null===Ae?ne(Le,Re.HALF_FLOAT_OES)?(xe.push('OES_texture_half_float_linear'),_e.OES_texture_half_float_linear={shim:!0}):ve.push('OES_texture_half_float_linear'):ne(Le,Re.HALF_FLOAT_OES)?xe.push('OES_texture_half_float_linear'):ve.push('OES_texture_half_float_linear')},null!=window.WebGLRenderingContext){for(se(),Ee={},(ge=0,he=ve.length);ge<he;ge++)ye=ve[ge],Ee[ye]=!0;ue=WebGLRenderingContext.prototype.getExtension,WebGLRenderingContext.prototype.getExtension=function(Se){var Me;return Me=_e[Se],void 0===Me?Ee[Se]?null:ue.call(this,Se):Me},fe=WebGLRenderingContext.prototype.getSupportedExtensions,WebGLRenderingContext.prototype.getSupportedExtensions=function(){var Se,Me,Ae,Le,Re,Ce,we;for(we=fe.call(this),Ce=[],(Me=0,Le=we.length);Me<Le;Me++)Se=we[Me],void 0===Ee[Se]&&Ce.push(Se);for(Ae=0,Re=xe.length;Ae<Re;Ae++)Se=xe[Ae],0>Te.call(Ce,Se)&&Ce.push(Se);return Ce},WebGLRenderingContext.prototype.getFloatExtension=function(Se){var Me,Ae,Le,Re,Ce,we,Pe,Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe,ke,He,We,je,Xe,qe,Ye,Ze,Ke;for(null==Se.prefer&&(Se.prefer=['half']),null==Se.require&&(Se.require=[]),null==Se.throws&&(Se.throws=!0),Ze=this.getExtension('OES_texture_float'),we=this.getExtension('OES_texture_half_float'),qe=this.getExtension('WEBGL_color_buffer_float'),Re=this.getExtension('EXT_color_buffer_half_float'),Ye=this.getExtension('OES_texture_float_linear'),Ce=this.getExtension('OES_texture_half_float_linear'),Xe={texture:null!==Ze,filterable:null!==Ye,renderable:null!==qe,score:0,precision:'single',half:!1,single:!0,type:this.FLOAT},Le={texture:null!==we,filterable:null!==Ce,renderable:null!==Re,score:0,precision:'half',half:!0,single:!1,type:null==(ke=null==we?void 0:we.HALF_FLOAT_OES)?null:ke},Ae=[],Xe.texture&&Ae.push(Xe),Le.texture&&Ae.push(Le),je=[],(De=0,Be=Ae.length);De<Be;De++){for(Me=Ae[De],Ke=!0,He=Se.require,(Ie=0,Ue=He.length);Ie<Ue;Ie++)ye=He[Ie],!1===Me[ye]&&(Ke=!1);Ke&&je.push(Me)}for(Ve=0,Ne=je.length;Ve<Ne;Ve++)for(Me=je[Ve],We=Se.prefer,(Pe=ze=0,Ge=We.length);ze<Ge;Pe=++ze)Oe=We[Pe],Fe=Math.pow(2,Se.prefer.length-Pe-1),Me[Oe]&&(Me.score+=Fe);if(je.sort(function(Qe,Je){return Qe.score===Je.score?0:Qe.score<Je.score?1:Qe.score>Je.score?-1:void 0}),0!==je.length)return je=je[0],{filterable:je.filterable,renderable:je.renderable,type:je.type,precision:je.precision};if(Se.throws)throw'No floating point texture support that is '+Se.require.join(', ');else return null}}}).call(this)},function(){(function(){var pe=[].indexOf||function(ue){for(var fe=0,ge=this.length;fe<ge;fe++)if(fe in this&&this[fe]===ue)return fe;return-1},ie,ne,se,le;null!=window.WebGLRenderingContext&&(le=['WEBKIT','MOZ','MS','O'],se=/^WEBKIT_(.*)|MOZ_(.*)|MS_(.*)|O_(.*)/,ie=WebGLRenderingContext.prototype.getExtension,WebGLRenderingContext.prototype.getExtension=function(ue){var fe,ge,he,ye,xe;if(ye=ue.match(se),null!==ye&&(ue=ye[1]),fe=ie.call(this,ue),null===fe){for(ge=0,he=le.length;ge<he;ge++)if(xe=le[ge],fe=ie.call(this,xe+'_'+ue),null!==fe)return fe;return null}return fe},ne=WebGLRenderingContext.prototype.getSupportedExtensions,WebGLRenderingContext.prototype.getSupportedExtensions=function(){var ue,fe,ge,he,ye,xe;for(xe=ne.call(this),ye=[],(fe=0,ge=xe.length);fe<ge;fe++)ue=xe[fe],he=ue.match(se),null!==he&&(ue=he[1]),0>pe.call(ye,ue)&&ye.push(ue);return ye})}).call(this)},function(){(function(){var ie;window.ShadowTest=ie=function(){function ne(){this.id=sender.getID()}return ne.prototype.begin=function(se,le){var pe,ue,fe,ge,he,ye,xe,_e,ve,Ee,Te,Se,Me,Ae,Le,Re,Ce,we,Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe,ke,He;this.cb=le;try{De=new WebGLFramework(se,{antialias:!1,preserveDrawingBuffer:!0,willReadFrequently:!1,depth:!0}).depthTest(),Fe=De.getFloatExtension({require:['renderable','filterable'],prefer:['single','half']}),De.getExt('OES_standard_derivatives')}catch(We){return we=We,void console.log(we)}return ve=De.drawable(meshes.cube),ke=De.drawable(meshes.plane(50)),He=De.drawable(meshes.quad),Te=De.shader({common:'//essl\nvarying vec3 vWorldNormal; varying vec4 vWorldPosition;\nuniform mat4 camProj, camView;\nuniform mat4 lightProj, lightView; uniform mat3 lightRot;\nuniform mat4 model;',vertex:'//essl\nattribute vec3 position, normal;\n\nvoid main(){\n    vWorldNormal = normal;\n    vWorldPosition = model * vec4(position, 1.0);\n    gl_Position = camProj * camView * vWorldPosition;\n}',fragment:'//essl\nuniform sampler2D sLightDepth;\n\nfloat linstep(float low, float high, float v){\n    return clamp((v-low)/(high-low), 0.0, 1.0);\n}\n\nfloat VSM(sampler2D depths, vec2 uv, float compare){\n    vec2 moments = texture2D(depths, uv).xy;\n    float p = smoothstep(compare-0.02, compare, moments.x);\n    float variance = max(moments.y - moments.x*moments.x, -0.001);\n    float d = compare - moments.x;\n    float p_max = linstep(0.2, 1.0, variance / (variance + d*d));\n    return clamp(max(p, p_max), 0.0, 1.0);\n}\n\nfloat attenuation(vec3 dir){\n    float dist = length(dir);\n    float radiance = 1.0/(1.0+pow(dist/10.0, 2.0));\n    return clamp(radiance*10.0, 0.0, 1.0);\n}\n\nfloat influence(vec3 normal, float coneAngle){\n    float minConeAngle = ((360.0-coneAngle-10.0)/360.0)*PI;\n    float maxConeAngle = ((360.0-coneAngle)/360.0)*PI;\n    return smoothstep(minConeAngle, maxConeAngle, acos(normal.z));\n}\n\nfloat lambert(vec3 surfaceNormal, vec3 lightDirNormal){\n    return max(0.0, dot(surfaceNormal, lightDirNormal));\n}\n\nvec3 skyLight(vec3 normal){\n    return vec3(smoothstep(0.0, PI, PI-acos(normal.y)))*0.4;\n}\n\nvec3 gamma(vec3 color){\n    return pow(color, vec3(2.2));\n}\n\nvoid main(){\n    vec3 worldNormal = normalize(vWorldNormal);\n\n    vec3 camPos = (camView * vWorldPosition).xyz;\n    vec3 lightPos = (lightView * vWorldPosition).xyz;\n    vec3 lightPosNormal = normalize(lightPos);\n    vec3 lightSurfaceNormal = lightRot * worldNormal;\n    vec4 lightDevice = lightProj * vec4(lightPos, 1.0);\n    vec2 lightDeviceNormal = lightDevice.xy/lightDevice.w;\n    vec2 lightUV = lightDeviceNormal*0.5+0.5;\n\n    // shadow calculation\n    float lightDepth2 = clamp(length(lightPos)/40.0, 0.0, 1.0);\n    float illuminated = VSM(sLightDepth, lightUV, lightDepth2);\n\n    vec3 excident = (\n        skyLight(worldNormal) +\n        lambert(lightSurfaceNormal, -lightPosNormal) *\n        influence(lightPosNormal, 55.0) *\n        attenuation(lightPos) *\n        illuminated\n    );\n    gl_FragColor = vec4(gamma(excident), 1.0);\n}'}),Ge=De.shader({common:'//essl\nvarying vec3 vWorldNormal; varying vec4 vWorldPosition;\nuniform mat4 lightProj, lightView; uniform mat3 lightRot;\nuniform mat4 model;',vertex:'//essl\nattribute vec3 position, normal;\n\nvoid main(){\n    vWorldNormal = normal;\n    vWorldPosition = model * vec4(position, 1.0);\n    gl_Position = lightProj * lightView * vWorldPosition;\n}',fragment:'//essl\n#extension GL_OES_standard_derivatives : enable\nvoid main(){\n    vec3 worldNormal = normalize(vWorldNormal);\n    vec3 lightPos = (lightView * vWorldPosition).xyz;\n    float depth = clamp(length(lightPos)/40.0, 0.0, 1.0);\n    float dx = dFdx(depth);\n    float dy = dFdy(depth);\n    gl_FragColor = vec4(depth, pow(depth, 2.0) + 0.25*(dx*dx + dy*dy), 0.0, 1.0);\n}'}),Ie=De.texture({type:Fe.type,channels:'rgba'}).bind().setSize(1024,1024).linear().clampToEdge(),Be=De.framebuffer().bind().color(Ie).depth().unbind(),pe=function(){function We(je,Xe){this.size=je,this.output=De.texture({type:Fe.type,channels:'rgba'}).bind().setSize(this.size,this.size).linear().clampToEdge(),this.framebuffer=De.framebuffer().bind().color(this.output).unbind(),this.shader=De.shader({common:'//essl\nvarying vec2 texcoord;',vertex:'//essl\nattribute vec2 position;\n\nvoid main(){\n    texcoord = position*0.5+0.5;\n    gl_Position = vec4(position, 0.0, 1.0);\n}',fragment:'//essl\nuniform vec2 viewport;\nuniform sampler2D source;\n\nvec3 get(float x, float y){\n    vec2 off = vec2(x, y);\n    return texture2D(source, texcoord+off/viewport).rgb;\n}\nvec3 get(int x, int y){\n    vec2 off = vec2(x, y);\n    return texture2D(source, texcoord+off/viewport).rgb;\n}\nvec3 filter(){\n    '+Xe+'\n}\nvoid main(){\n    gl_FragColor = vec4(filter(), 1.0);\n}'})}return We.prototype.bind=function(je){return this.output.bind(je)},We.prototype.apply=function(je){return this.framebuffer.bind(),De.viewport(0,0,this.size,this.size),this.shader.use().vec2('viewport',this.size,this.size).sampler('source',je).draw(He),this.framebuffer.unbind()},We}(),Me=new pe(512,'//essl\nreturn get(0.0, 0.0);'),Se=new pe(256,'//essl\nreturn get(0.0, 0.0);'),ue=new pe(256,'//essl\nvec3 result = vec3(0.0);\nfor(int x=-1; x<=1; x++){\n    for(int y=-1; y<=1; y++){\n        result += get(x,y);\n    }\n}\nreturn result/9.0;'),he=De.mat4(),xe=De.mat4(),Ue=De.mat4().perspective({fov:60},1,{near:0.01,far:100}),Ve=De.mat4().trans(0,0,-6).rotatex(30).rotatey(110),Ne=De.mat3().fromMat4Rot(Ve),ze=De.mat4(),_e=0.1*-Math.PI,Oe=0,fe=10,ye=55,ge=41,Ee=0,Ce=function(je){return je.mat4('model',ze.ident().trans(0,0,0)).draw(ke).mat4('model',ze.ident().trans(0,1+Oe,0)).draw(ve).mat4('model',ze.ident().trans(5,1,-1)).draw(ve)},Re=function(){return Be.bind(),De.viewport(0,0,Ie.width,Ie.height).clearColor(1,1,1,1).clearDepth(1).cullFace('back'),Ge.use().mat4('lightView',Ve).mat4('lightProj',Ue).mat3('lightRot',Ne),Ce(Ge),Be.unbind(),Me.apply(Ie),Se.apply(Me),ue.apply(Se)},Le=function(){return De.adjustSize().viewport().cullFace('back').clearColor(0,0,0,0).clearDepth(1),he.perspective({fov:60,aspect:De.aspect,near:0.01,far:100}),xe.ident().trans(0,-1,-fe).rotatex(ge).rotatey(ye),Te.use().mat4('camProj',he).mat4('camView',xe).mat4('lightView',Ve).mat4('lightProj',Ue).mat3('lightRot',Ne).sampler('sLightDepth',ue),Ce(Te)},Ae=function(){return Re(),Le()},Ae(),De.animationInterval(function(We){return function(je){if(Oe=1+Math.sin(_e),_e+=1/10,Ae(),5==Ee++)return caf(je),sender.getData(De.getContext(),se,We.id),We.cb()}}(this))},ne}()}).call(this)},function(ee,oe,ie){var ne,se,le=Object.assign||function(ue){for(var fe=1,ge;fe<arguments.length;fe++)for(var he in ge=arguments[fe],ge)Object.prototype.hasOwnProperty.call(ge,he)&&(ue[he]=ge[he]);return ue},pe={REVISION:'78'};(ne=pe,se='function'==typeof ne?ne.call(oe,ie,oe,ee):ne,!(se!==void 0&&(ee.exports=se))),Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Math.sign===void 0&&(Math.sign=function(ue){return 0>ue?-1:0<ue?1:+ue}),Function.prototype.name===void 0&&Object.defineProperty(Function.prototype,'name',{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}}),Object.assign===void 0&&function(){Object.assign=function(ue){'use strict';if(ue===void 0||null===ue)throw new TypeError('Cannot convert undefined or null to object');for(var fe=Object(ue),ge=1,he;ge<arguments.length;ge++)if(he=arguments[ge],void 0!==he&&null!==he)for(var ye in he)Object.prototype.hasOwnProperty.call(he,ye)&&(fe[ye]=he[ye]);return fe}}(),le(pe,{MOUSE:{LEFT:0,MIDDLE:1,RIGHT:2},CullFaceNone:0,CullFaceBack:1,CullFaceFront:2,CullFaceFrontBack:3,FrontFaceDirectionCW:0,FrontFaceDirectionCCW:1,BasicShadowMap:0,PCFShadowMap:1,PCFSoftShadowMap:2,FrontSide:0,BackSide:1,DoubleSide:2,FlatShading:1,SmoothShading:2,NoColors:0,FaceColors:1,VertexColors:2,NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5,AddEquation:100,SubtractEquation:101,ReverseSubtractEquation:102,MinEquation:103,MaxEquation:104,ZeroFactor:200,OneFactor:201,SrcColorFactor:202,OneMinusSrcColorFactor:203,SrcAlphaFactor:204,OneMinusSrcAlphaFactor:205,DstAlphaFactor:206,OneMinusDstAlphaFactor:207,DstColorFactor:208,OneMinusDstColorFactor:209,SrcAlphaSaturateFactor:210,NeverDepth:0,AlwaysDepth:1,LessDepth:2,LessEqualDepth:3,EqualDepth:4,GreaterEqualDepth:5,GreaterDepth:6,NotEqualDepth:7,MultiplyOperation:0,MixOperation:1,AddOperation:2,NoToneMapping:0,LinearToneMapping:1,ReinhardToneMapping:2,Uncharted2ToneMapping:3,CineonToneMapping:4,UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307,RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002,NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008,UnsignedByteType:1009,ByteType:1010,ShortType:1011,UnsignedShortType:1012,IntType:1013,UnsignedIntType:1014,FloatType:1015,HalfFloatType:1025,UnsignedShort4444Type:1016,UnsignedShort5551Type:1017,UnsignedShort565Type:1018,AlphaFormat:1019,RGBFormat:1020,RGBAFormat:1021,LuminanceFormat:1022,LuminanceAlphaFormat:1023,RGBEFormat:pe.RGBAFormat,DepthFormat:1026,RGB_S3TC_DXT1_Format:2001,RGBA_S3TC_DXT1_Format:2002,RGBA_S3TC_DXT3_Format:2003,RGBA_S3TC_DXT5_Format:2004,RGB_PVRTC_4BPPV1_Format:2100,RGB_PVRTC_2BPPV1_Format:2101,RGBA_PVRTC_4BPPV1_Format:2102,RGBA_PVRTC_2BPPV1_Format:2103,RGB_ETC1_Format:2151,LoopOnce:2200,LoopRepeat:2201,LoopPingPong:2202,InterpolateDiscrete:2300,InterpolateLinear:2301,InterpolateSmooth:2302,ZeroCurvatureEnding:2400,ZeroSlopeEnding:2401,WrapAroundEnding:2402,TrianglesDrawMode:0,TriangleStripDrawMode:1,TriangleFanDrawMode:2,LinearEncoding:3e3,sRGBEncoding:3001,GammaEncoding:3007,RGBEEncoding:3002,LogLuvEncoding:3003,RGBM7Encoding:3004,RGBM16Encoding:3005,RGBDEncoding:3006,BasicDepthPacking:3200,RGBADepthPacking:3201}),pe.Color=function(ue,fe,ge){return void 0===fe&&void 0===ge?this.set(ue):this.setRGB(ue,fe,ge)},pe.Color.prototype={constructor:pe.Color,r:1,g:1,b:1,set:function(fe){return fe instanceof pe.Color?this.copy(fe):'number'==typeof fe?this.setHex(fe):'string'==typeof fe&&this.setStyle(fe),this},setScalar:function(fe){this.r=fe,this.g=fe,this.b=fe},setHex:function(fe){return fe=Math.floor(fe),this.r=(255&fe>>16)/255,this.g=(255&fe>>8)/255,this.b=(255&fe)/255,this},setRGB:function(fe,ge,he){return this.r=fe,this.g=ge,this.b=he,this},setHSL:function(){function ue(fe,ge,he){return 0>he&&(he+=1),1<he&&(he-=1),he<1/6?fe+6*(ge-fe)*he:he<1/2?ge:he<2/3?fe+6*(ge-fe)*(2/3-he):fe}return function(ge,he,ye){if(ge=pe.Math.euclideanModulo(ge,1),he=pe.Math.clamp(he,0,1),ye=pe.Math.clamp(ye,0,1),0===he)this.r=this.g=this.b=ye;else{var xe=0.5>=ye?ye*(1+he):ye+he-ye*he,_e=2*ye-xe;this.r=ue(_e,xe,ge+1/3),this.g=ue(_e,xe,ge),this.b=ue(_e,xe,ge-1/3)}return this}}(),setStyle:function(fe){function ge(Ae){void 0===Ae||1>parseFloat(Ae)&&console.warn('THREE.Color: Alpha component of '+fe+' will be ignored.')}var he;if(he=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(fe)){var ye,xe=he[1],_e=he[2];switch(xe){case'rgb':case'rgba':if(ye=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(_e))return this.r=Math.min(255,parseInt(ye[1],10))/255,this.g=Math.min(255,parseInt(ye[2],10))/255,this.b=Math.min(255,parseInt(ye[3],10))/255,ge(ye[5]),this;if(ye=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(_e))return this.r=Math.min(100,parseInt(ye[1],10))/100,this.g=Math.min(100,parseInt(ye[2],10))/100,this.b=Math.min(100,parseInt(ye[3],10))/100,ge(ye[5]),this;break;case'hsl':case'hsla':if(ye=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(_e)){var ve=parseFloat(ye[1])/360,Ee=parseInt(ye[2],10)/100,Te=parseInt(ye[3],10)/100;return ge(ye[5]),this.setHSL(ve,Ee,Te)}}}else if(he=/^\#([A-Fa-f0-9]+)$/.exec(fe)){var Se=he[1],Me=Se.length;if(3===Me)return this.r=parseInt(Se.charAt(0)+Se.charAt(0),16)/255,this.g=parseInt(Se.charAt(1)+Se.charAt(1),16)/255,this.b=parseInt(Se.charAt(2)+Se.charAt(2),16)/255,this;if(6===Me)return this.r=parseInt(Se.charAt(0)+Se.charAt(1),16)/255,this.g=parseInt(Se.charAt(2)+Se.charAt(3),16)/255,this.b=parseInt(Se.charAt(4)+Se.charAt(5),16)/255,this}if(fe&&0<fe.length){var Se=pe.ColorKeywords[fe];void 0===Se?console.warn('THREE.Color: Unknown color '+fe):this.setHex(Se)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(fe){return this.r=fe.r,this.g=fe.g,this.b=fe.b,this},copyGammaToLinear:function(fe,ge){return void 0===ge&&(ge=2),this.r=Math.pow(fe.r,ge),this.g=Math.pow(fe.g,ge),this.b=Math.pow(fe.b,ge),this},copyLinearToGamma:function(fe,ge){void 0===ge&&(ge=2);var he=0<ge?1/ge:1;return this.r=Math.pow(fe.r,he),this.g=Math.pow(fe.g,he),this.b=Math.pow(fe.b,he),this},convertGammaToLinear:function(){var fe=this.r,ge=this.g,he=this.b;return this.r=fe*fe,this.g=ge*ge,this.b=he*he,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return('000000'+this.getHex().toString(16)).slice(-6)},getHSL:function(fe){var ge=fe||{h:0,s:0,l:0},he=this.r,ye=this.g,xe=this.b,_e=Math.max(he,ye,xe),ve=Math.min(he,ye,xe),Se=(ve+_e)/2,Ee,Te;if(ve===_e)Ee=0,Te=0;else{var Me=_e-ve;Te=0.5>=Se?Me/(_e+ve):Me/(2-_e-ve),_e===he?Ee=(ye-xe)/Me+(ye<xe?6:0):_e===ye?Ee=(xe-he)/Me+2:_e===xe?Ee=(he-ye)/Me+4:void 0,Ee/=6}return ge.h=Ee,ge.s=Te,ge.l=Se,ge},getStyle:function(){return'rgb('+(0|255*this.r)+','+(0|255*this.g)+','+(0|255*this.b)+')'},offsetHSL:function(fe,ge,he){var ye=this.getHSL();return ye.h+=fe,ye.s+=ge,ye.l+=he,this.setHSL(ye.h,ye.s,ye.l),this},add:function(fe){return this.r+=fe.r,this.g+=fe.g,this.b+=fe.b,this},addColors:function(fe,ge){return this.r=fe.r+ge.r,this.g=fe.g+ge.g,this.b=fe.b+ge.b,this},addScalar:function(fe){return this.r+=fe,this.g+=fe,this.b+=fe,this},multiply:function(fe){return this.r*=fe.r,this.g*=fe.g,this.b*=fe.b,this},multiplyScalar:function(fe){return this.r*=fe,this.g*=fe,this.b*=fe,this},lerp:function(fe,ge){return this.r+=(fe.r-this.r)*ge,this.g+=(fe.g-this.g)*ge,this.b+=(fe.b-this.b)*ge,this},equals:function(fe){return fe.r===this.r&&fe.g===this.g&&fe.b===this.b},fromArray:function(fe,ge){return void 0===ge&&(ge=0),this.r=fe[ge],this.g=fe[ge+1],this.b=fe[ge+2],this},toArray:function(fe,ge){return void 0===fe&&(fe=[]),void 0===ge&&(ge=0),fe[ge]=this.r,fe[ge+1]=this.g,fe[ge+2]=this.b,fe}},pe.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},pe.Quaternion=function(ue,fe,ge,he){this._x=ue||0,this._y=fe||0,this._z=ge||0,this._w=he===void 0?1:he},pe.Quaternion.prototype={constructor:pe.Quaternion,get x(){return this._x},set x(ue){this._x=ue,this.onChangeCallback()},get y(){return this._y},set y(ue){this._y=ue,this.onChangeCallback()},get z(){return this._z},set z(ue){this._z=ue,this.onChangeCallback()},get w(){return this._w},set w(ue){this._w=ue,this.onChangeCallback()},set:function(fe,ge,he,ye){return this._x=fe,this._y=ge,this._z=he,this._w=ye,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(fe){return this._x=fe.x,this._y=fe.y,this._z=fe.z,this._w=fe.w,this.onChangeCallback(),this},setFromEuler:function(fe,ge){if(!1==fe instanceof pe.Euler)throw new Error('THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.');var he=Math.cos(fe._x/2),ye=Math.cos(fe._y/2),xe=Math.cos(fe._z/2),_e=Math.sin(fe._x/2),ve=Math.sin(fe._y/2),Ee=Math.sin(fe._z/2),Te=fe.order;return'XYZ'===Te?(this._x=_e*ye*xe+he*ve*Ee,this._y=he*ve*xe-_e*ye*Ee,this._z=he*ye*Ee+_e*ve*xe,this._w=he*ye*xe-_e*ve*Ee):'YXZ'===Te?(this._x=_e*ye*xe+he*ve*Ee,this._y=he*ve*xe-_e*ye*Ee,this._z=he*ye*Ee-_e*ve*xe,this._w=he*ye*xe+_e*ve*Ee):'ZXY'===Te?(this._x=_e*ye*xe-he*ve*Ee,this._y=he*ve*xe+_e*ye*Ee,this._z=he*ye*Ee+_e*ve*xe,this._w=he*ye*xe-_e*ve*Ee):'ZYX'===Te?(this._x=_e*ye*xe-he*ve*Ee,this._y=he*ve*xe+_e*ye*Ee,this._z=he*ye*Ee-_e*ve*xe,this._w=he*ye*xe+_e*ve*Ee):'YZX'===Te?(this._x=_e*ye*xe+he*ve*Ee,this._y=he*ve*xe+_e*ye*Ee,this._z=he*ye*Ee-_e*ve*xe,this._w=he*ye*xe-_e*ve*Ee):'XZY'===Te&&(this._x=_e*ye*xe-he*ve*Ee,this._y=he*ve*xe-_e*ye*Ee,this._z=he*ye*Ee+_e*ve*xe,this._w=he*ye*xe+_e*ve*Ee),!1!==ge&&this.onChangeCallback(),this},setFromAxisAngle:function(fe,ge){var he=ge/2,ye=Math.sin(he);return this._x=fe.x*ye,this._y=fe.y*ye,this._z=fe.z*ye,this._w=Math.cos(he),this.onChangeCallback(),this},setFromRotationMatrix:function(fe){var ge=fe.elements,he=ge[0],ye=ge[4],xe=ge[8],_e=ge[1],ve=ge[5],Ee=ge[9],Te=ge[2],Se=ge[6],Me=ge[10],Ae=he+ve+Me,Le;return 0<Ae?(Le=0.5/Math.sqrt(Ae+1),this._w=0.25/Le,this._x=(Se-Ee)*Le,this._y=(xe-Te)*Le,this._z=(_e-ye)*Le):he>ve&&he>Me?(Le=2*Math.sqrt(1+he-ve-Me),this._w=(Se-Ee)/Le,this._x=0.25*Le,this._y=(ye+_e)/Le,this._z=(xe+Te)/Le):ve>Me?(Le=2*Math.sqrt(1+ve-he-Me),this._w=(xe-Te)/Le,this._x=(ye+_e)/Le,this._y=0.25*Le,this._z=(Ee+Se)/Le):(Le=2*Math.sqrt(1+Me-he-ve),this._w=(_e-ye)/Le,this._x=(xe+Te)/Le,this._y=(Ee+Se)/Le,this._z=0.25*Le),this.onChangeCallback(),this},setFromUnitVectors:function(){var ue,fe;return function(ye,xe){return void 0==ue&&(ue=new pe.Vector3),fe=ye.dot(xe)+1,fe<1e-6?(fe=0,Math.abs(ye.x)>Math.abs(ye.z)?ue.set(-ye.y,ye.x,0):ue.set(0,-ye.z,ye.y)):ue.crossVectors(ye,xe),this._x=ue.x,this._y=ue.y,this._z=ue.z,this._w=fe,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(fe){return this._x*fe._x+this._y*fe._y+this._z*fe._z+this._w*fe._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var fe=this.length();return 0===fe?(this._x=0,this._y=0,this._z=0,this._w=1):(fe=1/fe,this._x*=fe,this._y*=fe,this._z*=fe,this._w*=fe),this.onChangeCallback(),this},multiply:function(fe,ge){return void 0===ge?this.multiplyQuaternions(this,fe):(console.warn('THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.'),this.multiplyQuaternions(fe,ge))},premultiply:function(fe){return this.multiplyQuaternions(fe,this)},multiplyQuaternions:function(fe,ge){var he=fe._x,ye=fe._y,xe=fe._z,_e=fe._w,ve=ge._x,Ee=ge._y,Te=ge._z,Se=ge._w;return this._x=he*Se+_e*ve+ye*Te-xe*Ee,this._y=ye*Se+_e*Ee+xe*ve-he*Te,this._z=xe*Se+_e*Te+he*Ee-ye*ve,this._w=_e*Se-he*ve-ye*Ee-xe*Te,this.onChangeCallback(),this},slerp:function(fe,ge){if(0===ge)return this;if(1===ge)return this.copy(fe);var he=this._x,ye=this._y,xe=this._z,_e=this._w,ve=_e*fe._w+he*fe._x+ye*fe._y+xe*fe._z;if(0>ve?(this._w=-fe._w,this._x=-fe._x,this._y=-fe._y,this._z=-fe._z,ve=-ve):this.copy(fe),1<=ve)return this._w=_e,this._x=he,this._y=ye,this._z=xe,this;var Ee=Math.sqrt(1-ve*ve);if(1e-3>Math.abs(Ee))return this._w=0.5*(_e+this._w),this._x=0.5*(he+this._x),this._y=0.5*(ye+this._y),this._z=0.5*(xe+this._z),this;var Te=Math.atan2(Ee,ve),Se=Math.sin((1-ge)*Te)/Ee,Me=Math.sin(ge*Te)/Ee;return this._w=_e*Se+this._w*Me,this._x=he*Se+this._x*Me,this._y=ye*Se+this._y*Me,this._z=xe*Se+this._z*Me,this.onChangeCallback(),this},equals:function(fe){return fe._x===this._x&&fe._y===this._y&&fe._z===this._z&&fe._w===this._w},fromArray:function(fe,ge){return void 0===ge&&(ge=0),this._x=fe[ge],this._y=fe[ge+1],this._z=fe[ge+2],this._w=fe[ge+3],this.onChangeCallback(),this},toArray:function(fe,ge){return void 0===fe&&(fe=[]),void 0===ge&&(ge=0),fe[ge]=this._x,fe[ge+1]=this._y,fe[ge+2]=this._z,fe[ge+3]=this._w,fe},onChange:function(fe){return this.onChangeCallback=fe,this},onChangeCallback:function(){}},le(pe.Quaternion,{slerp:function(fe,ge,he,ye){return he.copy(fe).slerp(ge,ye)},slerpFlat:function(fe,ge,he,ye,xe,_e,ve){var Ee=he[ye+0],Te=he[ye+1],Se=he[ye+2],Me=he[ye+3],Ae=xe[_e+0],Le=xe[_e+1],Re=xe[_e+2],Ce=xe[_e+3];if(Me!==Ce||Ee!==Ae||Te!==Le||Se!==Re){var we=1-ve,Pe=Ee*Ae+Te*Le+Se*Re+Me*Ce,Fe=0<=Pe?1:-1,De=1-Pe*Pe;if(De>Number.EPSILON){var Ie=Math.sqrt(De),Be=Math.atan2(Ie,Pe*Fe);we=Math.sin(we*Be)/Ie,ve=Math.sin(ve*Be)/Ie}var Ue=ve*Fe;if(Ee=Ee*we+Ae*Ue,Te=Te*we+Le*Ue,Se=Se*we+Re*Ue,Me=Me*we+Ce*Ue,we==1-ve){var Ne=1/Math.sqrt(Ee*Ee+Te*Te+Se*Se+Me*Me);Ee*=Ne,Te*=Ne,Se*=Ne,Me*=Ne}}fe[ge]=Ee,fe[ge+1]=Te,fe[ge+2]=Se,fe[ge+3]=Me}}),pe.Vector2=function(ue,fe){this.x=ue||0,this.y=fe||0},pe.Vector2.prototype={constructor:pe.Vector2,get width(){return this.x},set width(ue){this.x=ue},get height(){return this.y},set height(ue){this.y=ue},set:function(fe,ge){return this.x=fe,this.y=ge,this},setScalar:function(fe){return this.x=fe,this.y=fe,this},setX:function(fe){return this.x=fe,this},setY:function(fe){return this.y=fe,this},setComponent:function(fe,ge){switch(fe){case 0:this.x=ge;break;case 1:this.y=ge;break;default:throw new Error('index is out of range: '+fe);}},getComponent:function(fe){switch(fe){case 0:return this.x;case 1:return this.y;default:throw new Error('index is out of range: '+fe);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(fe){return this.x=fe.x,this.y=fe.y,this},add:function(fe,ge){return void 0===ge?(this.x+=fe.x,this.y+=fe.y,this):(console.warn('THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.'),this.addVectors(fe,ge))},addScalar:function(fe){return this.x+=fe,this.y+=fe,this},addVectors:function(fe,ge){return this.x=fe.x+ge.x,this.y=fe.y+ge.y,this},addScaledVector:function(fe,ge){return this.x+=fe.x*ge,this.y+=fe.y*ge,this},sub:function(fe,ge){return void 0===ge?(this.x-=fe.x,this.y-=fe.y,this):(console.warn('THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.'),this.subVectors(fe,ge))},subScalar:function(fe){return this.x-=fe,this.y-=fe,this},subVectors:function(fe,ge){return this.x=fe.x-ge.x,this.y=fe.y-ge.y,this},multiply:function(fe){return this.x*=fe.x,this.y*=fe.y,this},multiplyScalar:function(fe){return isFinite(fe)?(this.x*=fe,this.y*=fe):(this.x=0,this.y=0),this},divide:function(fe){return this.x/=fe.x,this.y/=fe.y,this},divideScalar:function(fe){return this.multiplyScalar(1/fe)},min:function(fe){return this.x=Math.min(this.x,fe.x),this.y=Math.min(this.y,fe.y),this},max:function(fe){return this.x=Math.max(this.x,fe.x),this.y=Math.max(this.y,fe.y),this},clamp:function(fe,ge){return this.x=Math.max(fe.x,Math.min(ge.x,this.x)),this.y=Math.max(fe.y,Math.min(ge.y,this.y)),this},clampScalar:function(){var ue,fe;return function(he,ye){return void 0==ue&&(ue=new pe.Vector2,fe=new pe.Vector2),ue.set(he,he),fe.set(ye,ye),this.clamp(ue,fe)}}(),clampLength:function(fe,ge){var he=this.length();return this.multiplyScalar(Math.max(fe,Math.min(ge,he))/he)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(fe){return this.x*fe.x+this.y*fe.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var ue=Math.atan2(this.y,this.x);return 0>ue&&(ue+=2*Math.PI),ue},distanceTo:function(fe){return Math.sqrt(this.distanceToSquared(fe))},distanceToSquared:function(fe){var ge=this.x-fe.x,he=this.y-fe.y;return ge*ge+he*he},setLength:function(fe){return this.multiplyScalar(fe/this.length())},lerp:function(fe,ge){return this.x+=(fe.x-this.x)*ge,this.y+=(fe.y-this.y)*ge,this},lerpVectors:function(fe,ge,he){return this.subVectors(ge,fe).multiplyScalar(he).add(fe)},equals:function(fe){return fe.x===this.x&&fe.y===this.y},fromArray:function(fe,ge){return void 0===ge&&(ge=0),this.x=fe[ge],this.y=fe[ge+1],this},toArray:function(fe,ge){return void 0===fe&&(fe=[]),void 0===ge&&(ge=0),fe[ge]=this.x,fe[ge+1]=this.y,fe},fromAttribute:function(fe,ge,he){return void 0===he&&(he=0),ge=ge*fe.itemSize+he,this.x=fe.array[ge],this.y=fe.array[ge+1],this},rotateAround:function(fe,ge){var he=Math.cos(ge),ye=Math.sin(ge),xe=this.x-fe.x,_e=this.y-fe.y;return this.x=xe*he-_e*ye+fe.x,this.y=xe*ye+_e*he+fe.y,this}},pe.Vector3=function(ue,fe,ge){this.x=ue||0,this.y=fe||0,this.z=ge||0},pe.Vector3.prototype={constructor:pe.Vector3,set:function(fe,ge,he){return this.x=fe,this.y=ge,this.z=he,this},setScalar:function(fe){return this.x=fe,this.y=fe,this.z=fe,this},setX:function(fe){return this.x=fe,this},setY:function(fe){return this.y=fe,this},setZ:function(fe){return this.z=fe,this},setComponent:function(fe,ge){switch(fe){case 0:this.x=ge;break;case 1:this.y=ge;break;case 2:this.z=ge;break;default:throw new Error('index is out of range: '+fe);}},getComponent:function(fe){switch(fe){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error('index is out of range: '+fe);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(fe){return this.x=fe.x,this.y=fe.y,this.z=fe.z,this},add:function(fe,ge){return void 0===ge?(this.x+=fe.x,this.y+=fe.y,this.z+=fe.z,this):(console.warn('THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.'),this.addVectors(fe,ge))},addScalar:function(fe){return this.x+=fe,this.y+=fe,this.z+=fe,this},addVectors:function(fe,ge){return this.x=fe.x+ge.x,this.y=fe.y+ge.y,this.z=fe.z+ge.z,this},addScaledVector:function(fe,ge){return this.x+=fe.x*ge,this.y+=fe.y*ge,this.z+=fe.z*ge,this},sub:function(fe,ge){return void 0===ge?(this.x-=fe.x,this.y-=fe.y,this.z-=fe.z,this):(console.warn('THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.'),this.subVectors(fe,ge))},subScalar:function(fe){return this.x-=fe,this.y-=fe,this.z-=fe,this},subVectors:function(fe,ge){return this.x=fe.x-ge.x,this.y=fe.y-ge.y,this.z=fe.z-ge.z,this},multiply:function(fe,ge){return void 0===ge?(this.x*=fe.x,this.y*=fe.y,this.z*=fe.z,this):(console.warn('THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.'),this.multiplyVectors(fe,ge))},multiplyScalar:function(fe){return isFinite(fe)?(this.x*=fe,this.y*=fe,this.z*=fe):(this.x=0,this.y=0,this.z=0),this},multiplyVectors:function(fe,ge){return this.x=fe.x*ge.x,this.y=fe.y*ge.y,this.z=fe.z*ge.z,this},applyEuler:function(){var ue;return function(ge){return!1==ge instanceof pe.Euler&&console.error('THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.'),void 0==ue&&(ue=new pe.Quaternion),this.applyQuaternion(ue.setFromEuler(ge))}}(),applyAxisAngle:function(){var ue;return function(ge,he){return void 0==ue&&(ue=new pe.Quaternion),this.applyQuaternion(ue.setFromAxisAngle(ge,he))}}(),applyMatrix3:function(fe){var ge=this.x,he=this.y,ye=this.z,xe=fe.elements;return this.x=xe[0]*ge+xe[3]*he+xe[6]*ye,this.y=xe[1]*ge+xe[4]*he+xe[7]*ye,this.z=xe[2]*ge+xe[5]*he+xe[8]*ye,this},applyMatrix4:function(fe){var ge=this.x,he=this.y,ye=this.z,xe=fe.elements;return this.x=xe[0]*ge+xe[4]*he+xe[8]*ye+xe[12],this.y=xe[1]*ge+xe[5]*he+xe[9]*ye+xe[13],this.z=xe[2]*ge+xe[6]*he+xe[10]*ye+xe[14],this},applyProjection:function(fe){var ge=this.x,he=this.y,ye=this.z,xe=fe.elements,_e=1/(xe[3]*ge+xe[7]*he+xe[11]*ye+xe[15]);return this.x=(xe[0]*ge+xe[4]*he+xe[8]*ye+xe[12])*_e,this.y=(xe[1]*ge+xe[5]*he+xe[9]*ye+xe[13])*_e,this.z=(xe[2]*ge+xe[6]*he+xe[10]*ye+xe[14])*_e,this},applyQuaternion:function(fe){var ge=this.x,he=this.y,ye=this.z,xe=fe.x,_e=fe.y,ve=fe.z,Ee=fe.w,Te=Ee*ge+_e*ye-ve*he,Se=Ee*he+ve*ge-xe*ye,Me=Ee*ye+xe*he-_e*ge,Ae=-xe*ge-_e*he-ve*ye;return this.x=Te*Ee+Ae*-xe+Se*-ve-Me*-_e,this.y=Se*Ee+Ae*-_e+Me*-xe-Te*-ve,this.z=Me*Ee+Ae*-ve+Te*-_e-Se*-xe,this},project:function(){var ue;return function(ge){return void 0==ue&&(ue=new pe.Matrix4),ue.multiplyMatrices(ge.projectionMatrix,ue.getInverse(ge.matrixWorld)),this.applyProjection(ue)}}(),unproject:function(){var ue;return function(ge){return void 0==ue&&(ue=new pe.Matrix4),ue.multiplyMatrices(ge.matrixWorld,ue.getInverse(ge.projectionMatrix)),this.applyProjection(ue)}}(),transformDirection:function(fe){var ge=this.x,he=this.y,ye=this.z,xe=fe.elements;return this.x=xe[0]*ge+xe[4]*he+xe[8]*ye,this.y=xe[1]*ge+xe[5]*he+xe[9]*ye,this.z=xe[2]*ge+xe[6]*he+xe[10]*ye,this.normalize()},divide:function(fe){return this.x/=fe.x,this.y/=fe.y,this.z/=fe.z,this},divideScalar:function(fe){return this.multiplyScalar(1/fe)},min:function(fe){return this.x=Math.min(this.x,fe.x),this.y=Math.min(this.y,fe.y),this.z=Math.min(this.z,fe.z),this},max:function(fe){return this.x=Math.max(this.x,fe.x),this.y=Math.max(this.y,fe.y),this.z=Math.max(this.z,fe.z),this},clamp:function(fe,ge){return this.x=Math.max(fe.x,Math.min(ge.x,this.x)),this.y=Math.max(fe.y,Math.min(ge.y,this.y)),this.z=Math.max(fe.z,Math.min(ge.z,this.z)),this},clampScalar:function(){var ue,fe;return function(he,ye){return void 0==ue&&(ue=new pe.Vector3,fe=new pe.Vector3),ue.set(he,he,he),fe.set(ye,ye,ye),this.clamp(ue,fe)}}(),clampLength:function(fe,ge){var he=this.length();return this.multiplyScalar(Math.max(fe,Math.min(ge,he))/he)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(fe){return this.x*fe.x+this.y*fe.y+this.z*fe.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(fe){return this.multiplyScalar(fe/this.length())},lerp:function(fe,ge){return this.x+=(fe.x-this.x)*ge,this.y+=(fe.y-this.y)*ge,this.z+=(fe.z-this.z)*ge,this},lerpVectors:function(fe,ge,he){return this.subVectors(ge,fe).multiplyScalar(he).add(fe)},cross:function(fe,ge){if(void 0!==ge)return console.warn('THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.'),this.crossVectors(fe,ge);var he=this.x,ye=this.y,xe=this.z;return this.x=ye*fe.z-xe*fe.y,this.y=xe*fe.x-he*fe.z,this.z=he*fe.y-ye*fe.x,this},crossVectors:function(fe,ge){var he=fe.x,ye=fe.y,xe=fe.z,_e=ge.x,ve=ge.y,Ee=ge.z;return this.x=ye*Ee-xe*ve,this.y=xe*_e-he*Ee,this.z=he*ve-ye*_e,this},projectOnVector:function(fe){var ge=fe.dot(this)/fe.lengthSq();return this.copy(fe).multiplyScalar(ge)},projectOnPlane:function(){var ue;return function(ge){return void 0==ue&&(ue=new pe.Vector3),ue.copy(this).projectOnVector(ge),this.sub(ue)}}(),reflect:function(){var ue;return function(ge){return void 0==ue&&(ue=new pe.Vector3),this.sub(ue.copy(ge).multiplyScalar(2*this.dot(ge)))}}(),angleTo:function(fe){var ge=this.dot(fe)/Math.sqrt(this.lengthSq()*fe.lengthSq());return Math.acos(pe.Math.clamp(ge,-1,1))},distanceTo:function(fe){return Math.sqrt(this.distanceToSquared(fe))},distanceToSquared:function(fe){var ge=this.x-fe.x,he=this.y-fe.y,ye=this.z-fe.z;return ge*ge+he*he+ye*ye},setFromSpherical:function(fe){var ge=Math.sin(fe.phi)*fe.radius;return this.x=ge*Math.sin(fe.theta),this.y=Math.cos(fe.phi)*fe.radius,this.z=ge*Math.cos(fe.theta),this},setFromMatrixPosition:function(fe){return this.setFromMatrixColumn(fe,3)},setFromMatrixScale:function(fe){var ge=this.setFromMatrixColumn(fe,0).length(),he=this.setFromMatrixColumn(fe,1).length(),ye=this.setFromMatrixColumn(fe,2).length();return this.x=ge,this.y=he,this.z=ye,this},setFromMatrixColumn:function(fe,ge){if('number'==typeof fe){console.warn('THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).');var he=fe;fe=ge,ge=he}return this.fromArray(fe.elements,4*ge)},equals:function(fe){return fe.x===this.x&&fe.y===this.y&&fe.z===this.z},fromArray:function(fe,ge){return void 0===ge&&(ge=0),this.x=fe[ge],this.y=fe[ge+1],this.z=fe[ge+2],this},toArray:function(fe,ge){return void 0===fe&&(fe=[]),void 0===ge&&(ge=0),fe[ge]=this.x,fe[ge+1]=this.y,fe[ge+2]=this.z,fe},fromAttribute:function(fe,ge,he){return void 0===he&&(he=0),ge=ge*fe.itemSize+he,this.x=fe.array[ge],this.y=fe.array[ge+1],this.z=fe.array[ge+2],this}},pe.Vector4=function(ue,fe,ge,he){this.x=ue||0,this.y=fe||0,this.z=ge||0,this.w=he===void 0?1:he},pe.Vector4.prototype={constructor:pe.Vector4,set:function(fe,ge,he,ye){return this.x=fe,this.y=ge,this.z=he,this.w=ye,this},setScalar:function(fe){return this.x=fe,this.y=fe,this.z=fe,this.w=fe,this},setX:function(fe){return this.x=fe,this},setY:function(fe){return this.y=fe,this},setZ:function(fe){return this.z=fe,this},setW:function(fe){return this.w=fe,this},setComponent:function(fe,ge){switch(fe){case 0:this.x=ge;break;case 1:this.y=ge;break;case 2:this.z=ge;break;case 3:this.w=ge;break;default:throw new Error('index is out of range: '+fe);}},getComponent:function(fe){switch(fe){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error('index is out of range: '+fe);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(fe){return this.x=fe.x,this.y=fe.y,this.z=fe.z,this.w=void 0===fe.w?1:fe.w,this},add:function(fe,ge){return void 0===ge?(this.x+=fe.x,this.y+=fe.y,this.z+=fe.z,this.w+=fe.w,this):(console.warn('THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.'),this.addVectors(fe,ge))},addScalar:function(fe){return this.x+=fe,this.y+=fe,this.z+=fe,this.w+=fe,this},addVectors:function(fe,ge){return this.x=fe.x+ge.x,this.y=fe.y+ge.y,this.z=fe.z+ge.z,this.w=fe.w+ge.w,this},addScaledVector:function(fe,ge){return this.x+=fe.x*ge,this.y+=fe.y*ge,this.z+=fe.z*ge,this.w+=fe.w*ge,this},sub:function(fe,ge){return void 0===ge?(this.x-=fe.x,this.y-=fe.y,this.z-=fe.z,this.w-=fe.w,this):(console.warn('THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.'),this.subVectors(fe,ge))},subScalar:function(fe){return this.x-=fe,this.y-=fe,this.z-=fe,this.w-=fe,this},subVectors:function(fe,ge){return this.x=fe.x-ge.x,this.y=fe.y-ge.y,this.z=fe.z-ge.z,this.w=fe.w-ge.w,this},multiplyScalar:function(fe){return isFinite(fe)?(this.x*=fe,this.y*=fe,this.z*=fe,this.w*=fe):(this.x=0,this.y=0,this.z=0,this.w=0),this},applyMatrix4:function(fe){var ge=this.x,he=this.y,ye=this.z,xe=this.w,_e=fe.elements;return this.x=_e[0]*ge+_e[4]*he+_e[8]*ye+_e[12]*xe,this.y=_e[1]*ge+_e[5]*he+_e[9]*ye+_e[13]*xe,this.z=_e[2]*ge+_e[6]*he+_e[10]*ye+_e[14]*xe,this.w=_e[3]*ge+_e[7]*he+_e[11]*ye+_e[15]*xe,this},divideScalar:function(fe){return this.multiplyScalar(1/fe)},setAxisAngleFromQuaternion:function(fe){this.w=2*Math.acos(fe.w);var ge=Math.sqrt(1-fe.w*fe.w);return 1e-4>ge?(this.x=1,this.y=0,this.z=0):(this.x=fe.x/ge,this.y=fe.y/ge,this.z=fe.z/ge),this},setAxisAngleFromRotationMatrix:function(fe){var _e=0.01,ve=0.1,Ee=fe.elements,Te=Ee[0],Se=Ee[4],Me=Ee[8],Ae=Ee[1],Le=Ee[5],Re=Ee[9],Ce=Ee[2],we=Ee[6],Pe=Ee[10],ge,he,ye,xe;if(Math.abs(Se-Ae)<_e&&Math.abs(Me-Ce)<_e&&Math.abs(Re-we)<_e){if(Math.abs(Se+Ae)<ve&&Math.abs(Me+Ce)<ve&&Math.abs(Re+we)<ve&&Math.abs(Te+Le+Pe-3)<ve)return this.set(1,0,0,0),this;ge=Math.PI;var Fe=(Te+1)/2,De=(Le+1)/2,Ie=(Pe+1)/2,Be=(Se+Ae)/4,Ue=(Me+Ce)/4,Ne=(Re+we)/4;return Fe>De&&Fe>Ie?Fe<_e?(he=0,ye=0.707106781,xe=0.707106781):(he=Math.sqrt(Fe),ye=Be/he,xe=Ue/he):De>Ie?De<_e?(he=0.707106781,ye=0,xe=0.707106781):(ye=Math.sqrt(De),he=Be/ye,xe=Ne/ye):Ie<_e?(he=0.707106781,ye=0.707106781,xe=0):(xe=Math.sqrt(Ie),he=Ue/xe,ye=Ne/xe),this.set(he,ye,xe,ge),this}var Ge=Math.sqrt((we-Re)*(we-Re)+(Me-Ce)*(Me-Ce)+(Ae-Se)*(Ae-Se));return 1e-3>Math.abs(Ge)&&(Ge=1),this.x=(we-Re)/Ge,this.y=(Me-Ce)/Ge,this.z=(Ae-Se)/Ge,this.w=Math.acos((Te+Le+Pe-1)/2),this},min:function(fe){return this.x=Math.min(this.x,fe.x),this.y=Math.min(this.y,fe.y),this.z=Math.min(this.z,fe.z),this.w=Math.min(this.w,fe.w),this},max:function(fe){return this.x=Math.max(this.x,fe.x),this.y=Math.max(this.y,fe.y),this.z=Math.max(this.z,fe.z),this.w=Math.max(this.w,fe.w),this},clamp:function(fe,ge){return this.x=Math.max(fe.x,Math.min(ge.x,this.x)),this.y=Math.max(fe.y,Math.min(ge.y,this.y)),this.z=Math.max(fe.z,Math.min(ge.z,this.z)),this.w=Math.max(fe.w,Math.min(ge.w,this.w)),this},clampScalar:function(){var ue,fe;return function(he,ye){return void 0==ue&&(ue=new pe.Vector4,fe=new pe.Vector4),ue.set(he,he,he,he),fe.set(ye,ye,ye,ye),this.clamp(ue,fe)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(fe){return this.x*fe.x+this.y*fe.y+this.z*fe.z+this.w*fe.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(fe){return this.multiplyScalar(fe/this.length())},lerp:function(fe,ge){return this.x+=(fe.x-this.x)*ge,this.y+=(fe.y-this.y)*ge,this.z+=(fe.z-this.z)*ge,this.w+=(fe.w-this.w)*ge,this},lerpVectors:function(fe,ge,he){return this.subVectors(ge,fe).multiplyScalar(he).add(fe)},equals:function(fe){return fe.x===this.x&&fe.y===this.y&&fe.z===this.z&&fe.w===this.w},fromArray:function(fe,ge){return void 0===ge&&(ge=0),this.x=fe[ge],this.y=fe[ge+1],this.z=fe[ge+2],this.w=fe[ge+3],this},toArray:function(fe,ge){return void 0===fe&&(fe=[]),void 0===ge&&(ge=0),fe[ge]=this.x,fe[ge+1]=this.y,fe[ge+2]=this.z,fe[ge+3]=this.w,fe},fromAttribute:function(fe,ge,he){return void 0===he&&(he=0),ge=ge*fe.itemSize+he,this.x=fe.array[ge],this.y=fe.array[ge+1],this.z=fe.array[ge+2],this.w=fe.array[ge+3],this}},pe.Euler=function(ue,fe,ge,he){this._x=ue||0,this._y=fe||0,this._z=ge||0,this._order=he||pe.Euler.DefaultOrder},pe.Euler.RotationOrders=['XYZ','YZX','ZXY','XZY','YXZ','ZYX'],pe.Euler.DefaultOrder='XYZ',pe.Euler.prototype={constructor:pe.Euler,get x(){return this._x},set x(ue){this._x=ue,this.onChangeCallback()},get y(){return this._y},set y(ue){this._y=ue,this.onChangeCallback()},get z(){return this._z},set z(ue){this._z=ue,this.onChangeCallback()},get order(){return this._order},set order(ue){this._order=ue,this.onChangeCallback()},set:function(fe,ge,he,ye){return this._x=fe,this._y=ge,this._z=he,this._order=ye||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(fe){return this._x=fe._x,this._y=fe._y,this._z=fe._z,this._order=fe._order,this.onChangeCallback(),this},setFromRotationMatrix:function(fe,ge,he){var ye=pe.Math.clamp,xe=fe.elements,_e=xe[0],ve=xe[4],Ee=xe[8],Te=xe[1],Se=xe[5],Me=xe[9],Ae=xe[2],Le=xe[6],Re=xe[10];return ge=ge||this._order,'XYZ'===ge?(this._y=Math.asin(ye(Ee,-1,1)),0.99999>Math.abs(Ee)?(this._x=Math.atan2(-Me,Re),this._z=Math.atan2(-ve,_e)):(this._x=Math.atan2(Le,Se),this._z=0)):'YXZ'===ge?(this._x=Math.asin(-ye(Me,-1,1)),0.99999>Math.abs(Me)?(this._y=Math.atan2(Ee,Re),this._z=Math.atan2(Te,Se)):(this._y=Math.atan2(-Ae,_e),this._z=0)):'ZXY'===ge?(this._x=Math.asin(ye(Le,-1,1)),0.99999>Math.abs(Le)?(this._y=Math.atan2(-Ae,Re),this._z=Math.atan2(-ve,Se)):(this._y=0,this._z=Math.atan2(Te,_e))):'ZYX'===ge?(this._y=Math.asin(-ye(Ae,-1,1)),0.99999>Math.abs(Ae)?(this._x=Math.atan2(Le,Re),this._z=Math.atan2(Te,_e)):(this._x=0,this._z=Math.atan2(-ve,Se))):'YZX'===ge?(this._z=Math.asin(ye(Te,-1,1)),0.99999>Math.abs(Te)?(this._x=Math.atan2(-Me,Se),this._y=Math.atan2(-Ae,_e)):(this._x=0,this._y=Math.atan2(Ee,Re))):'XZY'===ge?(this._z=Math.asin(-ye(ve,-1,1)),0.99999>Math.abs(ve)?(this._x=Math.atan2(Le,Se),this._y=Math.atan2(Ee,_e)):(this._x=Math.atan2(-Me,Re),this._y=0)):console.warn('THREE.Euler: .setFromRotationMatrix() given unsupported order: '+ge),this._order=ge,!1!==he&&this.onChangeCallback(),this},setFromQuaternion:function(){var ue;return function(ge,he,ye){return void 0==ue&&(ue=new pe.Matrix4),ue.makeRotationFromQuaternion(ge),this.setFromRotationMatrix(ue,he,ye)}}(),setFromVector3:function(fe,ge){return this.set(fe.x,fe.y,fe.z,ge||this._order)},reorder:function(){var ue=new pe.Quaternion;return function(ge){return ue.setFromEuler(this),this.setFromQuaternion(ue,ge)}}(),equals:function(fe){return fe._x===this._x&&fe._y===this._y&&fe._z===this._z&&fe._order===this._order},fromArray:function(fe){return this._x=fe[0],this._y=fe[1],this._z=fe[2],void 0!==fe[3]&&(this._order=fe[3]),this.onChangeCallback(),this},toArray:function(fe,ge){return void 0===fe&&(fe=[]),void 0===ge&&(ge=0),fe[ge]=this._x,fe[ge+1]=this._y,fe[ge+2]=this._z,fe[ge+3]=this._order,fe},toVector3:function(fe){return fe?fe.set(this._x,this._y,this._z):new pe.Vector3(this._x,this._y,this._z)},onChange:function(fe){return this.onChangeCallback=fe,this},onChangeCallback:function(){}},pe.Line3=function(ue,fe){this.start=ue===void 0?new pe.Vector3:ue,this.end=fe===void 0?new pe.Vector3:fe},pe.Line3.prototype={constructor:pe.Line3,set:function(fe,ge){return this.start.copy(fe),this.end.copy(ge),this},clone:function(){return new this.constructor().copy(this)},copy:function(fe){return this.start.copy(fe.start),this.end.copy(fe.end),this},center:function(fe){var ge=fe||new pe.Vector3;return ge.addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(fe){var ge=fe||new pe.Vector3;return ge.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(fe,ge){var he=ge||new pe.Vector3;return this.delta(he).multiplyScalar(fe).add(this.start)},closestPointToPointParameter:function(){var ue=new pe.Vector3,fe=new pe.Vector3;return function(he,ye){ue.subVectors(he,this.start),fe.subVectors(this.end,this.start);var xe=fe.dot(fe),_e=fe.dot(ue),ve=_e/xe;return ye&&(ve=pe.Math.clamp(ve,0,1)),ve}}(),closestPointToPoint:function(fe,ge,he){var ye=this.closestPointToPointParameter(fe,ge),xe=he||new pe.Vector3;return this.delta(xe).multiplyScalar(ye).add(this.start)},applyMatrix4:function(fe){return this.start.applyMatrix4(fe),this.end.applyMatrix4(fe),this},equals:function(fe){return fe.start.equals(this.start)&&fe.end.equals(this.end)}},pe.Box2=function(ue,fe){this.min=ue===void 0?new pe.Vector2(+Infinity,+Infinity):ue,this.max=fe===void 0?new pe.Vector2(-Infinity,-Infinity):fe},pe.Box2.prototype={constructor:pe.Box2,set:function(fe,ge){return this.min.copy(fe),this.max.copy(ge),this},setFromPoints:function(fe){this.makeEmpty();for(var ge=0,he=fe.length;ge<he;ge++)this.expandByPoint(fe[ge]);return this},setFromCenterAndSize:function(){var ue=new pe.Vector2;return function(ge,he){var ye=ue.copy(he).multiplyScalar(0.5);return this.min.copy(ge).sub(ye),this.max.copy(ge).add(ye),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(fe){return this.min.copy(fe.min),this.max.copy(fe.max),this},makeEmpty:function(){return this.min.x=this.min.y=+Infinity,this.max.x=this.max.y=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(fe){var ge=fe||new pe.Vector2;return ge.addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(fe){var ge=fe||new pe.Vector2;return ge.subVectors(this.max,this.min)},expandByPoint:function(fe){return this.min.min(fe),this.max.max(fe),this},expandByVector:function(fe){return this.min.sub(fe),this.max.add(fe),this},expandByScalar:function(fe){return this.min.addScalar(-fe),this.max.addScalar(fe),this},containsPoint:function(fe){return fe.x<this.min.x||fe.x>this.max.x||fe.y<this.min.y||fe.y>this.max.y?!1:!0},containsBox:function(fe){return this.min.x<=fe.min.x&&fe.max.x<=this.max.x&&this.min.y<=fe.min.y&&fe.max.y<=this.max.y},getParameter:function(fe,ge){var he=ge||new pe.Vector2;return he.set((fe.x-this.min.x)/(this.max.x-this.min.x),(fe.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(fe){return fe.max.x<this.min.x||fe.min.x>this.max.x||fe.max.y<this.min.y||fe.min.y>this.max.y?!1:!0},clampPoint:function(fe,ge){var he=ge||new pe.Vector2;return he.copy(fe).clamp(this.min,this.max)},distanceToPoint:function(){var ue=new pe.Vector2;return function(ge){var he=ue.copy(ge).clamp(this.min,this.max);return he.sub(ge).length()}}(),intersect:function(fe){return this.min.max(fe.min),this.max.min(fe.max),this},union:function(fe){return this.min.min(fe.min),this.max.max(fe.max),this},translate:function(fe){return this.min.add(fe),this.max.add(fe),this},equals:function(fe){return fe.min.equals(this.min)&&fe.max.equals(this.max)}},pe.Box3=function(ue,fe){this.min=ue===void 0?new pe.Vector3(+Infinity,+Infinity,+Infinity):ue,this.max=fe===void 0?new pe.Vector3(-Infinity,-Infinity,-Infinity):fe},pe.Box3.prototype={constructor:pe.Box3,set:function(fe,ge){return this.min.copy(fe),this.max.copy(ge),this},setFromArray:function(fe){for(var ge=+Infinity,he=+Infinity,ye=+Infinity,xe=-Infinity,_e=-Infinity,ve=-Infinity,Ee=0,Te=fe.length;Ee<Te;Ee+=3){var Se=fe[Ee],Me=fe[Ee+1],Ae=fe[Ee+2];Se<ge&&(ge=Se),Me<he&&(he=Me),Ae<ye&&(ye=Ae),Se>xe&&(xe=Se),Me>_e&&(_e=Me),Ae>ve&&(ve=Ae)}this.min.set(ge,he,ye),this.max.set(xe,_e,ve)},setFromPoints:function(fe){this.makeEmpty();for(var ge=0,he=fe.length;ge<he;ge++)this.expandByPoint(fe[ge]);return this},setFromCenterAndSize:function(){var ue=new pe.Vector3;return function(ge,he){var ye=ue.copy(he).multiplyScalar(0.5);return this.min.copy(ge).sub(ye),this.max.copy(ge).add(ye),this}}(),setFromObject:function(){var ue=new pe.Vector3;return function(ge){var he=this;return ge.updateMatrixWorld(!0),this.makeEmpty(),ge.traverse(function(ye){var xe=ye.geometry;if(void 0!==xe)if(xe instanceof pe.Geometry)for(var _e=xe.vertices,ve=0,Ee=_e.length;ve<Ee;ve++)ue.copy(_e[ve]),ue.applyMatrix4(ye.matrixWorld),he.expandByPoint(ue);else if(xe instanceof pe.BufferGeometry&&void 0!==xe.attributes.position)for(var Te=xe.attributes.position.array,ve=0,Ee=Te.length;ve<Ee;ve+=3)ue.fromArray(Te,ve),ue.applyMatrix4(ye.matrixWorld),he.expandByPoint(ue)}),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(fe){return this.min.copy(fe.min),this.max.copy(fe.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=+Infinity,this.max.x=this.max.y=this.max.z=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(fe){var ge=fe||new pe.Vector3;return ge.addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(fe){var ge=fe||new pe.Vector3;return ge.subVectors(this.max,this.min)},expandByPoint:function(fe){return this.min.min(fe),this.max.max(fe),this},expandByVector:function(fe){return this.min.sub(fe),this.max.add(fe),this},expandByScalar:function(fe){return this.min.addScalar(-fe),this.max.addScalar(fe),this},containsPoint:function(fe){return fe.x<this.min.x||fe.x>this.max.x||fe.y<this.min.y||fe.y>this.max.y||fe.z<this.min.z||fe.z>this.max.z?!1:!0},containsBox:function(fe){return this.min.x<=fe.min.x&&fe.max.x<=this.max.x&&this.min.y<=fe.min.y&&fe.max.y<=this.max.y&&this.min.z<=fe.min.z&&fe.max.z<=this.max.z},getParameter:function(fe,ge){var he=ge||new pe.Vector3;return he.set((fe.x-this.min.x)/(this.max.x-this.min.x),(fe.y-this.min.y)/(this.max.y-this.min.y),(fe.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(fe){return fe.max.x<this.min.x||fe.min.x>this.max.x||fe.max.y<this.min.y||fe.min.y>this.max.y||fe.max.z<this.min.z||fe.min.z>this.max.z?!1:!0},intersectsSphere:function(){var ue;return function(ge){return void 0==ue&&(ue=new pe.Vector3),this.clampPoint(ge.center,ue),ue.distanceToSquared(ge.center)<=ge.radius*ge.radius}}(),intersectsPlane:function(fe){var ge,he;return 0<fe.normal.x?(ge=fe.normal.x*this.min.x,he=fe.normal.x*this.max.x):(ge=fe.normal.x*this.max.x,he=fe.normal.x*this.min.x),0<fe.normal.y?(ge+=fe.normal.y*this.min.y,he+=fe.normal.y*this.max.y):(ge+=fe.normal.y*this.max.y,he+=fe.normal.y*this.min.y),0<fe.normal.z?(ge+=fe.normal.z*this.min.z,he+=fe.normal.z*this.max.z):(ge+=fe.normal.z*this.max.z,he+=fe.normal.z*this.min.z),ge<=fe.constant&&he>=fe.constant},clampPoint:function(fe,ge){var he=ge||new pe.Vector3;return he.copy(fe).clamp(this.min,this.max)},distanceToPoint:function(){var ue=new pe.Vector3;return function(ge){var he=ue.copy(ge).clamp(this.min,this.max);return he.sub(ge).length()}}(),getBoundingSphere:function(){var ue=new pe.Vector3;return function(ge){var he=ge||new pe.Sphere;return he.center=this.center(),he.radius=0.5*this.size(ue).length(),he}}(),intersect:function(fe){return this.min.max(fe.min),this.max.min(fe.max),this.isEmpty()&&this.makeEmpty(),this},union:function(fe){return this.min.min(fe.min),this.max.max(fe.max),this},applyMatrix4:function(){var ue=[new pe.Vector3,new pe.Vector3,new pe.Vector3,new pe.Vector3,new pe.Vector3,new pe.Vector3,new pe.Vector3,new pe.Vector3];return function(ge){return this.isEmpty()?this:(ue[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(ge),ue[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(ge),ue[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(ge),ue[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(ge),ue[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(ge),ue[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(ge),ue[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(ge),ue[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(ge),this.setFromPoints(ue),this)}}(),translate:function(fe){return this.min.add(fe),this.max.add(fe),this},equals:function(fe){return fe.min.equals(this.min)&&fe.max.equals(this.max)}},pe.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),0<arguments.length&&console.error('THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.')},pe.Matrix3.prototype={constructor:pe.Matrix3,set:function(fe,ge,he,ye,xe,_e,ve,Ee,Te){var Se=this.elements;return Se[0]=fe,Se[1]=ye,Se[2]=ve,Se[3]=ge,Se[4]=xe,Se[5]=Ee,Se[6]=he,Se[7]=_e,Se[8]=Te,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(fe){var ge=fe.elements;return this.set(ge[0],ge[3],ge[6],ge[1],ge[4],ge[7],ge[2],ge[5],ge[8]),this},setFromMatrix4:function(fe){var ge=fe.elements;return this.set(ge[0],ge[4],ge[8],ge[1],ge[5],ge[9],ge[2],ge[6],ge[10]),this},applyToVector3Array:function(){var ue;return function(ge,he,ye){ue==void 0&&(ue=new pe.Vector3),he===void 0&&(he=0),ye===void 0&&(ye=ge.length);for(var xe=0,_e=he;xe<ye;xe+=3,_e+=3)ue.fromArray(ge,_e),ue.applyMatrix3(this),ue.toArray(ge,_e);return ge}}(),applyToBuffer:function(){var ue;return function(ge,he,ye){ue==void 0&&(ue=new pe.Vector3),he===void 0&&(he=0),ye===void 0&&(ye=ge.length/ge.itemSize);for(var xe=0,_e=he;xe<ye;xe++,_e++)ue.x=ge.getX(_e),ue.y=ge.getY(_e),ue.z=ge.getZ(_e),ue.applyMatrix3(this),ge.setXYZ(ue.x,ue.y,ue.z);return ge}}(),multiplyScalar:function(fe){var ge=this.elements;return ge[0]*=fe,ge[3]*=fe,ge[6]*=fe,ge[1]*=fe,ge[4]*=fe,ge[7]*=fe,ge[2]*=fe,ge[5]*=fe,ge[8]*=fe,this},determinant:function(){var fe=this.elements,ge=fe[0],he=fe[1],ye=fe[2],xe=fe[3],_e=fe[4],ve=fe[5],Ee=fe[6],Te=fe[7],Se=fe[8];return ge*_e*Se-ge*ve*Te-he*xe*Se+he*ve*Ee+ye*xe*Te-ye*_e*Ee},getInverse:function(fe,ge){fe instanceof pe.Matrix4&&console.error('THREE.Matrix3.getInverse no longer takes a Matrix4 argument.');var he=fe.elements,ye=this.elements,xe=he[0],_e=he[1],ve=he[2],Ee=he[3],Te=he[4],Se=he[5],Me=he[6],Ae=he[7],Le=he[8],Re=Le*Te-Se*Ae,Ce=Se*Me-Le*Ee,we=Ae*Ee-Te*Me,Pe=xe*Re+_e*Ce+ve*we;if(0==Pe){var Fe='THREE.Matrix3.getInverse(): can\'t invert matrix, determinant is 0';if(ge||!1)throw new Error(Fe);else console.warn(Fe);return this.identity()}var De=1/Pe;return ye[0]=Re*De,ye[1]=(ve*Ae-Le*_e)*De,ye[2]=(Se*_e-ve*Te)*De,ye[3]=Ce*De,ye[4]=(Le*xe-ve*Me)*De,ye[5]=(ve*Ee-Se*xe)*De,ye[6]=we*De,ye[7]=(_e*Me-Ae*xe)*De,ye[8]=(Te*xe-_e*Ee)*De,this},transpose:function(){var ge=this.elements,fe;return fe=ge[1],ge[1]=ge[3],ge[3]=fe,fe=ge[2],ge[2]=ge[6],ge[6]=fe,fe=ge[5],ge[5]=ge[7],ge[7]=fe,this},flattenToArrayOffset:function(fe,ge){return console.warn('THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead.'),this.toArray(fe,ge)},getNormalMatrix:function(fe){return this.setFromMatrix4(fe).getInverse(this).transpose()},transposeIntoArray:function(fe){var ge=this.elements;return fe[0]=ge[0],fe[1]=ge[3],fe[2]=ge[6],fe[3]=ge[1],fe[4]=ge[4],fe[5]=ge[7],fe[6]=ge[2],fe[7]=ge[5],fe[8]=ge[8],this},fromArray:function(fe){return this.elements.set(fe),this},toArray:function(fe,ge){void 0===fe&&(fe=[]),void 0===ge&&(ge=0);var he=this.elements;return fe[ge]=he[0],fe[ge+1]=he[1],fe[ge+2]=he[2],fe[ge+3]=he[3],fe[ge+4]=he[4],fe[ge+5]=he[5],fe[ge+6]=he[6],fe[ge+7]=he[7],fe[ge+8]=he[8],fe}},pe.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),0<arguments.length&&console.error('THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.')},pe.Matrix4.prototype={constructor:pe.Matrix4,set:function(fe,ge,he,ye,xe,_e,ve,Ee,Te,Se,Me,Ae,Le,Re,Ce,we){var Pe=this.elements;return Pe[0]=fe,Pe[4]=ge,Pe[8]=he,Pe[12]=ye,Pe[1]=xe,Pe[5]=_e,Pe[9]=ve,Pe[13]=Ee,Pe[2]=Te,Pe[6]=Se,Pe[10]=Me,Pe[14]=Ae,Pe[3]=Le,Pe[7]=Re,Pe[11]=Ce,Pe[15]=we,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new pe.Matrix4().fromArray(this.elements)},copy:function(fe){return this.elements.set(fe.elements),this},copyPosition:function(fe){var ge=this.elements,he=fe.elements;return ge[12]=he[12],ge[13]=he[13],ge[14]=he[14],this},extractBasis:function(fe,ge,he){return fe.setFromMatrixColumn(this,0),ge.setFromMatrixColumn(this,1),he.setFromMatrixColumn(this,2),this},makeBasis:function(fe,ge,he){return this.set(fe.x,ge.x,he.x,0,fe.y,ge.y,he.y,0,fe.z,ge.z,he.z,0,0,0,0,1),this},extractRotation:function(){var ue;return function(ge){void 0==ue&&(ue=new pe.Vector3);var he=this.elements,ye=ge.elements,xe=1/ue.setFromMatrixColumn(ge,0).length(),_e=1/ue.setFromMatrixColumn(ge,1).length(),ve=1/ue.setFromMatrixColumn(ge,2).length();return he[0]=ye[0]*xe,he[1]=ye[1]*xe,he[2]=ye[2]*xe,he[4]=ye[4]*_e,he[5]=ye[5]*_e,he[6]=ye[6]*_e,he[8]=ye[8]*ve,he[9]=ye[9]*ve,he[10]=ye[10]*ve,this}}(),makeRotationFromEuler:function(fe){!1==fe instanceof pe.Euler&&console.error('THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.');var ge=this.elements,he=fe.x,ye=fe.y,xe=fe.z,_e=Math.cos(he),ve=Math.sin(he),Ee=Math.cos(ye),Te=Math.sin(ye),Se=Math.cos(xe),Me=Math.sin(xe);if('XYZ'===fe.order){var Ae=_e*Se,Le=_e*Me,Re=ve*Se,Ce=ve*Me;ge[0]=Ee*Se,ge[4]=-Ee*Me,ge[8]=Te,ge[1]=Le+Re*Te,ge[5]=Ae-Ce*Te,ge[9]=-ve*Ee,ge[2]=Ce-Ae*Te,ge[6]=Re+Le*Te,ge[10]=_e*Ee}else if('YXZ'===fe.order){var we=Ee*Se,Pe=Ee*Me,Fe=Te*Se,De=Te*Me;ge[0]=we+De*ve,ge[4]=Fe*ve-Pe,ge[8]=_e*Te,ge[1]=_e*Me,ge[5]=_e*Se,ge[9]=-ve,ge[2]=Pe*ve-Fe,ge[6]=De+we*ve,ge[10]=_e*Ee}else if('ZXY'===fe.order){var we=Ee*Se,Pe=Ee*Me,Fe=Te*Se,De=Te*Me;ge[0]=we-De*ve,ge[4]=-_e*Me,ge[8]=Fe+Pe*ve,ge[1]=Pe+Fe*ve,ge[5]=_e*Se,ge[9]=De-we*ve,ge[2]=-_e*Te,ge[6]=ve,ge[10]=_e*Ee}else if('ZYX'===fe.order){var Ae=_e*Se,Le=_e*Me,Re=ve*Se,Ce=ve*Me;ge[0]=Ee*Se,ge[4]=Re*Te-Le,ge[8]=Ae*Te+Ce,ge[1]=Ee*Me,ge[5]=Ce*Te+Ae,ge[9]=Le*Te-Re,ge[2]=-Te,ge[6]=ve*Ee,ge[10]=_e*Ee}else if('YZX'===fe.order){var Ie=_e*Ee,Be=_e*Te,Ue=ve*Ee,Ne=ve*Te;ge[0]=Ee*Se,ge[4]=Ne-Ie*Me,ge[8]=Ue*Me+Be,ge[1]=Me,ge[5]=_e*Se,ge[9]=-ve*Se,ge[2]=-Te*Se,ge[6]=Be*Me+Ue,ge[10]=Ie-Ne*Me}else if('XZY'===fe.order){var Ie=_e*Ee,Be=_e*Te,Ue=ve*Ee,Ne=ve*Te;ge[0]=Ee*Se,ge[4]=-Me,ge[8]=Te*Se,ge[1]=Ie*Me+Ne,ge[5]=_e*Se,ge[9]=Be*Me-Ue,ge[2]=Ue*Me-Be,ge[6]=ve*Se,ge[10]=Ne*Me+Ie}return ge[3]=0,ge[7]=0,ge[11]=0,ge[12]=0,ge[13]=0,ge[14]=0,ge[15]=1,this},makeRotationFromQuaternion:function(fe){var ge=this.elements,he=fe.x,ye=fe.y,xe=fe.z,_e=fe.w,ve=he+he,Ee=ye+ye,Te=xe+xe,Se=he*ve,Me=he*Ee,Ae=he*Te,Le=ye*Ee,Re=ye*Te,Ce=xe*Te,we=_e*ve,Pe=_e*Ee,Fe=_e*Te;return ge[0]=1-(Le+Ce),ge[4]=Me-Fe,ge[8]=Ae+Pe,ge[1]=Me+Fe,ge[5]=1-(Se+Ce),ge[9]=Re-we,ge[2]=Ae-Pe,ge[6]=Re+we,ge[10]=1-(Se+Le),ge[3]=0,ge[7]=0,ge[11]=0,ge[12]=0,ge[13]=0,ge[14]=0,ge[15]=1,this},lookAt:function(){var ue,fe,ge;return function(ye,xe,_e){void 0==ue&&(ue=new pe.Vector3,fe=new pe.Vector3,ge=new pe.Vector3);var ve=this.elements;return ge.subVectors(ye,xe).normalize(),0===ge.lengthSq()&&(ge.z=1),ue.crossVectors(_e,ge).normalize(),0===ue.lengthSq()&&(ge.z+=1e-4,ue.crossVectors(_e,ge).normalize()),fe.crossVectors(ge,ue),ve[0]=ue.x,ve[4]=fe.x,ve[8]=ge.x,ve[1]=ue.y,ve[5]=fe.y,ve[9]=ge.y,ve[2]=ue.z,ve[6]=fe.z,ve[10]=ge.z,this}}(),multiply:function(fe,ge){return void 0===ge?this.multiplyMatrices(this,fe):(console.warn('THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.'),this.multiplyMatrices(fe,ge))},premultiply:function(fe){return this.multiplyMatrices(fe,this)},multiplyMatrices:function(fe,ge){var he=fe.elements,ye=ge.elements,xe=this.elements,_e=he[0],ve=he[4],Ee=he[8],Te=he[12],Se=he[1],Me=he[5],Ae=he[9],Le=he[13],Re=he[2],Ce=he[6],we=he[10],Pe=he[14],Fe=he[3],De=he[7],Ie=he[11],Be=he[15],Ue=ye[0],Ne=ye[4],Ge=ye[8],Ve=ye[12],ze=ye[1],Oe=ye[5],ke=ye[9],He=ye[13],We=ye[2],je=ye[6],Xe=ye[10],qe=ye[14],Ye=ye[3],Ze=ye[7],Ke=ye[11],Qe=ye[15];return xe[0]=_e*Ue+ve*ze+Ee*We+Te*Ye,xe[4]=_e*Ne+ve*Oe+Ee*je+Te*Ze,xe[8]=_e*Ge+ve*ke+Ee*Xe+Te*Ke,xe[12]=_e*Ve+ve*He+Ee*qe+Te*Qe,xe[1]=Se*Ue+Me*ze+Ae*We+Le*Ye,xe[5]=Se*Ne+Me*Oe+Ae*je+Le*Ze,xe[9]=Se*Ge+Me*ke+Ae*Xe+Le*Ke,xe[13]=Se*Ve+Me*He+Ae*qe+Le*Qe,xe[2]=Re*Ue+Ce*ze+we*We+Pe*Ye,xe[6]=Re*Ne+Ce*Oe+we*je+Pe*Ze,xe[10]=Re*Ge+Ce*ke+we*Xe+Pe*Ke,xe[14]=Re*Ve+Ce*He+we*qe+Pe*Qe,xe[3]=Fe*Ue+De*ze+Ie*We+Be*Ye,xe[7]=Fe*Ne+De*Oe+Ie*je+Be*Ze,xe[11]=Fe*Ge+De*ke+Ie*Xe+Be*Ke,xe[15]=Fe*Ve+De*He+Ie*qe+Be*Qe,this},multiplyToArray:function(fe,ge,he){var ye=this.elements;return this.multiplyMatrices(fe,ge),he[0]=ye[0],he[1]=ye[1],he[2]=ye[2],he[3]=ye[3],he[4]=ye[4],he[5]=ye[5],he[6]=ye[6],he[7]=ye[7],he[8]=ye[8],he[9]=ye[9],he[10]=ye[10],he[11]=ye[11],he[12]=ye[12],he[13]=ye[13],he[14]=ye[14],he[15]=ye[15],this},multiplyScalar:function(fe){var ge=this.elements;return ge[0]*=fe,ge[4]*=fe,ge[8]*=fe,ge[12]*=fe,ge[1]*=fe,ge[5]*=fe,ge[9]*=fe,ge[13]*=fe,ge[2]*=fe,ge[6]*=fe,ge[10]*=fe,ge[14]*=fe,ge[3]*=fe,ge[7]*=fe,ge[11]*=fe,ge[15]*=fe,this},applyToVector3Array:function(){var ue;return function(ge,he,ye){ue==void 0&&(ue=new pe.Vector3),he===void 0&&(he=0),ye===void 0&&(ye=ge.length);for(var xe=0,_e=he;xe<ye;xe+=3,_e+=3)ue.fromArray(ge,_e),ue.applyMatrix4(this),ue.toArray(ge,_e);return ge}}(),applyToBuffer:function(){var ue;return function(ge,he,ye){ue==void 0&&(ue=new pe.Vector3),he===void 0&&(he=0),ye===void 0&&(ye=ge.length/ge.itemSize);for(var xe=0,_e=he;xe<ye;xe++,_e++)ue.x=ge.getX(_e),ue.y=ge.getY(_e),ue.z=ge.getZ(_e),ue.applyMatrix4(this),ge.setXYZ(ue.x,ue.y,ue.z);return ge}}(),determinant:function(){var fe=this.elements,ge=fe[0],he=fe[4],ye=fe[8],xe=fe[12],_e=fe[1],ve=fe[5],Ee=fe[9],Te=fe[13],Se=fe[2],Me=fe[6],Ae=fe[10],Le=fe[14],Re=fe[3],Ce=fe[7],we=fe[11],Pe=fe[15];return Re*(+xe*Ee*Me-ye*Te*Me-xe*ve*Ae+he*Te*Ae+ye*ve*Le-he*Ee*Le)+Ce*(+ge*Ee*Le-ge*Te*Ae+xe*_e*Ae-ye*_e*Le+ye*Te*Se-xe*Ee*Se)+we*(+ge*Te*Me-ge*ve*Le-xe*_e*Me+he*_e*Le+xe*ve*Se-he*Te*Se)+Pe*(-ye*ve*Se-ge*Ee*Me+ge*ve*Ae+ye*_e*Me-he*_e*Ae+he*Ee*Se)},transpose:function(){var fe=this.elements,ge;return ge=fe[1],fe[1]=fe[4],fe[4]=ge,ge=fe[2],fe[2]=fe[8],fe[8]=ge,ge=fe[6],fe[6]=fe[9],fe[9]=ge,ge=fe[3],fe[3]=fe[12],fe[12]=ge,ge=fe[7],fe[7]=fe[13],fe[13]=ge,ge=fe[11],fe[11]=fe[14],fe[14]=ge,this},flattenToArrayOffset:function(fe,ge){return console.warn('THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead.'),this.toArray(fe,ge)},getPosition:function(){var ue;return function(){return void 0==ue&&(ue=new pe.Vector3),console.warn('THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.'),ue.setFromMatrixColumn(this,3)}}(),setPosition:function(fe){var ge=this.elements;return ge[12]=fe.x,ge[13]=fe.y,ge[14]=fe.z,this},getInverse:function(fe,ge){var he=this.elements,ye=fe.elements,xe=ye[0],_e=ye[1],ve=ye[2],Ee=ye[3],Te=ye[4],Se=ye[5],Me=ye[6],Ae=ye[7],Le=ye[8],Re=ye[9],Ce=ye[10],we=ye[11],Pe=ye[12],Fe=ye[13],De=ye[14],Ie=ye[15],Be=Re*De*Ae-Fe*Ce*Ae+Fe*Me*we-Se*De*we-Re*Me*Ie+Se*Ce*Ie,Ue=Pe*Ce*Ae-Le*De*Ae-Pe*Me*we+Te*De*we+Le*Me*Ie-Te*Ce*Ie,Ne=Le*Fe*Ae-Pe*Re*Ae+Pe*Se*we-Te*Fe*we-Le*Se*Ie+Te*Re*Ie,Ge=Pe*Re*Me-Le*Fe*Me-Pe*Se*Ce+Te*Fe*Ce+Le*Se*De-Te*Re*De,Ve=xe*Be+_e*Ue+ve*Ne+Ee*Ge;if(0==Ve){var ze='THREE.Matrix4.getInverse(): can\'t invert matrix, determinant is 0';if(ge||!1)throw new Error(ze);else console.warn(ze);return this.identity()}var Oe=1/Ve;return he[0]=Be*Oe,he[1]=(Fe*Ce*Ee-Re*De*Ee-Fe*ve*we+_e*De*we+Re*ve*Ie-_e*Ce*Ie)*Oe,he[2]=(Se*De*Ee-Fe*Me*Ee+Fe*ve*Ae-_e*De*Ae-Se*ve*Ie+_e*Me*Ie)*Oe,he[3]=(Re*Me*Ee-Se*Ce*Ee-Re*ve*Ae+_e*Ce*Ae+Se*ve*we-_e*Me*we)*Oe,he[4]=Ue*Oe,he[5]=(Le*De*Ee-Pe*Ce*Ee+Pe*ve*we-xe*De*we-Le*ve*Ie+xe*Ce*Ie)*Oe,he[6]=(Pe*Me*Ee-Te*De*Ee-Pe*ve*Ae+xe*De*Ae+Te*ve*Ie-xe*Me*Ie)*Oe,he[7]=(Te*Ce*Ee-Le*Me*Ee+Le*ve*Ae-xe*Ce*Ae-Te*ve*we+xe*Me*we)*Oe,he[8]=Ne*Oe,he[9]=(Pe*Re*Ee-Le*Fe*Ee-Pe*_e*we+xe*Fe*we+Le*_e*Ie-xe*Re*Ie)*Oe,he[10]=(Te*Fe*Ee-Pe*Se*Ee+Pe*_e*Ae-xe*Fe*Ae-Te*_e*Ie+xe*Se*Ie)*Oe,he[11]=(Le*Se*Ee-Te*Re*Ee-Le*_e*Ae+xe*Re*Ae+Te*_e*we-xe*Se*we)*Oe,he[12]=Ge*Oe,he[13]=(Le*Fe*ve-Pe*Re*ve+Pe*_e*Ce-xe*Fe*Ce-Le*_e*De+xe*Re*De)*Oe,he[14]=(Pe*Se*ve-Te*Fe*ve-Pe*_e*Me+xe*Fe*Me+Te*_e*De-xe*Se*De)*Oe,he[15]=(Te*Re*ve-Le*Se*ve+Le*_e*Me-xe*Re*Me-Te*_e*Ce+xe*Se*Ce)*Oe,this},scale:function(fe){var ge=this.elements,he=fe.x,ye=fe.y,xe=fe.z;return ge[0]*=he,ge[4]*=ye,ge[8]*=xe,ge[1]*=he,ge[5]*=ye,ge[9]*=xe,ge[2]*=he,ge[6]*=ye,ge[10]*=xe,ge[3]*=he,ge[7]*=ye,ge[11]*=xe,this},getMaxScaleOnAxis:function(){var fe=this.elements,ge=fe[0]*fe[0]+fe[1]*fe[1]+fe[2]*fe[2],he=fe[4]*fe[4]+fe[5]*fe[5]+fe[6]*fe[6],ye=fe[8]*fe[8]+fe[9]*fe[9]+fe[10]*fe[10];return Math.sqrt(Math.max(ge,he,ye))},makeTranslation:function(fe,ge,he){return this.set(1,0,0,fe,0,1,0,ge,0,0,1,he,0,0,0,1),this},makeRotationX:function(fe){var ge=Math.cos(fe),he=Math.sin(fe);return this.set(1,0,0,0,0,ge,-he,0,0,he,ge,0,0,0,0,1),this},makeRotationY:function(fe){var ge=Math.cos(fe),he=Math.sin(fe);return this.set(ge,0,he,0,0,1,0,0,-he,0,ge,0,0,0,0,1),this},makeRotationZ:function(fe){var ge=Math.cos(fe),he=Math.sin(fe);return this.set(ge,-he,0,0,he,ge,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(fe,ge){var he=Math.cos(ge),ye=Math.sin(ge),xe=1-he,_e=fe.x,ve=fe.y,Ee=fe.z,Te=xe*_e,Se=xe*ve;return this.set(Te*_e+he,Te*ve-ye*Ee,Te*Ee+ye*ve,0,Te*ve+ye*Ee,Se*ve+he,Se*Ee-ye*_e,0,Te*Ee-ye*ve,Se*Ee+ye*_e,xe*Ee*Ee+he,0,0,0,0,1),this},makeScale:function(fe,ge,he){return this.set(fe,0,0,0,0,ge,0,0,0,0,he,0,0,0,0,1),this},compose:function(fe,ge,he){return this.makeRotationFromQuaternion(ge),this.scale(he),this.setPosition(fe),this},decompose:function(){var ue,fe;return function(he,ye,xe){void 0==ue&&(ue=new pe.Vector3,fe=new pe.Matrix4);var _e=this.elements,ve=ue.set(_e[0],_e[1],_e[2]).length(),Ee=ue.set(_e[4],_e[5],_e[6]).length(),Te=ue.set(_e[8],_e[9],_e[10]).length(),Se=this.determinant();0>Se&&(ve=-ve),he.x=_e[12],he.y=_e[13],he.z=_e[14],fe.elements.set(this.elements);var Me=1/ve,Ae=1/Ee,Le=1/Te;return fe.elements[0]*=Me,fe.elements[1]*=Me,fe.elements[2]*=Me,fe.elements[4]*=Ae,fe.elements[5]*=Ae,fe.elements[6]*=Ae,fe.elements[8]*=Le,fe.elements[9]*=Le,fe.elements[10]*=Le,ye.setFromRotationMatrix(fe),xe.x=ve,xe.y=Ee,xe.z=Te,this}}(),makeFrustum:function(fe,ge,he,ye,xe,_e){var ve=this.elements;return ve[0]=2*xe/(ge-fe),ve[4]=0,ve[8]=(ge+fe)/(ge-fe),ve[12]=0,ve[1]=0,ve[5]=2*xe/(ye-he),ve[9]=(ye+he)/(ye-he),ve[13]=0,ve[2]=0,ve[6]=0,ve[10]=-(_e+xe)/(_e-xe),ve[14]=-2*_e*xe/(_e-xe),ve[3]=0,ve[7]=0,ve[11]=-1,ve[15]=0,this},makePerspective:function(fe,ge,he,ye){var xe=he*Math.tan(0.5*(pe.Math.DEG2RAD*fe)),_e=-xe;return this.makeFrustum(_e*ge,xe*ge,_e,xe,he,ye)},makeOrthographic:function(fe,ge,he,ye,xe,_e){var ve=this.elements,Ee=1/(ge-fe),Te=1/(he-ye),Se=1/(_e-xe);return ve[0]=2*Ee,ve[4]=0,ve[8]=0,ve[12]=-((ge+fe)*Ee),ve[1]=0,ve[5]=2*Te,ve[9]=0,ve[13]=-((he+ye)*Te),ve[2]=0,ve[6]=0,ve[10]=-2*Se,ve[14]=-((_e+xe)*Se),ve[3]=0,ve[7]=0,ve[11]=0,ve[15]=1,this},equals:function(fe){for(var ge=this.elements,he=fe.elements,ye=0;16>ye;ye++)if(ge[ye]!==he[ye])return!1;return!0},fromArray:function(fe){return this.elements.set(fe),this},toArray:function(fe,ge){void 0===fe&&(fe=[]),void 0===ge&&(ge=0);var he=this.elements;return fe[ge]=he[0],fe[ge+1]=he[1],fe[ge+2]=he[2],fe[ge+3]=he[3],fe[ge+4]=he[4],fe[ge+5]=he[5],fe[ge+6]=he[6],fe[ge+7]=he[7],fe[ge+8]=he[8],fe[ge+9]=he[9],fe[ge+10]=he[10],fe[ge+11]=he[11],fe[ge+12]=he[12],fe[ge+13]=he[13],fe[ge+14]=he[14],fe[ge+15]=he[15],fe}},pe.Ray=function(ue,fe){this.origin=ue===void 0?new pe.Vector3:ue,this.direction=fe===void 0?new pe.Vector3:fe},pe.Ray.prototype={constructor:pe.Ray,set:function(fe,ge){return this.origin.copy(fe),this.direction.copy(ge),this},clone:function(){return new this.constructor().copy(this)},copy:function(fe){return this.origin.copy(fe.origin),this.direction.copy(fe.direction),this},at:function(fe,ge){var he=ge||new pe.Vector3;return he.copy(this.direction).multiplyScalar(fe).add(this.origin)},lookAt:function(fe){return this.direction.copy(fe).sub(this.origin).normalize(),this},recast:function(){var ue=new pe.Vector3;return function(ge){return this.origin.copy(this.at(ge,ue)),this}}(),closestPointToPoint:function(fe,ge){var he=ge||new pe.Vector3;he.subVectors(fe,this.origin);var ye=he.dot(this.direction);return 0>ye?he.copy(this.origin):he.copy(this.direction).multiplyScalar(ye).add(this.origin)},distanceToPoint:function(fe){return Math.sqrt(this.distanceSqToPoint(fe))},distanceSqToPoint:function(){var ue=new pe.Vector3;return function(ge){var he=ue.subVectors(ge,this.origin).dot(this.direction);return 0>he?this.origin.distanceToSquared(ge):(ue.copy(this.direction).multiplyScalar(he).add(this.origin),ue.distanceToSquared(ge))}}(),distanceSqToSegment:function(){var ue=new pe.Vector3,fe=new pe.Vector3,ge=new pe.Vector3;return function(ye,xe,_e,ve){ue.copy(ye).add(xe).multiplyScalar(0.5),fe.copy(xe).sub(ye).normalize(),ge.copy(this.origin).sub(ue);var Ee=0.5*ye.distanceTo(xe),Te=-this.direction.dot(fe),Se=ge.dot(this.direction),Me=-ge.dot(fe),Ae=ge.lengthSq(),Le=Math.abs(1-Te*Te),Re,Ce,we,Pe;if(!(0<Le))Ce=0<Te?-Ee:Ee,Re=Math.max(0,-(Te*Ce+Se)),we=-Re*Re+Ce*(Ce+2*Me)+Ae;else if(Re=Te*Me-Se,Ce=Te*Se-Me,Pe=Ee*Le,!(0<=Re))Ce<=-Pe?(Re=Math.max(0,-(-Te*Ee+Se)),Ce=0<Re?-Ee:Math.min(Math.max(-Ee,-Me),Ee),we=-Re*Re+Ce*(Ce+2*Me)+Ae):Ce<=Pe?(Re=0,Ce=Math.min(Math.max(-Ee,-Me),Ee),we=Ce*(Ce+2*Me)+Ae):(Re=Math.max(0,-(Te*Ee+Se)),Ce=0<Re?Ee:Math.min(Math.max(-Ee,-Me),Ee),we=-Re*Re+Ce*(Ce+2*Me)+Ae);else if(!(Ce>=-Pe))Ce=-Ee,Re=Math.max(0,-(Te*Ce+Se)),we=-Re*Re+Ce*(Ce+2*Me)+Ae;else if(Ce<=Pe){var Fe=1/Le;Re*=Fe,Ce*=Fe,we=Re*(Re+Te*Ce+2*Se)+Ce*(Te*Re+Ce+2*Me)+Ae}else Ce=Ee,Re=Math.max(0,-(Te*Ce+Se)),we=-Re*Re+Ce*(Ce+2*Me)+Ae;return _e&&_e.copy(this.direction).multiplyScalar(Re).add(this.origin),ve&&ve.copy(fe).multiplyScalar(Ce).add(ue),we}}(),intersectSphere:function(){var ue=new pe.Vector3;return function(ge,he){ue.subVectors(ge.center,this.origin);var ye=ue.dot(this.direction),xe=ue.dot(ue)-ye*ye,_e=ge.radius*ge.radius;if(xe>_e)return null;var ve=Math.sqrt(_e-xe),Ee=ye-ve,Te=ye+ve;return 0>Ee&&0>Te?null:0>Ee?this.at(Te,he):this.at(Ee,he)}}(),intersectsSphere:function(fe){return this.distanceToPoint(fe.center)<=fe.radius},distanceToPlane:function(fe){var ge=fe.normal.dot(this.direction);if(0===ge)return 0===fe.distanceToPoint(this.origin)?0:null;var he=-(this.origin.dot(fe.normal)+fe.constant)/ge;return 0<=he?he:null},intersectPlane:function(fe,ge){var he=this.distanceToPlane(fe);return null===he?null:this.at(he,ge)},intersectsPlane:function(fe){var ge=fe.distanceToPoint(this.origin);if(0===ge)return!0;var he=fe.normal.dot(this.direction);return!!(0>he*ge)},intersectBox:function(fe,ge){var Te=1/this.direction.x,Se=1/this.direction.y,Me=1/this.direction.z,Ae=this.origin,he,ye,xe,_e,ve,Ee;return(0<=Te?(he=(fe.min.x-Ae.x)*Te,ye=(fe.max.x-Ae.x)*Te):(he=(fe.max.x-Ae.x)*Te,ye=(fe.min.x-Ae.x)*Te),0<=Se?(xe=(fe.min.y-Ae.y)*Se,_e=(fe.max.y-Ae.y)*Se):(xe=(fe.max.y-Ae.y)*Se,_e=(fe.min.y-Ae.y)*Se),he>_e||xe>ye)?null:((xe>he||he!==he)&&(he=xe),(_e<ye||ye!==ye)&&(ye=_e),0<=Me?(ve=(fe.min.z-Ae.z)*Me,Ee=(fe.max.z-Ae.z)*Me):(ve=(fe.max.z-Ae.z)*Me,Ee=(fe.min.z-Ae.z)*Me),he>Ee||ve>ye)?null:((ve>he||he!==he)&&(he=ve),(Ee<ye||ye!==ye)&&(ye=Ee),0>ye?null:this.at(0<=he?he:ye,ge))},intersectsBox:function(){var ue=new pe.Vector3;return function(ge){return null!==this.intersectBox(ge,ue)}}(),intersectTriangle:function(){var ue=new pe.Vector3,fe=new pe.Vector3,ge=new pe.Vector3,he=new pe.Vector3;return function(xe,_e,ve,Ee,Te){fe.subVectors(_e,xe),ge.subVectors(ve,xe),he.crossVectors(fe,ge);var Se=this.direction.dot(he),Me;if(0<Se){if(Ee)return null;Me=1}else if(0>Se)Me=-1,Se=-Se;else return null;ue.subVectors(this.origin,xe);var Ae=Me*this.direction.dot(ge.crossVectors(ue,ge));if(0>Ae)return null;var Le=Me*this.direction.dot(fe.cross(ue));if(0>Le)return null;if(Ae+Le>Se)return null;var Re=-Me*ue.dot(he);return 0>Re?null:this.at(Re/Se,Te)}}(),applyMatrix4:function(fe){return this.direction.add(this.origin).applyMatrix4(fe),this.origin.applyMatrix4(fe),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(fe){return fe.origin.equals(this.origin)&&fe.direction.equals(this.direction)}},pe.Sphere=function(ue,fe){this.center=ue===void 0?new pe.Vector3:ue,this.radius=fe===void 0?0:fe},pe.Sphere.prototype={constructor:pe.Sphere,set:function(fe,ge){return this.center.copy(fe),this.radius=ge,this},setFromPoints:function(){var ue=new pe.Box3;return function(ge,he){var ye=this.center;void 0===he?ue.setFromPoints(ge).center(ye):ye.copy(he);for(var xe=0,_e=0,ve=ge.length;_e<ve;_e++)xe=Math.max(xe,ye.distanceToSquared(ge[_e]));return this.radius=Math.sqrt(xe),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(fe){return this.center.copy(fe.center),this.radius=fe.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(fe){return fe.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(fe){return fe.distanceTo(this.center)-this.radius},intersectsSphere:function(fe){var ge=this.radius+fe.radius;return fe.center.distanceToSquared(this.center)<=ge*ge},intersectsBox:function(fe){return fe.intersectsSphere(this)},intersectsPlane:function(fe){return Math.abs(this.center.dot(fe.normal)-fe.constant)<=this.radius},clampPoint:function(fe,ge){var he=this.center.distanceToSquared(fe),ye=ge||new pe.Vector3;return ye.copy(fe),he>this.radius*this.radius&&(ye.sub(this.center).normalize(),ye.multiplyScalar(this.radius).add(this.center)),ye},getBoundingBox:function(fe){var ge=fe||new pe.Box3;return ge.set(this.center,this.center),ge.expandByScalar(this.radius),ge},applyMatrix4:function(fe){return this.center.applyMatrix4(fe),this.radius*=fe.getMaxScaleOnAxis(),this},translate:function(fe){return this.center.add(fe),this},equals:function(fe){return fe.center.equals(this.center)&&fe.radius===this.radius}},pe.Frustum=function(ue,fe,ge,he,ye,xe){this.planes=[ue===void 0?new pe.Plane:ue,fe===void 0?new pe.Plane:fe,ge===void 0?new pe.Plane:ge,he===void 0?new pe.Plane:he,ye===void 0?new pe.Plane:ye,xe===void 0?new pe.Plane:xe]},pe.Frustum.prototype={constructor:pe.Frustum,set:function(fe,ge,he,ye,xe,_e){var ve=this.planes;return ve[0].copy(fe),ve[1].copy(ge),ve[2].copy(he),ve[3].copy(ye),ve[4].copy(xe),ve[5].copy(_e),this},clone:function(){return new this.constructor().copy(this)},copy:function(fe){for(var ge=this.planes,he=0;6>he;he++)ge[he].copy(fe.planes[he]);return this},setFromMatrix:function(fe){var ge=this.planes,he=fe.elements,ye=he[0],xe=he[1],_e=he[2],ve=he[3],Ee=he[4],Te=he[5],Se=he[6],Me=he[7],Ae=he[8],Le=he[9],Re=he[10],Ce=he[11],we=he[12],Pe=he[13],Fe=he[14],De=he[15];return ge[0].setComponents(ve-ye,Me-Ee,Ce-Ae,De-we).normalize(),ge[1].setComponents(ve+ye,Me+Ee,Ce+Ae,De+we).normalize(),ge[2].setComponents(ve+xe,Me+Te,Ce+Le,De+Pe).normalize(),ge[3].setComponents(ve-xe,Me-Te,Ce-Le,De-Pe).normalize(),ge[4].setComponents(ve-_e,Me-Se,Ce-Re,De-Fe).normalize(),ge[5].setComponents(ve+_e,Me+Se,Ce+Re,De+Fe).normalize(),this},intersectsObject:function(){var ue=new pe.Sphere;return function(ge){var he=ge.geometry;return null===he.boundingSphere&&he.computeBoundingSphere(),ue.copy(he.boundingSphere).applyMatrix4(ge.matrixWorld),this.intersectsSphere(ue)}}(),intersectsSprite:function(){var ue=new pe.Sphere;return function(ge){return ue.center.set(0,0,0),ue.radius=0.7071067811865476,ue.applyMatrix4(ge.matrixWorld),this.intersectsSphere(ue)}}(),intersectsSphere:function(fe){for(var ge=this.planes,he=fe.center,ye=-fe.radius,xe=0,_e;6>xe;xe++)if(_e=ge[xe].distanceToPoint(he),_e<ye)return!1;return!0},intersectsBox:function(){var ue=new pe.Vector3,fe=new pe.Vector3;return function(he){for(var ye=this.planes,xe=0,_e;6>xe;xe++){_e=ye[xe],ue.x=0<_e.normal.x?he.min.x:he.max.x,fe.x=0<_e.normal.x?he.max.x:he.min.x,ue.y=0<_e.normal.y?he.min.y:he.max.y,fe.y=0<_e.normal.y?he.max.y:he.min.y,ue.z=0<_e.normal.z?he.min.z:he.max.z,fe.z=0<_e.normal.z?he.max.z:he.min.z;var ve=_e.distanceToPoint(ue),Ee=_e.distanceToPoint(fe);if(0>ve&&0>Ee)return!1}return!0}}(),containsPoint:function(fe){for(var ge=this.planes,he=0;6>he;he++)if(0>ge[he].distanceToPoint(fe))return!1;return!0}},pe.Plane=function(ue,fe){this.normal=ue===void 0?new pe.Vector3(1,0,0):ue,this.constant=fe===void 0?0:fe},pe.Plane.prototype={constructor:pe.Plane,set:function(fe,ge){return this.normal.copy(fe),this.constant=ge,this},setComponents:function(fe,ge,he,ye){return this.normal.set(fe,ge,he),this.constant=ye,this},setFromNormalAndCoplanarPoint:function(fe,ge){return this.normal.copy(fe),this.constant=-ge.dot(this.normal),this},setFromCoplanarPoints:function(){var ue=new pe.Vector3,fe=new pe.Vector3;return function(he,ye,xe){var _e=ue.subVectors(xe,ye).cross(fe.subVectors(he,ye)).normalize();return this.setFromNormalAndCoplanarPoint(_e,he),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(fe){return this.normal.copy(fe.normal),this.constant=fe.constant,this},normalize:function(){var fe=1/this.normal.length();return this.normal.multiplyScalar(fe),this.constant*=fe,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(fe){return this.normal.dot(fe)+this.constant},distanceToSphere:function(fe){return this.distanceToPoint(fe.center)-fe.radius},projectPoint:function(fe,ge){return this.orthoPoint(fe,ge).sub(fe).negate()},orthoPoint:function(fe,ge){var he=this.distanceToPoint(fe),ye=ge||new pe.Vector3;return ye.copy(this.normal).multiplyScalar(he)},intersectLine:function(){var ue=new pe.Vector3;return function(ge,he){var ye=he||new pe.Vector3,xe=ge.delta(ue),_e=this.normal.dot(xe);if(0===_e)return 0===this.distanceToPoint(ge.start)?ye.copy(ge.start):void 0;var ve=-(ge.start.dot(this.normal)+this.constant)/_e;return 0>ve||1<ve?void 0:ye.copy(xe).multiplyScalar(ve).add(ge.start)}}(),intersectsLine:function(fe){var ge=this.distanceToPoint(fe.start),he=this.distanceToPoint(fe.end);return 0>ge&&0<he||0>he&&0<ge},intersectsBox:function(fe){return fe.intersectsPlane(this)},intersectsSphere:function(fe){return fe.intersectsPlane(this)},coplanarPoint:function(fe){var ge=fe||new pe.Vector3;return ge.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var ue=new pe.Vector3,fe=new pe.Matrix3;return function(he,ye){var xe=this.coplanarPoint(ue).applyMatrix4(he),_e=ye||fe.getNormalMatrix(he),ve=this.normal.applyMatrix3(_e).normalize();return this.constant=-xe.dot(ve),this}}(),translate:function(fe){return this.constant-=fe.dot(this.normal),this},equals:function(fe){return fe.normal.equals(this.normal)&&fe.constant===this.constant}},pe.Spherical=function(ue,fe,ge){return this.radius=void 0===ue?1:ue,this.phi=void 0===fe?0:fe,this.theta=void 0===ge?0:ge,this},pe.Spherical.prototype={constructor:pe.Spherical,set:function(fe,ge,he){return this.radius=fe,this.phi=ge,this.theta=he,this},clone:function(){return new this.constructor().copy(this)},copy:function(fe){return this.radius.copy(fe.radius),this.phi.copy(fe.phi),this.theta.copy(fe.theta),this},makeSafe:function(){var fe=1e-6;return this.phi=Math.max(fe,Math.min(Math.PI-fe,this.phi)),this},setFromVector3:function(fe){return this.radius=fe.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(fe.x,fe.z),this.phi=Math.acos(pe.Math.clamp(fe.y/this.radius,-1,1))),this}},pe.Math={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var ue='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split(''),fe=Array(36),ge=0,he;return function(){for(var xe=0;36>xe;xe++)8===xe||13===xe||18===xe||23===xe?fe[xe]='-':14===xe?fe[xe]='4':(2>=ge&&(ge=0|33554432+16777216*Math.random()),he=15&ge,ge>>=4,fe[xe]=ue[19===xe?8|3&he:he]);return fe.join('')}}(),clamp:function(fe,ge,he){return Math.max(ge,Math.min(he,fe))},euclideanModulo:function(fe,ge){return(fe%ge+ge)%ge},mapLinear:function(fe,ge,he,ye,xe){return ye+(fe-ge)*(xe-ye)/(he-ge)},smoothstep:function(fe,ge,he){return fe<=ge?0:fe>=he?1:(fe=(fe-ge)/(he-ge),fe*fe*(3-2*fe))},smootherstep:function(fe,ge,he){return fe<=ge?0:fe>=he?1:(fe=(fe-ge)/(he-ge),fe*fe*fe*(fe*(6*fe-15)+10))},random16:function(){return console.warn('THREE.Math.random16() has been deprecated. Use Math.random() instead.'),Math.random()},randInt:function(fe,ge){return fe+Math.floor(Math.random()*(ge-fe+1))},randFloat:function(fe,ge){return fe+Math.random()*(ge-fe)},randFloatSpread:function(fe){return fe*(0.5-Math.random())},degToRad:function(fe){return fe*pe.Math.DEG2RAD},radToDeg:function(fe){return fe*pe.Math.RAD2DEG},isPowerOfTwo:function(fe){return 0==(fe&fe-1)&&0!==fe},nearestPowerOfTwo:function(fe){return Math.pow(2,Math.round(Math.log(fe)/Math.LN2))},nextPowerOfTwo:function(fe){return fe--,fe|=fe>>1,fe|=fe>>2,fe|=fe>>4,fe|=fe>>8,fe|=fe>>16,fe++,fe}},pe.Spline=function(ue){function fe(Le,Re,Ce,we,Pe,Fe,De){var Ie=0.5*(Ce-Le),Be=0.5*(we-Re);return(2*(Re-Ce)+Ie+Be)*De+(-3*(Re-Ce)-2*Ie-Be)*Fe+Ie*Pe+Re}this.points=ue;var ge=[],he={x:0,y:0,z:0},ye,xe,_e,ve,Ee,Te,Se,Me,Ae;this.initFromArray=function(Le){this.points=[];for(var Re=0;Re<Le.length;Re++)this.points[Re]={x:Le[Re][0],y:Le[Re][1],z:Le[Re][2]}},this.getPoint=function(Le){return ye=(this.points.length-1)*Le,xe=Math.floor(ye),_e=ye-xe,ge[0]=0===xe?xe:xe-1,ge[1]=xe,ge[2]=xe>this.points.length-2?this.points.length-1:xe+1,ge[3]=xe>this.points.length-3?this.points.length-1:xe+2,Te=this.points[ge[0]],Se=this.points[ge[1]],Me=this.points[ge[2]],Ae=this.points[ge[3]],ve=_e*_e,Ee=_e*ve,he.x=fe(Te.x,Se.x,Me.x,Ae.x,_e,ve,Ee),he.y=fe(Te.y,Se.y,Me.y,Ae.y,_e,ve,Ee),he.z=fe(Te.z,Se.z,Me.z,Ae.z,_e,ve,Ee),he},this.getControlPointsArray=function(){var Ce=this.points.length,we=[],Le,Re;for(Le=0;Le<Ce;Le++)Re=this.points[Le],we[Le]=[Re.x,Re.y,Re.z];return we},this.getLength=function(Le){var Fe=0,De=0,Ie=0,Be=new pe.Vector3,Ue=new pe.Vector3,Ne=[],Ge=0,Re,Ce,we,Pe;for(Ne[0]=0,Le||(Le=100),we=this.points.length*Le,Be.copy(this.points[0]),Re=1;Re<we;Re++)Ce=Re/we,Pe=this.getPoint(Ce),Ue.copy(Pe),Ge+=Ue.distanceTo(Be),Be.copy(Pe),Fe=(this.points.length-1)*Ce,De=Math.floor(Fe),De!==Ie&&(Ne[De]=Ge,Ie=De);return Ne[Ne.length]=Ge,{chunks:Ne,total:Ge}},this.reparametrizeByArcLength=function(Le){var Ue=[],Ne=new pe.Vector3,Ge=this.getLength(),Re,Ce,we,Pe,Fe,De,Ie,Be;for(Ue.push(Ne.copy(this.points[0]).clone()),Re=1;Re<this.points.length;Re++){for(De=Ge.chunks[Re]-Ge.chunks[Re-1],Ie=Math.ceil(Le*De/Ge.total),Pe=(Re-1)/(this.points.length-1),Fe=Re/(this.points.length-1),Ce=1;Ce<Ie-1;Ce++)we=Pe+Ce*(1/Ie)*(Fe-Pe),Be=this.getPoint(we),Ue.push(Ne.copy(Be).clone());Ue.push(Ne.copy(this.points[Re]).clone())}this.points=Ue}},pe.Triangle=function(ue,fe,ge){this.a=ue===void 0?new pe.Vector3:ue,this.b=fe===void 0?new pe.Vector3:fe,this.c=ge===void 0?new pe.Vector3:ge},pe.Triangle.normal=function(){var ue=new pe.Vector3;return function(ge,he,ye,xe){var _e=xe||new pe.Vector3;_e.subVectors(ye,he),ue.subVectors(ge,he),_e.cross(ue);var ve=_e.lengthSq();return 0<ve?_e.multiplyScalar(1/Math.sqrt(ve)):_e.set(0,0,0)}}(),pe.Triangle.barycoordFromPoint=function(){var ue=new pe.Vector3,fe=new pe.Vector3,ge=new pe.Vector3;return function(ye,xe,_e,ve,Ee){ue.subVectors(ve,xe),fe.subVectors(_e,xe),ge.subVectors(ye,xe);var Te=ue.dot(ue),Se=ue.dot(fe),Me=ue.dot(ge),Ae=fe.dot(fe),Le=fe.dot(ge),Re=Te*Ae-Se*Se,Ce=Ee||new pe.Vector3;if(0==Re)return Ce.set(-2,-1,-1);var we=1/Re,Pe=(Ae*Me-Se*Le)*we,Fe=(Te*Le-Se*Me)*we;return Ce.set(1-Pe-Fe,Fe,Pe)}}(),pe.Triangle.containsPoint=function(){var ue=new pe.Vector3;return function(ge,he,ye,xe){var _e=pe.Triangle.barycoordFromPoint(ge,he,ye,xe,ue);return 0<=_e.x&&0<=_e.y&&1>=_e.x+_e.y}}(),pe.Triangle.prototype={constructor:pe.Triangle,set:function(fe,ge,he){return this.a.copy(fe),this.b.copy(ge),this.c.copy(he),this},setFromPointsAndIndices:function(fe,ge,he,ye){return this.a.copy(fe[ge]),this.b.copy(fe[he]),this.c.copy(fe[ye]),this},clone:function(){return new this.constructor().copy(this)},copy:function(fe){return this.a.copy(fe.a),this.b.copy(fe.b),this.c.copy(fe.c),this},area:function(){var ue=new pe.Vector3,fe=new pe.Vector3;return function(){return ue.subVectors(this.c,this.b),fe.subVectors(this.a,this.b),0.5*ue.cross(fe).length()}}(),midpoint:function(fe){var ge=fe||new pe.Vector3;return ge.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(fe){return pe.Triangle.normal(this.a,this.b,this.c,fe)},plane:function(fe){var ge=fe||new pe.Plane;return ge.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(fe,ge){return pe.Triangle.barycoordFromPoint(fe,this.a,this.b,this.c,ge)},containsPoint:function(fe){return pe.Triangle.containsPoint(fe,this.a,this.b,this.c)},closestPointToPoint:function(){var ue,fe,ge,he;return function(xe,_e){void 0==ue&&(ue=new pe.Plane,fe=[new pe.Line3,new pe.Line3,new pe.Line3],ge=new pe.Vector3,he=new pe.Vector3);var ve=_e||new pe.Vector3,Ee=Infinity;if(ue.setFromCoplanarPoints(this.a,this.b,this.c),ue.projectPoint(xe,ge),!0===this.containsPoint(ge))ve.copy(ge);else{fe[0].set(this.a,this.b),fe[1].set(this.b,this.c),fe[2].set(this.c,this.a);for(var Te=0;Te<fe.length;Te++){fe[Te].closestPointToPoint(ge,!0,he);var Se=ge.distanceToSquared(he);Se<Ee&&(Ee=Se,ve.copy(he))}}return ve}}(),equals:function(fe){return fe.a.equals(this.a)&&fe.b.equals(this.b)&&fe.c.equals(this.c)}},pe.Interpolant=function(ue,fe,ge,he){this.parameterPositions=ue,this._cachedIndex=0,this.resultBuffer=he===void 0?new fe.constructor(ge):he,this.sampleValues=fe,this.valueSize=ge},pe.Interpolant.prototype={constructor:pe.Interpolant,evaluate:function(fe){var ge=this.parameterPositions,he=this._cachedIndex,ye=ge[he],xe=ge[he-1];validate_interval:{seek:{var _e;linear_scan:{forward_scan:if(!(fe<ye)){for(var ve=he+2;;){if(void 0===ye){if(fe<xe)break forward_scan;return he=ge.length,this._cachedIndex=he,this.afterEnd_(he-1,fe,xe)}if(he===ve)break;if(xe=ye,ye=ge[++he],fe<ye)break seek}_e=ge.length;break linear_scan}if(!(fe>=xe)){var Ee=ge[1];fe<Ee&&(he=2,xe=Ee);for(var ve=he-2;;){if(void 0===xe)return this._cachedIndex=0,this.beforeStart_(0,fe,ye);if(he===ve)break;if(ye=xe,xe=ge[--he-1],fe>=xe)break seek}_e=he,he=0;break linear_scan}break validate_interval}for(;he<_e;){var Te=he+_e>>>1;fe<ge[Te]?_e=Te:he=Te+1}if(ye=ge[he],xe=ge[he-1],void 0===xe)return this._cachedIndex=0,this.beforeStart_(0,fe,ye);if(void 0===ye)return he=ge.length,this._cachedIndex=he,this.afterEnd_(he-1,xe,fe)}this._cachedIndex=he,this.intervalChanged_(he,xe,ye)}return this.interpolate_(he,xe,fe,ye)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(fe){for(var ge=this.resultBuffer,he=this.sampleValues,ye=this.valueSize,_e=0;_e!==ye;++_e)ge[_e]=he[fe*ye+_e];return ge},interpolate_:function(){throw new Error('call to abstract method')},intervalChanged_:function(){}},le(pe.Interpolant.prototype,{beforeStart_:pe.Interpolant.prototype.copySampleValue_,afterEnd_:pe.Interpolant.prototype.copySampleValue_}),pe.CubicInterpolant=function(ue,fe,ge,he){pe.Interpolant.call(this,ue,fe,ge,he),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0},pe.CubicInterpolant.prototype=le(Object.create(pe.Interpolant.prototype),{constructor:pe.CubicInterpolant,DefaultSettings_:{endingStart:pe.ZeroCurvatureEnding,endingEnd:pe.ZeroCurvatureEnding},intervalChanged_:function(fe,ge,he){var ye=this.parameterPositions,xe=fe-2,_e=fe+1,ve=ye[xe],Ee=ye[_e];if(ve===void 0)switch(this.getSettings_().endingStart){case pe.ZeroSlopeEnding:xe=fe,ve=2*ge-he;break;case pe.WrapAroundEnding:xe=ye.length-2,ve=ge+ye[xe]-ye[xe+1];break;default:xe=fe,ve=he;}if(void 0===Ee)switch(this.getSettings_().endingEnd){case pe.ZeroSlopeEnding:_e=fe,Ee=2*he-ge;break;case pe.WrapAroundEnding:_e=1,Ee=he+ye[1]-ye[0];break;default:_e=fe-1,Ee=ge;}var Te=0.5*(he-ge),Se=this.valueSize;this._weightPrev=Te/(ge-ve),this._weightNext=Te/(Ee-he),this._offsetPrev=xe*Se,this._offsetNext=_e*Se},interpolate_:function(fe,ge,he,ye){for(var xe=this.resultBuffer,_e=this.sampleValues,ve=this.valueSize,Ee=fe*ve,Se=this._offsetPrev,Me=this._offsetNext,Ae=this._weightPrev,Le=this._weightNext,Re=(he-ge)/(ye-ge),Ce=Re*Re,we=Ce*Re,Be=0;Be!==ve;++Be)xe[Be]=(-Ae*we+2*Ae*Ce-Ae*Re)*_e[Se+Be]+((1+Ae)*we+(-1.5-2*Ae)*Ce+(-0.5+Ae)*Re+1)*_e[Ee-ve+Be]+((-1-Le)*we+(1.5+Le)*Ce+0.5*Re)*_e[Ee+Be]+(Le*we-Le*Ce)*_e[Me+Be];return xe}}),pe.DiscreteInterpolant=function(ue,fe,ge,he){pe.Interpolant.call(this,ue,fe,ge,he)},pe.DiscreteInterpolant.prototype=le(Object.create(pe.Interpolant.prototype),{constructor:pe.DiscreteInterpolant,interpolate_:function(fe){return this.copySampleValue_(fe-1)}}),pe.LinearInterpolant=function(ue,fe,ge,he){pe.Interpolant.call(this,ue,fe,ge,he)},pe.LinearInterpolant.prototype=le(Object.create(pe.Interpolant.prototype),{constructor:pe.LinearInterpolant,interpolate_:function(fe,ge,he,ye){for(var xe=this.resultBuffer,_e=this.sampleValues,ve=this.valueSize,Ee=fe*ve,Se=(he-ge)/(ye-ge),Ae=0;Ae!==ve;++Ae)xe[Ae]=_e[Ee-ve+Ae]*(1-Se)+_e[Ee+Ae]*Se;return xe}}),pe.QuaternionLinearInterpolant=function(ue,fe,ge,he){pe.Interpolant.call(this,ue,fe,ge,he)},pe.QuaternionLinearInterpolant.prototype=le(Object.create(pe.Interpolant.prototype),{constructor:pe.QuaternionLinearInterpolant,interpolate_:function(fe,ge,he,ye){for(var xe=this.resultBuffer,_e=this.sampleValues,ve=this.valueSize,Ee=fe*ve,Se=Ee+ve;Ee!==Se;Ee+=4)pe.Quaternion.slerpFlat(xe,0,_e,Ee-ve,_e,Ee,(he-ge)/(ye-ge));return xe}}),pe.Clock=function(ue){this.autoStart=!(ue!==void 0)||ue,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},pe.Clock.prototype={constructor:pe.Clock,start:function(){this.startTime=(performance||Date).now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var fe=0;if(this.autoStart&&!this.running&&this.start(),this.running){var ge=(performance||Date).now();fe=(ge-this.oldTime)/1e3,this.oldTime=ge,this.elapsedTime+=fe}return fe}},pe.EventDispatcher=function(){},le(pe.EventDispatcher.prototype,{addEventListener:function(fe,ge){this._listeners===void 0&&(this._listeners={});var he=this._listeners;he[fe]===void 0&&(he[fe]=[]),-1===he[fe].indexOf(ge)&&he[fe].push(ge)},hasEventListener:function(fe,ge){if(this._listeners===void 0)return!1;var he=this._listeners;return void 0!==he[fe]&&-1!==he[fe].indexOf(ge)},removeEventListener:function(fe,ge){if(void 0!==this._listeners){var he=this._listeners,ye=he[fe];if(void 0!==ye){var xe=ye.indexOf(ge);-1!==xe&&ye.splice(xe,1)}}},dispatchEvent:function(fe){if(void 0!==this._listeners){var ge=this._listeners,he=ge[fe.type];if(void 0!==he){fe.target=this;var ye=[],xe=0,_e=he.length;for(xe=0;xe<_e;xe++)ye[xe]=he[xe];for(xe=0;xe<_e;xe++)ye[xe].call(this,fe)}}}}),pe.Layers=function(){this.mask=1},pe.Layers.prototype={constructor:pe.Layers,set:function(fe){this.mask=1<<fe},enable:function(fe){this.mask|=1<<fe},toggle:function(fe){this.mask^=1<<fe},disable:function(fe){this.mask&=~(1<<fe)},test:function(fe){return 0!=(this.mask&fe.mask)}},function(ue){function fe(he,ye){return he.distance-ye.distance}function ge(he,ye,xe,_e){if(!1!==he.visible&&(he.raycast(ye,xe),!0===_e))for(var ve=he.children,Ee=0,Te=ve.length;Ee<Te;Ee++)ge(ve[Ee],ye,xe,!0)}ue.Raycaster=function(he,ye,xe,_e){this.ray=new ue.Ray(he,ye),this.near=xe||0,this.far=_e||Infinity,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn('THREE.Raycaster: params.PointCloud has been renamed to params.Points.'),this.Points}}})},ue.Raycaster.prototype={constructor:ue.Raycaster,linePrecision:1,set:function(ye,xe){this.ray.set(ye,xe)},setFromCamera:function(ye,xe){xe instanceof ue.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(xe.matrixWorld),this.ray.direction.set(ye.x,ye.y,0.5).unproject(xe).sub(this.ray.origin).normalize()):xe instanceof ue.OrthographicCamera?(this.ray.origin.set(ye.x,ye.y,(xe.near+xe.far)/(xe.near-xe.far)).unproject(xe),this.ray.direction.set(0,0,-1).transformDirection(xe.matrixWorld)):console.error('THREE.Raycaster: Unsupported camera type.')},intersectObject:function(ye,xe){var _e=[];return ge(ye,this,_e,xe),_e.sort(fe),_e},intersectObjects:function(ye,xe){var _e=[];if(!1===Array.isArray(ye))return console.warn('THREE.Raycaster.intersectObjects: objects is not an Array.'),_e;for(var ve=0,Ee=ye.length;ve<Ee;ve++)ge(ye[ve],this,_e,xe);return _e.sort(fe),_e}}}(pe),pe.Object3D=function(){Object.defineProperty(this,'id',{value:pe.Object3DIdCount++}),this.uuid=pe.Math.generateUUID(),this.name='',this.type='Object3D',this.parent=null,this.children=[],this.up=pe.Object3D.DefaultUp.clone();var ge=new pe.Vector3,he=new pe.Euler,ye=new pe.Quaternion,xe=new pe.Vector3(1,1,1);he.onChange(function(){ye.setFromEuler(he,!1)}),ye.onChange(function(){he.setFromQuaternion(ye,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:ge},rotation:{enumerable:!0,value:he},quaternion:{enumerable:!0,value:ye},scale:{enumerable:!0,value:xe},modelViewMatrix:{value:new pe.Matrix4},normalMatrix:{value:new pe.Matrix3}}),this.matrix=new pe.Matrix4,this.matrixWorld=new pe.Matrix4,this.matrixAutoUpdate=pe.Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new pe.Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}},pe.Object3D.DefaultUp=new pe.Vector3(0,1,0),pe.Object3D.DefaultMatrixAutoUpdate=!0,le(pe.Object3D.prototype,pe.EventDispatcher.prototype,{applyMatrix:function(fe){this.matrix.multiplyMatrices(fe,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(fe,ge){this.quaternion.setFromAxisAngle(fe,ge)},setRotationFromEuler:function(fe){this.quaternion.setFromEuler(fe,!0)},setRotationFromMatrix:function(fe){this.quaternion.setFromRotationMatrix(fe)},setRotationFromQuaternion:function(fe){this.quaternion.copy(fe)},rotateOnAxis:function(){var ue=new pe.Quaternion;return function(ge,he){return ue.setFromAxisAngle(ge,he),this.quaternion.multiply(ue),this}}(),rotateX:function(){var ue=new pe.Vector3(1,0,0);return function(ge){return this.rotateOnAxis(ue,ge)}}(),rotateY:function(){var ue=new pe.Vector3(0,1,0);return function(ge){return this.rotateOnAxis(ue,ge)}}(),rotateZ:function(){var ue=new pe.Vector3(0,0,1);return function(ge){return this.rotateOnAxis(ue,ge)}}(),translateOnAxis:function(){var ue=new pe.Vector3;return function(ge,he){return ue.copy(ge).applyQuaternion(this.quaternion),this.position.add(ue.multiplyScalar(he)),this}}(),translateX:function(){var ue=new pe.Vector3(1,0,0);return function(ge){return this.translateOnAxis(ue,ge)}}(),translateY:function(){var ue=new pe.Vector3(0,1,0);return function(ge){return this.translateOnAxis(ue,ge)}}(),translateZ:function(){var ue=new pe.Vector3(0,0,1);return function(ge){return this.translateOnAxis(ue,ge)}}(),localToWorld:function(fe){return fe.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var ue=new pe.Matrix4;return function(ge){return ge.applyMatrix4(ue.getInverse(this.matrixWorld))}}(),lookAt:function(){var ue=new pe.Matrix4;return function(ge){ue.lookAt(ge,this.position,this.up),this.quaternion.setFromRotationMatrix(ue)}}(),add:function(fe){if(1<arguments.length){for(var ge=0;ge<arguments.length;ge++)this.add(arguments[ge]);return this}return fe===this?(console.error('THREE.Object3D.add: object can\'t be added as a child of itself.',fe),this):(fe instanceof pe.Object3D?(null!==fe.parent&&fe.parent.remove(fe),fe.parent=this,fe.dispatchEvent({type:'added'}),this.children.push(fe)):console.error('THREE.Object3D.add: object not an instance of THREE.Object3D.',fe),this)},remove:function(fe){if(1<arguments.length)for(var ge=0;ge<arguments.length;ge++)this.remove(arguments[ge]);var he=this.children.indexOf(fe);-1!==he&&(fe.parent=null,fe.dispatchEvent({type:'removed'}),this.children.splice(he,1))},getObjectById:function(fe){return this.getObjectByProperty('id',fe)},getObjectByName:function(fe){return this.getObjectByProperty('name',fe)},getObjectByProperty:function(fe,ge){if(this[fe]===ge)return this;for(var he=0,ye=this.children.length;he<ye;he++){var xe=this.children[he],_e=xe.getObjectByProperty(fe,ge);if(_e!==void 0)return _e}},getWorldPosition:function(fe){var ge=fe||new pe.Vector3;return this.updateMatrixWorld(!0),ge.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var ue=new pe.Vector3,fe=new pe.Vector3;return function(he){var ye=he||new pe.Quaternion;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(ue,ye,fe),ye}}(),getWorldRotation:function(){var ue=new pe.Quaternion;return function(ge){var he=ge||new pe.Euler;return this.getWorldQuaternion(ue),he.setFromQuaternion(ue,this.rotation.order,!1)}}(),getWorldScale:function(){var ue=new pe.Vector3,fe=new pe.Quaternion;return function(he){var ye=he||new pe.Vector3;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(ue,fe,ye),ye}}(),getWorldDirection:function(){var ue=new pe.Quaternion;return function(ge){var he=ge||new pe.Vector3;return this.getWorldQuaternion(ue),he.set(0,0,1).applyQuaternion(ue)}}(),raycast:function(){},traverse:function(fe){fe(this);for(var ge=this.children,he=0,ye=ge.length;he<ye;he++)ge[he].traverse(fe)},traverseVisible:function(fe){if(!1!==this.visible){fe(this);for(var ge=this.children,he=0,ye=ge.length;he<ye;he++)ge[he].traverseVisible(fe)}},traverseAncestors:function(fe){var ge=this.parent;null!==ge&&(fe(ge),ge.traverseAncestors(fe))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(fe){!0===this.matrixAutoUpdate&&this.updateMatrix(),(!0===this.matrixWorldNeedsUpdate||!0===fe)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,fe=!0);for(var ge=0,he=this.children.length;ge<he;ge++)this.children[ge].updateMatrixWorld(fe)},toJSON:function(fe){function ge(Me){var Ae=[];for(var Le in Me){var Re=Me[Le];delete Re.metadata,Ae.push(Re)}return Ae}var he=void 0===fe||''===fe,ye={};he&&(fe={geometries:{},materials:{},textures:{},images:{}},ye.metadata={version:4.4,type:'Object',generator:'Object3D.toJSON'});var xe={};if(xe.uuid=this.uuid,xe.type=this.type,''!==this.name&&(xe.name=this.name),'{}'!==JSON.stringify(this.userData)&&(xe.userData=this.userData),!0===this.castShadow&&(xe.castShadow=!0),!0===this.receiveShadow&&(xe.receiveShadow=!0),!1===this.visible&&(xe.visible=!1),xe.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===fe.geometries[this.geometry.uuid]&&(fe.geometries[this.geometry.uuid]=this.geometry.toJSON(fe)),xe.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===fe.materials[this.material.uuid]&&(fe.materials[this.material.uuid]=this.material.toJSON(fe)),xe.material=this.material.uuid),0<this.children.length){xe.children=[];for(var _e=0;_e<this.children.length;_e++)xe.children.push(this.children[_e].toJSON(fe).object)}if(he){var ve=ge(fe.geometries),Ee=ge(fe.materials),Te=ge(fe.textures),Se=ge(fe.images);0<ve.length&&(ye.geometries=ve),0<Ee.length&&(ye.materials=Ee),0<Te.length&&(ye.textures=Te),0<Se.length&&(ye.images=Se)}return ye.object=xe,ye},clone:function(fe){return new this.constructor().copy(this,fe)},copy:function(fe,ge){if(void 0===ge&&(ge=!0),this.name=fe.name,this.up.copy(fe.up),this.position.copy(fe.position),this.quaternion.copy(fe.quaternion),this.scale.copy(fe.scale),this.matrix.copy(fe.matrix),this.matrixWorld.copy(fe.matrixWorld),this.matrixAutoUpdate=fe.matrixAutoUpdate,this.matrixWorldNeedsUpdate=fe.matrixWorldNeedsUpdate,this.visible=fe.visible,this.castShadow=fe.castShadow,this.receiveShadow=fe.receiveShadow,this.frustumCulled=fe.frustumCulled,this.renderOrder=fe.renderOrder,this.userData=JSON.parse(JSON.stringify(fe.userData)),!0===ge)for(var he=0,ye;he<fe.children.length;he++)ye=fe.children[he],this.add(ye.clone());return this}}),pe.Object3DIdCount=0,pe.Face3=function(ue,fe,ge,he,ye,xe){this.a=ue,this.b=fe,this.c=ge,this.normal=he instanceof pe.Vector3?he:new pe.Vector3,this.vertexNormals=Array.isArray(he)?he:[],this.color=ye instanceof pe.Color?ye:new pe.Color,this.vertexColors=Array.isArray(ye)?ye:[],this.materialIndex=xe===void 0?0:xe},pe.Face3.prototype={constructor:pe.Face3,clone:function(){return new this.constructor().copy(this)},copy:function(fe){this.a=fe.a,this.b=fe.b,this.c=fe.c,this.normal.copy(fe.normal),this.color.copy(fe.color),this.materialIndex=fe.materialIndex;for(var ge=0,he=fe.vertexNormals.length;ge<he;ge++)this.vertexNormals[ge]=fe.vertexNormals[ge].clone();for(var ge=0,he=fe.vertexColors.length;ge<he;ge++)this.vertexColors[ge]=fe.vertexColors[ge].clone();return this}},pe.BufferAttribute=function(ue,fe,ge){this.uuid=pe.Math.generateUUID(),this.array=ue,this.itemSize=fe,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0,this.normalized=!0===ge},pe.BufferAttribute.prototype={constructor:pe.BufferAttribute,get count(){return this.array.length/this.itemSize},set needsUpdate(ue){!0===ue&&this.version++},setDynamic:function(fe){return this.dynamic=fe,this},copy:function(fe){return this.array=new fe.array.constructor(fe.array),this.itemSize=fe.itemSize,this.dynamic=fe.dynamic,this},copyAt:function(fe,ge,he){fe*=this.itemSize,he*=ge.itemSize;for(var ye=0,xe=this.itemSize;ye<xe;ye++)this.array[fe+ye]=ge.array[he+ye];return this},copyArray:function(fe){return this.array.set(fe),this},copyColorsArray:function(fe){for(var ge=this.array,he=0,ye=0,xe=fe.length,_e;ye<xe;ye++)_e=fe[ye],void 0===_e&&(console.warn('THREE.BufferAttribute.copyColorsArray(): color is undefined',ye),_e=new pe.Color),ge[he++]=_e.r,ge[he++]=_e.g,ge[he++]=_e.b;return this},copyIndicesArray:function(fe){for(var ge=this.array,he=0,ye=0,xe=fe.length,_e;ye<xe;ye++)_e=fe[ye],ge[he++]=_e.a,ge[he++]=_e.b,ge[he++]=_e.c;return this},copyVector2sArray:function(fe){for(var ge=this.array,he=0,ye=0,xe=fe.length,_e;ye<xe;ye++)_e=fe[ye],void 0===_e&&(console.warn('THREE.BufferAttribute.copyVector2sArray(): vector is undefined',ye),_e=new pe.Vector2),ge[he++]=_e.x,ge[he++]=_e.y;return this},copyVector3sArray:function(fe){for(var ge=this.array,he=0,ye=0,xe=fe.length,_e;ye<xe;ye++)_e=fe[ye],void 0===_e&&(console.warn('THREE.BufferAttribute.copyVector3sArray(): vector is undefined',ye),_e=new pe.Vector3),ge[he++]=_e.x,ge[he++]=_e.y,ge[he++]=_e.z;return this},copyVector4sArray:function(fe){for(var ge=this.array,he=0,ye=0,xe=fe.length,_e;ye<xe;ye++)_e=fe[ye],void 0===_e&&(console.warn('THREE.BufferAttribute.copyVector4sArray(): vector is undefined',ye),_e=new pe.Vector4),ge[he++]=_e.x,ge[he++]=_e.y,ge[he++]=_e.z,ge[he++]=_e.w;return this},set:function(fe,ge){return void 0===ge&&(ge=0),this.array.set(fe,ge),this},getX:function(fe){return this.array[fe*this.itemSize]},setX:function(fe,ge){return this.array[fe*this.itemSize]=ge,this},getY:function(fe){return this.array[fe*this.itemSize+1]},setY:function(fe,ge){return this.array[fe*this.itemSize+1]=ge,this},getZ:function(fe){return this.array[fe*this.itemSize+2]},setZ:function(fe,ge){return this.array[fe*this.itemSize+2]=ge,this},getW:function(fe){return this.array[fe*this.itemSize+3]},setW:function(fe,ge){return this.array[fe*this.itemSize+3]=ge,this},setXY:function(fe,ge,he){return fe*=this.itemSize,this.array[fe+0]=ge,this.array[fe+1]=he,this},setXYZ:function(fe,ge,he,ye){return fe*=this.itemSize,this.array[fe+0]=ge,this.array[fe+1]=he,this.array[fe+2]=ye,this},setXYZW:function(fe,ge,he,ye,xe){return fe*=this.itemSize,this.array[fe+0]=ge,this.array[fe+1]=he,this.array[fe+2]=ye,this.array[fe+3]=xe,this},clone:function(){return new this.constructor().copy(this)}},pe.Int8Attribute=function(ue,fe){return new pe.BufferAttribute(new Int8Array(ue),fe)},pe.Uint8Attribute=function(ue,fe){return new pe.BufferAttribute(new Uint8Array(ue),fe)},pe.Uint8ClampedAttribute=function(ue,fe){return new pe.BufferAttribute(new Uint8ClampedArray(ue),fe)},pe.Int16Attribute=function(ue,fe){return new pe.BufferAttribute(new Int16Array(ue),fe)},pe.Uint16Attribute=function(ue,fe){return new pe.BufferAttribute(new Uint16Array(ue),fe)},pe.Int32Attribute=function(ue,fe){return new pe.BufferAttribute(new Int32Array(ue),fe)},pe.Uint32Attribute=function(ue,fe){return new pe.BufferAttribute(new Uint32Array(ue),fe)},pe.Float32Attribute=function(ue,fe){return new pe.BufferAttribute(new Float32Array(ue),fe)},pe.Float64Attribute=function(ue,fe){return new pe.BufferAttribute(new Float64Array(ue),fe)},pe.DynamicBufferAttribute=function(ue,fe){return console.warn('THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.'),new pe.BufferAttribute(ue,fe).setDynamic(!0)},pe.InstancedBufferAttribute=function(ue,fe,ge){pe.BufferAttribute.call(this,ue,fe),this.meshPerAttribute=ge||1},pe.InstancedBufferAttribute.prototype=Object.create(pe.BufferAttribute.prototype),pe.InstancedBufferAttribute.prototype.constructor=pe.InstancedBufferAttribute,pe.InstancedBufferAttribute.prototype.copy=function(ue){return pe.BufferAttribute.prototype.copy.call(this,ue),this.meshPerAttribute=ue.meshPerAttribute,this},pe.InterleavedBuffer=function(ue,fe){this.uuid=pe.Math.generateUUID(),this.array=ue,this.stride=fe,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},pe.InterleavedBuffer.prototype={constructor:pe.InterleavedBuffer,get length(){return this.array.length},get count(){return this.array.length/this.stride},set needsUpdate(ue){!0===ue&&this.version++},setDynamic:function(fe){return this.dynamic=fe,this},copy:function(fe){return this.array=new fe.array.constructor(fe.array),this.stride=fe.stride,this.dynamic=fe.dynamic,this},copyAt:function(fe,ge,he){fe*=this.stride,he*=ge.stride;for(var ye=0,xe=this.stride;ye<xe;ye++)this.array[fe+ye]=ge.array[he+ye];return this},set:function(fe,ge){return void 0===ge&&(ge=0),this.array.set(fe,ge),this},clone:function(){return new this.constructor().copy(this)}},pe.InstancedInterleavedBuffer=function(ue,fe,ge){pe.InterleavedBuffer.call(this,ue,fe),this.meshPerAttribute=ge||1},pe.InstancedInterleavedBuffer.prototype=Object.create(pe.InterleavedBuffer.prototype),pe.InstancedInterleavedBuffer.prototype.constructor=pe.InstancedInterleavedBuffer,pe.InstancedInterleavedBuffer.prototype.copy=function(ue){return pe.InterleavedBuffer.prototype.copy.call(this,ue),this.meshPerAttribute=ue.meshPerAttribute,this},pe.InterleavedBufferAttribute=function(ue,fe,ge){this.uuid=pe.Math.generateUUID(),this.data=ue,this.itemSize=fe,this.offset=ge},pe.InterleavedBufferAttribute.prototype={constructor:pe.InterleavedBufferAttribute,get length(){return console.warn('THREE.BufferAttribute: .length has been deprecated. Please use .count.'),this.array.length},get count(){return this.data.count},setX:function(fe,ge){return this.data.array[fe*this.data.stride+this.offset]=ge,this},setY:function(fe,ge){return this.data.array[fe*this.data.stride+this.offset+1]=ge,this},setZ:function(fe,ge){return this.data.array[fe*this.data.stride+this.offset+2]=ge,this},setW:function(fe,ge){return this.data.array[fe*this.data.stride+this.offset+3]=ge,this},getX:function(fe){return this.data.array[fe*this.data.stride+this.offset]},getY:function(fe){return this.data.array[fe*this.data.stride+this.offset+1]},getZ:function(fe){return this.data.array[fe*this.data.stride+this.offset+2]},getW:function(fe){return this.data.array[fe*this.data.stride+this.offset+3]},setXY:function(fe,ge,he){return fe=fe*this.data.stride+this.offset,this.data.array[fe+0]=ge,this.data.array[fe+1]=he,this},setXYZ:function(fe,ge,he,ye){return fe=fe*this.data.stride+this.offset,this.data.array[fe+0]=ge,this.data.array[fe+1]=he,this.data.array[fe+2]=ye,this},setXYZW:function(fe,ge,he,ye,xe){return fe=fe*this.data.stride+this.offset,this.data.array[fe+0]=ge,this.data.array[fe+1]=he,this.data.array[fe+2]=ye,this.data.array[fe+3]=xe,this}},pe.Geometry=function(){Object.defineProperty(this,'id',{value:pe.GeometryIdCount++}),this.uuid=pe.Math.generateUUID(),this.name='',this.type='Geometry',this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},le(pe.Geometry.prototype,pe.EventDispatcher.prototype,{applyMatrix:function(fe){for(var ge=new pe.Matrix3().getNormalMatrix(fe),he=0,ye=this.vertices.length,xe;he<ye;he++)xe=this.vertices[he],xe.applyMatrix4(fe);for(var he=0,ye=this.faces.length,_e;he<ye;he++){_e=this.faces[he],_e.normal.applyMatrix3(ge).normalize();for(var ve=0,Ee=_e.vertexNormals.length;ve<Ee;ve++)_e.vertexNormals[ve].applyMatrix3(ge).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var ue;return function(ge){return void 0==ue&&(ue=new pe.Matrix4),ue.makeRotationX(ge),this.applyMatrix(ue),this}}(),rotateY:function(){var ue;return function(ge){return void 0==ue&&(ue=new pe.Matrix4),ue.makeRotationY(ge),this.applyMatrix(ue),this}}(),rotateZ:function(){var ue;return function(ge){return void 0==ue&&(ue=new pe.Matrix4),ue.makeRotationZ(ge),this.applyMatrix(ue),this}}(),translate:function(){var ue;return function(ge,he,ye){return void 0==ue&&(ue=new pe.Matrix4),ue.makeTranslation(ge,he,ye),this.applyMatrix(ue),this}}(),scale:function(){var ue;return function(ge,he,ye){return void 0==ue&&(ue=new pe.Matrix4),ue.makeScale(ge,he,ye),this.applyMatrix(ue),this}}(),lookAt:function(){var ue;return function(ge){ue==void 0&&(ue=new pe.Object3D),ue.lookAt(ge),ue.updateMatrix(),this.applyMatrix(ue.matrix)}}(),fromBufferGeometry:function(fe){function ge(Be,Ue,Ne,Ge){var Ve=void 0===ve?[]:[Me[Be].clone(),Me[Ue].clone(),Me[Ne].clone()],ze=void 0===Ee?[]:[he.colors[Be].clone(),he.colors[Ue].clone(),he.colors[Ne].clone()],Oe=new pe.Face3(Be,Ue,Ne,Ve,ze,Ge);he.faces.push(Oe),void 0!==Te&&he.faceVertexUvs[0].push([Ae[Be].clone(),Ae[Ue].clone(),Ae[Ne].clone()]),void 0!==Se&&he.faceVertexUvs[1].push([Le[Be].clone(),Le[Ue].clone(),Le[Ne].clone()])}var he=this,ye=null===fe.index?void 0:fe.index.array,xe=fe.attributes,_e=xe.position.array,ve=void 0===xe.normal?void 0:xe.normal.array,Ee=void 0===xe.color?void 0:xe.color.array,Te=void 0===xe.uv?void 0:xe.uv.array,Se=void 0===xe.uv2?void 0:xe.uv2.array;void 0!==Se&&(this.faceVertexUvs[1]=[]);for(var Me=[],Ae=[],Le=[],Re=0,Ce=0;Re<_e.length;Re+=3,Ce+=2)he.vertices.push(new pe.Vector3(_e[Re],_e[Re+1],_e[Re+2])),void 0!==ve&&Me.push(new pe.Vector3(ve[Re],ve[Re+1],ve[Re+2])),void 0!==Ee&&he.colors.push(new pe.Color(Ee[Re],Ee[Re+1],Ee[Re+2])),void 0!==Te&&Ae.push(new pe.Vector2(Te[Ce],Te[Ce+1])),void 0!==Se&&Le.push(new pe.Vector2(Se[Ce],Se[Ce+1]));if(void 0!==ye){var we=fe.groups;if(0<we.length)for(var Re=0;Re<we.length;Re++)for(var Pe=we[Re],Fe=Pe.start,De=Pe.count,Ce=Fe;Ce<Fe+De;Ce+=3)ge(ye[Ce],ye[Ce+1],ye[Ce+2],Pe.materialIndex);else for(var Re=0;Re<ye.length;Re+=3)ge(ye[Re],ye[Re+1],ye[Re+2])}else for(var Re=0;Re<_e.length/3;Re+=3)ge(Re,Re+1,Re+2);return this.computeFaceNormals(),null!==fe.boundingBox&&(this.boundingBox=fe.boundingBox.clone()),null!==fe.boundingSphere&&(this.boundingSphere=fe.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var fe=this.boundingBox.center().negate();return this.translate(fe.x,fe.y,fe.z),fe},normalize:function(){this.computeBoundingSphere();var fe=this.boundingSphere.center,ge=this.boundingSphere.radius,he=0===ge?1:1/ge,ye=new pe.Matrix4;return ye.set(he,0,0,-he*fe.x,0,he,0,-he*fe.y,0,0,he,-he*fe.z,0,0,0,1),this.applyMatrix(ye),this},computeFaceNormals:function(){for(var fe=new pe.Vector3,ge=new pe.Vector3,he=0,ye=this.faces.length;he<ye;he++){var xe=this.faces[he],_e=this.vertices[xe.a],ve=this.vertices[xe.b],Ee=this.vertices[xe.c];fe.subVectors(Ee,ve),ge.subVectors(_e,ve),fe.cross(ge),fe.normalize(),xe.normal.copy(fe)}},computeVertexNormals:function(fe){fe===void 0&&(fe=!0);var ge,he,ye,xe,_e,ve;for(ve=Array(this.vertices.length),ge=0,he=this.vertices.length;ge<he;ge++)ve[ge]=new pe.Vector3;if(fe){var Ee,Te,Se,Me=new pe.Vector3,Ae=new pe.Vector3;for(ye=0,xe=this.faces.length;ye<xe;ye++)_e=this.faces[ye],Ee=this.vertices[_e.a],Te=this.vertices[_e.b],Se=this.vertices[_e.c],Me.subVectors(Se,Te),Ae.subVectors(Ee,Te),Me.cross(Ae),ve[_e.a].add(Me),ve[_e.b].add(Me),ve[_e.c].add(Me)}else for(ye=0,xe=this.faces.length;ye<xe;ye++)_e=this.faces[ye],ve[_e.a].add(_e.normal),ve[_e.b].add(_e.normal),ve[_e.c].add(_e.normal);for(ge=0,he=this.vertices.length;ge<he;ge++)ve[ge].normalize();for(ye=0,xe=this.faces.length;ye<xe;ye++){_e=this.faces[ye];var Le=_e.vertexNormals;3===Le.length?(Le[0].copy(ve[_e.a]),Le[1].copy(ve[_e.b]),Le[2].copy(ve[_e.c])):(Le[0]=ve[_e.a].clone(),Le[1]=ve[_e.b].clone(),Le[2]=ve[_e.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var fe,ge,he,ye,xe;for(he=0,ye=this.faces.length;he<ye;he++)for(xe=this.faces[he],xe.__originalFaceNormal?xe.__originalFaceNormal.copy(xe.normal):xe.__originalFaceNormal=xe.normal.clone(),xe.__originalVertexNormals||(xe.__originalVertexNormals=[]),(fe=0,ge=xe.vertexNormals.length);fe<ge;fe++)xe.__originalVertexNormals[fe]?xe.__originalVertexNormals[fe].copy(xe.vertexNormals[fe]):xe.__originalVertexNormals[fe]=xe.vertexNormals[fe].clone();var _e=new pe.Geometry;for(_e.faces=this.faces,fe=0,ge=this.morphTargets.length;fe<ge;fe++){if(!this.morphNormals[fe]){this.morphNormals[fe]={},this.morphNormals[fe].faceNormals=[],this.morphNormals[fe].vertexNormals=[];var ve=this.morphNormals[fe].faceNormals,Ee=this.morphNormals[fe].vertexNormals,Te,Se;for(he=0,ye=this.faces.length;he<ye;he++)Te=new pe.Vector3,Se={a:new pe.Vector3,b:new pe.Vector3,c:new pe.Vector3},ve.push(Te),Ee.push(Se)}var Me=this.morphNormals[fe];_e.vertices=this.morphTargets[fe].vertices,_e.computeFaceNormals(),_e.computeVertexNormals();var Te,Se;for(he=0,ye=this.faces.length;he<ye;he++)xe=this.faces[he],Te=Me.faceNormals[he],Se=Me.vertexNormals[he],Te.copy(xe.normal),Se.a.copy(xe.vertexNormals[0]),Se.b.copy(xe.vertexNormals[1]),Se.c.copy(xe.vertexNormals[2])}for(he=0,ye=this.faces.length;he<ye;he++)xe=this.faces[he],xe.normal=xe.__originalFaceNormal,xe.vertexNormals=xe.__originalVertexNormals},computeTangents:function(){console.warn('THREE.Geometry: .computeTangents() has been removed.')},computeLineDistances:function(){for(var fe=0,ge=this.vertices,he=0,ye=ge.length;he<ye;he++)0<he&&(fe+=ge[he].distanceTo(ge[he-1])),this.lineDistances[he]=fe},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new pe.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new pe.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(fe,ge,he){if(!1==fe instanceof pe.Geometry)return void console.error('THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.',fe);var xe=this.vertices.length,_e=this.vertices,ve=fe.vertices,Ee=this.faces,Te=fe.faces,Se=this.faceVertexUvs[0],Me=fe.faceVertexUvs[0],ye;he===void 0&&(he=0),ge!==void 0&&(ye=new pe.Matrix3().getNormalMatrix(ge));for(var Ae=0,Le=ve.length;Ae<Le;Ae++){var Re=ve[Ae],Ce=Re.clone();ge!==void 0&&Ce.applyMatrix4(ge),_e.push(Ce)}for(Ae=0,Le=Te.length;Ae<Le;Ae++){var we=Te[Ae],Ie=we.vertexNormals,Be=we.vertexColors,Pe,Fe,De;Pe=new pe.Face3(we.a+xe,we.b+xe,we.c+xe),Pe.normal.copy(we.normal),ye!==void 0&&Pe.normal.applyMatrix3(ye).normalize();for(var Ue=0,Ne=Ie.length;Ue<Ne;Ue++)Fe=Ie[Ue].clone(),void 0!==ye&&Fe.applyMatrix3(ye).normalize(),Pe.vertexNormals.push(Fe);Pe.color.copy(we.color);for(var Ue=0,Ne=Be.length;Ue<Ne;Ue++)De=Be[Ue],Pe.vertexColors.push(De.clone());Pe.materialIndex=we.materialIndex+he,Ee.push(Pe)}for(Ae=0,Le=Me.length;Ae<Le;Ae++){var Ge=Me[Ae],Ve=[];if(void 0!==Ge){for(var Ue=0,Ne=Ge.length;Ue<Ne;Ue++)Ve.push(Ge[Ue].clone());Se.push(Ve)}}},mergeMesh:function(fe){return!1==fe instanceof pe.Mesh?void console.error('THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.',fe):void(fe.matrixAutoUpdate&&fe.updateMatrix(),this.merge(fe.geometry,fe.matrix))},mergeVertices:function(){var fe={},ge=[],he=[],ve=Math.pow(10,4),ye,xe,Ee,Te,Se,Me,Ae,Le;for(Ee=0,Te=this.vertices.length;Ee<Te;Ee++)ye=this.vertices[Ee],xe=Math.round(ye.x*ve)+'_'+Math.round(ye.y*ve)+'_'+Math.round(ye.z*ve),void 0===fe[xe]?(fe[xe]=Ee,ge.push(this.vertices[Ee]),he[Ee]=ge.length-1):he[Ee]=he[fe[xe]];var Re=[];for(Ee=0,Te=this.faces.length;Ee<Te;Ee++){Se=this.faces[Ee],Se.a=he[Se.a],Se.b=he[Se.b],Se.c=he[Se.c],Me=[Se.a,Se.b,Se.c];for(var Ce=-1,we=0;3>we;we++)if(Me[we]===Me[(we+1)%3]){Ce=we,Re.push(Ee);break}}for(Ee=Re.length-1;0<=Ee;Ee--){var Pe=Re[Ee];for(this.faces.splice(Pe,1),Ae=0,Le=this.faceVertexUvs.length;Ae<Le;Ae++)this.faceVertexUvs[Ae].splice(Pe,1)}var Fe=this.vertices.length-ge.length;return this.vertices=ge,Fe},sortFacesByMaterialIndex:function(){for(var ge=this.faces,he=ge.length,ye=0;ye<he;ye++)ge[ye]._id=ye;ge.sort(function(Se,Me){return Se.materialIndex-Me.materialIndex});var xe=this.faceVertexUvs[0],_e=this.faceVertexUvs[1],ve,Ee;xe&&xe.length===he&&(ve=[]),_e&&_e.length===he&&(Ee=[]);for(var ye=0,Te;ye<he;ye++)Te=ge[ye]._id,ve&&ve.push(xe[Te]),Ee&&Ee.push(_e[Te]);ve&&(this.faceVertexUvs[0]=ve),Ee&&(this.faceVertexUvs[1]=Ee)},toJSON:function(){function fe(We,je,Xe){return Xe?We|1<<je:We&~(1<<je)}function ge(We){var je=We.x.toString()+We.y.toString()+We.z.toString();return void 0===Le[je]?(Le[je]=Ae.length/3,Ae.push(We.x,We.y,We.z),Le[je]):Le[je]}function he(We){var je=We.r.toString()+We.g.toString()+We.b.toString();return void 0===Ce[je]?(Ce[je]=Re.length,Re.push(We.getHex()),Ce[je]):Ce[je]}function ye(We){var je=We.x.toString()+We.y.toString();return void 0===Pe[je]?(Pe[je]=we.length/2,we.push(We.x,We.y),Pe[je]):Pe[je]}var xe={metadata:{version:4.4,type:'Geometry',generator:'Geometry.toJSON'}};if(xe.uuid=this.uuid,xe.type=this.type,''!==this.name&&(xe.name=this.name),void 0!==this.parameters){var _e=this.parameters;for(var ve in _e)void 0!==_e[ve]&&(xe[ve]=_e[ve]);return xe}for(var Ee=[],Te=0,Se;Te<this.vertices.length;Te++)Se=this.vertices[Te],Ee.push(Se.x,Se.y,Se.z);for(var Me=[],Ae=[],Le={},Re=[],Ce={},we=[],Pe={},Te=0;Te<this.faces.length;Te++){var Fe=this.faces[Te],Be=void 0!==this.faceVertexUvs[0][Te],Ue=0<Fe.normal.length(),Ne=0<Fe.vertexNormals.length,Ge=1!==Fe.color.r||1!==Fe.color.g||1!==Fe.color.b,Ve=0<Fe.vertexColors.length,ze=0;if(ze=fe(ze,0,0),ze=fe(ze,1,!0),ze=fe(ze,2,!1),ze=fe(ze,3,Be),ze=fe(ze,4,Ue),ze=fe(ze,5,Ne),ze=fe(ze,6,Ge),ze=fe(ze,7,Ve),Me.push(ze),Me.push(Fe.a,Fe.b,Fe.c),Me.push(Fe.materialIndex),Be){var Oe=this.faceVertexUvs[0][Te];Me.push(ye(Oe[0]),ye(Oe[1]),ye(Oe[2]))}if(Ue&&Me.push(ge(Fe.normal)),Ne){var ke=Fe.vertexNormals;Me.push(ge(ke[0]),ge(ke[1]),ge(ke[2]))}if(Ge&&Me.push(he(Fe.color)),Ve){var He=Fe.vertexColors;Me.push(he(He[0]),he(He[1]),he(He[2]))}}return xe.data={},xe.data.vertices=Ee,xe.data.normals=Ae,0<Re.length&&(xe.data.colors=Re),0<we.length&&(xe.data.uvs=[we]),xe.data.faces=Me,xe},clone:function(){return new pe.Geometry().copy(this)},copy:function(fe){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]];for(var ge=fe.vertices,he=0,ye=ge.length;he<ye;he++)this.vertices.push(ge[he].clone());for(var xe=fe.faces,he=0,ye=xe.length;he<ye;he++)this.faces.push(xe[he].clone());for(var he=0,ye=fe.faceVertexUvs.length,_e;he<ye;he++){_e=fe.faceVertexUvs[he],this.faceVertexUvs[he]===void 0&&(this.faceVertexUvs[he]=[]);for(var ve=0,Ee=_e.length;ve<Ee;ve++){for(var Te=_e[ve],Se=[],Me=0,Ae=Te.length,Le;Me<Ae;Me++)Le=Te[Me],Se.push(Le.clone());this.faceVertexUvs[he].push(Se)}}return this},dispose:function(){this.dispatchEvent({type:'dispose'})}}),pe.GeometryIdCount=0,pe.DirectGeometry=function(){Object.defineProperty(this,'id',{value:pe.GeometryIdCount++}),this.uuid=pe.Math.generateUUID(),this.name='',this.type='DirectGeometry',this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1},le(pe.DirectGeometry.prototype,pe.EventDispatcher.prototype,{computeBoundingBox:pe.Geometry.prototype.computeBoundingBox,computeBoundingSphere:pe.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn('THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.')},computeVertexNormals:function(){console.warn('THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.')},computeGroups:function(fe){for(var he=[],xe=fe.faces,_e=0,ge,ye,ve;_e<xe.length;_e++)ve=xe[_e],ve.materialIndex!==ye&&(ye=ve.materialIndex,void 0!=ge&&(ge.count=3*_e-ge.start,he.push(ge)),ge={start:3*_e,materialIndex:ye});ge!==void 0&&(ge.count=3*_e-ge.start,he.push(ge)),this.groups=he},fromGeometry:function(fe){var ge=fe.faces,he=fe.vertices,ye=fe.faceVertexUvs,xe=ye[0]&&0<ye[0].length,_e=ye[1]&&0<ye[1].length,ve=fe.morphTargets,Ee=ve.length,Te;if(0<Ee){Te=[];for(var Se=0;Se<Ee;Se++)Te[Se]=[];this.morphTargets.position=Te}var Me=fe.morphNormals,Ae=Me.length,Le;if(0<Ae){Le=[];for(var Se=0;Se<Ae;Se++)Le[Se]=[];this.morphTargets.normal=Le}for(var Re=fe.skinIndices,Ce=fe.skinWeights,we=Re.length===he.length,Pe=Ce.length===he.length,Se=0,Fe;Se<ge.length;Se++){Fe=ge[Se],this.vertices.push(he[Fe.a],he[Fe.b],he[Fe.c]);var De=Fe.vertexNormals;if(3===De.length)this.normals.push(De[0],De[1],De[2]);else{var Ie=Fe.normal;this.normals.push(Ie,Ie,Ie)}var Be=Fe.vertexColors;if(3===Be.length)this.colors.push(Be[0],Be[1],Be[2]);else{var Ue=Fe.color;this.colors.push(Ue,Ue,Ue)}if(!0===xe){var Ne=ye[0][Se];void 0===Ne?(console.warn('THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ',Se),this.uvs.push(new pe.Vector2,new pe.Vector2,new pe.Vector2)):this.uvs.push(Ne[0],Ne[1],Ne[2])}if(!0===_e){var Ne=ye[1][Se];void 0===Ne?(console.warn('THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ',Se),this.uvs2.push(new pe.Vector2,new pe.Vector2,new pe.Vector2)):this.uvs2.push(Ne[0],Ne[1],Ne[2])}for(var Ge=0,Ve;Ge<Ee;Ge++)Ve=ve[Ge].vertices,Te[Ge].push(Ve[Fe.a],Ve[Fe.b],Ve[Fe.c]);for(var Ge=0,ze;Ge<Ae;Ge++)ze=Me[Ge].vertexNormals[Se],Le[Ge].push(ze.a,ze.b,ze.c);we&&this.skinIndices.push(Re[Fe.a],Re[Fe.b],Re[Fe.c]),Pe&&this.skinWeights.push(Ce[Fe.a],Ce[Fe.b],Ce[Fe.c])}return this.computeGroups(fe),this.verticesNeedUpdate=fe.verticesNeedUpdate,this.normalsNeedUpdate=fe.normalsNeedUpdate,this.colorsNeedUpdate=fe.colorsNeedUpdate,this.uvsNeedUpdate=fe.uvsNeedUpdate,this.groupsNeedUpdate=fe.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:'dispose'})}}),pe.BufferGeometry=function(){Object.defineProperty(this,'id',{value:pe.GeometryIdCount++}),this.uuid=pe.Math.generateUUID(),this.name='',this.type='BufferGeometry',this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:Infinity}},le(pe.BufferGeometry.prototype,pe.EventDispatcher.prototype,{getIndex:function(){return this.index},setIndex:function(fe){this.index=fe},addAttribute:function(fe,ge){return!1==ge instanceof pe.BufferAttribute&&!1==ge instanceof pe.InterleavedBufferAttribute?(console.warn('THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).'),void this.addAttribute(fe,new pe.BufferAttribute(arguments[1],arguments[2]))):'index'===fe?(console.warn('THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.'),void this.setIndex(ge)):(this.attributes[fe]=ge,this)},getAttribute:function(fe){return this.attributes[fe]},removeAttribute:function(fe){return delete this.attributes[fe],this},addGroup:function(fe,ge,he){this.groups.push({start:fe,count:ge,materialIndex:he===void 0?0:he})},clearGroups:function(){this.groups=[]},setDrawRange:function(fe,ge){this.drawRange.start=fe,this.drawRange.count=ge},applyMatrix:function(fe){var ge=this.attributes.position;void 0!==ge&&(fe.applyToVector3Array(ge.array),ge.needsUpdate=!0);var he=this.attributes.normal;if(void 0!==he){var ye=new pe.Matrix3().getNormalMatrix(fe);ye.applyToVector3Array(he.array),he.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var ue;return function(ge){return void 0==ue&&(ue=new pe.Matrix4),ue.makeRotationX(ge),this.applyMatrix(ue),this}}(),rotateY:function(){var ue;return function(ge){return void 0==ue&&(ue=new pe.Matrix4),ue.makeRotationY(ge),this.applyMatrix(ue),this}}(),rotateZ:function(){var ue;return function(ge){return void 0==ue&&(ue=new pe.Matrix4),ue.makeRotationZ(ge),this.applyMatrix(ue),this}}(),translate:function(){var ue;return function(ge,he,ye){return void 0==ue&&(ue=new pe.Matrix4),ue.makeTranslation(ge,he,ye),this.applyMatrix(ue),this}}(),scale:function(){var ue;return function(ge,he,ye){return void 0==ue&&(ue=new pe.Matrix4),ue.makeScale(ge,he,ye),this.applyMatrix(ue),this}}(),lookAt:function(){var ue;return function(ge){ue==void 0&&(ue=new pe.Object3D),ue.lookAt(ge),ue.updateMatrix(),this.applyMatrix(ue.matrix)}}(),center:function(){this.computeBoundingBox();var fe=this.boundingBox.center().negate();return this.translate(fe.x,fe.y,fe.z),fe},setFromObject:function(fe){var ge=fe.geometry;if(fe instanceof pe.Points||fe instanceof pe.Line){var he=new pe.Float32Attribute(3*ge.vertices.length,3),ye=new pe.Float32Attribute(3*ge.colors.length,3);if(this.addAttribute('position',he.copyVector3sArray(ge.vertices)),this.addAttribute('color',ye.copyColorsArray(ge.colors)),ge.lineDistances&&ge.lineDistances.length===ge.vertices.length){var xe=new pe.Float32Attribute(ge.lineDistances.length,1);this.addAttribute('lineDistance',xe.copyArray(ge.lineDistances))}null!==ge.boundingSphere&&(this.boundingSphere=ge.boundingSphere.clone()),null!==ge.boundingBox&&(this.boundingBox=ge.boundingBox.clone())}else fe instanceof pe.Mesh&&ge instanceof pe.Geometry&&this.fromGeometry(ge);return this},updateFromObject:function(fe){var ge=fe.geometry;if(fe instanceof pe.Mesh){var he=ge.__directGeometry;if(void 0===he)return this.fromGeometry(ge);he.verticesNeedUpdate=ge.verticesNeedUpdate,he.normalsNeedUpdate=ge.normalsNeedUpdate,he.colorsNeedUpdate=ge.colorsNeedUpdate,he.uvsNeedUpdate=ge.uvsNeedUpdate,he.groupsNeedUpdate=ge.groupsNeedUpdate,ge.verticesNeedUpdate=!1,ge.normalsNeedUpdate=!1,ge.colorsNeedUpdate=!1,ge.uvsNeedUpdate=!1,ge.groupsNeedUpdate=!1,ge=he}if(!0===ge.verticesNeedUpdate){var ye=this.attributes.position;void 0!==ye&&(ye.copyVector3sArray(ge.vertices),ye.needsUpdate=!0),ge.verticesNeedUpdate=!1}if(!0===ge.normalsNeedUpdate){var ye=this.attributes.normal;void 0!==ye&&(ye.copyVector3sArray(ge.normals),ye.needsUpdate=!0),ge.normalsNeedUpdate=!1}if(!0===ge.colorsNeedUpdate){var ye=this.attributes.color;void 0!==ye&&(ye.copyColorsArray(ge.colors),ye.needsUpdate=!0),ge.colorsNeedUpdate=!1}if(ge.uvsNeedUpdate){var ye=this.attributes.uv;void 0!==ye&&(ye.copyVector2sArray(ge.uvs),ye.needsUpdate=!0),ge.uvsNeedUpdate=!1}if(ge.lineDistancesNeedUpdate){var ye=this.attributes.lineDistance;void 0!==ye&&(ye.copyArray(ge.lineDistances),ye.needsUpdate=!0),ge.lineDistancesNeedUpdate=!1}return ge.groupsNeedUpdate&&(ge.computeGroups(fe.geometry),this.groups=ge.groups,ge.groupsNeedUpdate=!1),this},fromGeometry:function(fe){return fe.__directGeometry=new pe.DirectGeometry().fromGeometry(fe),this.fromDirectGeometry(fe.__directGeometry)},fromDirectGeometry:function(fe){var ge=new Float32Array(3*fe.vertices.length);if(this.addAttribute('position',new pe.BufferAttribute(ge,3).copyVector3sArray(fe.vertices)),0<fe.normals.length){var he=new Float32Array(3*fe.normals.length);this.addAttribute('normal',new pe.BufferAttribute(he,3).copyVector3sArray(fe.normals))}if(0<fe.colors.length){var ye=new Float32Array(3*fe.colors.length);this.addAttribute('color',new pe.BufferAttribute(ye,3).copyColorsArray(fe.colors))}if(0<fe.uvs.length){var xe=new Float32Array(2*fe.uvs.length);this.addAttribute('uv',new pe.BufferAttribute(xe,2).copyVector2sArray(fe.uvs))}if(0<fe.uvs2.length){var _e=new Float32Array(2*fe.uvs2.length);this.addAttribute('uv2',new pe.BufferAttribute(_e,2).copyVector2sArray(fe.uvs2))}if(0<fe.indices.length){var ve=65535<fe.vertices.length?Uint32Array:Uint16Array,Ee=new ve(3*fe.indices.length);this.setIndex(new pe.BufferAttribute(Ee,1).copyIndicesArray(fe.indices))}for(var Te in this.groups=fe.groups,fe.morphTargets){for(var Se=[],Me=fe.morphTargets[Te],Ae=0,Le=Me.length;Ae<Le;Ae++){var Re=Me[Ae],Ce=new pe.Float32Attribute(3*Re.length,3);Se.push(Ce.copyVector3sArray(Re))}this.morphAttributes[Te]=Se}if(0<fe.skinIndices.length){var we=new pe.Float32Attribute(4*fe.skinIndices.length,4);this.addAttribute('skinIndex',we.copyVector4sArray(fe.skinIndices))}if(0<fe.skinWeights.length){var Pe=new pe.Float32Attribute(4*fe.skinWeights.length,4);this.addAttribute('skinWeight',Pe.copyVector4sArray(fe.skinWeights))}return null!==fe.boundingSphere&&(this.boundingSphere=fe.boundingSphere.clone()),null!==fe.boundingBox&&(this.boundingBox=fe.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new pe.Box3);var fe=this.attributes.position.array;fe===void 0?this.boundingBox.makeEmpty():this.boundingBox.setFromArray(fe),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var ue=new pe.Box3,fe=new pe.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new pe.Sphere);var he=this.attributes.position;if(he){var ye=he.array,xe=this.boundingSphere.center;ue.setFromArray(ye),ue.center(xe);for(var _e=0,ve=0,Ee=ye.length;ve<Ee;ve+=3)fe.fromArray(ye,ve),_e=Math.max(_e,xe.distanceToSquared(fe));this.boundingSphere.radius=Math.sqrt(_e),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var fe=this.index,ge=this.attributes,he=this.groups;if(ge.position){var ye=ge.position.array;if(ge.normal===void 0)this.addAttribute('normal',new pe.BufferAttribute(new Float32Array(ye.length),3));else for(var xe=ge.normal.array,_e=0,ve=xe.length;_e<ve;_e++)xe[_e]=0;var Ee=ge.normal.array,Te,Se,Me,Ae=new pe.Vector3,Le=new pe.Vector3,Re=new pe.Vector3,Ce=new pe.Vector3,we=new pe.Vector3;if(fe){var Pe=fe.array;0===he.length&&this.addGroup(0,Pe.length);for(var Fe=0,De=he.length;Fe<De;++Fe)for(var Ie=he[Fe],Be=Ie.start,Ue=Ie.count,_e=Be,ve=Be+Ue;_e<ve;_e+=3)Te=3*Pe[_e+0],Se=3*Pe[_e+1],Me=3*Pe[_e+2],Ae.fromArray(ye,Te),Le.fromArray(ye,Se),Re.fromArray(ye,Me),Ce.subVectors(Re,Le),we.subVectors(Ae,Le),Ce.cross(we),Ee[Te]+=Ce.x,Ee[Te+1]+=Ce.y,Ee[Te+2]+=Ce.z,Ee[Se]+=Ce.x,Ee[Se+1]+=Ce.y,Ee[Se+2]+=Ce.z,Ee[Me]+=Ce.x,Ee[Me+1]+=Ce.y,Ee[Me+2]+=Ce.z}else for(var _e=0,ve=ye.length;_e<ve;_e+=9)Ae.fromArray(ye,_e),Le.fromArray(ye,_e+3),Re.fromArray(ye,_e+6),Ce.subVectors(Re,Le),we.subVectors(Ae,Le),Ce.cross(we),Ee[_e]=Ce.x,Ee[_e+1]=Ce.y,Ee[_e+2]=Ce.z,Ee[_e+3]=Ce.x,Ee[_e+4]=Ce.y,Ee[_e+5]=Ce.z,Ee[_e+6]=Ce.x,Ee[_e+7]=Ce.y,Ee[_e+8]=Ce.z;this.normalizeNormals(),ge.normal.needsUpdate=!0}},merge:function(fe,ge){if(!1==fe instanceof pe.BufferGeometry)return void console.error('THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.',fe);ge===void 0&&(ge=0);var he=this.attributes;for(var ye in he)if(fe.attributes[ye]!==void 0)for(var xe=he[ye],_e=xe.array,ve=fe.attributes[ye],Ee=ve.array,Te=ve.itemSize,Se=0,Me=Te*ge;Se<Ee.length;Se++,Me++)_e[Me]=Ee[Se];return this},normalizeNormals:function(){for(var fe=this.attributes.normal.array,_e=0,ve=fe.length,ge,he,ye,xe;_e<ve;_e+=3)ge=fe[_e],he=fe[_e+1],ye=fe[_e+2],xe=1/Math.sqrt(ge*ge+he*he+ye*ye),fe[_e]*=xe,fe[_e+1]*=xe,fe[_e+2]*=xe},toNonIndexed:function(){if(null===this.index)return console.warn('THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed.'),this;var fe=new pe.BufferGeometry,ge=this.index.array,he=this.attributes;for(var ye in he){for(var xe=he[ye],_e=xe.array,ve=xe.itemSize,Ee=new _e.constructor(ge.length*ve),Te=0,Se=0,Me=0,Ae=ge.length;Me<Ae;Me++){Te=ge[Me]*ve;for(var Le=0;Le<ve;Le++)Ee[Se++]=_e[Te++]}fe.addAttribute(ye,new pe.BufferAttribute(Ee,ve))}return fe},toJSON:function(){var fe={metadata:{version:4.4,type:'BufferGeometry',generator:'BufferGeometry.toJSON'}};if(fe.uuid=this.uuid,fe.type=this.type,''!==this.name&&(fe.name=this.name),void 0!==this.parameters){var ge=this.parameters;for(var he in ge)void 0!==ge[he]&&(fe[he]=ge[he]);return fe}fe.data={attributes:{}};var ye=this.index;if(null!==ye){var xe=Array.prototype.slice.call(ye.array);fe.data.index={type:ye.array.constructor.name,array:xe}}var _e=this.attributes;for(var he in _e){var ve=_e[he],xe=Array.prototype.slice.call(ve.array);fe.data.attributes[he]={itemSize:ve.itemSize,type:ve.array.constructor.name,array:xe,normalized:ve.normalized}}var Ee=this.groups;0<Ee.length&&(fe.data.groups=JSON.parse(JSON.stringify(Ee)));var Te=this.boundingSphere;return null!==Te&&(fe.data.boundingSphere={center:Te.center.toArray(),radius:Te.radius}),fe},clone:function(){return new pe.BufferGeometry().copy(this)},copy:function(fe){var ge=fe.index;null!==ge&&this.setIndex(ge.clone());var he=fe.attributes;for(var ye in he){var xe=he[ye];this.addAttribute(ye,xe.clone())}for(var _e=fe.groups,ve=0,Ee=_e.length,Te;ve<Ee;ve++)Te=_e[ve],this.addGroup(Te.start,Te.count,Te.materialIndex);return this},dispose:function(){this.dispatchEvent({type:'dispose'})}}),pe.BufferGeometry.MaxIndex=65535,pe.InstancedBufferGeometry=function(){pe.BufferGeometry.call(this),this.type='InstancedBufferGeometry',this.maxInstancedCount=void 0},pe.InstancedBufferGeometry.prototype=Object.create(pe.BufferGeometry.prototype),pe.InstancedBufferGeometry.prototype.constructor=pe.InstancedBufferGeometry,pe.InstancedBufferGeometry.prototype.addGroup=function(ue,fe,ge){this.groups.push({start:ue,count:fe,instances:ge})},pe.InstancedBufferGeometry.prototype.copy=function(ue){var fe=ue.index;null!==fe&&this.setIndex(fe.clone());var ge=ue.attributes;for(var he in ge){var ye=ge[he];this.addAttribute(he,ye.clone())}for(var xe=ue.groups,_e=0,ve=xe.length,Ee;_e<ve;_e++)Ee=xe[_e],this.addGroup(Ee.start,Ee.count,Ee.instances);return this},pe.Uniform=function(ue){'string'==typeof ue&&(console.warn('THREE.Uniform: Type parameter is no longer needed.'),ue=arguments[1]),this.value=ue,this.dynamic=!1},pe.Uniform.prototype={constructor:pe.Uniform,onUpdate:function(fe){return this.dynamic=!0,this.onUpdateCallback=fe,this}},pe.AnimationAction=function(){throw new Error('THREE.AnimationAction: Use mixer.clipAction for construction.')},pe.AnimationAction._new=function(fe,ge,he){this._mixer=fe,this._clip=ge,this._localRoot=he||null;for(var ye=ge.tracks,xe=ye.length,_e=Array(xe),ve={endingStart:pe.ZeroCurvatureEnding,endingEnd:pe.ZeroCurvatureEnding},Ee=0,Te;Ee!==xe;++Ee)Te=ye[Ee].createInterpolant(null),_e[Ee]=Te,Te.settings=ve;this._interpolantSettings=ve,this._interpolants=_e,this._propertyBindings=Array(xe),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=pe.LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=Infinity,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0},pe.AnimationAction._new.prototype={constructor:pe.AnimationAction._new,play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){this._startTime;return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(fe){return this._startTime=fe,this},setLoop:function(fe,ge){return this.loop=fe,this.repetitions=ge,this},setEffectiveWeight:function(fe){return this.weight=fe,this._effectiveWeight=this.enabled?fe:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(fe){return this._scheduleFading(fe,0,1)},fadeOut:function(fe){return this._scheduleFading(fe,1,0)},crossFadeFrom:function(fe,ge,he){this._mixer;if(fe.fadeOut(ge),this.fadeIn(ge),he){var xe=this._clip.duration,_e=fe._clip.duration;fe.warp(1,_e/xe,ge),this.warp(xe/_e,1,ge)}return this},crossFadeTo:function(fe,ge,he){return fe.crossFadeFrom(this,ge,he)},stopFading:function(){var fe=this._weightInterpolant;return null!==fe&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(fe)),this},setEffectiveTimeScale:function(fe){return this.timeScale=fe,this._effectiveTimeScale=this.paused?0:fe,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(fe){return this.timeScale=this._clip.duration/fe,this.stopWarping()},syncWith:function(fe){return this.time=fe.time,this.timeScale=fe.timeScale,this.stopWarping()},halt:function(fe){return this.warp(this._effectiveTimeScale,0,fe)},warp:function(fe,ge,he){var ye=this._mixer,xe=ye.time,_e=this._timeScaleInterpolant,ve=this.timeScale;null===_e&&(_e=ye._lendControlInterpolant(),this._timeScaleInterpolant=_e);var Ee=_e.parameterPositions,Te=_e.sampleValues;return Ee[0]=xe,Ee[1]=xe+he,Te[0]=fe/ve,Te[1]=ge/ve,this},stopWarping:function(){var fe=this._timeScaleInterpolant;return null!==fe&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(fe)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(fe,ge,he,ye){var xe=this._startTime;if(null!==xe){var _e=(fe-xe)*he;if(0>_e||0===he)return;this._startTime=null,ge=he*_e}ge*=this._updateTimeScale(fe);var ve=this._updateTime(ge),Ee=this._updateWeight(fe);if(0<Ee)for(var Te=this._interpolants,Se=this._propertyBindings,Me=0,Ae=Te.length;Me!==Ae;++Me)Te[Me].evaluate(ve),Se[Me].accumulate(ye,Ee)},_updateWeight:function(fe){var ge=0;if(this.enabled){ge=this.weight;var he=this._weightInterpolant;if(null!==he){var ye=he.evaluate(fe)[0];ge*=ye,fe>he.parameterPositions[1]&&(this.stopFading(),0===ye&&(this.enabled=!1))}}return this._effectiveWeight=ge,ge},_updateTimeScale:function(fe){var ge=0;if(!this.paused){ge=this.timeScale;var he=this._timeScaleInterpolant;if(null!==he){var ye=he.evaluate(fe)[0];ge*=ye,fe>he.parameterPositions[1]&&(this.stopWarping(),0===ge?this.paused=!0:this.timeScale=ge)}}return this._effectiveTimeScale=ge,ge},_updateTime:function(fe){var ge=this.time+fe;if(0===fe)return ge;var he=this._clip.duration,ye=this.loop,xe=this._loopCount;if(ye===pe.LoopOnce){-1===xe&&(this.loopCount=0,this._setEndings(!0,!0,!1));handle_stop:{if(ge>=he)ge=he;else if(0>ge)ge=0;else break handle_stop;this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:'finished',action:this,direction:0>fe?-1:1})}}else{var _e=ye===pe.LoopPingPong;if(-1===xe&&(0<=fe?(xe=0,this._setEndings(!0,0===this.repetitions,_e)):this._setEndings(0===this.repetitions,!0,_e)),ge>=he||0>ge){var ve=Math.floor(ge/he);ge-=he*ve,xe+=Math.abs(ve);var Ee=this.repetitions-xe;if(0>Ee)this.clampWhenFinished?this.paused=!0:this.enabled=!1,ge=0<fe?he:0,this._mixer.dispatchEvent({type:'finished',action:this,direction:0<fe?1:-1});else{if(0==Ee){var Te=0>fe;this._setEndings(Te,!Te,_e)}else this._setEndings(!1,!1,_e);this._loopCount=xe,this._mixer.dispatchEvent({type:'loop',action:this,loopDelta:ve})}}if(_e&&1==(1&xe))return this.time=ge,he-ge}return this.time=ge,ge},_setEndings:function(fe,ge,he){var ye=this._interpolantSettings;he?(ye.endingStart=pe.ZeroSlopeEnding,ye.endingEnd=pe.ZeroSlopeEnding):(ye.endingStart=fe?this.zeroSlopeAtStart?pe.ZeroSlopeEnding:pe.ZeroCurvatureEnding:pe.WrapAroundEnding,ye.endingEnd=ge?this.zeroSlopeAtEnd?pe.ZeroSlopeEnding:pe.ZeroCurvatureEnding:pe.WrapAroundEnding)},_scheduleFading:function(fe,ge,he){var ye=this._mixer,xe=ye.time,_e=this._weightInterpolant;null===_e&&(_e=ye._lendControlInterpolant(),this._weightInterpolant=_e);var ve=_e.parameterPositions,Ee=_e.sampleValues;return ve[0]=xe,Ee[0]=ge,ve[1]=xe+fe,Ee[1]=he,this}},pe.AnimationClip=function(ue,fe,ge){this.name=ue,this.tracks=ge,this.duration=fe===void 0?-1:fe,this.uuid=pe.Math.generateUUID(),0>this.duration&&this.resetDuration(),this.trim(),this.optimize()},pe.AnimationClip.prototype={constructor:pe.AnimationClip,resetDuration:function(){for(var fe=this.tracks,ge=0,he=0,ye=fe.length,xe;he!==ye;++he)xe=this.tracks[he],ge=Math.max(ge,xe.times[xe.times.length-1]);this.duration=ge},trim:function(){for(var fe=0;fe<this.tracks.length;fe++)this.tracks[fe].trim(0,this.duration);return this},optimize:function(){for(var fe=0;fe<this.tracks.length;fe++)this.tracks[fe].optimize();return this}},le(pe.AnimationClip,{parse:function(fe){for(var ge=[],he=fe.tracks,ye=1/(fe.fps||1),xe=0,_e=he.length;xe!==_e;++xe)ge.push(pe.KeyframeTrack.parse(he[xe]).scale(ye));return new pe.AnimationClip(fe.name,fe.duration,ge)},toJSON:function(fe){for(var ge=[],he=fe.tracks,ye={name:fe.name,duration:fe.duration,tracks:ge},xe=0,_e=he.length;xe!==_e;++xe)ge.push(pe.KeyframeTrack.toJSON(he[xe]));return ye},CreateFromMorphTargetSequence:function(fe,ge,he,ye){for(var xe=ge.length,_e=[],ve=0;ve<xe;ve++){var Ee=[],Te=[];Ee.push((ve+xe-1)%xe,ve,(ve+1)%xe),Te.push(0,1,0);var Se=pe.AnimationUtils.getKeyframeOrder(Ee);Ee=pe.AnimationUtils.sortedArray(Ee,1,Se),Te=pe.AnimationUtils.sortedArray(Te,1,Se),ye||0!==Ee[0]||(Ee.push(xe),Te.push(Te[0])),_e.push(new pe.NumberKeyframeTrack('.morphTargetInfluences['+ge[ve].name+']',Ee,Te).scale(1/he))}return new pe.AnimationClip(fe,-1,_e)},findByName:function(fe,ge){var he=fe;if(!Array.isArray(fe)){var ye=fe;he=ye.geometry&&ye.geometry.animations||ye.animations}for(var xe=0;xe<he.length;xe++)if(he[xe].name===ge)return he[xe];return null},CreateClipsFromMorphTargetSequences:function(fe,ge,he){for(var ye={},xe=/^([\w-]*?)([\d]+)$/,_e=0,ve=fe.length;_e<ve;_e++){var Ee=fe[_e],Te=Ee.name.match(xe);if(Te&&1<Te.length){var Se=Te[1],Me=ye[Se];Me||(ye[Se]=Me=[]),Me.push(Ee)}}var Ae=[];for(var Se in ye)Ae.push(pe.AnimationClip.CreateFromMorphTargetSequence(Se,ye[Se],ge,he));return Ae},parseAnimation:function(fe,ge){if(!fe)return console.error('  no animation in JSONLoader data'),null;for(var ye=function(Ue,Ne,Ge,Ve,ze){if(0!==Ge.length){var Oe=[],ke=[];pe.AnimationUtils.flattenJSON(Ge,Oe,ke,Ve),0!==Oe.length&&ze.push(new Ue(Ne,Oe,ke))}},xe=[],_e=fe.name||'default',ve=fe.length||-1,Ee=fe.fps||30,Te=fe.hierarchy||[],Se=0,Me;Se<Te.length;Se++)if(Me=Te[Se].keys,Me&&0!==Me.length)if(Me[0].morphTargets){for(var Ae={},Le=0;Le<Me.length;Le++)if(Me[Le].morphTargets)for(var Re=0;Re<Me[Le].morphTargets.length;Re++)Ae[Me[Le].morphTargets[Re]]=-1;for(var Ce in Ae){for(var we=[],Pe=[],Re=0,Fe;Re!==Me[Le].morphTargets.length;++Re)Fe=Me[Le],we.push(Fe.time),Pe.push(Fe.morphTarget===Ce?1:0);xe.push(new pe.NumberKeyframeTrack('.morphTargetInfluence['+Ce+']',we,Pe))}ve=Ae.length*(Ee||1)}else{var De='.bones['+ge[Se].name+']';ye(pe.VectorKeyframeTrack,De+'.position',Me,'pos',xe),ye(pe.QuaternionKeyframeTrack,De+'.quaternion',Me,'rot',xe),ye(pe.VectorKeyframeTrack,De+'.scale',Me,'scl',xe)}if(0===xe.length)return null;var Ie=new pe.AnimationClip(_e,ve,xe);return Ie}}),pe.AnimationMixer=function(ue){this._root=ue,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1},le(pe.AnimationMixer.prototype,pe.EventDispatcher.prototype,{clipAction:function(fe,ge){var he=ge||this._root,ye=he.uuid,xe='string'==typeof fe?pe.AnimationClip.findByName(he,fe):fe,_e=null===xe?fe:xe.uuid,ve=this._actionsByClip[_e],Ee=null;if(void 0!==ve){var Te=ve.actionByRoot[ye];if(void 0!==Te)return Te;Ee=ve.knownActions[0],null===xe&&(xe=Ee._clip)}if(null===xe)return null;var Se=new pe.AnimationMixer._Action(this,xe,ge);return this._bindAction(Se,Ee),this._addInactiveAction(Se,_e,ye),Se},existingAction:function(fe,ge){var he=ge||this._root,ye=he.uuid,xe='string'==typeof fe?pe.AnimationClip.findByName(he,fe):fe,_e=xe?xe.uuid:fe,ve=this._actionsByClip[_e];return void 0===ve?null:ve.actionByRoot[ye]||null},stopAllAction:function(){var fe=this._actions,ge=this._nActiveActions,he=this._bindings,ye=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var xe=0;xe!==ge;++xe)fe[xe].reset();for(var xe=0;xe!==ye;++xe)he[xe].useCount=0;return this},update:function(fe){fe*=this.timeScale;for(var ge=this._actions,he=this._nActiveActions,ye=this.time+=fe,xe=Math.sign(fe),_e=this._accuIndex^=1,ve=0,Ee;ve!==he;++ve)Ee=ge[ve],Ee.enabled&&Ee._update(ye,fe,xe,_e);for(var Te=this._bindings,Se=this._nActiveBindings,ve=0;ve!==Se;++ve)Te[ve].apply(_e);return this},getRoot:function(){return this._root},uncacheClip:function(fe){var ge=this._actions,he=fe.uuid,ye=this._actionsByClip,xe=ye[he];if(xe!==void 0){for(var _e=xe.knownActions,ve=0,Ee=_e.length,Te;ve!==Ee;++ve){Te=_e[ve],this._deactivateAction(Te);var Se=Te._cacheIndex,Me=ge[ge.length-1];Te._cacheIndex=null,Te._byClipCacheIndex=null,Me._cacheIndex=Se,ge[Se]=Me,ge.pop(),this._removeInactiveBindingsForAction(Te)}delete ye[he]}},uncacheRoot:function(fe){var ge=fe.uuid,he=this._actionsByClip;for(var ye in he){var xe=he[ye].actionByRoot,_e=xe[ge];_e!==void 0&&(this._deactivateAction(_e),this._removeInactiveAction(_e))}var ve=this._bindingsByRootAndName,Ee=ve[ge];if(Ee!==void 0)for(var Te in Ee){var Se=Ee[Te];Se.restoreOriginalState(),this._removeInactiveBinding(Se)}},uncacheAction:function(fe,ge){var he=this.existingAction(fe,ge);null!==he&&(this._deactivateAction(he),this._removeInactiveAction(he))}}),pe.AnimationMixer._Action=pe.AnimationAction._new,le(pe.AnimationMixer.prototype,{_bindAction:function(fe,ge){var he=fe._localRoot||this._root,ye=fe._clip.tracks,xe=ye.length,_e=fe._propertyBindings,ve=fe._interpolants,Ee=he.uuid,Te=this._bindingsByRootAndName,Se=Te[Ee];Se===void 0&&(Se={},Te[Ee]=Se);for(var Me=0;Me!==xe;++Me){var Ae=ye[Me],Le=Ae.name,Re=Se[Le];if(void 0!==Re)_e[Me]=Re;else{if(Re=_e[Me],void 0!==Re){null===Re._cacheIndex&&(++Re.referenceCount,this._addInactiveBinding(Re,Ee,Le));continue}var Ce=ge&&ge._propertyBindings[Me].binding.parsedPath;Re=new pe.PropertyMixer(pe.PropertyBinding.create(he,Le,Ce),Ae.ValueTypeName,Ae.getValueSize()),++Re.referenceCount,this._addInactiveBinding(Re,Ee,Le),_e[Me]=Re}ve[Me].resultBuffer=Re.buffer}},_activateAction:function(fe){if(!this._isActiveAction(fe)){if(null===fe._cacheIndex){var ge=(fe._localRoot||this._root).uuid,he=fe._clip.uuid,ye=this._actionsByClip[he];this._bindAction(fe,ye&&ye.knownActions[0]),this._addInactiveAction(fe,he,ge)}for(var xe=fe._propertyBindings,_e=0,ve=xe.length,Ee;_e!==ve;++_e)Ee=xe[_e],0==Ee.useCount++&&(this._lendBinding(Ee),Ee.saveOriginalState());this._lendAction(fe)}},_deactivateAction:function(fe){if(this._isActiveAction(fe)){for(var ge=fe._propertyBindings,he=0,ye=ge.length,xe;he!==ye;++he)xe=ge[he],0==--xe.useCount&&(xe.restoreOriginalState(),this._takeBackBinding(xe));this._takeBackAction(fe)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var fe=this;this.stats={actions:{get total(){return fe._actions.length},get inUse(){return fe._nActiveActions}},bindings:{get total(){return fe._bindings.length},get inUse(){return fe._nActiveBindings}},controlInterpolants:{get total(){return fe._controlInterpolants.length},get inUse(){return fe._nActiveControlInterpolants}}}},_isActiveAction:function(fe){var ge=fe._cacheIndex;return null!==ge&&ge<this._nActiveActions},_addInactiveAction:function(fe,ge,he){var ye=this._actions,xe=this._actionsByClip,_e=xe[ge];if(_e===void 0)_e={knownActions:[fe],actionByRoot:{}},fe._byClipCacheIndex=0,xe[ge]=_e;else{var ve=_e.knownActions;fe._byClipCacheIndex=ve.length,ve.push(fe)}fe._cacheIndex=ye.length,ye.push(fe),_e.actionByRoot[he]=fe},_removeInactiveAction:function(fe){var ge=this._actions,he=ge[ge.length-1],ye=fe._cacheIndex;he._cacheIndex=ye,ge[ye]=he,ge.pop(),fe._cacheIndex=null;var xe=fe._clip.uuid,_e=this._actionsByClip,ve=_e[xe],Ee=ve.knownActions,Te=Ee[Ee.length-1],Se=fe._byClipCacheIndex;Te._byClipCacheIndex=Se,Ee[Se]=Te,Ee.pop(),fe._byClipCacheIndex=null;var Me=ve.actionByRoot,Ae=(ge._localRoot||this._root).uuid;delete Me[Ae],0===Ee.length&&delete _e[xe],this._removeInactiveBindingsForAction(fe)},_removeInactiveBindingsForAction:function(fe){for(var ge=fe._propertyBindings,he=0,ye=ge.length,xe;he!==ye;++he)xe=ge[he],0==--xe.referenceCount&&this._removeInactiveBinding(xe)},_lendAction:function(fe){var ge=this._actions,he=fe._cacheIndex,ye=this._nActiveActions++,xe=ge[ye];fe._cacheIndex=ye,ge[ye]=fe,xe._cacheIndex=he,ge[he]=xe},_takeBackAction:function(fe){var ge=this._actions,he=fe._cacheIndex,ye=--this._nActiveActions,xe=ge[ye];fe._cacheIndex=ye,ge[ye]=fe,xe._cacheIndex=he,ge[he]=xe},_addInactiveBinding:function(fe,ge,he){var ye=this._bindingsByRootAndName,xe=ye[ge],_e=this._bindings;xe===void 0&&(xe={},ye[ge]=xe),xe[he]=fe,fe._cacheIndex=_e.length,_e.push(fe)},_removeInactiveBinding:function(fe){var ge=this._bindings,he=fe.binding,ye=he.rootNode.uuid,xe=he.path,_e=this._bindingsByRootAndName,ve=_e[ye],Ee=ge[ge.length-1],Te=fe._cacheIndex;Ee._cacheIndex=Te,ge[Te]=Ee,ge.pop(),delete ve[xe];remove_empty_map:{for(var Se in ve)break remove_empty_map;delete _e[ye]}},_lendBinding:function(fe){var ge=this._bindings,he=fe._cacheIndex,ye=this._nActiveBindings++,xe=ge[ye];fe._cacheIndex=ye,ge[ye]=fe,xe._cacheIndex=he,ge[he]=xe},_takeBackBinding:function(fe){var ge=this._bindings,he=fe._cacheIndex,ye=--this._nActiveBindings,xe=ge[ye];fe._cacheIndex=ye,ge[ye]=fe,xe._cacheIndex=he,ge[he]=xe},_lendControlInterpolant:function(){var fe=this._controlInterpolants,ge=this._nActiveControlInterpolants++,he=fe[ge];return void 0===he&&(he=new pe.LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),he.__cacheIndex=ge,fe[ge]=he),he},_takeBackControlInterpolant:function(fe){var ge=this._controlInterpolants,he=fe.__cacheIndex,ye=--this._nActiveControlInterpolants,xe=ge[ye];fe.__cacheIndex=ye,ge[ye]=fe,xe.__cacheIndex=he,ge[he]=xe},_controlInterpolantsResultBuffer:new Float32Array(1)}),pe.AnimationObjectGroup=function(){this.uuid=pe.Math.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var fe={};this._indicesByUUID=fe;for(var ge=0,he=arguments.length;ge!==he;++ge)fe[arguments[ge].uuid]=ge;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var ye=this;this.stats={objects:{get total(){return ye._objects.length},get inUse(){return this.total-ye.nCachedObjects_}},get bindingsPerObject(){return ye._bindings.length}}},pe.AnimationObjectGroup.prototype={constructor:pe.AnimationObjectGroup,add:function(){for(var ge=this._objects,he=ge.length,ye=this.nCachedObjects_,xe=this._indicesByUUID,_e=this._paths,ve=this._parsedPaths,Ee=this._bindings,Te=Ee.length,Se=0,Me=arguments.length;Se!==Me;++Se){var Ae=arguments[Se],Le=Ae.uuid,Re=xe[Le];if(Re===void 0){Re=he++,xe[Le]=Re,ge.push(Ae);for(var Ce=0,we=Te;Ce!==we;++Ce)Ee[Ce].push(new pe.PropertyBinding(Ae,_e[Ce],ve[Ce]))}else if(Re<ye){var Pe=ge[Re],Fe=--ye,De=ge[Fe];xe[De.uuid]=Re,ge[Re]=De,xe[Le]=Fe,ge[Fe]=Ae;for(var Ce=0,we=Te;Ce!==we;++Ce){var Ie=Ee[Ce],Be=Ie[Fe],Ue=Ie[Re];Ie[Re]=Be,Ue===void 0&&(Ue=new pe.PropertyBinding(Ae,_e[Ce],ve[Ce])),Ie[Fe]=Ue}}else ge[Re]!==Pe&&console.error('Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes...')}this.nCachedObjects_=ye},remove:function(){for(var ge=this._objects,he=ge.length,ye=this.nCachedObjects_,xe=this._indicesByUUID,_e=this._bindings,ve=_e.length,Ee=0,Te=arguments.length;Ee!==Te;++Ee){var Se=arguments[Ee],Me=Se.uuid,Ae=xe[Me];if(Ae!==void 0&&Ae>=ye){var Le=ye++,Re=ge[Le];xe[Re.uuid]=Ae,ge[Ae]=Re,xe[Me]=Le,ge[Le]=Se;for(var Ce=0;Ce!==ve;++Ce){var Pe=_e[Ce],Fe=Pe[Le],De=Pe[Ae];Pe[Ae]=Fe,Pe[Le]=De}}}this.nCachedObjects_=ye},uncache:function(){for(var ge=this._objects,he=ge.length,ye=this.nCachedObjects_,xe=this._indicesByUUID,_e=this._bindings,ve=_e.length,Ee=0,Te=arguments.length;Ee!==Te;++Ee){var Se=arguments[Ee],Me=Se.uuid,Ae=xe[Me];if(void 0!==Ae)if(delete xe[Me],Ae<ye){var Le=--ye,Re=ge[Le],Ce=--he,we=ge[Ce];xe[Re.uuid]=Ae,ge[Ae]=Re,xe[we.uuid]=Le,ge[Le]=we,ge.pop();for(var Pe=0,Fe=ve;Pe!==Fe;++Pe){var De=_e[Pe],Ie=De[Le],Be=De[Ce];De[Ae]=Ie,De[Le]=Be,De.pop()}}else{var Ce=--he,we=ge[Ce];xe[we.uuid]=Ae,ge[Ae]=we,ge.pop();for(var Pe=0,Fe=ve,De;Pe!==Fe;++Pe)De=_e[Pe],De[Ae]=De[Ce],De.pop()}}this.nCachedObjects_=ye},subscribe_:function(fe,ge){var he=this._bindingsIndicesByPath,ye=he[fe],xe=this._bindings;if(ye!==void 0)return xe[ye];var _e=this._paths,ve=this._parsedPaths,Ee=this._objects,Te=Ee.length,Se=this.nCachedObjects_,Me=Array(Te);ye=xe.length,he[fe]=ye,_e.push(fe),ve.push(ge),xe.push(Me);for(var Ae=Se,Le=Ee.length,Re;Ae!==Le;++Ae)Re=Ee[Ae],Me[Ae]=new pe.PropertyBinding(Re,fe,ge);return Me},unsubscribe_:function(fe){var ge=this._bindingsIndicesByPath,he=ge[fe];if(he!==void 0){var ye=this._paths,xe=this._parsedPaths,_e=this._bindings,ve=_e.length-1,Ee=_e[ve],Te=fe[ve];ge[Te]=he,_e[he]=Ee,_e.pop(),xe[he]=xe[ve],xe.pop(),ye[he]=ye[ve],ye.pop()}}},pe.AnimationUtils={arraySlice:function(fe,ge,he){return pe.AnimationUtils.isTypedArray(fe)?new fe.constructor(fe.subarray(ge,he)):fe.slice(ge,he)},convertArray:function(fe,ge,he){return fe&&(he||fe.constructor!==ge)?'number'==typeof ge.BYTES_PER_ELEMENT?new ge(fe):Array.prototype.slice.call(fe):fe},isTypedArray:function(fe){return ArrayBuffer.isView(fe)&&!(fe instanceof DataView)},getKeyframeOrder:function(fe){for(var he=fe.length,ye=Array(he),xe=0;xe!==he;++xe)ye[xe]=xe;return ye.sort(function(_e,ve){return fe[_e]-fe[ve]}),ye},sortedArray:function(fe,ge,he){for(var ye=fe.length,xe=new fe.constructor(ye),_e=0,ve=0,Ee;ve!==ye;++_e){Ee=he[_e]*ge;for(var Te=0;Te!==ge;++Te)xe[ve++]=fe[Ee+Te]}return xe},flattenJSON:function(fe,ge,he,ye){for(var xe=1,_e=fe[0];_e!==void 0&&_e[ye]===void 0;)_e=fe[xe++];if(void 0!==_e){var ve=_e[ye];if(void 0!==ve)if(Array.isArray(ve))do ve=_e[ye],void 0!==ve&&(ge.push(_e.time),he.push.apply(he,ve)),_e=fe[xe++];while(void 0!==_e);else if(void 0!==ve.toArray)do ve=_e[ye],void 0!==ve&&(ge.push(_e.time),ve.toArray(he,he.length)),_e=fe[xe++];while(void 0!==_e);else do ve=_e[ye],void 0!==ve&&(ge.push(_e.time),he.push(ve)),_e=fe[xe++];while(void 0!==_e)}}},pe.KeyframeTrack=function(ue,fe,ge,he){if(ue===void 0)throw new Error('track name is undefined');if(void 0===fe||0===fe.length)throw new Error('no keyframes in track named '+ue);this.name=ue,this.times=pe.AnimationUtils.convertArray(fe,this.TimeBufferType),this.values=pe.AnimationUtils.convertArray(ge,this.ValueBufferType),this.setInterpolation(he||this.DefaultInterpolation),this.validate(),this.optimize()},pe.KeyframeTrack.prototype={constructor:pe.KeyframeTrack,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:pe.InterpolateLinear,InterpolantFactoryMethodDiscrete:function(fe){return new pe.DiscreteInterpolant(this.times,this.values,this.getValueSize(),fe)},InterpolantFactoryMethodLinear:function(fe){return new pe.LinearInterpolant(this.times,this.values,this.getValueSize(),fe)},InterpolantFactoryMethodSmooth:function(fe){return new pe.CubicInterpolant(this.times,this.values,this.getValueSize(),fe)},setInterpolation:function(fe){var ge;if(fe===pe.InterpolateDiscrete?ge=this.InterpolantFactoryMethodDiscrete:fe===pe.InterpolateLinear?ge=this.InterpolantFactoryMethodLinear:fe===pe.InterpolateSmooth?ge=this.InterpolantFactoryMethodSmooth:void 0,void 0===ge){var he='unsupported interpolation for '+this.ValueTypeName+' keyframe track named '+this.name;if(void 0===this.createInterpolant)if(fe!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(he);return void console.warn(he)}this.createInterpolant=ge},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return pe.InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return pe.InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return pe.InterpolateSmooth;}},getValueSize:function(){return this.values.length/this.times.length},shift:function(fe){if(0!==fe)for(var ge=this.times,he=0,ye=ge.length;he!==ye;++he)ge[he]+=fe;return this},scale:function(fe){if(1!==fe)for(var ge=this.times,he=0,ye=ge.length;he!==ye;++he)ge[he]*=fe;return this},trim:function(fe,ge){for(var he=this.times,ye=he.length,xe=0,_e=ye-1;xe!==ye&&he[xe]<fe;)++xe;for(;-1!=_e&&he[_e]>ge;)--_e;if(++_e,0!=xe||_e!==ye){xe>=_e&&(_e=Math.max(_e,1),xe=_e-1);var ve=this.getValueSize();this.times=pe.AnimationUtils.arraySlice(he,xe,_e),this.values=pe.AnimationUtils.arraySlice(this.values,xe*ve,_e*ve)}return this},validate:function(){var fe=!0,ge=this.getValueSize();0!=ge-Math.floor(ge)&&(console.error('invalid value size in track',this),fe=!1);var he=this.times,ye=this.values,xe=he.length;0===xe&&(console.error('track is empty',this),fe=!1);for(var _e=null,ve=0,Ee;ve!==xe;ve++){if(Ee=he[ve],'number'==typeof Ee&&isNaN(Ee)){console.error('time is not a valid number',this,ve,Ee),fe=!1;break}if(null!=_e&&_e>Ee){console.error('out of order keys',this,ve,Ee,_e),fe=!1;break}_e=Ee}if(ye!==void 0&&pe.AnimationUtils.isTypedArray(ye))for(var ve=0,Te=ye.length,Se;ve!==Te;++ve)if(Se=ye[ve],isNaN(Se)){console.error('value is not a valid number',this,ve,Se),fe=!1;break}return fe},optimize:function(){for(var fe=this.times,ge=this.values,he=this.getValueSize(),ye=1,xe=1,_e=fe.length-1;xe<=_e;++xe){var ve=!1,Ee=fe[xe],Te=fe[xe+1];if(Ee!==Te&&(1!==xe||Ee!==Ee[0]))for(var Se=xe*he,Le=0,Re;Le!==he;++Le)if(Re=ge[Se+Le],Re!==ge[Se-he+Le]||Re!==ge[Se+he+Le]){ve=!0;break}if(ve){if(xe!==ye){fe[ye]=fe[xe];for(var Ce=xe*he,we=ye*he,Le=0;Le!==he;++Le)ge[we+Le]=ge[Ce+Le]}++ye}}return ye!==fe.length&&(this.times=pe.AnimationUtils.arraySlice(fe,0,ye),this.values=pe.AnimationUtils.arraySlice(ge,0,ye*he)),this}},le(pe.KeyframeTrack,{parse:function(fe){if(fe.type===void 0)throw new Error('track type undefined, can not parse');var ge=pe.KeyframeTrack._getTrackTypeForValueTypeName(fe.type);if(fe.times===void 0){var he=[],ye=[];pe.AnimationUtils.flattenJSON(fe.keys,he,ye,'value'),fe.times=he,fe.values=ye}return void 0===ge.parse?new ge(fe.name,fe.times,fe.values,fe.interpolation):ge.parse(fe)},toJSON:function(fe){var ge=fe.constructor,he;if(void 0!==ge.toJSON)he=ge.toJSON(fe);else{he={name:fe.name,times:pe.AnimationUtils.convertArray(fe.times,Array),values:pe.AnimationUtils.convertArray(fe.values,Array)};var ye=fe.getInterpolation();ye!==fe.DefaultInterpolation&&(he.interpolation=ye)}return he.type=fe.ValueTypeName,he},_getTrackTypeForValueTypeName:function(fe){switch(fe.toLowerCase()){case'scalar':case'double':case'float':case'number':case'integer':return pe.NumberKeyframeTrack;case'vector':case'vector2':case'vector3':case'vector4':return pe.VectorKeyframeTrack;case'color':return pe.ColorKeyframeTrack;case'quaternion':return pe.QuaternionKeyframeTrack;case'bool':case'boolean':return pe.BooleanKeyframeTrack;case'string':return pe.StringKeyframeTrack;}throw new Error('Unsupported typeName: '+fe)}}),pe.PropertyBinding=function(ue,fe,ge){this.path=fe,this.parsedPath=ge||pe.PropertyBinding.parseTrackName(fe),this.node=pe.PropertyBinding.findNode(ue,this.parsedPath.nodeName)||ue,this.rootNode=ue},pe.PropertyBinding.prototype={constructor:pe.PropertyBinding,getValue:function(fe,ge){this.bind(),this.getValue(fe,ge)},setValue:function(fe,ge){this.bind(),this.setValue(fe,ge)},bind:function(){var fe=this.node,ge=this.parsedPath,he=ge.objectName,ye=ge.propertyName,xe=ge.propertyIndex;if(fe||(fe=pe.PropertyBinding.findNode(this.rootNode,ge.nodeName)||this.rootNode,this.node=fe),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!fe)return void console.error('  trying to update node for track: '+this.path+' but it wasn\'t found.');if(he){var _e=ge.objectIndex;switch(he){case'materials':if(!fe.material)return void console.error('  can not bind to material as node does not have a material',this);if(!fe.material.materials)return void console.error('  can not bind to material.materials as node.material does not have a materials array',this);fe=fe.material.materials;break;case'bones':if(!fe.skeleton)return void console.error('  can not bind to bones as node does not have a skeleton',this);fe=fe.skeleton.bones;for(var ve=0;ve<fe.length;ve++)if(fe[ve].name===_e){_e=ve;break}break;default:if(void 0===fe[he])return void console.error('  can not bind to objectName of node, undefined',this);fe=fe[he];}if(void 0!==_e){if(void 0===fe[_e])return void console.error('  trying to bind to objectIndex of objectName, but is undefined:',this,fe);fe=fe[_e]}}var Ee=fe[ye];if(void 0===Ee){var Te=ge.nodeName;return void console.error('  trying to update property for track: '+Te+'.'+ye+' but it wasn\'t found.',fe)}var Se=this.Versioning.None;void 0===fe.needsUpdate?void 0!==fe.matrixWorldNeedsUpdate&&(Se=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=fe):(Se=this.Versioning.NeedsUpdate,this.targetObject=fe);var Me=this.BindingType.Direct;if(void 0!==xe){if('morphTargetInfluences'===ye){if(!fe.geometry)return void console.error('  can not bind to morphTargetInfluences becasuse node does not have a geometry',this);if(!fe.geometry.morphTargets)return void console.error('  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets',this);for(var ve=0;ve<this.node.geometry.morphTargets.length;ve++)if(fe.geometry.morphTargets[ve].name===xe){xe=ve;break}}Me=this.BindingType.ArrayElement,this.resolvedProperty=Ee,this.propertyIndex=xe}else void 0!==Ee.fromArray&&void 0!==Ee.toArray?(Me=this.BindingType.HasFromToArray,this.resolvedProperty=Ee):void 0===Ee.length?this.propertyName=ye:(Me=this.BindingType.EntireArray,this.resolvedProperty=Ee);this.getValue=this.GetterByBindingType[Me],this.setValue=this.SetterByBindingTypeAndVersioning[Me][Se]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}},le(pe.PropertyBinding.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:pe.PropertyBinding.prototype.getValue,_setValue_unbound:pe.PropertyBinding.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(fe,ge){fe[ge]=this.node[this.propertyName]},function(fe,ge){for(var he=this.resolvedProperty,ye=0,xe=he.length;ye!==xe;++ye)fe[ge++]=he[ye]},function(fe,ge){fe[ge]=this.resolvedProperty[this.propertyIndex]},function(fe,ge){this.resolvedProperty.toArray(fe,ge)}],SetterByBindingTypeAndVersioning:[[function(fe,ge){this.node[this.propertyName]=fe[ge]},function(fe,ge){this.node[this.propertyName]=fe[ge],this.targetObject.needsUpdate=!0},function(fe,ge){this.node[this.propertyName]=fe[ge],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(fe,ge){for(var he=this.resolvedProperty,ye=0,xe=he.length;ye!==xe;++ye)he[ye]=fe[ge++]},function(fe,ge){for(var he=this.resolvedProperty,ye=0,xe=he.length;ye!==xe;++ye)he[ye]=fe[ge++];this.targetObject.needsUpdate=!0},function(fe,ge){for(var he=this.resolvedProperty,ye=0,xe=he.length;ye!==xe;++ye)he[ye]=fe[ge++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(fe,ge){this.resolvedProperty[this.propertyIndex]=fe[ge]},function(fe,ge){this.resolvedProperty[this.propertyIndex]=fe[ge],this.targetObject.needsUpdate=!0},function(fe,ge){this.resolvedProperty[this.propertyIndex]=fe[ge],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(fe,ge){this.resolvedProperty.fromArray(fe,ge)},function(fe,ge){this.resolvedProperty.fromArray(fe,ge),this.targetObject.needsUpdate=!0},function(fe,ge){this.resolvedProperty.fromArray(fe,ge),this.targetObject.matrixWorldNeedsUpdate=!0}]]}),pe.PropertyBinding.Composite=function(ue,fe,ge){var he=ge||pe.PropertyBinding.parseTrackName(fe);this._targetGroup=ue,this._bindings=ue.subscribe_(fe,he)},pe.PropertyBinding.Composite.prototype={constructor:pe.PropertyBinding.Composite,getValue:function(fe,ge){this.bind();var he=this._targetGroup.nCachedObjects_,ye=this._bindings[he];ye!==void 0&&ye.getValue(fe,ge)},setValue:function(fe,ge){for(var he=this._bindings,ye=this._targetGroup.nCachedObjects_,xe=he.length;ye!==xe;++ye)he[ye].setValue(fe,ge)},bind:function(){for(var fe=this._bindings,ge=this._targetGroup.nCachedObjects_,he=fe.length;ge!==he;++ge)fe[ge].bind()},unbind:function(){for(var fe=this._bindings,ge=this._targetGroup.nCachedObjects_,he=fe.length;ge!==he;++ge)fe[ge].unbind()}},pe.PropertyBinding.create=function(ue,fe,ge){return ue instanceof pe.AnimationObjectGroup?new pe.PropertyBinding.Composite(ue,fe,ge):new pe.PropertyBinding(ue,fe,ge)},pe.PropertyBinding.parseTrackName=function(ue){var fe=/^(([\w]+\/)*)([\w-\d]+)?(\.([\w]+)(\[([\w\d\[\]\_.:\- ]+)\])?)?(\.([\w.]+)(\[([\w\d\[\]\_. ]+)\])?)$/,ge=fe.exec(ue);if(!ge)throw new Error('cannot parse trackName at all: '+ue);ge.index===fe.lastIndex&&fe.lastIndex++;var he={nodeName:ge[3],objectName:ge[5],objectIndex:ge[7],propertyName:ge[9],propertyIndex:ge[11]};if(null===he.propertyName||0===he.propertyName.length)throw new Error('can not parse propertyName from trackName: '+ue);return he},pe.PropertyBinding.findNode=function(ue,fe){if(!fe||''===fe||'root'===fe||'.'===fe||-1===fe||fe===ue.name||fe===ue.uuid)return ue;if(ue.skeleton){var ge=function(ve){for(var Ee=0,Te;Ee<ve.bones.length;Ee++)if(Te=ve.bones[Ee],Te.name===fe)return Te;return null},he=ge(ue.skeleton);if(he)return he}if(ue.children){var ye=function _e(ve){for(var Ee=0,Te;Ee<ve.length;Ee++){if(Te=ve[Ee],Te.name===fe||Te.uuid===fe)return Te;var Se=_e(Te.children);if(Se)return Se}return null},xe=ye(ue.children);if(xe)return xe}return null},pe.PropertyMixer=function(ue,fe,ge){this.binding=ue,this.valueSize=ge;var he=Float64Array,ye;'quaternion'===fe?ye=this._slerp:'string'===fe||'bool'===fe?(he=Array,ye=this._select):ye=this._lerp;this.buffer=new he(4*ge),this._mixBufferRegion=ye,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0},pe.PropertyMixer.prototype={constructor:pe.PropertyMixer,accumulate:function(fe,ge){var he=this.buffer,ye=this.valueSize,xe=fe*ye+ye,_e=this.cumulativeWeight;if(0===_e){for(var ve=0;ve!==ye;++ve)he[xe+ve]=he[ve];_e=ge}else{_e+=ge;var Ee=ge/_e;this._mixBufferRegion(he,xe,0,Ee,ye)}this.cumulativeWeight=_e},apply:function(fe){var ge=this.valueSize,he=this.buffer,ye=fe*ge+ge,xe=this.cumulativeWeight,_e=this.binding;if(this.cumulativeWeight=0,1>xe){this._mixBufferRegion(he,ye,3*ge,1-xe,ge)}for(var Ee=ge;Ee!==ge+ge;++Ee)if(he[Ee]!==he[Ee+ge]){_e.setValue(he,ye);break}},saveOriginalState:function(){var fe=this.binding,ge=this.buffer,he=this.valueSize,ye=3*he;fe.getValue(ge,ye);for(var xe=he;xe!==ye;++xe)ge[xe]=ge[ye+xe%he];this.cumulativeWeight=0},restoreOriginalState:function(){var fe=3*this.valueSize;this.binding.setValue(this.buffer,fe)},_select:function(fe,ge,he,ye,xe){if(0.5<=ye)for(var _e=0;_e!==xe;++_e)fe[ge+_e]=fe[he+_e]},_slerp:function(fe,ge,he,ye){pe.Quaternion.slerpFlat(fe,ge,fe,ge,fe,he,ye)},_lerp:function(fe,ge,he,ye,xe){for(var ve=0,Ee;ve!==xe;++ve)Ee=ge+ve,fe[Ee]=fe[Ee]*(1-ye)+fe[he+ve]*ye}},pe.BooleanKeyframeTrack=function(ue,fe,ge){pe.KeyframeTrack.call(this,ue,fe,ge)},pe.BooleanKeyframeTrack.prototype=le(Object.create(pe.KeyframeTrack.prototype),{constructor:pe.BooleanKeyframeTrack,ValueTypeName:'bool',ValueBufferType:Array,DefaultInterpolation:pe.InterpolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),pe.ColorKeyframeTrack=function(ue,fe,ge,he){pe.KeyframeTrack.call(this,ue,fe,ge,he)},pe.ColorKeyframeTrack.prototype=le(Object.create(pe.KeyframeTrack.prototype),{constructor:pe.ColorKeyframeTrack,ValueTypeName:'color'}),pe.NumberKeyframeTrack=function(ue,fe,ge,he){pe.KeyframeTrack.call(this,ue,fe,ge,he)},pe.NumberKeyframeTrack.prototype=le(Object.create(pe.KeyframeTrack.prototype),{constructor:pe.NumberKeyframeTrack,ValueTypeName:'number'}),pe.QuaternionKeyframeTrack=function(ue,fe,ge,he){pe.KeyframeTrack.call(this,ue,fe,ge,he)},pe.QuaternionKeyframeTrack.prototype=le(Object.create(pe.KeyframeTrack.prototype),{constructor:pe.QuaternionKeyframeTrack,ValueTypeName:'quaternion',DefaultInterpolation:pe.InterpolateLinear,InterpolantFactoryMethodLinear:function(fe){return new pe.QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),fe)},InterpolantFactoryMethodSmooth:void 0}),pe.StringKeyframeTrack=function(ue,fe,ge,he){pe.KeyframeTrack.call(this,ue,fe,ge,he)},pe.StringKeyframeTrack.prototype=le(Object.create(pe.KeyframeTrack.prototype),{constructor:pe.StringKeyframeTrack,ValueTypeName:'string',ValueBufferType:Array,DefaultInterpolation:pe.InterpolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),pe.VectorKeyframeTrack=function(ue,fe,ge,he){pe.KeyframeTrack.call(this,ue,fe,ge,he)},pe.VectorKeyframeTrack.prototype=le(Object.create(pe.KeyframeTrack.prototype),{constructor:pe.VectorKeyframeTrack,ValueTypeName:'vector'}),pe.Audio=function(ue){pe.Object3D.call(this),this.type='Audio',this.context=ue.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(ue.getInput()),this.autoplay=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType='empty',this.filters=[]},pe.Audio.prototype=le(Object.create(pe.Object3D.prototype),{constructor:pe.Audio,getOutput:function(){return this.gain},setNodeSource:function(fe){return this.hasPlaybackControl=!1,this.sourceType='audioNode',this.source=fe,this.connect(),this},setBuffer:function(fe){return this.source.buffer=fe,this.sourceType='buffer',this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)return void console.warn('THREE.Audio: Audio is already playing.');if(!1===this.hasPlaybackControl)return void console.warn('THREE.Audio: this Audio has no playback control.');var fe=this.context.createBufferSource();return fe.buffer=this.source.buffer,fe.loop=this.source.loop,fe.onended=this.source.onended,fe.start(0,this.startTime),fe.playbackRate.value=this.playbackRate,this.isPlaying=!0,this.source=fe,this.connect()},pause:function(){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this)},stop:function(){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.source.stop(),this.startTime=0,this.isPlaying=!1,this)},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var fe=1,ge=this.filters.length;fe<ge;fe++)this.filters[fe-1].connect(this.filters[fe]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var fe=1,ge=this.filters.length;fe<ge;fe++)this.filters[fe-1].disconnect(this.filters[fe]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(fe){return fe||(fe=[]),!0===this.isPlaying?(this.disconnect(),this.filters=fe,this.connect()):this.filters=fe,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(fe){return this.setFilters(fe?[fe]:[])},setPlaybackRate:function(fe){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.playbackRate=fe,!0===this.isPlaying&&(this.source.playbackRate.value=this.playbackRate),this)},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn('THREE.Audio: this Audio has no playback control.'),!1):this.source.loop},setLoop:function(fe){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):void(this.source.loop=fe)},getVolume:function(){return this.gain.gain.value},setVolume:function(fe){return this.gain.gain.value=fe,this}}),pe.AudioAnalyser=function(ue,fe){this.analyser=ue.context.createAnalyser(),this.analyser.fftSize=fe===void 0?2048:fe,this.data=new Uint8Array(this.analyser.frequencyBinCount),ue.getOutput().connect(this.analyser)},le(pe.AudioAnalyser.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var fe=0,ge=this.getFrequencyData(),he=0;he<ge.length;he++)fe+=ge[he];return fe/ge.length}}),Object.defineProperty(pe,'AudioContext',{get:function(){var ue;return function(){return void 0==ue&&(ue=new(window.AudioContext||window.webkitAudioContext)),ue}}()}),pe.PositionalAudio=function(ue){pe.Audio.call(this,ue),this.panner=this.context.createPanner(),this.panner.connect(this.gain)},pe.PositionalAudio.prototype=le(Object.create(pe.Audio.prototype),{constructor:pe.PositionalAudio,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(fe){this.panner.refDistance=fe},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(fe){this.panner.rolloffFactor=fe},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(fe){this.panner.distanceModel=fe},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(fe){this.panner.maxDistance=fe},updateMatrixWorld:function(){var ue=new pe.Vector3;return function(ge){pe.Object3D.prototype.updateMatrixWorld.call(this,ge),ue.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(ue.x,ue.y,ue.z)}}()}),pe.AudioListener=function(){pe.Object3D.call(this),this.type='AudioListener',this.context=pe.AudioContext,this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null},pe.AudioListener.prototype=le(Object.create(pe.Object3D.prototype),{constructor:pe.AudioListener,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(fe){null===this.filter?this.gain.disconnect(this.context.destination):(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)),this.filter=fe,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(fe){this.gain.gain.value=fe},updateMatrixWorld:function(){var ue=new pe.Vector3,fe=new pe.Quaternion,ge=new pe.Vector3,he=new pe.Vector3;return function(xe){pe.Object3D.prototype.updateMatrixWorld.call(this,xe);var _e=this.context.listener,ve=this.up;this.matrixWorld.decompose(ue,fe,ge),he.set(0,0,-1).applyQuaternion(fe),_e.setPosition(ue.x,ue.y,ue.z),_e.setOrientation(he.x,he.y,he.z,ve.x,ve.y,ve.z)}}()}),pe.Camera=function(){pe.Object3D.call(this),this.type='Camera',this.matrixWorldInverse=new pe.Matrix4,this.projectionMatrix=new pe.Matrix4},pe.Camera.prototype=Object.create(pe.Object3D.prototype),pe.Camera.prototype.constructor=pe.Camera,pe.Camera.prototype.getWorldDirection=function(){var ue=new pe.Quaternion;return function(ge){var he=ge||new pe.Vector3;return this.getWorldQuaternion(ue),he.set(0,0,-1).applyQuaternion(ue)}}(),pe.Camera.prototype.lookAt=function(){var ue=new pe.Matrix4;return function(ge){ue.lookAt(this.position,ge,this.up),this.quaternion.setFromRotationMatrix(ue)}}(),pe.Camera.prototype.clone=function(){return new this.constructor().copy(this)},pe.Camera.prototype.copy=function(ue){return pe.Object3D.prototype.copy.call(this,ue),this.matrixWorldInverse.copy(ue.matrixWorldInverse),this.projectionMatrix.copy(ue.projectionMatrix),this},pe.CubeCamera=function(ue,fe,ge){pe.Object3D.call(this),this.type='CubeCamera';var he=90,ye=1,xe=new pe.PerspectiveCamera(he,ye,ue,fe);xe.up.set(0,-1,0),xe.lookAt(new pe.Vector3(1,0,0)),this.add(xe);var _e=new pe.PerspectiveCamera(he,ye,ue,fe);_e.up.set(0,-1,0),_e.lookAt(new pe.Vector3(-1,0,0)),this.add(_e);var ve=new pe.PerspectiveCamera(he,ye,ue,fe);ve.up.set(0,0,1),ve.lookAt(new pe.Vector3(0,1,0)),this.add(ve);var Ee=new pe.PerspectiveCamera(he,ye,ue,fe);Ee.up.set(0,0,-1),Ee.lookAt(new pe.Vector3(0,-1,0)),this.add(Ee);var Te=new pe.PerspectiveCamera(he,ye,ue,fe);Te.up.set(0,-1,0),Te.lookAt(new pe.Vector3(0,0,1)),this.add(Te);var Se=new pe.PerspectiveCamera(he,ye,ue,fe);Se.up.set(0,-1,0),Se.lookAt(new pe.Vector3(0,0,-1)),this.add(Se);var Me={format:pe.RGBFormat,magFilter:pe.LinearFilter,minFilter:pe.LinearFilter};this.renderTarget=new pe.WebGLRenderTargetCube(ge,ge,Me),this.updateCubeMap=function(Ae,Le){null===this.parent&&this.updateMatrixWorld();var Re=this.renderTarget,Ce=Re.texture.generateMipmaps;Re.texture.generateMipmaps=!1,Re.activeCubeFace=0,Ae.render(Le,xe,Re),Re.activeCubeFace=1,Ae.render(Le,_e,Re),Re.activeCubeFace=2,Ae.render(Le,ve,Re),Re.activeCubeFace=3,Ae.render(Le,Ee,Re),Re.activeCubeFace=4,Ae.render(Le,Te,Re),Re.texture.generateMipmaps=Ce,Re.activeCubeFace=5,Ae.render(Le,Se,Re),Ae.setRenderTarget(null)}},pe.CubeCamera.prototype=Object.create(pe.Object3D.prototype),pe.CubeCamera.prototype.constructor=pe.CubeCamera,pe.OrthographicCamera=function(ue,fe,ge,he,ye,xe){pe.Camera.call(this),this.type='OrthographicCamera',this.zoom=1,this.view=null,this.left=ue,this.right=fe,this.top=ge,this.bottom=he,this.near=ye===void 0?0.1:ye,this.far=xe===void 0?2e3:xe,this.updateProjectionMatrix()},pe.OrthographicCamera.prototype=le(Object.create(pe.Camera.prototype),{constructor:pe.OrthographicCamera,copy:function(fe){return pe.Camera.prototype.copy.call(this,fe),this.left=fe.left,this.right=fe.right,this.top=fe.top,this.bottom=fe.bottom,this.near=fe.near,this.far=fe.far,this.zoom=fe.zoom,this.view=null===fe.view?null:le({},fe.view),this},setViewOffset:function(fe,ge,he,ye,xe,_e){this.view={fullWidth:fe,fullHeight:ge,offsetX:he,offsetY:ye,width:xe,height:_e},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var fe=(this.right-this.left)/(2*this.zoom),ge=(this.top-this.bottom)/(2*this.zoom),he=(this.right+this.left)/2,ye=(this.top+this.bottom)/2,xe=he-fe,_e=he+fe,ve=ye+ge,Ee=ye-ge;if(null!==this.view){var Te=this.zoom/(this.view.width/this.view.fullWidth),Se=this.zoom/(this.view.height/this.view.fullHeight),Me=(this.right-this.left)/this.view.width,Ae=(this.top-this.bottom)/this.view.height;xe+=Me*(this.view.offsetX/Te),_e=xe+Me*(this.view.width/Te),ve-=Ae*(this.view.offsetY/Se),Ee=ve-Ae*(this.view.height/Se)}this.projectionMatrix.makeOrthographic(xe,_e,ve,Ee,this.near,this.far)},toJSON:function(fe){var ge=pe.Object3D.prototype.toJSON.call(this,fe);return ge.object.zoom=this.zoom,ge.object.left=this.left,ge.object.right=this.right,ge.object.top=this.top,ge.object.bottom=this.bottom,ge.object.near=this.near,ge.object.far=this.far,null!==this.view&&(ge.object.view=le({},this.view)),ge}}),pe.PerspectiveCamera=function(ue,fe,ge,he){pe.Camera.call(this),this.type='PerspectiveCamera',this.fov=ue===void 0?50:ue,this.zoom=1,this.near=ge===void 0?0.1:ge,this.far=he===void 0?2e3:he,this.focus=10,this.aspect=fe===void 0?1:fe,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()},pe.PerspectiveCamera.prototype=le(Object.create(pe.Camera.prototype),{constructor:pe.PerspectiveCamera,copy:function(fe){return pe.Camera.prototype.copy.call(this,fe),this.fov=fe.fov,this.zoom=fe.zoom,this.near=fe.near,this.far=fe.far,this.focus=fe.focus,this.aspect=fe.aspect,this.view=null===fe.view?null:le({},fe.view),this.filmGauge=fe.filmGauge,this.filmOffset=fe.filmOffset,this},setFocalLength:function(fe){var ge=0.5*this.getFilmHeight()/fe;this.fov=2*pe.Math.RAD2DEG*Math.atan(ge),this.updateProjectionMatrix()},getFocalLength:function(){var fe=Math.tan(0.5*pe.Math.DEG2RAD*this.fov);return 0.5*this.getFilmHeight()/fe},getEffectiveFOV:function(){return 2*pe.Math.RAD2DEG*Math.atan(Math.tan(0.5*pe.Math.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(fe,ge,he,ye,xe,_e){this.aspect=fe/ge,this.view={fullWidth:fe,fullHeight:ge,offsetX:he,offsetY:ye,width:xe,height:_e},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var fe=this.near,ge=fe*Math.tan(0.5*pe.Math.DEG2RAD*this.fov)/this.zoom,he=2*ge,ye=this.aspect*he,xe=-0.5*ye,_e=this.view;if(null!==_e){var ve=_e.fullWidth,Ee=_e.fullHeight;xe+=_e.offsetX*ye/ve,ge-=_e.offsetY*he/Ee,ye*=_e.width/ve,he*=_e.height/Ee}var Te=this.filmOffset;0!==Te&&(xe+=fe*Te/this.getFilmWidth()),this.projectionMatrix.makeFrustum(xe,xe+ye,ge-he,ge,fe,this.far)},toJSON:function(fe){var ge=pe.Object3D.prototype.toJSON.call(this,fe);return ge.object.fov=this.fov,ge.object.zoom=this.zoom,ge.object.near=this.near,ge.object.far=this.far,ge.object.focus=this.focus,ge.object.aspect=this.aspect,null!==this.view&&(ge.object.view=le({},this.view)),ge.object.filmGauge=this.filmGauge,ge.object.filmOffset=this.filmOffset,ge}}),pe.StereoCamera=function(){this.type='StereoCamera',this.aspect=1,this.cameraL=new pe.PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new pe.PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1},le(pe.StereoCamera.prototype,{update:function(){var ue,fe,ge,he,ye,xe=new pe.Matrix4,_e=new pe.Matrix4;return function(Ee){var Te=ue!==Ee.focus||fe!==Ee.fov||ge!==Ee.aspect*this.aspect||he!==Ee.near||ye!==Ee.far;if(Te){ue=Ee.focus,fe=Ee.fov,ge=Ee.aspect*this.aspect,he=Ee.near,ye=Ee.far;var Se=Ee.projectionMatrix.clone(),Me=0.064/2,Ae=Me*he/ue,Le=he*Math.tan(0.5*(pe.Math.DEG2RAD*fe)),Re,Ce;_e.elements[12]=-Me,xe.elements[12]=Me,Re=-Le*ge+Ae,Ce=Le*ge+Ae,Se.elements[0]=2*he/(Ce-Re),Se.elements[8]=(Ce+Re)/(Ce-Re),this.cameraL.projectionMatrix.copy(Se),Re=-Le*ge-Ae,Ce=Le*ge-Ae,Se.elements[0]=2*he/(Ce-Re),Se.elements[8]=(Ce+Re)/(Ce-Re),this.cameraR.projectionMatrix.copy(Se)}this.cameraL.matrixWorld.copy(Ee.matrixWorld).multiply(_e),this.cameraR.matrixWorld.copy(Ee.matrixWorld).multiply(xe)}}()}),pe.Light=function(ue,fe){pe.Object3D.call(this),this.type='Light',this.color=new pe.Color(ue),this.intensity=fe===void 0?1:fe,this.receiveShadow=void 0},pe.Light.prototype=le(Object.create(pe.Object3D.prototype),{constructor:pe.Light,copy:function(fe){return pe.Object3D.prototype.copy.call(this,fe),this.color.copy(fe.color),this.intensity=fe.intensity,this},toJSON:function(fe){var ge=pe.Object3D.prototype.toJSON.call(this,fe);return ge.object.color=this.color.getHex(),ge.object.intensity=this.intensity,void 0!==this.groundColor&&(ge.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(ge.object.distance=this.distance),void 0!==this.angle&&(ge.object.angle=this.angle),void 0!==this.decay&&(ge.object.decay=this.decay),void 0!==this.penumbra&&(ge.object.penumbra=this.penumbra),ge}}),pe.LightShadow=function(ue){this.camera=ue,this.bias=0,this.radius=1,this.mapSize=new pe.Vector2(512,512),this.map=null,this.matrix=new pe.Matrix4},le(pe.LightShadow.prototype,{copy:function(fe){return this.camera=fe.camera.clone(),this.bias=fe.bias,this.radius=fe.radius,this.mapSize.copy(fe.mapSize),this},clone:function(){return new this.constructor().copy(this)}}),pe.AmbientLight=function(ue,fe){pe.Light.call(this,ue,fe),this.type='AmbientLight',this.castShadow=void 0},pe.AmbientLight.prototype=le(Object.create(pe.Light.prototype),{constructor:pe.AmbientLight}),pe.DirectionalLight=function(ue,fe){pe.Light.call(this,ue,fe),this.type='DirectionalLight',this.position.set(0,1,0),this.updateMatrix(),this.target=new pe.Object3D,this.shadow=new pe.DirectionalLightShadow},pe.DirectionalLight.prototype=le(Object.create(pe.Light.prototype),{constructor:pe.DirectionalLight,copy:function(fe){return pe.Light.prototype.copy.call(this,fe),this.target=fe.target.clone(),this.shadow=fe.shadow.clone(),this}}),pe.DirectionalLightShadow=function(){pe.LightShadow.call(this,new pe.OrthographicCamera(-5,5,5,-5,0.5,500))},pe.DirectionalLightShadow.prototype=le(Object.create(pe.LightShadow.prototype),{constructor:pe.DirectionalLightShadow}),pe.HemisphereLight=function(ue,fe,ge){pe.Light.call(this,ue,ge),this.type='HemisphereLight',this.castShadow=void 0,this.position.set(0,1,0),this.updateMatrix(),this.groundColor=new pe.Color(fe)},pe.HemisphereLight.prototype=le(Object.create(pe.Light.prototype),{constructor:pe.HemisphereLight,copy:function(fe){return pe.Light.prototype.copy.call(this,fe),this.groundColor.copy(fe.groundColor),this}}),pe.PointLight=function(ue,fe,ge,he){pe.Light.call(this,ue,fe),this.type='PointLight',Object.defineProperty(this,'power',{get:function(){return 4*this.intensity*Math.PI},set:function(xe){this.intensity=xe/(4*Math.PI)}}),this.distance=ge===void 0?0:ge,this.decay=he===void 0?1:he,this.shadow=new pe.LightShadow(new pe.PerspectiveCamera(90,1,0.5,500))},pe.PointLight.prototype=le(Object.create(pe.Light.prototype),{constructor:pe.PointLight,copy:function(fe){return pe.Light.prototype.copy.call(this,fe),this.distance=fe.distance,this.decay=fe.decay,this.shadow=fe.shadow.clone(),this}}),pe.SpotLight=function(ue,fe,ge,he,ye,xe){pe.Light.call(this,ue,fe),this.type='SpotLight',this.position.set(0,1,0),this.updateMatrix(),this.target=new pe.Object3D,Object.defineProperty(this,'power',{get:function(){return this.intensity*Math.PI},set:function(ve){this.intensity=ve/Math.PI}}),this.distance=ge===void 0?0:ge,this.angle=he===void 0?Math.PI/3:he,this.penumbra=ye===void 0?0:ye,this.decay=xe===void 0?1:xe,this.shadow=new pe.SpotLightShadow},pe.SpotLight.prototype=le(Object.create(pe.Light.prototype),{constructor:pe.SpotLight,copy:function(fe){return pe.Light.prototype.copy.call(this,fe),this.distance=fe.distance,this.angle=fe.angle,this.penumbra=fe.penumbra,this.decay=fe.decay,this.target=fe.target.clone(),this.shadow=fe.shadow.clone(),this}}),pe.SpotLightShadow=function(){pe.LightShadow.call(this,new pe.PerspectiveCamera(50,1,0.5,500))},pe.SpotLightShadow.prototype=le(Object.create(pe.LightShadow.prototype),{constructor:pe.SpotLightShadow,update:function(fe){var ge=2*pe.Math.RAD2DEG*fe.angle,he=this.mapSize.width/this.mapSize.height,ye=fe.distance||500,xe=this.camera;(ge!==xe.fov||he!==xe.aspect||ye!==xe.far)&&(xe.fov=ge,xe.aspect=he,xe.far=ye,xe.updateProjectionMatrix())}}),pe.AudioLoader=function(ue){this.manager=ue===void 0?pe.DefaultLoadingManager:ue},le(pe.AudioLoader.prototype,{load:function(fe,ge,he,ye){var xe=new pe.XHRLoader(this.manager);xe.setResponseType('arraybuffer'),xe.load(fe,function(_e){var ve=pe.AudioContext;ve.decodeAudioData(_e,function(Ee){ge(Ee)})},he,ye)}}),pe.Cache={enabled:!1,files:{},add:function(fe,ge){!1===this.enabled||(this.files[fe]=ge)},get:function(fe){return!1===this.enabled?void 0:this.files[fe]},remove:function(fe){delete this.files[fe]},clear:function(){this.files={}}},pe.Loader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},pe.Loader.prototype={constructor:pe.Loader,crossOrigin:void 0,extractUrlBase:function(fe){var ge=fe.split('/');return 1===ge.length?'./':(ge.pop(),ge.join('/')+'/')},initMaterials:function(fe,ge,he){for(var ye=[],xe=0;xe<fe.length;++xe)ye[xe]=this.createMaterial(fe[xe],ge,he);return ye},createMaterial:function(){var ue,fe,ge;return function(ye,xe,_e){function ve(Ae,Le,Re,Ce,we){var Pe=xe+Ae,Fe=pe.Loader.Handlers.get(Pe),De;null===Fe?(fe.setCrossOrigin(_e),De=fe.load(Pe)):De=Fe.load(Pe),void 0!==Le&&(De.repeat.fromArray(Le),1!==Le[0]&&(De.wrapS=pe.RepeatWrapping),1!==Le[1]&&(De.wrapT=pe.RepeatWrapping)),void 0!==Re&&De.offset.fromArray(Re),void 0!==Ce&&('repeat'===Ce[0]&&(De.wrapS=pe.RepeatWrapping),'mirror'===Ce[0]&&(De.wrapS=pe.MirroredRepeatWrapping),'repeat'===Ce[1]&&(De.wrapT=pe.RepeatWrapping),'mirror'===Ce[1]&&(De.wrapT=pe.MirroredRepeatWrapping)),void 0!==we&&(De.anisotropy=we);var Ie=pe.Math.generateUUID();return Ee[Ie]=De,Ie}void 0==ue&&(ue=new pe.Color),void 0==fe&&(fe=new pe.TextureLoader),void 0==ge&&(ge=new pe.MaterialLoader);var Ee={},Te={uuid:pe.Math.generateUUID(),type:'MeshLambertMaterial'};for(var Se in ye){var Me=ye[Se];switch(Se){case'DbgColor':case'DbgIndex':case'opticalDensity':case'illumination':break;case'DbgName':Te.name=Me;break;case'blending':Te.blending=pe[Me];break;case'colorAmbient':case'mapAmbient':console.warn('THREE.Loader.createMaterial:',Se,'is no longer supported.');break;case'colorDiffuse':Te.color=ue.fromArray(Me).getHex();break;case'colorSpecular':Te.specular=ue.fromArray(Me).getHex();break;case'colorEmissive':Te.emissive=ue.fromArray(Me).getHex();break;case'specularCoef':Te.shininess=Me;break;case'shading':'basic'===Me.toLowerCase()&&(Te.type='MeshBasicMaterial'),'phong'===Me.toLowerCase()&&(Te.type='MeshPhongMaterial'),'standard'===Me.toLowerCase()&&(Te.type='MeshStandardMaterial');break;case'mapDiffuse':Te.map=ve(Me,ye.mapDiffuseRepeat,ye.mapDiffuseOffset,ye.mapDiffuseWrap,ye.mapDiffuseAnisotropy);break;case'mapDiffuseRepeat':case'mapDiffuseOffset':case'mapDiffuseWrap':case'mapDiffuseAnisotropy':break;case'mapEmissive':Te.emissiveMap=ve(Me,ye.mapEmissiveRepeat,ye.mapEmissiveOffset,ye.mapEmissiveWrap,ye.mapEmissiveAnisotropy);break;case'mapEmissiveRepeat':case'mapEmissiveOffset':case'mapEmissiveWrap':case'mapEmissiveAnisotropy':break;case'mapLight':Te.lightMap=ve(Me,ye.mapLightRepeat,ye.mapLightOffset,ye.mapLightWrap,ye.mapLightAnisotropy);break;case'mapLightRepeat':case'mapLightOffset':case'mapLightWrap':case'mapLightAnisotropy':break;case'mapAO':Te.aoMap=ve(Me,ye.mapAORepeat,ye.mapAOOffset,ye.mapAOWrap,ye.mapAOAnisotropy);break;case'mapAORepeat':case'mapAOOffset':case'mapAOWrap':case'mapAOAnisotropy':break;case'mapBump':Te.bumpMap=ve(Me,ye.mapBumpRepeat,ye.mapBumpOffset,ye.mapBumpWrap,ye.mapBumpAnisotropy);break;case'mapBumpScale':Te.bumpScale=Me;break;case'mapBumpRepeat':case'mapBumpOffset':case'mapBumpWrap':case'mapBumpAnisotropy':break;case'mapNormal':Te.normalMap=ve(Me,ye.mapNormalRepeat,ye.mapNormalOffset,ye.mapNormalWrap,ye.mapNormalAnisotropy);break;case'mapNormalFactor':Te.normalScale=[Me,Me];break;case'mapNormalRepeat':case'mapNormalOffset':case'mapNormalWrap':case'mapNormalAnisotropy':break;case'mapSpecular':Te.specularMap=ve(Me,ye.mapSpecularRepeat,ye.mapSpecularOffset,ye.mapSpecularWrap,ye.mapSpecularAnisotropy);break;case'mapSpecularRepeat':case'mapSpecularOffset':case'mapSpecularWrap':case'mapSpecularAnisotropy':break;case'mapMetalness':Te.metalnessMap=ve(Me,ye.mapMetalnessRepeat,ye.mapMetalnessOffset,ye.mapMetalnessWrap,ye.mapMetalnessAnisotropy);break;case'mapMetalnessRepeat':case'mapMetalnessOffset':case'mapMetalnessWrap':case'mapMetalnessAnisotropy':break;case'mapRoughness':Te.roughnessMap=ve(Me,ye.mapRoughnessRepeat,ye.mapRoughnessOffset,ye.mapRoughnessWrap,ye.mapRoughnessAnisotropy);break;case'mapRoughnessRepeat':case'mapRoughnessOffset':case'mapRoughnessWrap':case'mapRoughnessAnisotropy':break;case'mapAlpha':Te.alphaMap=ve(Me,ye.mapAlphaRepeat,ye.mapAlphaOffset,ye.mapAlphaWrap,ye.mapAlphaAnisotropy);break;case'mapAlphaRepeat':case'mapAlphaOffset':case'mapAlphaWrap':case'mapAlphaAnisotropy':break;case'flipSided':Te.side=pe.BackSide;break;case'doubleSided':Te.side=pe.DoubleSide;break;case'transparency':console.warn('THREE.Loader.createMaterial: transparency has been renamed to opacity'),Te.opacity=Me;break;case'depthTest':case'depthWrite':case'colorWrite':case'opacity':case'reflectivity':case'transparent':case'visible':case'wireframe':Te[Se]=Me;break;case'vertexColors':!0===Me&&(Te.vertexColors=pe.VertexColors),'face'===Me&&(Te.vertexColors=pe.FaceColors);break;default:console.error('THREE.Loader.createMaterial: Unsupported',Se,Me);}}return'MeshBasicMaterial'===Te.type&&delete Te.emissive,'MeshPhongMaterial'!==Te.type&&delete Te.specular,1>Te.opacity&&(Te.transparent=!0),ge.setTextures(Ee),ge.parse(Te)}}()},pe.Loader.Handlers={handlers:[],add:function(fe,ge){this.handlers.push(fe,ge)},get:function(fe){for(var ge=this.handlers,he=0,ye=ge.length;he<ye;he+=2){var xe=ge[he],_e=ge[he+1];if(xe.test(fe))return _e}return null}},pe.XHRLoader=function(ue){this.manager=ue===void 0?pe.DefaultLoadingManager:ue},le(pe.XHRLoader.prototype,{load:function(fe,ge,he,ye){void 0!==this.path&&(fe=this.path+fe);var xe=this,_e=pe.Cache.get(fe);if(void 0!==_e)return ge&&setTimeout(function(){ge(_e)},0),_e;var ve=new XMLHttpRequest;return ve.overrideMimeType('text/plain'),ve.open('GET',fe,!0),ve.addEventListener('load',function(Ee){var Te=Ee.target.response;pe.Cache.add(fe,Te),200===this.status?(ge&&ge(Te),xe.manager.itemEnd(fe)):0===this.status?(console.warn('THREE.XHRLoader: HTTP Status 0 received.'),ge&&ge(Te),xe.manager.itemEnd(fe)):(ye&&ye(Ee),xe.manager.itemError(fe))},!1),void 0!==he&&ve.addEventListener('progress',function(Ee){he(Ee)},!1),ve.addEventListener('error',function(Ee){ye&&ye(Ee),xe.manager.itemError(fe)},!1),void 0!==this.responseType&&(ve.responseType=this.responseType),void 0!==this.withCredentials&&(ve.withCredentials=this.withCredentials),ve.send(null),xe.manager.itemStart(fe),ve},setPath:function(fe){return this.path=fe,this},setResponseType:function(fe){return this.responseType=fe,this},setWithCredentials:function(fe){return this.withCredentials=fe,this}}),pe.FontLoader=function(ue){this.manager=ue===void 0?pe.DefaultLoadingManager:ue},le(pe.FontLoader.prototype,{load:function(fe,ge,he,ye){var xe=this,_e=new pe.XHRLoader(this.manager);_e.load(fe,function(ve){var Ee;try{Ee=JSON.parse(ve)}catch(Se){console.warn('THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead.'),Ee=JSON.parse(ve.substring(65,ve.length-2))}var Te=xe.parse(Ee);ge&&ge(Te)},he,ye)},parse:function(fe){return new pe.Font(fe)}}),pe.ImageLoader=function(ue){this.manager=ue===void 0?pe.DefaultLoadingManager:ue},le(pe.ImageLoader.prototype,{load:function(fe,ge,he,ye){var xe=document.createElementNS('http://www.w3.org/1999/xhtml','img');if(xe.onload=function(){URL.revokeObjectURL(xe.src),ge&&ge(xe)},0===fe.indexOf('data:'))xe.src=fe;else{var _e=new pe.XHRLoader(this.manager);_e.setPath(this.path),_e.setResponseType('blob'),_e.load(fe,function(ve){xe.src=URL.createObjectURL(ve)},he,ye)}return xe},setCrossOrigin:function(fe){return this.crossOrigin=fe,this},setPath:function(fe){return this.path=fe,this}}),pe.JSONLoader=function(ue){'boolean'==typeof ue&&(console.warn('THREE.JSONLoader: showStatus parameter has been removed from constructor.'),ue=void 0),this.manager=ue===void 0?pe.DefaultLoadingManager:ue,this.withCredentials=!1},le(pe.JSONLoader.prototype,{load:function(fe,ge,he,ye){var xe=this,_e=this.texturePath&&'string'==typeof this.texturePath?this.texturePath:pe.Loader.prototype.extractUrlBase(fe),ve=new pe.XHRLoader(this.manager);ve.setWithCredentials(this.withCredentials),ve.load(fe,function(Ee){var Te=JSON.parse(Ee),Se=Te.metadata;if(Se!==void 0){var Me=Se.type;if(Me!==void 0){if('object'===Me.toLowerCase())return void console.error('THREE.JSONLoader: '+fe+' should be loaded with THREE.ObjectLoader instead.');if('scene'===Me.toLowerCase())return void console.error('THREE.JSONLoader: '+fe+' should be loaded with THREE.SceneLoader instead.')}}var Ae=xe.parse(Te,_e);ge(Ae.geometry,Ae.materials)},he,ye)},setTexturePath:function(fe){this.texturePath=fe},parse:function(fe,ge){var ve=new pe.Geometry,Ee=void 0===fe.scale?1:1/fe.scale;if(function(Se){function Me(it,nt){return it&1<<nt}var $e=fe.faces,et=fe.vertices,tt=fe.normals,rt=fe.colors,ot=0,Ae,Le,Re,Ce,we,Pe,Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe,ke,He,We,je,Xe,qe,Ye,Ze,Ke,Qe,Je;if(void 0!==fe.uvs){for(Ae=0;Ae<fe.uvs.length;Ae++)fe.uvs[Ae].length&&ot++;for(Ae=0;Ae<ot;Ae++)ve.faceVertexUvs[Ae]=[]}for(Ce=0,we=et.length;Ce<we;)He=new pe.Vector3,He.x=et[Ce++]*Se,He.y=et[Ce++]*Se,He.z=et[Ce++]*Se,ve.vertices.push(He);for(Ce=0,we=$e.length;Ce<we;)if(Be=$e[Ce++],Ue=Me(Be,0),Ne=Me(Be,1),Ge=Me(Be,3),Ve=Me(Be,4),ze=Me(Be,5),Oe=Me(Be,6),ke=Me(Be,7),Ue){if(je=new pe.Face3,je.a=$e[Ce],je.b=$e[Ce+1],je.c=$e[Ce+3],Xe=new pe.Face3,Xe.a=$e[Ce+1],Xe.b=$e[Ce+2],Xe.c=$e[Ce+3],Ce+=4,Ne&&(Ie=$e[Ce++],je.materialIndex=Ie,Xe.materialIndex=Ie),Re=ve.faces.length,Ge)for(Ae=0;Ae<ot;Ae++)for(Ze=fe.uvs[Ae],ve.faceVertexUvs[Ae][Re]=[],ve.faceVertexUvs[Ae][Re+1]=[],Le=0;4>Le;Le++)De=$e[Ce++],Qe=Ze[2*De],Je=Ze[2*De+1],Ke=new pe.Vector2(Qe,Je),2!==Le&&ve.faceVertexUvs[Ae][Re].push(Ke),0!==Le&&ve.faceVertexUvs[Ae][Re+1].push(Ke);if(Ve&&(Fe=3*$e[Ce++],je.normal.set(tt[Fe++],tt[Fe++],tt[Fe]),Xe.normal.copy(je.normal)),ze)for(Ae=0;4>Ae;Ae++)Fe=3*$e[Ce++],Ye=new pe.Vector3(tt[Fe++],tt[Fe++],tt[Fe]),2!==Ae&&je.vertexNormals.push(Ye),0!==Ae&&Xe.vertexNormals.push(Ye);if(Oe&&(Pe=$e[Ce++],qe=rt[Pe],je.color.setHex(qe),Xe.color.setHex(qe)),ke)for(Ae=0;4>Ae;Ae++)Pe=$e[Ce++],qe=rt[Pe],2!==Ae&&je.vertexColors.push(new pe.Color(qe)),0!==Ae&&Xe.vertexColors.push(new pe.Color(qe));ve.faces.push(je),ve.faces.push(Xe)}else{if(We=new pe.Face3,We.a=$e[Ce++],We.b=$e[Ce++],We.c=$e[Ce++],Ne&&(Ie=$e[Ce++],We.materialIndex=Ie),Re=ve.faces.length,Ge)for(Ae=0;Ae<ot;Ae++)for(Ze=fe.uvs[Ae],ve.faceVertexUvs[Ae][Re]=[],Le=0;3>Le;Le++)De=$e[Ce++],Qe=Ze[2*De],Je=Ze[2*De+1],Ke=new pe.Vector2(Qe,Je),ve.faceVertexUvs[Ae][Re].push(Ke);if(Ve&&(Fe=3*$e[Ce++],We.normal.set(tt[Fe++],tt[Fe++],tt[Fe])),ze)for(Ae=0;3>Ae;Ae++)Fe=3*$e[Ce++],Ye=new pe.Vector3(tt[Fe++],tt[Fe++],tt[Fe]),We.vertexNormals.push(Ye);if(Oe&&(Pe=$e[Ce++],We.color.setHex(rt[Pe])),ke)for(Ae=0;3>Ae;Ae++)Pe=$e[Ce++],We.vertexColors.push(new pe.Color(rt[Pe]));ve.faces.push(We)}}(Ee),function(){var Se=void 0===fe.influencesPerVertex?2:fe.influencesPerVertex;if(fe.skinWeights)for(var Me=0,Ae=fe.skinWeights.length;Me<Ae;Me+=Se){var Le=fe.skinWeights[Me],Re=1<Se?fe.skinWeights[Me+1]:0,Ce=2<Se?fe.skinWeights[Me+2]:0,we=3<Se?fe.skinWeights[Me+3]:0;ve.skinWeights.push(new pe.Vector4(Le,Re,Ce,we))}if(fe.skinIndices)for(var Me=0,Ae=fe.skinIndices.length;Me<Ae;Me+=Se){var Pe=fe.skinIndices[Me],Fe=1<Se?fe.skinIndices[Me+1]:0,De=2<Se?fe.skinIndices[Me+2]:0,Ie=3<Se?fe.skinIndices[Me+3]:0;ve.skinIndices.push(new pe.Vector4(Pe,Fe,De,Ie))}ve.bones=fe.bones,ve.bones&&0<ve.bones.length&&(ve.skinWeights.length!==ve.skinIndices.length||ve.skinIndices.length!==ve.vertices.length)&&console.warn('When skinning, number of vertices ('+ve.vertices.length+'), skinIndices ('+ve.skinIndices.length+'), and skinWeights ('+ve.skinWeights.length+') should match.')}(),function(Se){if(void 0!==fe.morphTargets)for(var Me=0,Ae=fe.morphTargets.length;Me<Ae;Me++){ve.morphTargets[Me]={},ve.morphTargets[Me].name=fe.morphTargets[Me].name,ve.morphTargets[Me].vertices=[];for(var Le=ve.morphTargets[Me].vertices,Re=fe.morphTargets[Me].vertices,Ce=0,we=Re.length,Pe;Ce<we;Ce+=3)Pe=new pe.Vector3,Pe.x=Re[Ce]*Se,Pe.y=Re[Ce+1]*Se,Pe.z=Re[Ce+2]*Se,Le.push(Pe)}if(void 0!==fe.morphColors&&0<fe.morphColors.length){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var Fe=ve.faces,De=fe.morphColors[0].colors,Me=0,Ae=Fe.length;Me<Ae;Me++)Fe[Me].color.fromArray(De,3*Me)}}(Ee),function(){var Se=[],Me=[];void 0!==fe.animation&&Me.push(fe.animation),void 0!==fe.animations&&(fe.animations.length?Me=Me.concat(fe.animations):Me.push(fe.animations));for(var Ae=0,Le;Ae<Me.length;Ae++)Le=pe.AnimationClip.parseAnimation(Me[Ae],ve.bones),Le&&Se.push(Le);if(ve.morphTargets){var Re=pe.AnimationClip.CreateClipsFromMorphTargetSequences(ve.morphTargets,10);Se=Se.concat(Re)}0<Se.length&&(ve.animations=Se)}(),ve.computeFaceNormals(),ve.computeBoundingSphere(),void 0===fe.materials||0===fe.materials.length)return{geometry:ve};var Te=pe.Loader.prototype.initMaterials(fe.materials,ge,this.crossOrigin);return{geometry:ve,materials:Te}}}),pe.LoadingManager=function(ue,fe,ge){var he=this,ye=!1,xe=0,_e=0;this.onStart=void 0,this.onLoad=ue,this.onProgress=fe,this.onError=ge,this.itemStart=function(ve){_e++,!1==ye&&he.onStart!==void 0&&he.onStart(ve,xe,_e),ye=!0},this.itemEnd=function(ve){xe++,he.onProgress!==void 0&&he.onProgress(ve,xe,_e),xe==_e&&(ye=!1,he.onLoad!==void 0&&he.onLoad())},this.itemError=function(ve){he.onError!==void 0&&he.onError(ve)}},pe.DefaultLoadingManager=new pe.LoadingManager,pe.BufferGeometryLoader=function(ue){this.manager=ue===void 0?pe.DefaultLoadingManager:ue},le(pe.BufferGeometryLoader.prototype,{load:function(fe,ge,he,ye){var xe=this,_e=new pe.XHRLoader(xe.manager);_e.load(fe,function(ve){ge(xe.parse(JSON.parse(ve)))},he,ye)},parse:function(fe){var ge=new pe.BufferGeometry,he=fe.data.index,ye={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};if(he!==void 0){var xe=new ye[he.type](he.array);ge.setIndex(new pe.BufferAttribute(xe,1))}var _e=fe.data.attributes;for(var ve in _e){var Ee=_e[ve],xe=new ye[Ee.type](Ee.array);ge.addAttribute(ve,new pe.BufferAttribute(xe,Ee.itemSize,Ee.normalized))}var Te=fe.data.groups||fe.data.drawcalls||fe.data.offsets;if(Te!==void 0)for(var Se=0,Me=Te.length,Ae;Se!==Me;++Se)Ae=Te[Se],ge.addGroup(Ae.start,Ae.count,Ae.materialIndex);var Le=fe.data.boundingSphere;if(Le!==void 0){var Re=new pe.Vector3;Le.center!==void 0&&Re.fromArray(Le.center),ge.boundingSphere=new pe.Sphere(Re,Le.radius)}return ge}}),pe.MaterialLoader=function(ue){this.manager=ue===void 0?pe.DefaultLoadingManager:ue,this.textures={}},le(pe.MaterialLoader.prototype,{load:function(fe,ge,he,ye){var xe=this,_e=new pe.XHRLoader(xe.manager);_e.load(fe,function(ve){ge(xe.parse(JSON.parse(ve)))},he,ye)},setTextures:function(fe){this.textures=fe},getTexture:function(fe){var ge=this.textures;return void 0===ge[fe]&&console.warn('THREE.MaterialLoader: Undefined texture',fe),ge[fe]},parse:function(fe){var ge=new pe[fe.type];if(void 0!==fe.uuid&&(ge.uuid=fe.uuid),void 0!==fe.name&&(ge.name=fe.name),void 0!==fe.color&&ge.color.setHex(fe.color),void 0!==fe.roughness&&(ge.roughness=fe.roughness),void 0!==fe.metalness&&(ge.metalness=fe.metalness),void 0!==fe.emissive&&ge.emissive.setHex(fe.emissive),void 0!==fe.specular&&ge.specular.setHex(fe.specular),void 0!==fe.shininess&&(ge.shininess=fe.shininess),void 0!==fe.uniforms&&(ge.uniforms=fe.uniforms),void 0!==fe.vertexShader&&(ge.vertexShader=fe.vertexShader),void 0!==fe.fragmentShader&&(ge.fragmentShader=fe.fragmentShader),void 0!==fe.vertexColors&&(ge.vertexColors=fe.vertexColors),void 0!==fe.shading&&(ge.shading=fe.shading),void 0!==fe.blending&&(ge.blending=fe.blending),void 0!==fe.side&&(ge.side=fe.side),void 0!==fe.opacity&&(ge.opacity=fe.opacity),void 0!==fe.transparent&&(ge.transparent=fe.transparent),void 0!==fe.alphaTest&&(ge.alphaTest=fe.alphaTest),void 0!==fe.depthTest&&(ge.depthTest=fe.depthTest),void 0!==fe.depthWrite&&(ge.depthWrite=fe.depthWrite),void 0!==fe.colorWrite&&(ge.colorWrite=fe.colorWrite),void 0!==fe.wireframe&&(ge.wireframe=fe.wireframe),void 0!==fe.wireframeLinewidth&&(ge.wireframeLinewidth=fe.wireframeLinewidth),void 0!==fe.size&&(ge.size=fe.size),void 0!==fe.sizeAttenuation&&(ge.sizeAttenuation=fe.sizeAttenuation),void 0!==fe.map&&(ge.map=this.getTexture(fe.map)),void 0!==fe.alphaMap&&(ge.alphaMap=this.getTexture(fe.alphaMap),ge.transparent=!0),void 0!==fe.bumpMap&&(ge.bumpMap=this.getTexture(fe.bumpMap)),void 0!==fe.bumpScale&&(ge.bumpScale=fe.bumpScale),void 0!==fe.normalMap&&(ge.normalMap=this.getTexture(fe.normalMap)),void 0!==fe.normalScale){var he=fe.normalScale;!1===Array.isArray(he)&&(he=[he,he]),ge.normalScale=new pe.Vector2().fromArray(he)}if(void 0!==fe.displacementMap&&(ge.displacementMap=this.getTexture(fe.displacementMap)),void 0!==fe.displacementScale&&(ge.displacementScale=fe.displacementScale),void 0!==fe.displacementBias&&(ge.displacementBias=fe.displacementBias),void 0!==fe.roughnessMap&&(ge.roughnessMap=this.getTexture(fe.roughnessMap)),void 0!==fe.metalnessMap&&(ge.metalnessMap=this.getTexture(fe.metalnessMap)),void 0!==fe.emissiveMap&&(ge.emissiveMap=this.getTexture(fe.emissiveMap)),void 0!==fe.emissiveIntensity&&(ge.emissiveIntensity=fe.emissiveIntensity),void 0!==fe.specularMap&&(ge.specularMap=this.getTexture(fe.specularMap)),void 0!==fe.envMap&&(ge.envMap=this.getTexture(fe.envMap),ge.combine=pe.MultiplyOperation),void 0!==fe.reflectivity&&(ge.reflectivity=fe.reflectivity),void 0!==fe.lightMap&&(ge.lightMap=this.getTexture(fe.lightMap)),void 0!==fe.lightMapIntensity&&(ge.lightMapIntensity=fe.lightMapIntensity),void 0!==fe.aoMap&&(ge.aoMap=this.getTexture(fe.aoMap)),void 0!==fe.aoMapIntensity&&(ge.aoMapIntensity=fe.aoMapIntensity),void 0!==fe.materials)for(var ye=0,xe=fe.materials.length;ye<xe;ye++)ge.materials.push(this.parse(fe.materials[ye]));return ge}}),pe.ObjectLoader=function(ue){this.manager=ue===void 0?pe.DefaultLoadingManager:ue,this.texturePath=''},le(pe.ObjectLoader.prototype,{load:function(fe,ge,he,ye){''===this.texturePath&&(this.texturePath=fe.substring(0,fe.lastIndexOf('/')+1));var xe=this,_e=new pe.XHRLoader(xe.manager);_e.load(fe,function(ve){xe.parse(JSON.parse(ve),ge)},he,ye)},setTexturePath:function(fe){this.texturePath=fe},setCrossOrigin:function(fe){this.crossOrigin=fe},parse:function(fe,ge){var he=this.parseGeometries(fe.geometries),ye=this.parseImages(fe.images,function(){void 0!==ge&&ge(ve)}),xe=this.parseTextures(fe.textures,ye),_e=this.parseMaterials(fe.materials,xe),ve=this.parseObject(fe.object,he,_e);return fe.animations&&(ve.animations=this.parseAnimations(fe.animations)),(void 0===fe.images||0===fe.images.length)&&void 0!==ge&&ge(ve),ve},parseGeometries:function(fe){var ge={};if(fe!==void 0)for(var he=new pe.JSONLoader,ye=new pe.BufferGeometryLoader,xe=0,_e=fe.length;xe<_e;xe++){var Ee=fe[xe],ve;switch(Ee.type){case'PlaneGeometry':case'PlaneBufferGeometry':ve=new pe[Ee.type](Ee.width,Ee.height,Ee.widthSegments,Ee.heightSegments);break;case'BoxGeometry':case'BoxBufferGeometry':case'CubeGeometry':ve=new pe[Ee.type](Ee.width,Ee.height,Ee.depth,Ee.widthSegments,Ee.heightSegments,Ee.depthSegments);break;case'CircleGeometry':case'CircleBufferGeometry':ve=new pe[Ee.type](Ee.radius,Ee.segments,Ee.thetaStart,Ee.thetaLength);break;case'CylinderGeometry':case'CylinderBufferGeometry':ve=new pe[Ee.type](Ee.radiusTop,Ee.radiusBottom,Ee.height,Ee.radialSegments,Ee.heightSegments,Ee.openEnded,Ee.thetaStart,Ee.thetaLength);break;case'ConeGeometry':case'ConeBufferGeometry':ve=new pe[Ee.type](Ee.radius,Ee.height,Ee.radialSegments,Ee.heightSegments,Ee.openEnded,Ee.thetaStart,Ee.thetaLength);break;case'SphereGeometry':case'SphereBufferGeometry':ve=new pe[Ee.type](Ee.radius,Ee.widthSegments,Ee.heightSegments,Ee.phiStart,Ee.phiLength,Ee.thetaStart,Ee.thetaLength);break;case'DodecahedronGeometry':case'IcosahedronGeometry':case'OctahedronGeometry':case'TetrahedronGeometry':ve=new pe[Ee.type](Ee.radius,Ee.detail);break;case'RingGeometry':case'RingBufferGeometry':ve=new pe[Ee.type](Ee.innerRadius,Ee.outerRadius,Ee.thetaSegments,Ee.phiSegments,Ee.thetaStart,Ee.thetaLength);break;case'TorusGeometry':case'TorusBufferGeometry':ve=new pe[Ee.type](Ee.radius,Ee.tube,Ee.radialSegments,Ee.tubularSegments,Ee.arc);break;case'TorusKnotGeometry':case'TorusKnotBufferGeometry':ve=new pe[Ee.type](Ee.radius,Ee.tube,Ee.tubularSegments,Ee.radialSegments,Ee.p,Ee.q);break;case'LatheGeometry':case'LatheBufferGeometry':ve=new pe[Ee.type](Ee.points,Ee.segments,Ee.phiStart,Ee.phiLength);break;case'BufferGeometry':ve=ye.parse(Ee);break;case'Geometry':ve=he.parse(Ee.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+Ee.type+'"');continue;}ve.uuid=Ee.uuid,void 0!==Ee.name&&(ve.name=Ee.name),ge[Ee.uuid]=ve}return ge},parseMaterials:function(fe,ge){var he={};if(fe!==void 0){var ye=new pe.MaterialLoader;ye.setTextures(ge);for(var xe=0,_e=fe.length,ve;xe<_e;xe++)ve=ye.parse(fe[xe]),he[ve.uuid]=ve}return he},parseAnimations:function(fe){for(var ge=[],he=0,ye;he<fe.length;he++)ye=pe.AnimationClip.parse(fe[he]),ge.push(ye);return ge},parseImages:function(fe,ge){function he(Ae){return ye.manager.itemStart(Ae),ve.load(Ae,function(){ye.manager.itemEnd(Ae)})}var ye=this,xe={};if(fe!==void 0&&0<fe.length){var _e=new pe.LoadingManager(ge),ve=new pe.ImageLoader(_e);ve.setCrossOrigin(this.crossOrigin);for(var Ee=0,Te=fe.length;Ee<Te;Ee++){var Se=fe[Ee],Me=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(Se.url)?Se.url:ye.texturePath+Se.url;xe[Se.uuid]=he(Me)}}return xe},parseTextures:function(fe,ge){function he(Te){return'number'==typeof Te?Te:(console.warn('THREE.ObjectLoader.parseTexture: Constant should be in numeric form.',Te),pe[Te])}var ye={};if(fe!==void 0)for(var xe=0,_e=fe.length,ve;xe<_e;xe++){ve=fe[xe],void 0===ve.image&&console.warn('THREE.ObjectLoader: No "image" specified for',ve.uuid),void 0===ge[ve.image]&&console.warn('THREE.ObjectLoader: Undefined image',ve.image);var Ee=new pe.Texture(ge[ve.image]);Ee.needsUpdate=!0,Ee.uuid=ve.uuid,void 0!==ve.name&&(Ee.name=ve.name),void 0!==ve.mapping&&(Ee.mapping=he(ve.mapping)),void 0!==ve.offset&&(Ee.offset=new pe.Vector2(ve.offset[0],ve.offset[1])),void 0!==ve.repeat&&(Ee.repeat=new pe.Vector2(ve.repeat[0],ve.repeat[1])),void 0!==ve.minFilter&&(Ee.minFilter=he(ve.minFilter)),void 0!==ve.magFilter&&(Ee.magFilter=he(ve.magFilter)),void 0!==ve.anisotropy&&(Ee.anisotropy=ve.anisotropy),Array.isArray(ve.wrap)&&(Ee.wrapS=he(ve.wrap[0]),Ee.wrapT=he(ve.wrap[1])),ye[ve.uuid]=Ee}return ye},parseObject:function(){var ue=new pe.Matrix4;return function(ge,he,ye){function xe(Re){return void 0===he[Re]&&console.warn('THREE.ObjectLoader: Undefined geometry',Re),he[Re]}function _e(Re){if(void 0!==Re)return void 0===ye[Re]&&console.warn('THREE.ObjectLoader: Undefined material',Re),ye[Re]}var ve;switch(ge.type){case'Scene':ve=new pe.Scene;break;case'PerspectiveCamera':ve=new pe.PerspectiveCamera(ge.fov,ge.aspect,ge.near,ge.far),void 0!==ge.focus&&(ve.focus=ge.focus),void 0!==ge.zoom&&(ve.zoom=ge.zoom),void 0!==ge.filmGauge&&(ve.filmGauge=ge.filmGauge),void 0!==ge.filmOffset&&(ve.filmOffset=ge.filmOffset),void 0!==ge.view&&(ve.view=le({},ge.view));break;case'OrthographicCamera':ve=new pe.OrthographicCamera(ge.left,ge.right,ge.top,ge.bottom,ge.near,ge.far);break;case'AmbientLight':ve=new pe.AmbientLight(ge.color,ge.intensity);break;case'DirectionalLight':ve=new pe.DirectionalLight(ge.color,ge.intensity);break;case'PointLight':ve=new pe.PointLight(ge.color,ge.intensity,ge.distance,ge.decay);break;case'SpotLight':ve=new pe.SpotLight(ge.color,ge.intensity,ge.distance,ge.angle,ge.penumbra,ge.decay);break;case'HemisphereLight':ve=new pe.HemisphereLight(ge.color,ge.groundColor,ge.intensity);break;case'Mesh':var Ee=xe(ge.geometry),Te=_e(ge.material);ve=Ee.bones&&0<Ee.bones.length?new pe.SkinnedMesh(Ee,Te):new pe.Mesh(Ee,Te);break;case'LOD':ve=new pe.LOD;break;case'Line':ve=new pe.Line(xe(ge.geometry),_e(ge.material),ge.mode);break;case'PointCloud':case'Points':ve=new pe.Points(xe(ge.geometry),_e(ge.material));break;case'Sprite':ve=new pe.Sprite(_e(ge.material));break;case'Group':ve=new pe.Group;break;default:ve=new pe.Object3D;}if(ve.uuid=ge.uuid,void 0!==ge.name&&(ve.name=ge.name),void 0===ge.matrix?(void 0!==ge.position&&ve.position.fromArray(ge.position),void 0!==ge.rotation&&ve.rotation.fromArray(ge.rotation),void 0!==ge.scale&&ve.scale.fromArray(ge.scale)):(ue.fromArray(ge.matrix),ue.decompose(ve.position,ve.quaternion,ve.scale)),void 0!==ge.castShadow&&(ve.castShadow=ge.castShadow),void 0!==ge.receiveShadow&&(ve.receiveShadow=ge.receiveShadow),void 0!==ge.visible&&(ve.visible=ge.visible),void 0!==ge.userData&&(ve.userData=ge.userData),void 0!==ge.children)for(var Se in ge.children)ve.add(this.parseObject(ge.children[Se],he,ye));if('LOD'===ge.type)for(var Me=ge.levels,Ae=0;Ae<Me.length;Ae++){var Le=Me[Ae],Se=ve.getObjectByProperty('uuid',Le.object);void 0!==Se&&ve.addLevel(Se,Le.distance)}return ve}}()}),pe.TextureLoader=function(ue){this.manager=ue===void 0?pe.DefaultLoadingManager:ue},le(pe.TextureLoader.prototype,{load:function(fe,ge,he,ye){var xe=new pe.Texture,_e=new pe.ImageLoader(this.manager);return _e.setCrossOrigin(this.crossOrigin),_e.setPath(this.path),_e.load(fe,function(ve){xe.image=ve,xe.needsUpdate=!0,void 0!==ge&&ge(xe)},he,ye),xe},setCrossOrigin:function(fe){return this.crossOrigin=fe,this},setPath:function(fe){return this.path=fe,this}}),pe.CubeTextureLoader=function(ue){this.manager=ue===void 0?pe.DefaultLoadingManager:ue},le(pe.CubeTextureLoader.prototype,{load:function(fe,ge,he,ye){function xe(Se){ve.load(fe[Se],function(Me){_e.images[Se]=Me,Ee++,6==Ee&&(_e.needsUpdate=!0,ge&&ge(_e))},void 0,ye)}var _e=new pe.CubeTexture,ve=new pe.ImageLoader(this.manager);ve.setCrossOrigin(this.crossOrigin),ve.setPath(this.path);for(var Ee=0,Te=0;Te<fe.length;++Te)xe(Te);return _e},setCrossOrigin:function(fe){return this.crossOrigin=fe,this},setPath:function(fe){return this.path=fe,this}}),pe.DataTextureLoader=pe.BinaryTextureLoader=function(ue){this.manager=ue===void 0?pe.DefaultLoadingManager:ue,this._parser=null},le(pe.BinaryTextureLoader.prototype,{load:function(fe,ge,he,ye){var xe=this,_e=new pe.DataTexture,ve=new pe.XHRLoader(this.manager);return ve.setResponseType('arraybuffer'),ve.load(fe,function(Ee){var Te=xe._parser(Ee);Te&&(void 0===Te.image?void 0!==Te.data&&(_e.image.width=Te.width,_e.image.height=Te.height,_e.image.data=Te.data):_e.image=Te.image,_e.wrapS=void 0===Te.wrapS?pe.ClampToEdgeWrapping:Te.wrapS,_e.wrapT=void 0===Te.wrapT?pe.ClampToEdgeWrapping:Te.wrapT,_e.magFilter=void 0===Te.magFilter?pe.LinearFilter:Te.magFilter,_e.minFilter=void 0===Te.minFilter?pe.LinearMipMapLinearFilter:Te.minFilter,_e.anisotropy=void 0===Te.anisotropy?1:Te.anisotropy,void 0!==Te.format&&(_e.format=Te.format),void 0!==Te.type&&(_e.type=Te.type),void 0!==Te.mipmaps&&(_e.mipmaps=Te.mipmaps),1===Te.mipmapCount&&(_e.minFilter=pe.LinearFilter),_e.needsUpdate=!0,ge&&ge(_e,Te))},he,ye),_e}}),pe.CompressedTextureLoader=function(ue){this.manager=ue===void 0?pe.DefaultLoadingManager:ue,this._parser=null},le(pe.CompressedTextureLoader.prototype,{load:function(fe,ge,he,ye){function xe(Le){Te.load(fe[Le],function(Re){var Ce=_e._parser(Re,!0);ve[Le]={width:Ce.width,height:Ce.height,format:Ce.format,mipmaps:Ce.mipmaps},Se+=1,6==Se&&(1===Ce.mipmapCount&&(Ee.minFilter=pe.LinearFilter),Ee.format=Ce.format,Ee.needsUpdate=!0,ge&&ge(Ee))},he,ye)}var _e=this,ve=[],Ee=new pe.CompressedTexture;Ee.image=ve;var Te=new pe.XHRLoader(this.manager);if(Te.setPath(this.path),Te.setResponseType('arraybuffer'),Array.isArray(fe))for(var Se=0,Me=0,Ae=fe.length;Me<Ae;++Me)xe(Me);else Te.load(fe,function(Le){var Re=_e._parser(Le,!0);if(Re.isCubemap)for(var Ce=Re.mipmaps.length/Re.mipmapCount,we=0;we<Ce;we++){ve[we]={mipmaps:[]};for(var Pe=0;Pe<Re.mipmapCount;Pe++)ve[we].mipmaps.push(Re.mipmaps[we*Re.mipmapCount+Pe]),ve[we].format=Re.format,ve[we].width=Re.width,ve[we].height=Re.height}else Ee.image.width=Re.width,Ee.image.height=Re.height,Ee.mipmaps=Re.mipmaps;1===Re.mipmapCount&&(Ee.minFilter=pe.LinearFilter),Ee.format=Re.format,Ee.needsUpdate=!0,ge&&ge(Ee)},he,ye);return Ee},setPath:function(fe){return this.path=fe,this}}),pe.Material=function(){Object.defineProperty(this,'id',{value:pe.MaterialIdCount++}),this.uuid=pe.Math.generateUUID(),this.name='',this.type='Material',this.fog=!0,this.lights=!0,this.blending=pe.NormalBlending,this.side=pe.FrontSide,this.shading=pe.SmoothShading,this.vertexColors=pe.NoColors,this.opacity=1,this.transparent=!1,this.blendSrc=pe.SrcAlphaFactor,this.blendDst=pe.OneMinusSrcAlphaFactor,this.blendEquation=pe.AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=pe.LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this._needsUpdate=!0},pe.Material.prototype={constructor:pe.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(ue){!0===ue&&this.update(),this._needsUpdate=ue},setValues:function(fe){if(void 0!==fe)for(var ge in fe){var he=fe[ge];if(void 0===he){console.warn('THREE.Material: \''+ge+'\' parameter is undefined.');continue}var ye=this[ge];if(void 0===ye){console.warn('THREE.'+this.type+': \''+ge+'\' is not a property of this material.');continue}ye instanceof pe.Color?ye.set(he):ye instanceof pe.Vector3&&he instanceof pe.Vector3?ye.copy(he):'overdraw'==ge?this[ge]=+he:this[ge]=he}},toJSON:function(fe){function ge(ve){var Ee=[];for(var Te in ve){var Se=ve[Te];delete Se.metadata,Ee.push(Se)}return Ee}var he=void 0===fe;he&&(fe={textures:{},images:{}});var ye={metadata:{version:4.4,type:'Material',generator:'Material.toJSON'}};if(ye.uuid=this.uuid,ye.type=this.type,''!==this.name&&(ye.name=this.name),this.color instanceof pe.Color&&(ye.color=this.color.getHex()),void 0!==this.roughness&&(ye.roughness=this.roughness),void 0!==this.metalness&&(ye.metalness=this.metalness),this.emissive instanceof pe.Color&&(ye.emissive=this.emissive.getHex()),this.specular instanceof pe.Color&&(ye.specular=this.specular.getHex()),void 0!==this.shininess&&(ye.shininess=this.shininess),this.map instanceof pe.Texture&&(ye.map=this.map.toJSON(fe).uuid),this.alphaMap instanceof pe.Texture&&(ye.alphaMap=this.alphaMap.toJSON(fe).uuid),this.lightMap instanceof pe.Texture&&(ye.lightMap=this.lightMap.toJSON(fe).uuid),this.bumpMap instanceof pe.Texture&&(ye.bumpMap=this.bumpMap.toJSON(fe).uuid,ye.bumpScale=this.bumpScale),this.normalMap instanceof pe.Texture&&(ye.normalMap=this.normalMap.toJSON(fe).uuid,ye.normalScale=this.normalScale.toArray()),this.displacementMap instanceof pe.Texture&&(ye.displacementMap=this.displacementMap.toJSON(fe).uuid,ye.displacementScale=this.displacementScale,ye.displacementBias=this.displacementBias),this.roughnessMap instanceof pe.Texture&&(ye.roughnessMap=this.roughnessMap.toJSON(fe).uuid),this.metalnessMap instanceof pe.Texture&&(ye.metalnessMap=this.metalnessMap.toJSON(fe).uuid),this.emissiveMap instanceof pe.Texture&&(ye.emissiveMap=this.emissiveMap.toJSON(fe).uuid),this.specularMap instanceof pe.Texture&&(ye.specularMap=this.specularMap.toJSON(fe).uuid),this.envMap instanceof pe.Texture&&(ye.envMap=this.envMap.toJSON(fe).uuid,ye.reflectivity=this.reflectivity),void 0!==this.size&&(ye.size=this.size),void 0!==this.sizeAttenuation&&(ye.sizeAttenuation=this.sizeAttenuation),this.blending!==pe.NormalBlending&&(ye.blending=this.blending),this.shading!==pe.SmoothShading&&(ye.shading=this.shading),this.side!==pe.FrontSide&&(ye.side=this.side),this.vertexColors!==pe.NoColors&&(ye.vertexColors=this.vertexColors),1>this.opacity&&(ye.opacity=this.opacity),!0===this.transparent&&(ye.transparent=this.transparent),0<this.alphaTest&&(ye.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(ye.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(ye.wireframe=this.wireframe),1<this.wireframeLinewidth&&(ye.wireframeLinewidth=this.wireframeLinewidth),he){var xe=ge(fe.textures),_e=ge(fe.images);0<xe.length&&(ye.textures=xe),0<_e.length&&(ye.images=_e)}return ye},clone:function(){return new this.constructor().copy(this)},copy:function(fe){this.name=fe.name,this.fog=fe.fog,this.lights=fe.lights,this.blending=fe.blending,this.side=fe.side,this.shading=fe.shading,this.vertexColors=fe.vertexColors,this.opacity=fe.opacity,this.transparent=fe.transparent,this.blendSrc=fe.blendSrc,this.blendDst=fe.blendDst,this.blendEquation=fe.blendEquation,this.blendSrcAlpha=fe.blendSrcAlpha,this.blendDstAlpha=fe.blendDstAlpha,this.blendEquationAlpha=fe.blendEquationAlpha,this.depthFunc=fe.depthFunc,this.depthTest=fe.depthTest,this.depthWrite=fe.depthWrite,this.colorWrite=fe.colorWrite,this.precision=fe.precision,this.polygonOffset=fe.polygonOffset,this.polygonOffsetFactor=fe.polygonOffsetFactor,this.polygonOffsetUnits=fe.polygonOffsetUnits,this.alphaTest=fe.alphaTest,this.premultipliedAlpha=fe.premultipliedAlpha,this.overdraw=fe.overdraw,this.visible=fe.visible,this.clipShadows=fe.clipShadows;var ge=fe.clippingPlanes,he=null;if(null!==ge){var ye=ge.length;he=Array(ye);for(var xe=0;xe!==ye;++xe)he[xe]=ge[xe].clone()}return this.clippingPlanes=he,this},update:function(){this.dispatchEvent({type:'update'})},dispose:function(){this.dispatchEvent({type:'dispose'})}},le(pe.Material.prototype,pe.EventDispatcher.prototype),pe.MaterialIdCount=0,pe.LineBasicMaterial=function(ue){pe.Material.call(this),this.type='LineBasicMaterial',this.color=new pe.Color(16777215),this.linewidth=1,this.linecap='round',this.linejoin='round',this.lights=!1,this.setValues(ue)},pe.LineBasicMaterial.prototype=Object.create(pe.Material.prototype),pe.LineBasicMaterial.prototype.constructor=pe.LineBasicMaterial,pe.LineBasicMaterial.prototype.copy=function(ue){return pe.Material.prototype.copy.call(this,ue),this.color.copy(ue.color),this.linewidth=ue.linewidth,this.linecap=ue.linecap,this.linejoin=ue.linejoin,this},pe.LineDashedMaterial=function(ue){pe.Material.call(this),this.type='LineDashedMaterial',this.color=new pe.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.lights=!1,this.setValues(ue)},pe.LineDashedMaterial.prototype=Object.create(pe.Material.prototype),pe.LineDashedMaterial.prototype.constructor=pe.LineDashedMaterial,pe.LineDashedMaterial.prototype.copy=function(ue){return pe.Material.prototype.copy.call(this,ue),this.color.copy(ue.color),this.linewidth=ue.linewidth,this.scale=ue.scale,this.dashSize=ue.dashSize,this.gapSize=ue.gapSize,this},pe.MeshBasicMaterial=function(ue){pe.Material.call(this),this.type='MeshBasicMaterial',this.color=new pe.Color(16777215),this.map=null,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pe.MultiplyOperation,this.reflectivity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(ue)},pe.MeshBasicMaterial.prototype=Object.create(pe.Material.prototype),pe.MeshBasicMaterial.prototype.constructor=pe.MeshBasicMaterial,pe.MeshBasicMaterial.prototype.copy=function(ue){return pe.Material.prototype.copy.call(this,ue),this.color.copy(ue.color),this.map=ue.map,this.aoMap=ue.aoMap,this.aoMapIntensity=ue.aoMapIntensity,this.specularMap=ue.specularMap,this.alphaMap=ue.alphaMap,this.envMap=ue.envMap,this.combine=ue.combine,this.reflectivity=ue.reflectivity,this.refractionRatio=ue.refractionRatio,this.wireframe=ue.wireframe,this.wireframeLinewidth=ue.wireframeLinewidth,this.wireframeLinecap=ue.wireframeLinecap,this.wireframeLinejoin=ue.wireframeLinejoin,this.skinning=ue.skinning,this.morphTargets=ue.morphTargets,this},pe.MeshDepthMaterial=function(ue){pe.Material.call(this),this.type='MeshDepthMaterial',this.depthPacking=pe.BasicDepthPacking,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(ue)},pe.MeshDepthMaterial.prototype=Object.create(pe.Material.prototype),pe.MeshDepthMaterial.prototype.constructor=pe.MeshDepthMaterial,pe.MeshDepthMaterial.prototype.copy=function(ue){return pe.Material.prototype.copy.call(this,ue),this.depthPacking=ue.depthPacking,this.skinning=ue.skinning,this.morphTargets=ue.morphTargets,this.map=ue.map,this.alphaMap=ue.alphaMap,this.displacementMap=ue.displacementMap,this.displacementScale=ue.displacementScale,this.displacementBias=ue.displacementBias,this.wireframe=ue.wireframe,this.wireframeLinewidth=ue.wireframeLinewidth,this},pe.MeshLambertMaterial=function(ue){pe.Material.call(this),this.type='MeshLambertMaterial',this.color=new pe.Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pe.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pe.MultiplyOperation,this.reflectivity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(ue)},pe.MeshLambertMaterial.prototype=Object.create(pe.Material.prototype),pe.MeshLambertMaterial.prototype.constructor=pe.MeshLambertMaterial,pe.MeshLambertMaterial.prototype.copy=function(ue){return pe.Material.prototype.copy.call(this,ue),this.color.copy(ue.color),this.map=ue.map,this.lightMap=ue.lightMap,this.lightMapIntensity=ue.lightMapIntensity,this.aoMap=ue.aoMap,this.aoMapIntensity=ue.aoMapIntensity,this.emissive.copy(ue.emissive),this.emissiveMap=ue.emissiveMap,this.emissiveIntensity=ue.emissiveIntensity,this.specularMap=ue.specularMap,this.alphaMap=ue.alphaMap,this.envMap=ue.envMap,this.combine=ue.combine,this.reflectivity=ue.reflectivity,this.refractionRatio=ue.refractionRatio,this.wireframe=ue.wireframe,this.wireframeLinewidth=ue.wireframeLinewidth,this.wireframeLinecap=ue.wireframeLinecap,this.wireframeLinejoin=ue.wireframeLinejoin,this.skinning=ue.skinning,this.morphTargets=ue.morphTargets,this.morphNormals=ue.morphNormals,this},pe.MeshNormalMaterial=function(ue){pe.Material.call(this,ue),this.type='MeshNormalMaterial',this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.morphTargets=!1,this.setValues(ue)},pe.MeshNormalMaterial.prototype=Object.create(pe.Material.prototype),pe.MeshNormalMaterial.prototype.constructor=pe.MeshNormalMaterial,pe.MeshNormalMaterial.prototype.copy=function(ue){return pe.Material.prototype.copy.call(this,ue),this.wireframe=ue.wireframe,this.wireframeLinewidth=ue.wireframeLinewidth,this},pe.MeshPhongMaterial=function(ue){pe.Material.call(this),this.type='MeshPhongMaterial',this.color=new pe.Color(16777215),this.specular=new pe.Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pe.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new pe.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pe.MultiplyOperation,this.reflectivity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(ue)},pe.MeshPhongMaterial.prototype=Object.create(pe.Material.prototype),pe.MeshPhongMaterial.prototype.constructor=pe.MeshPhongMaterial,pe.MeshPhongMaterial.prototype.copy=function(ue){return pe.Material.prototype.copy.call(this,ue),this.color.copy(ue.color),this.specular.copy(ue.specular),this.shininess=ue.shininess,this.map=ue.map,this.lightMap=ue.lightMap,this.lightMapIntensity=ue.lightMapIntensity,this.aoMap=ue.aoMap,this.aoMapIntensity=ue.aoMapIntensity,this.emissive.copy(ue.emissive),this.emissiveMap=ue.emissiveMap,this.emissiveIntensity=ue.emissiveIntensity,this.bumpMap=ue.bumpMap,this.bumpScale=ue.bumpScale,this.normalMap=ue.normalMap,this.normalScale.copy(ue.normalScale),this.displacementMap=ue.displacementMap,this.displacementScale=ue.displacementScale,this.displacementBias=ue.displacementBias,this.specularMap=ue.specularMap,this.alphaMap=ue.alphaMap,this.envMap=ue.envMap,this.combine=ue.combine,this.reflectivity=ue.reflectivity,this.refractionRatio=ue.refractionRatio,this.wireframe=ue.wireframe,this.wireframeLinewidth=ue.wireframeLinewidth,this.wireframeLinecap=ue.wireframeLinecap,this.wireframeLinejoin=ue.wireframeLinejoin,this.skinning=ue.skinning,this.morphTargets=ue.morphTargets,this.morphNormals=ue.morphNormals,this},pe.MeshStandardMaterial=function(ue){pe.Material.call(this),this.defines={STANDARD:''},this.type='MeshStandardMaterial',this.color=new pe.Color(16777215),this.roughness=0.5,this.metalness=0.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pe.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new pe.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(ue)},pe.MeshStandardMaterial.prototype=Object.create(pe.Material.prototype),pe.MeshStandardMaterial.prototype.constructor=pe.MeshStandardMaterial,pe.MeshStandardMaterial.prototype.copy=function(ue){return pe.Material.prototype.copy.call(this,ue),this.defines={STANDARD:''},this.color.copy(ue.color),this.roughness=ue.roughness,this.metalness=ue.metalness,this.map=ue.map,this.lightMap=ue.lightMap,this.lightMapIntensity=ue.lightMapIntensity,this.aoMap=ue.aoMap,this.aoMapIntensity=ue.aoMapIntensity,this.emissive.copy(ue.emissive),this.emissiveMap=ue.emissiveMap,this.emissiveIntensity=ue.emissiveIntensity,this.bumpMap=ue.bumpMap,this.bumpScale=ue.bumpScale,this.normalMap=ue.normalMap,this.normalScale.copy(ue.normalScale),this.displacementMap=ue.displacementMap,this.displacementScale=ue.displacementScale,this.displacementBias=ue.displacementBias,this.roughnessMap=ue.roughnessMap,this.metalnessMap=ue.metalnessMap,this.alphaMap=ue.alphaMap,this.envMap=ue.envMap,this.envMapIntensity=ue.envMapIntensity,this.refractionRatio=ue.refractionRatio,this.wireframe=ue.wireframe,this.wireframeLinewidth=ue.wireframeLinewidth,this.wireframeLinecap=ue.wireframeLinecap,this.wireframeLinejoin=ue.wireframeLinejoin,this.skinning=ue.skinning,this.morphTargets=ue.morphTargets,this.morphNormals=ue.morphNormals,this},pe.MeshPhysicalMaterial=function(ue){pe.MeshStandardMaterial.call(this),this.defines={PHYSICAL:''},this.type='MeshPhysicalMaterial',this.reflectivity=0.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(ue)},pe.MeshPhysicalMaterial.prototype=Object.create(pe.MeshStandardMaterial.prototype),pe.MeshPhysicalMaterial.prototype.constructor=pe.MeshPhysicalMaterial,pe.MeshPhysicalMaterial.prototype.copy=function(ue){return pe.MeshStandardMaterial.prototype.copy.call(this,ue),this.defines={PHYSICAL:''},this.reflectivity=ue.reflectivity,this.clearCoat=ue.clearCoat,this.clearCoatRoughness=ue.clearCoatRoughness,this},pe.MultiMaterial=function(ue){this.uuid=pe.Math.generateUUID(),this.type='MultiMaterial',this.materials=ue instanceof Array?ue:[],this.visible=!0},pe.MultiMaterial.prototype={constructor:pe.MultiMaterial,toJSON:function(fe){for(var ge={metadata:{version:4.2,type:'material',generator:'MaterialExporter'},uuid:this.uuid,type:this.type,materials:[]},he=this.materials,ye=0,xe=he.length,_e;ye<xe;ye++)_e=he[ye].toJSON(fe),delete _e.metadata,ge.materials.push(_e);return ge.visible=this.visible,ge},clone:function(){for(var fe=new this.constructor,ge=0;ge<this.materials.length;ge++)fe.materials.push(this.materials[ge].clone());return fe.visible=this.visible,fe}},pe.PointsMaterial=function(ue){pe.Material.call(this),this.type='PointsMaterial',this.color=new pe.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(ue)},pe.PointsMaterial.prototype=Object.create(pe.Material.prototype),pe.PointsMaterial.prototype.constructor=pe.PointsMaterial,pe.PointsMaterial.prototype.copy=function(ue){return pe.Material.prototype.copy.call(this,ue),this.color.copy(ue.color),this.map=ue.map,this.size=ue.size,this.sizeAttenuation=ue.sizeAttenuation,this},pe.ShaderMaterial=function(ue){pe.Material.call(this),this.type='ShaderMaterial',this.defines={},this.uniforms={},this.vertexShader='void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}',this.fragmentShader='void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}',this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,ue!==void 0&&(ue.attributes!==void 0&&console.error('THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.'),this.setValues(ue))},pe.ShaderMaterial.prototype=Object.create(pe.Material.prototype),pe.ShaderMaterial.prototype.constructor=pe.ShaderMaterial,pe.ShaderMaterial.prototype.copy=function(ue){return pe.Material.prototype.copy.call(this,ue),this.fragmentShader=ue.fragmentShader,this.vertexShader=ue.vertexShader,this.uniforms=pe.UniformsUtils.clone(ue.uniforms),this.defines=ue.defines,this.wireframe=ue.wireframe,this.wireframeLinewidth=ue.wireframeLinewidth,this.lights=ue.lights,this.clipping=ue.clipping,this.skinning=ue.skinning,this.morphTargets=ue.morphTargets,this.morphNormals=ue.morphNormals,this.extensions=ue.extensions,this},pe.ShaderMaterial.prototype.toJSON=function(ue){var fe=pe.Material.prototype.toJSON.call(this,ue);return fe.uniforms=this.uniforms,fe.vertexShader=this.vertexShader,fe.fragmentShader=this.fragmentShader,fe},pe.RawShaderMaterial=function(ue){pe.ShaderMaterial.call(this,ue),this.type='RawShaderMaterial'},pe.RawShaderMaterial.prototype=Object.create(pe.ShaderMaterial.prototype),pe.RawShaderMaterial.prototype.constructor=pe.RawShaderMaterial,pe.SpriteMaterial=function(ue){pe.Material.call(this),this.type='SpriteMaterial',this.color=new pe.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(ue)},pe.SpriteMaterial.prototype=Object.create(pe.Material.prototype),pe.SpriteMaterial.prototype.constructor=pe.SpriteMaterial,pe.SpriteMaterial.prototype.copy=function(ue){return pe.Material.prototype.copy.call(this,ue),this.color.copy(ue.color),this.map=ue.map,this.rotation=ue.rotation,this},pe.ShadowMaterial=function(){pe.ShaderMaterial.call(this,{uniforms:pe.UniformsUtils.merge([pe.UniformsLib.lights,{opacity:{value:1}}]),vertexShader:pe.ShaderChunk.shadow_vert,fragmentShader:pe.ShaderChunk.shadow_frag}),this.lights=!0,this.transparent=!0,Object.defineProperties(this,{opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(fe){this.uniforms.opacity.value=fe}}})},pe.ShadowMaterial.prototype=Object.create(pe.ShaderMaterial.prototype),pe.ShadowMaterial.prototype.constructor=pe.ShadowMaterial,pe.Texture=function(ue,fe,ge,he,ye,xe,_e,ve,Ee,Te){Object.defineProperty(this,'id',{value:pe.TextureIdCount++}),this.uuid=pe.Math.generateUUID(),this.name='',this.sourceFile='',this.image=ue===void 0?pe.Texture.DEFAULT_IMAGE:ue,this.mipmaps=[],this.mapping=fe===void 0?pe.Texture.DEFAULT_MAPPING:fe,this.wrapS=ge===void 0?pe.ClampToEdgeWrapping:ge,this.wrapT=he===void 0?pe.ClampToEdgeWrapping:he,this.magFilter=ye===void 0?pe.LinearFilter:ye,this.minFilter=xe===void 0?pe.LinearMipMapLinearFilter:xe,this.anisotropy=Ee===void 0?1:Ee,this.format=_e===void 0?pe.RGBAFormat:_e,this.type=ve===void 0?pe.UnsignedByteType:ve,this.offset=new pe.Vector2(0,0),this.repeat=new pe.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=Te===void 0?pe.LinearEncoding:Te,this.version=0,this.onUpdate=null},pe.Texture.DEFAULT_IMAGE=void 0,pe.Texture.DEFAULT_MAPPING=pe.UVMapping,pe.Texture.prototype={constructor:pe.Texture,set needsUpdate(ue){!0===ue&&this.version++},clone:function(){return new this.constructor().copy(this)},copy:function(fe){return this.image=fe.image,this.mipmaps=fe.mipmaps.slice(0),this.mapping=fe.mapping,this.wrapS=fe.wrapS,this.wrapT=fe.wrapT,this.magFilter=fe.magFilter,this.minFilter=fe.minFilter,this.anisotropy=fe.anisotropy,this.format=fe.format,this.type=fe.type,this.offset.copy(fe.offset),this.repeat.copy(fe.repeat),this.generateMipmaps=fe.generateMipmaps,this.premultiplyAlpha=fe.premultiplyAlpha,this.flipY=fe.flipY,this.unpackAlignment=fe.unpackAlignment,this.encoding=fe.encoding,this},toJSON:function(fe){function ge(xe){var _e;return void 0===xe.toDataURL?(_e=document.createElementNS('http://www.w3.org/1999/xhtml','canvas'),_e.width=xe.width,_e.height=xe.height,_e.getContext('2d').drawImage(xe,0,0,xe.width,xe.height)):_e=xe,2048<_e.width||2048<_e.height?_e.toDataURL('image/jpeg',0.6):_e.toDataURL('image/png')}if(void 0!==fe.textures[this.uuid])return fe.textures[this.uuid];var he={metadata:{version:4.4,type:'Texture',generator:'Texture.toJSON'},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var ye=this.image;void 0===ye.uuid&&(ye.uuid=pe.Math.generateUUID()),void 0===fe.images[ye.uuid]&&(fe.images[ye.uuid]={uuid:ye.uuid,url:ge(ye)}),he.image=ye.uuid}return fe.textures[this.uuid]=he,he},dispose:function(){this.dispatchEvent({type:'dispose'})},transformUv:function(fe){if(this.mapping===pe.UVMapping){if(fe.multiply(this.repeat),fe.add(this.offset),0>fe.x||1<fe.x)switch(this.wrapS){case pe.RepeatWrapping:fe.x-=Math.floor(fe.x);break;case pe.ClampToEdgeWrapping:fe.x=0>fe.x?0:1;break;case pe.MirroredRepeatWrapping:1===Math.abs(Math.floor(fe.x)%2)?fe.x=Math.ceil(fe.x)-fe.x:fe.x-=Math.floor(fe.x);}if(0>fe.y||1<fe.y)switch(this.wrapT){case pe.RepeatWrapping:fe.y-=Math.floor(fe.y);break;case pe.ClampToEdgeWrapping:fe.y=0>fe.y?0:1;break;case pe.MirroredRepeatWrapping:1===Math.abs(Math.floor(fe.y)%2)?fe.y=Math.ceil(fe.y)-fe.y:fe.y-=Math.floor(fe.y);}this.flipY&&(fe.y=1-fe.y)}}},le(pe.Texture.prototype,pe.EventDispatcher.prototype),pe.TextureIdCount=0,pe.DepthTexture=function(ue,fe,ge,he,ye,xe,_e,ve,Ee){pe.Texture.call(this,null,he,ye,xe,_e,ve,pe.DepthFormat,ge,Ee),this.image={width:ue,height:fe},this.type=ge===void 0?pe.UnsignedShortType:ge,this.magFilter=_e===void 0?pe.NearestFilter:_e,this.minFilter=ve===void 0?pe.NearestFilter:ve,this.flipY=!1,this.generateMipmaps=!1},pe.DepthTexture.prototype=Object.create(pe.Texture.prototype),pe.DepthTexture.prototype.constructor=pe.DepthTexture,pe.CanvasTexture=function(ue,fe,ge,he,ye,xe,_e,ve,Ee){pe.Texture.call(this,ue,fe,ge,he,ye,xe,_e,ve,Ee),this.needsUpdate=!0},pe.CanvasTexture.prototype=Object.create(pe.Texture.prototype),pe.CanvasTexture.prototype.constructor=pe.CanvasTexture,pe.CubeTexture=function(ue,fe,ge,he,ye,xe,_e,ve,Ee,Te){ue=ue===void 0?[]:ue,fe=fe===void 0?pe.CubeReflectionMapping:fe,pe.Texture.call(this,ue,fe,ge,he,ye,xe,_e,ve,Ee,Te),this.flipY=!1},pe.CubeTexture.prototype=Object.create(pe.Texture.prototype),pe.CubeTexture.prototype.constructor=pe.CubeTexture,Object.defineProperty(pe.CubeTexture.prototype,'images',{get:function(){return this.image},set:function(fe){this.image=fe}}),pe.CompressedTexture=function(ue,fe,ge,he,ye,xe,_e,ve,Ee,Te,Se,Me){pe.Texture.call(this,null,xe,_e,ve,Ee,Te,he,ye,Se,Me),this.image={width:fe,height:ge},this.mipmaps=ue,this.flipY=!1,this.generateMipmaps=!1},pe.CompressedTexture.prototype=Object.create(pe.Texture.prototype),pe.CompressedTexture.prototype.constructor=pe.CompressedTexture,pe.DataTexture=function(ue,fe,ge,he,ye,xe,_e,ve,Ee,Te,Se,Me){pe.Texture.call(this,null,xe,_e,ve,Ee,Te,he,ye,Se,Me),this.image={data:ue,width:fe,height:ge},this.magFilter=Ee===void 0?pe.NearestFilter:Ee,this.minFilter=Te===void 0?pe.NearestFilter:Te,this.flipY=!1,this.generateMipmaps=!1},pe.DataTexture.prototype=Object.create(pe.Texture.prototype),pe.DataTexture.prototype.constructor=pe.DataTexture,pe.VideoTexture=function(ue,fe,ge,he,ye,xe,_e,ve,Ee){function Te(){requestAnimationFrame(Te),ue.readyState>=ue.HAVE_CURRENT_DATA&&(Se.needsUpdate=!0)}pe.Texture.call(this,ue,fe,ge,he,ye,xe,_e,ve,Ee),this.generateMipmaps=!1;var Se=this;Te()},pe.VideoTexture.prototype=Object.create(pe.Texture.prototype),pe.VideoTexture.prototype.constructor=pe.VideoTexture,pe.Group=function(){pe.Object3D.call(this),this.type='Group'},pe.Group.prototype=le(Object.create(pe.Object3D.prototype),{constructor:pe.Group}),pe.Points=function(ue,fe){pe.Object3D.call(this),this.type='Points',this.geometry=ue===void 0?new pe.BufferGeometry:ue,this.material=fe===void 0?new pe.PointsMaterial({color:16777215*Math.random()}):fe},pe.Points.prototype=le(Object.create(pe.Object3D.prototype),{constructor:pe.Points,raycast:function(){var ue=new pe.Matrix4,fe=new pe.Ray,ge=new pe.Sphere;return function(ye,xe){function _e(Ne,Ge){var Ve=fe.distanceSqToPoint(Ne);if(Ve<Ae){var ze=fe.closestPointToPoint(Ne);ze.applyMatrix4(Te);var Oe=ye.ray.origin.distanceTo(ze);if(Oe<ye.near||Oe>ye.far)return;xe.push({distance:Oe,distanceToRay:Math.sqrt(Ve),point:ze.clone(),index:Ge,face:null,object:ve})}}var ve=this,Ee=this.geometry,Te=this.matrixWorld,Se=ye.params.Points.threshold;if(null===Ee.boundingSphere&&Ee.computeBoundingSphere(),ge.copy(Ee.boundingSphere),ge.applyMatrix4(Te),!1!==ye.ray.intersectsSphere(ge)){ue.getInverse(Te),fe.copy(ye.ray).applyMatrix4(ue);var Me=Se/((this.scale.x+this.scale.y+this.scale.z)/3),Ae=Me*Me,Le=new pe.Vector3;if(Ee instanceof pe.BufferGeometry){var Re=Ee.index,Ce=Ee.attributes,we=Ce.position.array;if(null!==Re)for(var Pe=Re.array,Fe=0,De=Pe.length,Ie;Fe<De;Fe++)Ie=Pe[Fe],Le.fromArray(we,3*Ie),_e(Le,Ie);else for(var Fe=0,Be=we.length/3;Fe<Be;Fe++)Le.fromArray(we,3*Fe),_e(Le,Fe)}else for(var Ue=Ee.vertices,Fe=0,Be=Ue.length;Fe<Be;Fe++)_e(Ue[Fe],Fe)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),pe.Line=function(ue,fe,ge){return 1===ge?(console.warn('THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead.'),new pe.LineSegments(ue,fe)):void(pe.Object3D.call(this),this.type='Line',this.geometry=ue===void 0?new pe.BufferGeometry:ue,this.material=fe===void 0?new pe.LineBasicMaterial({color:16777215*Math.random()}):fe)},pe.Line.prototype=le(Object.create(pe.Object3D.prototype),{constructor:pe.Line,raycast:function(){var ue=new pe.Matrix4,fe=new pe.Ray,ge=new pe.Sphere;return function(ye,xe){var _e=ye.linePrecision,ve=_e*_e,Ee=this.geometry,Te=this.matrixWorld;if(null===Ee.boundingSphere&&Ee.computeBoundingSphere(),ge.copy(Ee.boundingSphere),ge.applyMatrix4(Te),!1!==ye.ray.intersectsSphere(ge)){ue.getInverse(Te),fe.copy(ye.ray).applyMatrix4(ue);var Se=new pe.Vector3,Me=new pe.Vector3,Ae=new pe.Vector3,Le=new pe.Vector3,Re=this instanceof pe.LineSegments?2:1;if(Ee instanceof pe.BufferGeometry){var Ce=Ee.index,we=Ee.attributes,Pe=we.position.array;if(null!==Ce)for(var Fe=Ce.array,De=0,Ie=Fe.length-1;De<Ie;De+=Re){var Be=Fe[De],Ue=Fe[De+1];Se.fromArray(Pe,3*Be),Me.fromArray(Pe,3*Ue);var Ne=fe.distanceSqToSegment(Se,Me,Le,Ae);if(!(Ne>ve)){Le.applyMatrix4(this.matrixWorld);var Ge=ye.ray.origin.distanceTo(Le);Ge<ye.near||Ge>ye.far||xe.push({distance:Ge,point:Ae.clone().applyMatrix4(this.matrixWorld),index:De,face:null,faceIndex:null,object:this})}}else for(var De=0,Ie=Pe.length/3-1;De<Ie;De+=Re){Se.fromArray(Pe,3*De),Me.fromArray(Pe,3*De+3);var Ne=fe.distanceSqToSegment(Se,Me,Le,Ae);if(!(Ne>ve)){Le.applyMatrix4(this.matrixWorld);var Ge=ye.ray.origin.distanceTo(Le);Ge<ye.near||Ge>ye.far||xe.push({distance:Ge,point:Ae.clone().applyMatrix4(this.matrixWorld),index:De,face:null,faceIndex:null,object:this})}}}else if(Ee instanceof pe.Geometry)for(var Ve=Ee.vertices,ze=Ve.length,De=0,Ne;De<ze-1;De+=Re)if(Ne=fe.distanceSqToSegment(Ve[De],Ve[De+1],Le,Ae),!(Ne>ve)){Le.applyMatrix4(this.matrixWorld);var Ge=ye.ray.origin.distanceTo(Le);Ge<ye.near||Ge>ye.far||xe.push({distance:Ge,point:Ae.clone().applyMatrix4(this.matrixWorld),index:De,face:null,faceIndex:null,object:this})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),pe.LineSegments=function(ue,fe){pe.Line.call(this,ue,fe),this.type='LineSegments'},pe.LineSegments.prototype=le(Object.create(pe.Line.prototype),{constructor:pe.LineSegments}),pe.Mesh=function(ue,fe){pe.Object3D.call(this),this.type='Mesh',this.geometry=ue===void 0?new pe.BufferGeometry:ue,this.material=fe===void 0?new pe.MeshBasicMaterial({color:16777215*Math.random()}):fe,this.drawMode=pe.TrianglesDrawMode,this.updateMorphTargets()},pe.Mesh.prototype=le(Object.create(pe.Object3D.prototype),{constructor:pe.Mesh,setDrawMode:function(fe){this.drawMode=fe},copy:function(fe){return pe.Object3D.prototype.copy.call(this,fe),this.drawMode=fe.drawMode,this},updateMorphTargets:function(){if(this.geometry.morphTargets!==void 0&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1,this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var fe=0,ge=this.geometry.morphTargets.length;fe<ge;fe++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[fe].name]=fe}},getMorphTargetIndexByName:function(fe){return void 0===this.morphTargetDictionary[fe]?(console.warn('THREE.Mesh.getMorphTargetIndexByName: morph target '+fe+' does not exist. Returning 0.'),0):this.morphTargetDictionary[fe]},raycast:function(){function ue(Fe,De,Ie,Be,Ue,Ne,Ge){return pe.Triangle.barycoordFromPoint(Fe,De,Ie,Be,Ce),Ue.multiplyScalar(Ce.x),Ne.multiplyScalar(Ce.y),Ge.multiplyScalar(Ce.z),Ue.add(Ne).add(Ge),Ue.clone()}function fe(Fe,De,Ie,Be,Ue,Ne,Ge){var ze=Fe.material,Ve;if(Ve=ze.side===pe.BackSide?Ie.intersectTriangle(Ne,Ue,Be,!0,Ge):Ie.intersectTriangle(Be,Ue,Ne,ze.side!==pe.DoubleSide,Ge),null===Ve)return null;Pe.copy(Ge),Pe.applyMatrix4(Fe.matrixWorld);var Oe=De.ray.origin.distanceTo(Pe);return Oe<De.near||Oe>De.far?null:{distance:Oe,point:Pe.clone(),object:Fe}}function ge(Fe,De,Ie,Be,Ue,Ne,Ge,Ve){_e.fromArray(Be,3*Ne),ve.fromArray(Be,3*Ge),Ee.fromArray(Be,3*Ve);var ze=fe(Fe,De,Ie,_e,ve,Ee,we);return ze&&(Ue&&(Ae.fromArray(Ue,2*Ne),Le.fromArray(Ue,2*Ge),Re.fromArray(Ue,2*Ve),ze.uv=ue(we,_e,ve,Ee,Ae,Le,Re)),ze.face=new pe.Face3(Ne,Ge,Ve,pe.Triangle.normal(_e,ve,Ee)),ze.faceIndex=Ne),ze}var he=new pe.Matrix4,ye=new pe.Ray,xe=new pe.Sphere,_e=new pe.Vector3,ve=new pe.Vector3,Ee=new pe.Vector3,Te=new pe.Vector3,Se=new pe.Vector3,Me=new pe.Vector3,Ae=new pe.Vector2,Le=new pe.Vector2,Re=new pe.Vector2,Ce=new pe.Vector3,we=new pe.Vector3,Pe=new pe.Vector3;return function(De,Ie){var Be=this.geometry,Ue=this.material,Ne=this.matrixWorld;if(void 0!==Ue&&(null===Be.boundingSphere&&Be.computeBoundingSphere(),xe.copy(Be.boundingSphere),xe.applyMatrix4(Ne),!1!==De.ray.intersectsSphere(xe))&&(he.getInverse(Ne),ye.copy(De.ray).applyMatrix4(he),null===Be.boundingBox||!1!==ye.intersectsBox(Be.boundingBox))){var Ge,Ve;if(Be instanceof pe.BufferGeometry){var He=Be.index,We=Be.attributes,je=We.position.array,ze,Oe,ke;if(void 0!==We.uv&&(Ge=We.uv.array),null!==He)for(var Xe=He.array,qe=0,Ye=Xe.length;qe<Ye;qe+=3)ze=Xe[qe],Oe=Xe[qe+1],ke=Xe[qe+2],Ve=ge(this,De,ye,je,Ge,ze,Oe,ke),Ve&&(Ve.faceIndex=Math.floor(qe/3),Ie.push(Ve));else for(var qe=0,Ye=je.length;qe<Ye;qe+=9)ze=qe/3,Oe=ze+1,ke=ze+2,Ve=ge(this,De,ye,je,Ge,ze,Oe,ke),Ve&&(Ve.index=ze,Ie.push(Ve))}else if(Be instanceof pe.Geometry){var Je=Ue instanceof pe.MultiMaterial,$e=!0==Je?Ue.materials:null,et=Be.vertices,tt=Be.faces,rt=Be.faceVertexUvs[0],Ze,Ke,Qe;0<rt.length&&(Ge=rt);for(var ot=0,it=tt.length;ot<it;ot++){var nt=tt[ot],st=!0==Je?$e[nt.materialIndex]:Ue;if(void 0!==st){if(Ze=et[nt.a],Ke=et[nt.b],Qe=et[nt.c],!0===st.morphTargets){var lt=Be.morphTargets,dt=this.morphTargetInfluences;_e.set(0,0,0),ve.set(0,0,0),Ee.set(0,0,0);for(var ct=0,ut=lt.length,mt;ct<ut;ct++)if(mt=dt[ct],0!==mt){var gt=lt[ct].vertices;_e.addScaledVector(Te.subVectors(gt[nt.a],Ze),mt),ve.addScaledVector(Se.subVectors(gt[nt.b],Ke),mt),Ee.addScaledVector(Me.subVectors(gt[nt.c],Qe),mt)}_e.add(Ze),ve.add(Ke),Ee.add(Qe),Ze=_e,Ke=ve,Qe=Ee}if(Ve=fe(this,De,ye,Ze,Ke,Qe,we),Ve){if(Ge){var ht=Ge[ot];Ae.copy(ht[0]),Le.copy(ht[1]),Re.copy(ht[2]),Ve.uv=ue(we,Ze,Ke,Qe,Ae,Le,Re)}Ve.face=nt,Ve.faceIndex=ot,Ie.push(Ve)}}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),pe.Bone=function(ue){pe.Object3D.call(this),this.type='Bone',this.skin=ue},pe.Bone.prototype=le(Object.create(pe.Object3D.prototype),{constructor:pe.Bone,copy:function(fe){return pe.Object3D.prototype.copy.call(this,fe),this.skin=fe.skin,this}}),pe.Skeleton=function(ue,fe,ge){if(this.useVertexTexture=void 0===ge||ge,this.identityMatrix=new pe.Matrix4,ue=ue||[],this.bones=ue.slice(0),this.useVertexTexture){var he=Math.sqrt(4*this.bones.length);he=pe.Math.nextPowerOfTwo(Math.ceil(he)),he=Math.max(he,4),this.boneTextureWidth=he,this.boneTextureHeight=he,this.boneMatrices=new Float32Array(4*(this.boneTextureWidth*this.boneTextureHeight)),this.boneTexture=new pe.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,pe.RGBAFormat,pe.FloatType)}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===fe)this.calculateInverses();else if(this.bones.length===fe.length)this.boneInverses=fe.slice(0);else{console.warn('THREE.Skeleton bonInverses is the wrong length.'),this.boneInverses=[];for(var ye=0,xe=this.bones.length;ye<xe;ye++)this.boneInverses.push(new pe.Matrix4)}},le(pe.Skeleton.prototype,{calculateInverses:function(){this.boneInverses=[];for(var fe=0,ge=this.bones.length,he;fe<ge;fe++)he=new pe.Matrix4,this.bones[fe]&&he.getInverse(this.bones[fe].matrixWorld),this.boneInverses.push(he)},pose:function(){for(var ge=0,he=this.bones.length,fe;ge<he;ge++)fe=this.bones[ge],fe&&fe.matrixWorld.getInverse(this.boneInverses[ge]);for(var ge=0,he=this.bones.length;ge<he;ge++)fe=this.bones[ge],fe&&(fe.parent instanceof pe.Bone?(fe.matrix.getInverse(fe.parent.matrixWorld),fe.matrix.multiply(fe.matrixWorld)):fe.matrix.copy(fe.matrixWorld),fe.matrix.decompose(fe.position,fe.quaternion,fe.scale))},update:function(){var ue=new pe.Matrix4;return function(){for(var ge=0,he=this.bones.length,ye;ge<he;ge++)ye=this.bones[ge]?this.bones[ge].matrixWorld:this.identityMatrix,ue.multiplyMatrices(ye,this.boneInverses[ge]),ue.toArray(this.boneMatrices,16*ge);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),clone:function(){return new pe.Skeleton(this.bones,this.boneInverses,this.useVertexTexture)}}),pe.SkinnedMesh=function(ue,fe,ge){pe.Mesh.call(this,ue,fe),this.type='SkinnedMesh',this.bindMode='attached',this.bindMatrix=new pe.Matrix4,this.bindMatrixInverse=new pe.Matrix4;var he=[];if(this.geometry&&this.geometry.bones!==void 0){for(var _e=0,ve=this.geometry.bones.length,ye,xe;_e<ve;++_e)xe=this.geometry.bones[_e],ye=new pe.Bone(this),he.push(ye),ye.name=xe.name,ye.position.fromArray(xe.pos),ye.quaternion.fromArray(xe.rotq),void 0!==xe.scl&&ye.scale.fromArray(xe.scl);for(var _e=0,ve=this.geometry.bones.length;_e<ve;++_e)xe=this.geometry.bones[_e],-1!==xe.parent&&null!==xe.parent&&void 0!==he[xe.parent]?he[xe.parent].add(he[_e]):this.add(he[_e])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new pe.Skeleton(he,void 0,ge),this.matrixWorld)},pe.SkinnedMesh.prototype=le(Object.create(pe.Mesh.prototype),{constructor:pe.SkinnedMesh,bind:function(fe,ge){this.skeleton=fe,ge===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),ge=this.matrixWorld),this.bindMatrix.copy(ge),this.bindMatrixInverse.getInverse(ge)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){if(this.geometry instanceof pe.Geometry)for(var fe=0;fe<this.geometry.skinWeights.length;fe++){var ge=this.geometry.skinWeights[fe],he=1/ge.lengthManhattan();he==Infinity?ge.set(1,0,0,0):ge.multiplyScalar(he)}else if(this.geometry instanceof pe.BufferGeometry)for(var ye=new pe.Vector4,xe=this.geometry.attributes.skinWeight,fe=0;fe<xe.count;fe++){ye.x=xe.getX(fe),ye.y=xe.getY(fe),ye.z=xe.getZ(fe),ye.w=xe.getW(fe);var he=1/ye.lengthManhattan();he==Infinity?ye.set(1,0,0,0):ye.multiplyScalar(he),xe.setXYZW(fe,ye.x,ye.y,ye.z,ye.w)}},updateMatrixWorld:function(){pe.Mesh.prototype.updateMatrixWorld.call(this,!0),'attached'===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):'detached'===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn('THREE.SkinnedMesh unrecognized bindMode: '+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material,this.skeleton.useVertexTexture).copy(this)}}),pe.LOD=function(){pe.Object3D.call(this),this.type='LOD',Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})},pe.LOD.prototype=le(Object.create(pe.Object3D.prototype),{constructor:pe.LOD,copy:function(fe){pe.Object3D.prototype.copy.call(this,fe,!1);for(var ge=fe.levels,he=0,ye=ge.length,xe;he<ye;he++)xe=ge[he],this.addLevel(xe.object.clone(),xe.distance);return this},addLevel:function(fe,ge){ge===void 0&&(ge=0),ge=Math.abs(ge);for(var he=this.levels,ye=0;ye<he.length&&!(ge<he[ye].distance);ye++);he.splice(ye,0,{distance:ge,object:fe}),this.add(fe)},getObjectForDistance:function(fe){for(var ge=this.levels,he=1,ye=ge.length;he<ye&&!(fe<ge[he].distance);he++);return ge[he-1].object},raycast:function(){var ue=new pe.Vector3;return function(ge,he){ue.setFromMatrixPosition(this.matrixWorld);var ye=ge.ray.origin.distanceTo(ue);this.getObjectForDistance(ye).raycast(ge,he)}}(),update:function(){var ue=new pe.Vector3,fe=new pe.Vector3;return function(he){var ye=this.levels;if(1<ye.length){ue.setFromMatrixPosition(he.matrixWorld),fe.setFromMatrixPosition(this.matrixWorld);var xe=ue.distanceTo(fe);ye[0].object.visible=!0;for(var _e=1,ve=ye.length;_e<ve&&xe>=ye[_e].distance;_e++)ye[_e-1].object.visible=!1,ye[_e].object.visible=!0;for(;_e<ve;_e++)ye[_e].object.visible=!1}}}(),toJSON:function(fe){var ge=pe.Object3D.prototype.toJSON.call(this,fe);ge.object.levels=[];for(var he=this.levels,ye=0,xe=he.length,_e;ye<xe;ye++)_e=he[ye],ge.object.levels.push({object:_e.object.uuid,distance:_e.distance});return ge}}),pe.Sprite=function(ue){pe.Object3D.call(this),this.type='Sprite',this.material=ue===void 0?new pe.SpriteMaterial:ue},pe.Sprite.prototype=le(Object.create(pe.Object3D.prototype),{constructor:pe.Sprite,raycast:function(){var ue=new pe.Vector3;return function(ge,he){ue.setFromMatrixPosition(this.matrixWorld);var ye=ge.ray.distanceSqToPoint(ue),xe=this.scale.x*this.scale.y/4;ye>xe||he.push({distance:Math.sqrt(ye),point:this.position,face:null,object:this})}}(),clone:function(){return new this.constructor(this.material).copy(this)}}),pe.LensFlare=function(ue,fe,ge,he,ye){pe.Object3D.call(this),this.lensFlares=[],this.positionScreen=new pe.Vector3,this.customUpdateCallback=void 0,ue!==void 0&&this.add(ue,fe,ge,he,ye)},pe.LensFlare.prototype=le(Object.create(pe.Object3D.prototype),{constructor:pe.LensFlare,copy:function(fe){pe.Object3D.prototype.copy.call(this,fe),this.positionScreen.copy(fe.positionScreen),this.customUpdateCallback=fe.customUpdateCallback;for(var ge=0,he=fe.lensFlares.length;ge<he;ge++)this.lensFlares.push(fe.lensFlares[ge]);return this},add:function(fe,ge,he,ye,xe,_e){ge===void 0&&(ge=-1),he===void 0&&(he=0),_e===void 0&&(_e=1),xe===void 0&&(xe=new pe.Color(16777215)),ye===void 0&&(ye=pe.NormalBlending),he=Math.min(he,Math.max(0,he)),this.lensFlares.push({texture:fe,size:ge,distance:he,x:0,y:0,z:0,scale:1,rotation:0,opacity:_e,color:xe,blending:ye})},updateLensFlares:function(){var ge=this.lensFlares.length,fe,he,ye=2*-this.positionScreen.x,xe=2*-this.positionScreen.y;for(fe=0;fe<ge;fe++)he=this.lensFlares[fe],he.x=this.positionScreen.x+ye*he.distance,he.y=this.positionScreen.y+xe*he.distance,he.wantedRotation=0.25*(he.x*Math.PI),he.rotation+=0.25*(he.wantedRotation-he.rotation)}}),pe.Scene=function(){pe.Object3D.call(this),this.type='Scene',this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0},pe.Scene.prototype=Object.create(pe.Object3D.prototype),pe.Scene.prototype.constructor=pe.Scene,pe.Scene.prototype.copy=function(ue,fe){return pe.Object3D.prototype.copy.call(this,ue,fe),null!==ue.background&&(this.background=ue.background.clone()),null!==ue.fog&&(this.fog=ue.fog.clone()),null!==ue.overrideMaterial&&(this.overrideMaterial=ue.overrideMaterial.clone()),this.autoUpdate=ue.autoUpdate,this.matrixAutoUpdate=ue.matrixAutoUpdate,this},pe.Fog=function(ue,fe,ge){this.name='',this.color=new pe.Color(ue),this.near=fe===void 0?1:fe,this.far=ge===void 0?1e3:ge},pe.Fog.prototype.clone=function(){return new pe.Fog(this.color.getHex(),this.near,this.far)},pe.FogExp2=function(ue,fe){this.name='',this.color=new pe.Color(ue),this.density=fe===void 0?2.5e-4:fe},pe.FogExp2.prototype.clone=function(){return new pe.FogExp2(this.color.getHex(),this.density)},pe.ShaderChunk={},pe.ShaderChunk.alphamap_fragment='#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n',pe.ShaderChunk.alphamap_pars_fragment='#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n',pe.ShaderChunk.alphatest_fragment='#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n',pe.ShaderChunk.aomap_fragment='#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n',pe.ShaderChunk.aomap_pars_fragment='#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif',pe.ShaderChunk.begin_vertex='\nvec3 transformed = vec3( position );\n',pe.ShaderChunk.beginnormal_vertex='\nvec3 objectNormal = vec3( normal );\n',pe.ShaderChunk.bsdfs='bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\n\treturn any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t\t}\n\t\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n',pe.ShaderChunk.bumpmap_pars_fragment='#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n',pe.ShaderChunk.clipping_planes_fragment='#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n#endif\n',pe.ShaderChunk.clipping_planes_pars_fragment='#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n',pe.ShaderChunk.clipping_planes_pars_vertex='#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n',pe.ShaderChunk.clipping_planes_vertex='#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n',pe.ShaderChunk.color_fragment='#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif',pe.ShaderChunk.color_pars_fragment='#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n',pe.ShaderChunk.color_pars_vertex='#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif',pe.ShaderChunk.color_vertex='#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif',pe.ShaderChunk.common='#define PI 3.14159265359\n#define PI2 6.28318530718\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\n',pe.ShaderChunk.cube_uv_reflection_fragment='#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n',pe.ShaderChunk.defaultnormal_vertex='#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n',pe.ShaderChunk.displacementmap_vertex='#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n',pe.ShaderChunk.displacementmap_pars_vertex='#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n',pe.ShaderChunk.emissivemap_fragment='#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n',pe.ShaderChunk.emissivemap_pars_fragment='#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n',pe.ShaderChunk.encodings_pars_fragment='\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n',pe.ShaderChunk.encodings_fragment='  gl_FragColor = linearToOutputTexel( gl_FragColor );\n',pe.ShaderChunk.envmap_fragment='#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n',pe.ShaderChunk.envmap_pars_fragment='#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntenstiy;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n',pe.ShaderChunk.envmap_pars_vertex='#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n',pe.ShaderChunk.envmap_vertex='#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n',pe.ShaderChunk.fog_fragment='#ifdef USE_FOG\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n',pe.ShaderChunk.fog_pars_fragment='#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif',pe.ShaderChunk.lightmap_fragment='#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n',pe.ShaderChunk.lightmap_pars_fragment='#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif',pe.ShaderChunk.lights_lambert_vertex='vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n',pe.ShaderChunk.lights_pars='uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tif ( testLightInRange( lightDistance, pointLight.distance ) ) {\n\t\t\tdirectLight.color = pointLight.color;\n\t\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( all( bvec2( angleCos > spotLight.coneCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\t#include <normal_flip>\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\t#include <normal_flip>\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n',pe.ShaderChunk.lights_phong_fragment='BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n',pe.ShaderChunk.lights_phong_pars_fragment='varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n',pe.ShaderChunk.lights_physical_fragment='PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n',pe.ShaderChunk.lights_physical_pars_fragment='struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectSpecular += radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n',pe.ShaderChunk.lights_template='\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t \tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\t\t\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n',pe.ShaderChunk.logdepthbuf_fragment='#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif',pe.ShaderChunk.logdepthbuf_pars_fragment='#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n',pe.ShaderChunk.logdepthbuf_pars_vertex='#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif',pe.ShaderChunk.logdepthbuf_vertex='#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n',pe.ShaderChunk.map_fragment='#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n',pe.ShaderChunk.map_pars_fragment='#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n',pe.ShaderChunk.map_particle_fragment='#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n',pe.ShaderChunk.map_particle_pars_fragment='#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n',pe.ShaderChunk.metalnessmap_fragment='float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.r;\n#endif\n',pe.ShaderChunk.metalnessmap_pars_fragment='#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif',pe.ShaderChunk.morphnormal_vertex='#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n',pe.ShaderChunk.morphtarget_pars_vertex='#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif',pe.ShaderChunk.morphtarget_vertex='#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n',pe.ShaderChunk.normal_flip='#ifdef DOUBLE_SIDED\n\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n\tfloat flipNormal = 1.0;\n#endif\n',pe.ShaderChunk.normal_fragment='#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal ) * flipNormal;\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n',pe.ShaderChunk.normalmap_pars_fragment='#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n',pe.ShaderChunk.packing='vec3 packNormalToRGB( const in vec3 normal ) {\n  return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n  return 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n  return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n  return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n',pe.ShaderChunk.premultiplied_alpha_fragment='#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n',pe.ShaderChunk.project_vertex='#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n',pe.ShaderChunk.roughnessmap_fragment='float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.r;\n#endif\n',pe.ShaderChunk.roughnessmap_pars_fragment='#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif',pe.ShaderChunk.shadowmap_pars_fragment='#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n',pe.ShaderChunk.shadowmap_pars_vertex='#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n',pe.ShaderChunk.shadowmap_vertex='#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n',pe.ShaderChunk.shadowmask_pars_fragment='float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n',pe.ShaderChunk.skinbase_vertex='#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif',pe.ShaderChunk.skinning_pars_vertex='#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n',pe.ShaderChunk.skinning_vertex='#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n',pe.ShaderChunk.skinnormal_vertex='#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n',pe.ShaderChunk.specularmap_fragment='float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif',pe.ShaderChunk.specularmap_pars_fragment='#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif',pe.ShaderChunk.tonemapping_fragment='#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n',pe.ShaderChunk.tonemapping_pars_fragment='#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n',pe.ShaderChunk.uv2_pars_fragment='#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif',pe.ShaderChunk.uv2_pars_vertex='#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif',pe.ShaderChunk.uv2_vertex='#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif',pe.ShaderChunk.uv_pars_fragment='#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif',pe.ShaderChunk.uv_pars_vertex='#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n',pe.ShaderChunk.uv_vertex='#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif',pe.ShaderChunk.worldpos_vertex='#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n',pe.UniformsUtils={merge:function(fe){for(var ge={},he=0,ye;he<fe.length;he++)for(var xe in ye=this.clone(fe[he]),ye)ge[xe]=ye[xe];return ge},clone:function(fe){var ge={};for(var he in fe)for(var ye in ge[he]={},fe[he]){var xe=fe[he][ye];ge[he][ye]=xe instanceof pe.Color||xe instanceof pe.Vector2||xe instanceof pe.Vector3||xe instanceof pe.Vector4||xe instanceof pe.Matrix3||xe instanceof pe.Matrix4||xe instanceof pe.Texture?xe.clone():Array.isArray(xe)?xe.slice():xe}return ge}},pe.UniformsLib={common:{diffuse:{value:new pe.Color(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new pe.Vector4(0,0,1,1)},specularMap:{value:null},alphaMap:{value:null},envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:0.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new pe.Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},fog:{fogDensity:{value:2.5e-4},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new pe.Color(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}}},points:{diffuse:{value:new pe.Color(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new pe.Vector4(0,0,1,1)}}},pe.ShaderChunk.cube_frag='uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\t#include <logdepthbuf_fragment>\n}\n',pe.ShaderChunk.cube_vert='varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n',pe.ShaderChunk.depth_frag='#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n',pe.ShaderChunk.depth_vert='#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n',pe.ShaderChunk.distanceRGBA_frag='uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n',pe.ShaderChunk.distanceRGBA_vert='varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n',pe.ShaderChunk.equirect_frag='uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <logdepthbuf_fragment>\n}\n',pe.ShaderChunk.equirect_vert='varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n',pe.ShaderChunk.linedashed_frag='uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',pe.ShaderChunk.linedashed_vert='uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n',pe.ShaderChunk.meshbasic_frag='uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight;\n\treflectedLight.directDiffuse = vec3( 0.0 );\n\treflectedLight.directSpecular = vec3( 0.0 );\n\treflectedLight.indirectDiffuse = diffuseColor.rgb;\n\treflectedLight.indirectSpecular = vec3( 0.0 );\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',pe.ShaderChunk.meshbasic_vert='#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n}\n',pe.ShaderChunk.meshlambert_frag='uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',pe.ShaderChunk.meshlambert_vert='#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n}\n',pe.ShaderChunk.meshphong_frag='#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',pe.ShaderChunk.meshphong_vert='#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n}\n',pe.ShaderChunk.meshphysical_frag='#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nuniform float envMapIntensity;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',pe.ShaderChunk.meshphysical_vert='#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n',pe.ShaderChunk.normal_frag='uniform float opacity;\nvarying vec3 vNormal;\n#include <common>\n#include <packing>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( vNormal ), opacity );\n\t#include <logdepthbuf_fragment>\n}\n',pe.ShaderChunk.normal_vert='varying vec3 vNormal;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvNormal = normalize( normalMatrix * normal );\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n',pe.ShaderChunk.points_frag='uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',pe.ShaderChunk.points_vert='uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n',pe.ShaderChunk.shadow_frag='uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0  - getShadowMask() ) );\n}\n',pe.ShaderChunk.shadow_vert='#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n',pe.ShaderLib={basic:{uniforms:pe.UniformsUtils.merge([pe.UniformsLib.common,pe.UniformsLib.aomap,pe.UniformsLib.fog]),vertexShader:pe.ShaderChunk.meshbasic_vert,fragmentShader:pe.ShaderChunk.meshbasic_frag},lambert:{uniforms:pe.UniformsUtils.merge([pe.UniformsLib.common,pe.UniformsLib.aomap,pe.UniformsLib.lightmap,pe.UniformsLib.emissivemap,pe.UniformsLib.fog,pe.UniformsLib.lights,{emissive:{value:new pe.Color(0)}}]),vertexShader:pe.ShaderChunk.meshlambert_vert,fragmentShader:pe.ShaderChunk.meshlambert_frag},phong:{uniforms:pe.UniformsUtils.merge([pe.UniformsLib.common,pe.UniformsLib.aomap,pe.UniformsLib.lightmap,pe.UniformsLib.emissivemap,pe.UniformsLib.bumpmap,pe.UniformsLib.normalmap,pe.UniformsLib.displacementmap,pe.UniformsLib.fog,pe.UniformsLib.lights,{emissive:{value:new pe.Color(0)},specular:{value:new pe.Color(1118481)},shininess:{value:30}}]),vertexShader:pe.ShaderChunk.meshphong_vert,fragmentShader:pe.ShaderChunk.meshphong_frag},standard:{uniforms:pe.UniformsUtils.merge([pe.UniformsLib.common,pe.UniformsLib.aomap,pe.UniformsLib.lightmap,pe.UniformsLib.emissivemap,pe.UniformsLib.bumpmap,pe.UniformsLib.normalmap,pe.UniformsLib.displacementmap,pe.UniformsLib.roughnessmap,pe.UniformsLib.metalnessmap,pe.UniformsLib.fog,pe.UniformsLib.lights,{emissive:{value:new pe.Color(0)},roughness:{value:0.5},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:pe.ShaderChunk.meshphysical_vert,fragmentShader:pe.ShaderChunk.meshphysical_frag},points:{uniforms:pe.UniformsUtils.merge([pe.UniformsLib.points,pe.UniformsLib.fog]),vertexShader:pe.ShaderChunk.points_vert,fragmentShader:pe.ShaderChunk.points_frag},dashed:{uniforms:pe.UniformsUtils.merge([pe.UniformsLib.common,pe.UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:pe.ShaderChunk.linedashed_vert,fragmentShader:pe.ShaderChunk.linedashed_frag},depth:{uniforms:pe.UniformsUtils.merge([pe.UniformsLib.common,pe.UniformsLib.displacementmap]),vertexShader:pe.ShaderChunk.depth_vert,fragmentShader:pe.ShaderChunk.depth_frag},normal:{uniforms:{opacity:{value:1}},vertexShader:pe.ShaderChunk.normal_vert,fragmentShader:pe.ShaderChunk.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1}},vertexShader:pe.ShaderChunk.cube_vert,fragmentShader:pe.ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null},tFlip:{value:-1}},vertexShader:pe.ShaderChunk.equirect_vert,fragmentShader:pe.ShaderChunk.equirect_frag},distanceRGBA:{uniforms:{lightPos:{value:new pe.Vector3}},vertexShader:pe.ShaderChunk.distanceRGBA_vert,fragmentShader:pe.ShaderChunk.distanceRGBA_frag}},pe.ShaderLib.physical={uniforms:pe.UniformsUtils.merge([pe.ShaderLib.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:pe.ShaderChunk.meshphysical_vert,fragmentShader:pe.ShaderChunk.meshphysical_frag},pe.WebGLRenderer=function(ue,fe){function ge(){return null==_t?Dt:1}function he(fr,gr,hr,yr){!0===it&&(fr*=yr,gr*=yr,hr*=yr),Qt.clearColor(fr,gr,hr,yr)}function ye(){Qt.init(),Qt.scissor(Mt.copy(It).multiplyScalar(Dt)),Qt.viewport(Lt.copy(Ut).multiplyScalar(Dt)),he(Ct.r,Ct.g,Ct.b,wt)}function xe(){xt=null,St=null,Tt='',Et=-1,Qt.reset()}function _e(fr){fr.preventDefault(),xe(),ye(),Jt.clear()}function ve(fr){var gr=fr.target;gr.removeEventListener('dispose',ve),Ee(gr)}function Ee(fr){Te(fr),Jt.delete(fr)}function Te(fr){var gr=Jt.get(fr).program;fr.program=void 0,gr!==void 0&&tr.releaseProgram(gr)}function Se(fr,gr,hr,yr){var xr;if(hr instanceof pe.InstancedBufferGeometry&&(xr=Zt.get('ANGLE_instanced_arrays'),null===xr))return void console.error('THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.');yr===void 0&&(yr=0),Qt.initAttributes();var _r=hr.attributes,vr=gr.getAttributes(),br=fr.defaultAttributeValues;for(var Er in vr){var Tr=vr[Er];if(0<=Tr){var Sr=_r[Er];if(Sr!==void 0){var Mr=qt.FLOAT,Ar=Sr.array,Lr=Sr.normalized;Ar instanceof Float32Array?Mr=qt.FLOAT:Ar instanceof Float64Array?console.warn('Unsupported data buffer format: Float64Array'):Ar instanceof Uint16Array?Mr=qt.UNSIGNED_SHORT:Ar instanceof Int16Array?Mr=qt.SHORT:Ar instanceof Uint32Array?Mr=qt.UNSIGNED_INT:Ar instanceof Int32Array?Mr=qt.INT:Ar instanceof Int8Array?Mr=qt.BYTE:Ar instanceof Uint8Array&&(Mr=qt.UNSIGNED_BYTE);var Rr=Sr.itemSize,Cr=er.getAttributeBuffer(Sr);if(Sr instanceof pe.InterleavedBufferAttribute){var wr=Sr.data,Pr=wr.stride,Fr=Sr.offset;wr instanceof pe.InstancedInterleavedBuffer?(Qt.enableAttributeAndDivisor(Tr,wr.meshPerAttribute,xr),hr.maxInstancedCount===void 0&&(hr.maxInstancedCount=wr.meshPerAttribute*wr.count)):Qt.enableAttribute(Tr),qt.bindBuffer(qt.ARRAY_BUFFER,Cr),qt.vertexAttribPointer(Tr,Rr,Mr,Lr,Pr*wr.array.BYTES_PER_ELEMENT,(yr*Pr+Fr)*wr.array.BYTES_PER_ELEMENT)}else Sr instanceof pe.InstancedBufferAttribute?(Qt.enableAttributeAndDivisor(Tr,Sr.meshPerAttribute,xr),void 0===hr.maxInstancedCount&&(hr.maxInstancedCount=Sr.meshPerAttribute*Sr.count)):Qt.enableAttribute(Tr),qt.bindBuffer(qt.ARRAY_BUFFER,Cr),qt.vertexAttribPointer(Tr,Rr,Mr,Lr,0,yr*Rr*Sr.array.BYTES_PER_ELEMENT)}else if(br!==void 0){var Dr=br[Er];if(Dr!==void 0)switch(Dr.length){case 2:qt.vertexAttrib2fv(Tr,Dr);break;case 3:qt.vertexAttrib3fv(Tr,Dr);break;case 4:qt.vertexAttrib4fv(Tr,Dr);break;default:qt.vertexAttrib1fv(Tr,Dr);}}}}Qt.disableUnusedAttributes()}function Me(fr,gr){return Math.abs(gr[0])-Math.abs(fr[0])}function Ae(fr,gr){return fr.object.renderOrder===gr.object.renderOrder?fr.material.id===gr.material.id?fr.z===gr.z?fr.id-gr.id:fr.z-gr.z:fr.material.id-gr.material.id:fr.object.renderOrder-gr.object.renderOrder}function Le(fr,gr){return fr.object.renderOrder===gr.object.renderOrder?fr.z===gr.z?fr.id-gr.id:gr.z-fr.z:fr.object.renderOrder-gr.object.renderOrder}function Re(fr,gr,hr,yr,xr){var _r,vr;hr.transparent?(_r=ct,vr=++ut):(_r=lt,vr=++dt);var br=_r[vr];br===void 0?(br={id:fr.id,object:fr,geometry:gr,material:hr,z:Wt.z,group:xr},_r.push(br)):(br.id=fr.id,br.object=fr,br.geometry=gr,br.material=hr,br.z=Wt.z,br.group=xr)}function Ce(fr){var gr=fr.geometry;return null===gr.boundingSphere&&gr.computeBoundingSphere(),Ot.copy(gr.boundingSphere).applyMatrix4(fr.matrixWorld),Pe(Ot)}function we(fr){return Ot.center.set(0,0,0),Ot.radius=0.7071067811865476,Ot.applyMatrix4(fr.matrixWorld),Pe(Ot)}function Pe(fr){if(!Nt.intersectsSphere(fr))return!1;var gr=Gt.numPlanes;if(0===gr)return!0;var hr=yt.clippingPlanes,yr=fr.center,xr=-fr.radius,_r=0;do if(hr[_r].distanceToPoint(yr)<xr)return!1;while(++_r!==gr);return!0}function Fe(fr,gr){if(!1!==fr.visible){if(fr.layers.test(gr.layers))if(fr instanceof pe.Light)st.push(fr);else if(fr instanceof pe.Sprite)(!1===fr.frustumCulled||!0===we(fr))&&gt.push(fr);else if(fr instanceof pe.LensFlare)ht.push(fr);else if(fr instanceof pe.ImmediateRenderObject)!0===yt.sortObjects&&(Wt.setFromMatrixPosition(fr.matrixWorld),Wt.applyProjection(Ht)),Re(fr,null,fr.material,Wt.z,null);else if((fr instanceof pe.Mesh||fr instanceof pe.Line||fr instanceof pe.Points)&&(fr instanceof pe.SkinnedMesh&&fr.skeleton.update(),!1===fr.frustumCulled||!0===Ce(fr))){var hr=fr.material;if(!0===hr.visible){!0===yt.sortObjects&&(Wt.setFromMatrixPosition(fr.matrixWorld),Wt.applyProjection(Ht));var yr=er.update(fr);if(hr instanceof pe.MultiMaterial)for(var xr=yr.groups,_r=hr.materials,vr=0,br=xr.length;vr<br;vr++){var Er=xr[vr],Tr=_r[Er.materialIndex];!0===Tr.visible&&Re(fr,yr,Tr,Wt.z,Er)}else Re(fr,yr,hr,Wt.z,null)}}for(var Sr=fr.children,vr=0,br=Sr.length;vr<br;vr++)Fe(Sr[vr],gr)}}function De(fr,gr,hr,yr){for(var xr=0,_r=fr.length;xr<_r;xr++){var vr=fr[xr],br=vr.object,Er=vr.geometry,Tr=void 0===yr?vr.material:yr,Sr=vr.group;if(br.modelViewMatrix.multiplyMatrices(gr.matrixWorldInverse,br.matrixWorld),br.normalMatrix.getNormalMatrix(br.modelViewMatrix),br instanceof pe.ImmediateRenderObject){Be(Tr);var Mr=Ue(gr,hr,Tr,br);Tt='',br.render(function(Ar){yt.renderBufferImmediate(Ar,Mr,Tr)})}else yt.renderBufferDirect(gr,hr,Er,Tr,br,Sr)}}function Ie(fr,gr,hr){var yr=Jt.get(fr),xr=tr.getParameters(fr,jt,gr,Gt.numPlanes,hr),_r=tr.getProgramCode(fr,xr),vr=yr.program,br=!0;if(vr===void 0)fr.addEventListener('dispose',ve);else if(vr.code!==_r)Te(fr);else{if(xr.shaderID!==void 0)return;br=!1}if(br){if(xr.shaderID){var Er=pe.ShaderLib[xr.shaderID];yr.__webglShader={name:fr.type,uniforms:pe.UniformsUtils.clone(Er.uniforms),vertexShader:Er.vertexShader,fragmentShader:Er.fragmentShader}}else yr.__webglShader={name:fr.type,uniforms:fr.uniforms,vertexShader:fr.vertexShader,fragmentShader:fr.fragmentShader};fr.__webglShader=yr.__webglShader,vr=tr.acquireProgram(fr,xr,_r),yr.program=vr,fr.program=vr}var Tr=vr.getAttributes();if(fr.morphTargets){fr.numSupportedMorphTargets=0;for(var Sr=0;Sr<yt.maxMorphTargets;Sr++)0<=Tr['morphTarget'+Sr]&&fr.numSupportedMorphTargets++}if(fr.morphNormals){fr.numSupportedMorphNormals=0;for(var Sr=0;Sr<yt.maxMorphNormals;Sr++)0<=Tr['morphNormal'+Sr]&&fr.numSupportedMorphNormals++}var Mr=yr.__webglShader.uniforms;(fr instanceof pe.ShaderMaterial||fr instanceof pe.RawShaderMaterial)&&!0!==fr.clipping||(yr.numClippingPlanes=Gt.numPlanes,Mr.clippingPlanes=Gt.uniform),fr.lights&&(yr.lightsHash=jt.hash,Mr.ambientLightColor.value=jt.ambient,Mr.directionalLights.value=jt.directional,Mr.spotLights.value=jt.spot,Mr.pointLights.value=jt.point,Mr.hemisphereLights.value=jt.hemi,Mr.directionalShadowMap.value=jt.directionalShadowMap,Mr.directionalShadowMatrix.value=jt.directionalShadowMatrix,Mr.spotShadowMap.value=jt.spotShadowMap,Mr.spotShadowMatrix.value=jt.spotShadowMatrix,Mr.pointShadowMap.value=jt.pointShadowMap,Mr.pointShadowMatrix.value=jt.pointShadowMatrix);var Ar=yr.program.getUniforms(),Lr=pe.WebGLUniforms.seqWithValue(Ar.seq,Mr);yr.uniformsList=Lr,yr.dynamicUniforms=pe.WebGLUniforms.splitDynamic(Lr,Mr)}function Be(fr){fr.side===pe.DoubleSide?Qt.disable(qt.CULL_FACE):Qt.enable(qt.CULL_FACE),Qt.setFlipSided(fr.side===pe.BackSide),!0===fr.transparent?Qt.setBlending(fr.blending,fr.blendEquation,fr.blendSrc,fr.blendDst,fr.blendEquationAlpha,fr.blendSrcAlpha,fr.blendDstAlpha,fr.premultipliedAlpha):Qt.setBlending(pe.NoBlending),Qt.setDepthFunc(fr.depthFunc),Qt.setDepthTest(fr.depthTest),Qt.setDepthWrite(fr.depthWrite),Qt.setColorWrite(fr.colorWrite),Qt.setPolygonOffset(fr.polygonOffset,fr.polygonOffsetFactor,fr.polygonOffsetUnits)}function Ue(fr,gr,hr,yr){Rt=0;var xr=Jt.get(hr);if(Vt){if(zt||fr!==St){var _r=fr===St&&hr.id===Et;Gt.setState(hr.clippingPlanes,hr.clipShadows,fr,xr,_r)}void 0!==xr.numClippingPlanes&&xr.numClippingPlanes!==Gt.numPlanes&&(hr.needsUpdate=!0)}void 0===xr.program&&(hr.needsUpdate=!0),void 0!==xr.lightsHash&&xr.lightsHash!==jt.hash&&(hr.needsUpdate=!0),hr.needsUpdate&&(Ie(hr,gr,yr),hr.needsUpdate=!1);var vr=!1,br=!1,Er=!1,Tr=xr.program,Sr=Tr.getUniforms(),Mr=xr.__webglShader.uniforms;if(Tr.id!==xt&&(qt.useProgram(Tr.program),xt=Tr.id,vr=!0,br=!0,Er=!0),hr.id!==Et&&(Et=hr.id,br=!0),vr||fr!==St){if(Sr.set(qt,fr,'projectionMatrix'),Kt.logarithmicDepthBuffer&&Sr.setValue(qt,'logDepthBufFC',2/(Math.log(fr.far+1)/Math.LN2)),fr!==St&&(St=fr,br=!0,Er=!0),hr instanceof pe.ShaderMaterial||hr instanceof pe.MeshPhongMaterial||hr instanceof pe.MeshStandardMaterial||hr.envMap){var Ar=Sr.map.cameraPosition;void 0!==Ar&&Ar.setValue(qt,Wt.setFromMatrixPosition(fr.matrixWorld))}(hr instanceof pe.MeshPhongMaterial||hr instanceof pe.MeshLambertMaterial||hr instanceof pe.MeshBasicMaterial||hr instanceof pe.MeshStandardMaterial||hr instanceof pe.ShaderMaterial||hr.skinning)&&Sr.setValue(qt,'viewMatrix',fr.matrixWorldInverse),Sr.set(qt,yt,'toneMappingExposure'),Sr.set(qt,yt,'toneMappingWhitePoint')}if(hr.skinning){Sr.setOptional(qt,yr,'bindMatrix'),Sr.setOptional(qt,yr,'bindMatrixInverse');var Lr=yr.skeleton;Lr&&(Kt.floatVertexTextures&&Lr.useVertexTexture?(Sr.set(qt,Lr,'boneTexture'),Sr.set(qt,Lr,'boneTextureWidth'),Sr.set(qt,Lr,'boneTextureHeight')):Sr.setOptional(qt,Lr,'boneMatrices'))}br&&(hr.lights&&Xe(Mr,Er),gr&&hr.fog&&Oe(Mr,gr),(hr instanceof pe.MeshBasicMaterial||hr instanceof pe.MeshLambertMaterial||hr instanceof pe.MeshPhongMaterial||hr instanceof pe.MeshStandardMaterial||hr instanceof pe.MeshDepthMaterial)&&Ne(Mr,hr),hr instanceof pe.LineBasicMaterial?Ge(Mr,hr):hr instanceof pe.LineDashedMaterial?(Ge(Mr,hr),Ve(Mr,hr)):hr instanceof pe.PointsMaterial?ze(Mr,hr):hr instanceof pe.MeshLambertMaterial?ke(Mr,hr):hr instanceof pe.MeshPhongMaterial?He(Mr,hr):hr instanceof pe.MeshPhysicalMaterial?je(Mr,hr):hr instanceof pe.MeshStandardMaterial?We(Mr,hr):hr instanceof pe.MeshDepthMaterial?hr.displacementMap&&(Mr.displacementMap.value=hr.displacementMap,Mr.displacementScale.value=hr.displacementScale,Mr.displacementBias.value=hr.displacementBias):hr instanceof pe.MeshNormalMaterial&&(Mr.opacity.value=hr.opacity),pe.WebGLUniforms.upload(qt,xr.uniformsList,Mr,yt)),Sr.set(qt,yr,'modelViewMatrix'),Sr.set(qt,yr,'normalMatrix'),Sr.setValue(qt,'modelMatrix',yr.matrixWorld);var Rr=xr.dynamicUniforms;return null!==Rr&&(pe.WebGLUniforms.evalDynamic(Rr,Mr,yr,fr),pe.WebGLUniforms.upload(qt,Rr,Mr,yt)),Tr}function Ne(fr,gr){fr.opacity.value=gr.opacity,fr.diffuse.value=gr.color,gr.emissive&&fr.emissive.value.copy(gr.emissive).multiplyScalar(gr.emissiveIntensity),fr.map.value=gr.map,fr.specularMap.value=gr.specularMap,fr.alphaMap.value=gr.alphaMap,gr.aoMap&&(fr.aoMap.value=gr.aoMap,fr.aoMapIntensity.value=gr.aoMapIntensity);var hr;if(gr.map?hr=gr.map:gr.specularMap?hr=gr.specularMap:gr.displacementMap?hr=gr.displacementMap:gr.normalMap?hr=gr.normalMap:gr.bumpMap?hr=gr.bumpMap:gr.roughnessMap?hr=gr.roughnessMap:gr.metalnessMap?hr=gr.metalnessMap:gr.alphaMap?hr=gr.alphaMap:gr.emissiveMap&&(hr=gr.emissiveMap),void 0!==hr){hr instanceof pe.WebGLRenderTarget&&(hr=hr.texture);var yr=hr.offset,xr=hr.repeat;fr.offsetRepeat.value.set(yr.x,yr.y,xr.x,xr.y)}fr.envMap.value=gr.envMap,fr.flipEnvMap.value=gr.envMap instanceof pe.CubeTexture?-1:1,fr.reflectivity.value=gr.reflectivity,fr.refractionRatio.value=gr.refractionRatio}function Ge(fr,gr){fr.diffuse.value=gr.color,fr.opacity.value=gr.opacity}function Ve(fr,gr){fr.dashSize.value=gr.dashSize,fr.totalSize.value=gr.dashSize+gr.gapSize,fr.scale.value=gr.scale}function ze(fr,gr){if(fr.diffuse.value=gr.color,fr.opacity.value=gr.opacity,fr.size.value=gr.size*Dt,fr.scale.value=0.5*Je.clientHeight,fr.map.value=gr.map,null!==gr.map){var hr=gr.map.offset,yr=gr.map.repeat;fr.offsetRepeat.value.set(hr.x,hr.y,yr.x,yr.y)}}function Oe(fr,gr){fr.fogColor.value=gr.color,gr instanceof pe.Fog?(fr.fogNear.value=gr.near,fr.fogFar.value=gr.far):gr instanceof pe.FogExp2&&(fr.fogDensity.value=gr.density)}function ke(fr,gr){gr.lightMap&&(fr.lightMap.value=gr.lightMap,fr.lightMapIntensity.value=gr.lightMapIntensity),gr.emissiveMap&&(fr.emissiveMap.value=gr.emissiveMap)}function He(fr,gr){fr.specular.value=gr.specular,fr.shininess.value=Math.max(gr.shininess,1e-4),gr.lightMap&&(fr.lightMap.value=gr.lightMap,fr.lightMapIntensity.value=gr.lightMapIntensity),gr.emissiveMap&&(fr.emissiveMap.value=gr.emissiveMap),gr.bumpMap&&(fr.bumpMap.value=gr.bumpMap,fr.bumpScale.value=gr.bumpScale),gr.normalMap&&(fr.normalMap.value=gr.normalMap,fr.normalScale.value.copy(gr.normalScale)),gr.displacementMap&&(fr.displacementMap.value=gr.displacementMap,fr.displacementScale.value=gr.displacementScale,fr.displacementBias.value=gr.displacementBias)}function We(fr,gr){fr.roughness.value=gr.roughness,fr.metalness.value=gr.metalness,gr.roughnessMap&&(fr.roughnessMap.value=gr.roughnessMap),gr.metalnessMap&&(fr.metalnessMap.value=gr.metalnessMap),gr.lightMap&&(fr.lightMap.value=gr.lightMap,fr.lightMapIntensity.value=gr.lightMapIntensity),gr.emissiveMap&&(fr.emissiveMap.value=gr.emissiveMap),gr.bumpMap&&(fr.bumpMap.value=gr.bumpMap,fr.bumpScale.value=gr.bumpScale),gr.normalMap&&(fr.normalMap.value=gr.normalMap,fr.normalScale.value.copy(gr.normalScale)),gr.displacementMap&&(fr.displacementMap.value=gr.displacementMap,fr.displacementScale.value=gr.displacementScale,fr.displacementBias.value=gr.displacementBias),gr.envMap&&(fr.envMapIntensity.value=gr.envMapIntensity)}function je(fr,gr){fr.clearCoat.value=gr.clearCoat,fr.clearCoatRoughness.value=gr.clearCoatRoughness,We(fr,gr)}function Xe(fr,gr){fr.ambientLightColor.needsUpdate=gr,fr.directionalLights.needsUpdate=gr,fr.pointLights.needsUpdate=gr,fr.spotLights.needsUpdate=gr,fr.hemisphereLights.needsUpdate=gr}function qe(fr){for(var gr=0,hr=0,yr=fr.length,xr;hr<yr;hr++)xr=fr[hr],xr.castShadow&&(jt.shadows[gr++]=xr);jt.shadows.length=gr}function Ye(fr,gr){var _r=0,vr=0,br=0,Ar=gr.matrixWorldInverse,Lr=0,Rr=0,Cr=0,wr=0,hr,yr,xr,Er,Tr,Sr,Mr;for(hr=0,yr=fr.length;hr<yr;hr++)if(xr=fr[hr],Er=xr.color,Tr=xr.intensity,Sr=xr.distance,Mr=xr.shadow&&xr.shadow.map?xr.shadow.map.texture:null,xr instanceof pe.AmbientLight)_r+=Er.r*Tr,vr+=Er.g*Tr,br+=Er.b*Tr;else if(xr instanceof pe.DirectionalLight){var Pr=rr.get(xr);Pr.color.copy(xr.color).multiplyScalar(xr.intensity),Pr.direction.setFromMatrixPosition(xr.matrixWorld),Wt.setFromMatrixPosition(xr.target.matrixWorld),Pr.direction.sub(Wt),Pr.direction.transformDirection(Ar),Pr.shadow=xr.castShadow,xr.castShadow&&(Pr.shadowBias=xr.shadow.bias,Pr.shadowRadius=xr.shadow.radius,Pr.shadowMapSize=xr.shadow.mapSize),jt.directionalShadowMap[Lr]=Mr,jt.directionalShadowMatrix[Lr]=xr.shadow.matrix,jt.directional[Lr++]=Pr}else if(xr instanceof pe.SpotLight){var Pr=rr.get(xr);Pr.position.setFromMatrixPosition(xr.matrixWorld),Pr.position.applyMatrix4(Ar),Pr.color.copy(Er).multiplyScalar(Tr),Pr.distance=Sr,Pr.direction.setFromMatrixPosition(xr.matrixWorld),Wt.setFromMatrixPosition(xr.target.matrixWorld),Pr.direction.sub(Wt),Pr.direction.transformDirection(Ar),Pr.coneCos=Math.cos(xr.angle),Pr.penumbraCos=Math.cos(xr.angle*(1-xr.penumbra)),Pr.decay=0===xr.distance?0:xr.decay,Pr.shadow=xr.castShadow,xr.castShadow&&(Pr.shadowBias=xr.shadow.bias,Pr.shadowRadius=xr.shadow.radius,Pr.shadowMapSize=xr.shadow.mapSize),jt.spotShadowMap[Cr]=Mr,jt.spotShadowMatrix[Cr]=xr.shadow.matrix,jt.spot[Cr++]=Pr}else if(xr instanceof pe.PointLight){var Pr=rr.get(xr);Pr.position.setFromMatrixPosition(xr.matrixWorld),Pr.position.applyMatrix4(Ar),Pr.color.copy(xr.color).multiplyScalar(xr.intensity),Pr.distance=xr.distance,Pr.decay=0===xr.distance?0:xr.decay,Pr.shadow=xr.castShadow,xr.castShadow&&(Pr.shadowBias=xr.shadow.bias,Pr.shadowRadius=xr.shadow.radius,Pr.shadowMapSize=xr.shadow.mapSize),jt.pointShadowMap[Rr]=Mr,void 0===jt.pointShadowMatrix[Rr]&&(jt.pointShadowMatrix[Rr]=new pe.Matrix4),Wt.setFromMatrixPosition(xr.matrixWorld).negate(),jt.pointShadowMatrix[Rr].identity().setPosition(Wt),jt.point[Rr++]=Pr}else if(xr instanceof pe.HemisphereLight){var Pr=rr.get(xr);Pr.direction.setFromMatrixPosition(xr.matrixWorld),Pr.direction.transformDirection(Ar),Pr.direction.normalize(),Pr.skyColor.copy(xr.color).multiplyScalar(Tr),Pr.groundColor.copy(xr.groundColor).multiplyScalar(Tr),jt.hemi[wr++]=Pr}jt.ambient[0]=_r,jt.ambient[1]=vr,jt.ambient[2]=br,jt.directional.length=Lr,jt.spot.length=Cr,jt.point.length=Rr,jt.hemi.length=wr,jt.hash=Lr+','+Rr+','+Cr+','+wr+','+jt.shadows.length}function Ke(fr){var gr;if(fr===pe.RepeatWrapping)return qt.REPEAT;if(fr===pe.ClampToEdgeWrapping)return qt.CLAMP_TO_EDGE;if(fr===pe.MirroredRepeatWrapping)return qt.MIRRORED_REPEAT;if(fr===pe.NearestFilter)return qt.NEAREST;if(fr===pe.NearestMipMapNearestFilter)return qt.NEAREST_MIPMAP_NEAREST;if(fr===pe.NearestMipMapLinearFilter)return qt.NEAREST_MIPMAP_LINEAR;if(fr===pe.LinearFilter)return qt.LINEAR;if(fr===pe.LinearMipMapNearestFilter)return qt.LINEAR_MIPMAP_NEAREST;if(fr===pe.LinearMipMapLinearFilter)return qt.LINEAR_MIPMAP_LINEAR;if(fr===pe.UnsignedByteType)return qt.UNSIGNED_BYTE;if(fr===pe.UnsignedShort4444Type)return qt.UNSIGNED_SHORT_4_4_4_4;if(fr===pe.UnsignedShort5551Type)return qt.UNSIGNED_SHORT_5_5_5_1;if(fr===pe.UnsignedShort565Type)return qt.UNSIGNED_SHORT_5_6_5;if(fr===pe.ByteType)return qt.BYTE;if(fr===pe.ShortType)return qt.SHORT;if(fr===pe.UnsignedShortType)return qt.UNSIGNED_SHORT;if(fr===pe.IntType)return qt.INT;if(fr===pe.UnsignedIntType)return qt.UNSIGNED_INT;if(fr===pe.FloatType)return qt.FLOAT;if(gr=Zt.get('OES_texture_half_float'),null!==gr&&fr===pe.HalfFloatType)return gr.HALF_FLOAT_OES;if(fr===pe.AlphaFormat)return qt.ALPHA;if(fr===pe.RGBFormat)return qt.RGB;if(fr===pe.RGBAFormat)return qt.RGBA;if(fr===pe.LuminanceFormat)return qt.LUMINANCE;if(fr===pe.LuminanceAlphaFormat)return qt.LUMINANCE_ALPHA;if(fr===pe.DepthFormat)return qt.DEPTH_COMPONENT;if(fr===pe.AddEquation)return qt.FUNC_ADD;if(fr===pe.SubtractEquation)return qt.FUNC_SUBTRACT;if(fr===pe.ReverseSubtractEquation)return qt.FUNC_REVERSE_SUBTRACT;if(fr===pe.ZeroFactor)return qt.ZERO;if(fr===pe.OneFactor)return qt.ONE;if(fr===pe.SrcColorFactor)return qt.SRC_COLOR;if(fr===pe.OneMinusSrcColorFactor)return qt.ONE_MINUS_SRC_COLOR;if(fr===pe.SrcAlphaFactor)return qt.SRC_ALPHA;if(fr===pe.OneMinusSrcAlphaFactor)return qt.ONE_MINUS_SRC_ALPHA;if(fr===pe.DstAlphaFactor)return qt.DST_ALPHA;if(fr===pe.OneMinusDstAlphaFactor)return qt.ONE_MINUS_DST_ALPHA;if(fr===pe.DstColorFactor)return qt.DST_COLOR;if(fr===pe.OneMinusDstColorFactor)return qt.ONE_MINUS_DST_COLOR;if(fr===pe.SrcAlphaSaturateFactor)return qt.SRC_ALPHA_SATURATE;if(gr=Zt.get('WEBGL_compressed_texture_s3tc'),null!==gr){if(fr===pe.RGB_S3TC_DXT1_Format)return gr.COMPRESSED_RGB_S3TC_DXT1_EXT;if(fr===pe.RGBA_S3TC_DXT1_Format)return gr.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(fr===pe.RGBA_S3TC_DXT3_Format)return gr.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(fr===pe.RGBA_S3TC_DXT5_Format)return gr.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(gr=Zt.get('WEBGL_compressed_texture_pvrtc'),null!==gr){if(fr===pe.RGB_PVRTC_4BPPV1_Format)return gr.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(fr===pe.RGB_PVRTC_2BPPV1_Format)return gr.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(fr===pe.RGBA_PVRTC_4BPPV1_Format)return gr.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(fr===pe.RGBA_PVRTC_2BPPV1_Format)return gr.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(gr=Zt.get('WEBGL_compressed_texture_etc1'),null!==gr&&fr===pe.RGB_ETC1_Format)return gr.COMPRESSED_RGB_ETC1_WEBGL;if(gr=Zt.get('EXT_blend_minmax'),null!==gr){if(fr===pe.MinEquation)return gr.MIN_EXT;if(fr===pe.MaxEquation)return gr.MAX_EXT}return 0}console.log('THREE.WebGLRenderer',pe.REVISION),ue=ue||{};var Je=ue.canvas===void 0?document.createElementNS('http://www.w3.org/1999/xhtml','canvas'):ue.canvas,$e=ue.context===void 0?null:ue.context,et=ue.alpha!==void 0&&ue.alpha,tt=!(ue.depth!==void 0)||ue.depth,rt=!(ue.stencil!==void 0)||ue.stencil,ot=ue.antialias!==void 0&&ue.antialias,it=!(ue.premultipliedAlpha!==void 0)||ue.premultipliedAlpha,nt=ue.preserveDrawingBuffer!==void 0&&ue.preserveDrawingBuffer,st=[],lt=[],dt=-1,ct=[],ut=-1,mt=new Float32Array(8),gt=[],ht=[];this.domElement=Je,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=pe.LinearToneMapping,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var yt=this,xt=null,_t=null,vt=null,Et=-1,Tt='',St=null,Mt=new pe.Vector4,At=null,Lt=new pe.Vector4,Rt=0,Ct=new pe.Color(0),wt=0,Pt=Je.width,Ft=Je.height,Dt=1,It=new pe.Vector4(0,0,Pt,Ft),Bt=!1,Ut=new pe.Vector4(0,0,Pt,Ft),Nt=new pe.Frustum,Gt=new pe.WebGLClipping,Vt=!1,zt=!1,Ot=new pe.Sphere,Ht=new pe.Matrix4,Wt=new pe.Vector3,jt={hash:'',ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},Xt={calls:0,vertices:0,faces:0,points:0};this.info={render:Xt,memory:{geometries:0,textures:0},programs:null};var qt;try{var Yt={alpha:et,depth:tt,stencil:rt,antialias:ot,premultipliedAlpha:it,preserveDrawingBuffer:nt};if(qt=$e||Je.getContext('webgl',Yt)||Je.getContext('experimental-webgl',Yt),null===qt)if(null!==Je.getContext('webgl'))throw'Error creating WebGL context with your selected attributes.';else throw'Error creating WebGL context.';void 0===qt.getShaderPrecisionFormat&&(qt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),Je.addEventListener('webglcontextlost',_e,!1)}catch(fr){console.error('THREE.WebGLRenderer: '+fr)}var Zt=new pe.WebGLExtensions(qt);(!('undefined'!=typeof fe)||fe)&&(Zt.get('WEBGL_depth_texture'),Zt.get('OES_texture_float'),Zt.get('OES_texture_float_linear'),Zt.get('OES_texture_half_float'),Zt.get('OES_texture_half_float_linear'),Zt.get('OES_standard_derivatives'),Zt.get('ANGLE_instanced_arrays'),Zt.get('OES_element_index_uint')&&(pe.BufferGeometry.MaxIndex=4294967296));var Kt=new pe.WebGLCapabilities(qt,Zt,ue),Qt=new pe.WebGLState(qt,Zt,Ke),Jt=new pe.WebGLProperties,$t=new pe.WebGLTextures(qt,Zt,Qt,Jt,Kt,Ke,this.info),er=new pe.WebGLObjects(qt,Jt,this.info),tr=new pe.WebGLPrograms(this,Kt),rr=new pe.WebGLLights;this.info.programs=tr.programs;var ar=new pe.WebGLBufferRenderer(qt,Zt,Xt),or=new pe.WebGLIndexedBufferRenderer(qt,Zt,Xt),ir=new pe.OrthographicCamera(-1,1,1,-1,0,1),nr=new pe.PerspectiveCamera,sr=new pe.Mesh(new pe.PlaneBufferGeometry(2,2),new pe.MeshBasicMaterial({depthTest:!1,depthWrite:!1})),dr=pe.ShaderLib.cube,pr=new pe.Mesh(new pe.BoxBufferGeometry(5,5,5),new pe.ShaderMaterial({uniforms:dr.uniforms,vertexShader:dr.vertexShader,fragmentShader:dr.fragmentShader,depthTest:!1,depthWrite:!1,side:pe.BackSide}));er.update(sr),er.update(pr),ye(),this.context=qt,this.capabilities=Kt,this.extensions=Zt,this.properties=Jt,this.state=Qt;var cr=new pe.WebGLShadowMap(this,jt,er);this.shadowMap=cr;var ur=new pe.SpritePlugin(this,gt),mr=new pe.LensFlarePlugin(this,ht);this.getContext=function(){return qt},this.getContextAttributes=function(){return qt.getContextAttributes()},this.forceContextLoss=function(){Zt.get('WEBGL_lose_context').loseContext()},this.getMaxAnisotropy=function(){return Kt.getMaxAnisotropy()},this.getPrecision=function(){return Kt.precision},this.getPixelRatio=function(){return Dt},this.setPixelRatio=function(fr){void 0===fr||(Dt=fr,this.setSize(Ut.z,Ut.w,!1))},this.getSize=function(){return{width:Pt,height:Ft}},this.setSize=function(fr,gr,hr){Pt=fr,Ft=gr,Je.width=fr*Dt,Je.height=gr*Dt,!1!==hr&&(Je.style.width=fr+'px',Je.style.height=gr+'px'),this.setViewport(0,0,fr,gr)},this.setViewport=function(fr,gr,hr,yr){Qt.viewport(Ut.set(fr,gr,hr,yr))},this.setScissor=function(fr,gr,hr,yr){Qt.scissor(It.set(fr,gr,hr,yr))},this.setScissorTest=function(fr){Qt.setScissorTest(Bt=fr)},this.getClearColor=function(){return Ct},this.setClearColor=function(fr,gr){Ct.set(fr),wt=gr===void 0?1:gr,he(Ct.r,Ct.g,Ct.b,wt)},this.getClearAlpha=function(){return wt},this.setClearAlpha=function(fr){wt=fr,he(Ct.r,Ct.g,Ct.b,wt)},this.clear=function(fr,gr,hr){var yr=0;(fr===void 0||fr)&&(yr|=qt.COLOR_BUFFER_BIT),(gr===void 0||gr)&&(yr|=qt.DEPTH_BUFFER_BIT),(hr===void 0||hr)&&(yr|=qt.STENCIL_BUFFER_BIT),qt.clear(yr)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(fr,gr,hr,yr){this.setRenderTarget(fr),this.clear(gr,hr,yr)},this.resetGLState=xe,this.dispose=function(){ct=[],ut=-1,lt=[],dt=-1,Je.removeEventListener('webglcontextlost',_e,!1)},this.renderBufferImmediate=function(fr,gr,hr){Qt.initAttributes();var yr=Jt.get(fr);fr.hasPositions&&!yr.position&&(yr.position=qt.createBuffer()),fr.hasNormals&&!yr.normal&&(yr.normal=qt.createBuffer()),fr.hasUvs&&!yr.uv&&(yr.uv=qt.createBuffer()),fr.hasColors&&!yr.color&&(yr.color=qt.createBuffer());var xr=gr.getAttributes();if(fr.hasPositions&&(qt.bindBuffer(qt.ARRAY_BUFFER,yr.position),qt.bufferData(qt.ARRAY_BUFFER,fr.positionArray,qt.DYNAMIC_DRAW),Qt.enableAttribute(xr.position),qt.vertexAttribPointer(xr.position,3,qt.FLOAT,!1,0,0)),fr.hasNormals){if(qt.bindBuffer(qt.ARRAY_BUFFER,yr.normal),'MeshPhongMaterial'!==hr.type&&'MeshStandardMaterial'!==hr.type&&'MeshPhysicalMaterial'!==hr.type&&hr.shading===pe.FlatShading)for(var _r=0,vr=3*fr.count;_r<vr;_r+=9){var br=fr.normalArray,Er=(br[_r+0]+br[_r+3]+br[_r+6])/3,Tr=(br[_r+1]+br[_r+4]+br[_r+7])/3,Sr=(br[_r+2]+br[_r+5]+br[_r+8])/3;br[_r+0]=Er,br[_r+1]=Tr,br[_r+2]=Sr,br[_r+3]=Er,br[_r+4]=Tr,br[_r+5]=Sr,br[_r+6]=Er,br[_r+7]=Tr,br[_r+8]=Sr}qt.bufferData(qt.ARRAY_BUFFER,fr.normalArray,qt.DYNAMIC_DRAW),Qt.enableAttribute(xr.normal),qt.vertexAttribPointer(xr.normal,3,qt.FLOAT,!1,0,0)}fr.hasUvs&&hr.map&&(qt.bindBuffer(qt.ARRAY_BUFFER,yr.uv),qt.bufferData(qt.ARRAY_BUFFER,fr.uvArray,qt.DYNAMIC_DRAW),Qt.enableAttribute(xr.uv),qt.vertexAttribPointer(xr.uv,2,qt.FLOAT,!1,0,0)),fr.hasColors&&hr.vertexColors!==pe.NoColors&&(qt.bindBuffer(qt.ARRAY_BUFFER,yr.color),qt.bufferData(qt.ARRAY_BUFFER,fr.colorArray,qt.DYNAMIC_DRAW),Qt.enableAttribute(xr.color),qt.vertexAttribPointer(xr.color,3,qt.FLOAT,!1,0,0)),Qt.disableUnusedAttributes(),qt.drawArrays(qt.TRIANGLES,0,fr.count),fr.count=0},this.renderBufferDirect=function(fr,gr,hr,yr,xr,_r){Be(yr);var vr=Ue(fr,gr,yr,xr),br=!1,Er=hr.id+'_'+vr.id+'_'+yr.wireframe;Er!=Tt&&(Tt=Er,br=!0);var Tr=xr.morphTargetInfluences;if(Tr!==void 0){for(var Sr=[],Mr=0,Ar=Tr.length,Lr;Mr<Ar;Mr++)Lr=Tr[Mr],Sr.push([Lr,Mr]);Sr.sort(Me),8<Sr.length&&(Sr.length=8);for(var Rr=hr.morphAttributes,Mr=0,Ar=Sr.length,Lr;Mr<Ar;Mr++)if(Lr=Sr[Mr],mt[Mr]=Lr[0],0!==Lr[0]){var Cr=Lr[1];!0===yr.morphTargets&&Rr.position&&hr.addAttribute('morphTarget'+Mr,Rr.position[Cr]),!0===yr.morphNormals&&Rr.normal&&hr.addAttribute('morphNormal'+Mr,Rr.normal[Cr])}else!0===yr.morphTargets&&hr.removeAttribute('morphTarget'+Mr),!0===yr.morphNormals&&hr.removeAttribute('morphNormal'+Mr);vr.getUniforms().setValue(qt,'morphTargetInfluences',mt),br=!0}var Cr=hr.index,wr=hr.attributes.position;!0===yr.wireframe&&(Cr=er.getWireframeAttribute(hr));var Pr;null===Cr?Pr=ar:(Pr=or,Pr.setIndex(Cr)),br&&(Se(yr,vr,hr),null!==Cr&&qt.bindBuffer(qt.ELEMENT_ARRAY_BUFFER,er.getAttributeBuffer(Cr)));var Fr=0,Dr=Infinity;null===Cr?wr!==void 0&&(Dr=wr.count):Dr=Cr.count;var Ir=hr.drawRange.start,Br=hr.drawRange.count,Ur=null===_r?0:_r.start,Nr=null===_r?Infinity:_r.count,Gr=Math.max(Fr,Ir,Ur),Vr=Math.min(Fr+Dr,Ir+Br,Ur+Nr)-1,zr=Math.max(0,Vr-Gr+1);if(xr instanceof pe.Mesh){if(!0===yr.wireframe)Qt.setLineWidth(yr.wireframeLinewidth*ge()),Pr.setMode(qt.LINES);else switch(xr.drawMode){case pe.TrianglesDrawMode:Pr.setMode(qt.TRIANGLES);break;case pe.TriangleStripDrawMode:Pr.setMode(qt.TRIANGLE_STRIP);break;case pe.TriangleFanDrawMode:Pr.setMode(qt.TRIANGLE_FAN);}}else if(xr instanceof pe.Line){var Or=yr.linewidth;Or===void 0&&(Or=1),Qt.setLineWidth(Or*ge()),xr instanceof pe.LineSegments?Pr.setMode(qt.LINES):Pr.setMode(qt.LINE_STRIP)}else xr instanceof pe.Points&&Pr.setMode(qt.POINTS);hr instanceof pe.InstancedBufferGeometry?0<hr.maxInstancedCount&&Pr.renderInstances(hr,Gr,zr):Pr.render(Gr,zr)},this.render=function(fr,gr,hr,yr){if(!1==gr instanceof pe.Camera)return void console.error('THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.');var xr=fr.fog;Tt='',Et=-1,St=null,!0===fr.autoUpdate&&fr.updateMatrixWorld(),null===gr.parent&&gr.updateMatrixWorld(),gr.matrixWorldInverse.getInverse(gr.matrixWorld),Ht.multiplyMatrices(gr.projectionMatrix,gr.matrixWorldInverse),Nt.setFromMatrix(Ht),st.length=0,dt=-1,ut=-1,gt.length=0,ht.length=0,zt=this.localClippingEnabled,Vt=Gt.init(this.clippingPlanes,zt,gr),Fe(fr,gr),lt.length=dt+1,ct.length=ut+1,!0===yt.sortObjects&&(lt.sort(Ae),ct.sort(Le)),Vt&&Gt.beginShadows(),qe(st),cr.render(fr,gr),Ye(st,gr),Vt&&Gt.endShadows(),Xt.calls=0,Xt.vertices=0,Xt.faces=0,Xt.points=0,void 0===hr&&(hr=null),this.setRenderTarget(hr);var _r=fr.background;if(null===_r?he(Ct.r,Ct.g,Ct.b,wt):_r instanceof pe.Color&&he(_r.r,_r.g,_r.b,1),(this.autoClear||yr)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),_r instanceof pe.CubeTexture?(nr.projectionMatrix.copy(gr.projectionMatrix),nr.matrixWorld.extractRotation(gr.matrixWorld),nr.matrixWorldInverse.getInverse(nr.matrixWorld),pr.material.uniforms.tCube.value=_r,pr.modelViewMatrix.multiplyMatrices(nr.matrixWorldInverse,pr.matrixWorld),yt.renderBufferDirect(nr,null,pr.geometry,pr.material,pr,null)):_r instanceof pe.Texture&&(sr.material.map=_r,yt.renderBufferDirect(ir,null,sr.geometry,sr.material,sr,null)),fr.overrideMaterial){var vr=fr.overrideMaterial;De(lt,gr,xr,vr),De(ct,gr,xr,vr)}else Qt.setBlending(pe.NoBlending),De(lt,gr,xr),De(ct,gr,xr);ur.render(fr,gr),mr.render(fr,gr,Lt),hr&&$t.updateRenderTargetMipmap(hr),Qt.setDepthTest(!0),Qt.setDepthWrite(!0),Qt.setColorWrite(!0)},this.setFaceCulling=function(fr,gr){Qt.setCullFace(fr),Qt.setFlipSided(gr===pe.FrontFaceDirectionCW)},this.allocTextureUnit=function(){var fr=Rt;return fr>=Kt.maxTextures&&console.warn('WebGLRenderer: trying to use '+fr+' texture units while this GPU supports only '+Kt.maxTextures),Rt+=1,fr},this.setTexture2D=function(){var fr=!1;return function(hr,yr){hr instanceof pe.WebGLRenderTarget&&(!fr&&(console.warn('THREE.WebGLRenderer.setTexture2D: don\'t use render targets as textures. Use their .texture property instead.'),fr=!0),hr=hr.texture),$t.setTexture2D(hr,yr)}}(),this.setTexture=function(){var fr=!1;return function(hr,yr){fr||(console.warn('THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead.'),fr=!0),$t.setTexture2D(hr,yr)}}(),this.setTextureCube=function(){var fr=!1;return function(hr,yr){hr instanceof pe.WebGLRenderTargetCube&&(!fr&&(console.warn('THREE.WebGLRenderer.setTextureCube: don\'t use cube render targets as textures. Use their .texture property instead.'),fr=!0),hr=hr.texture),hr instanceof pe.CubeTexture||Array.isArray(hr.image)&&6===hr.image.length?$t.setTextureCube(hr,yr):$t.setTextureCubeDynamic(hr,yr)}}(),this.getCurrentRenderTarget=function(){return _t},this.setRenderTarget=function(fr){_t=fr,fr&&void 0===Jt.get(fr).__webglFramebuffer&&$t.setupRenderTarget(fr);var gr=fr instanceof pe.WebGLRenderTargetCube,hr;if(fr){var yr=Jt.get(fr);hr=gr?yr.__webglFramebuffer[fr.activeCubeFace]:yr.__webglFramebuffer,Mt.copy(fr.scissor),At=fr.scissorTest,Lt.copy(fr.viewport)}else hr=null,Mt.copy(It).multiplyScalar(Dt),At=Bt,Lt.copy(Ut).multiplyScalar(Dt);if(vt!==hr&&(qt.bindFramebuffer(qt.FRAMEBUFFER,hr),vt=hr),Qt.scissor(Mt),Qt.setScissorTest(At),Qt.viewport(Lt),gr){var xr=Jt.get(fr.texture);qt.framebufferTexture2D(qt.FRAMEBUFFER,qt.COLOR_ATTACHMENT0,qt.TEXTURE_CUBE_MAP_POSITIVE_X+fr.activeCubeFace,xr.__webglTexture,fr.activeMipMapLevel)}},this.readRenderTargetPixels=function(fr,gr,hr,yr,xr,_r){if(!1==fr instanceof pe.WebGLRenderTarget)return void console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.');var vr=Jt.get(fr).__webglFramebuffer;if(vr){var br=!1;vr!==vt&&(qt.bindFramebuffer(qt.FRAMEBUFFER,vr),br=!0);try{var Er=fr.texture;if(Er.format!==pe.RGBAFormat&&Ke(Er.format)!==qt.getParameter(qt.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.');if(Er.type!==pe.UnsignedByteType&&Ke(Er.type)!==qt.getParameter(qt.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Er.type===pe.FloatType&&Zt.get('WEBGL_color_buffer_float'))&&!(Er.type===pe.HalfFloatType&&Zt.get('EXT_color_buffer_half_float')))return void console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.');qt.checkFramebufferStatus(qt.FRAMEBUFFER)===qt.FRAMEBUFFER_COMPLETE?0<=gr&&gr<=fr.width-yr&&0<=hr&&hr<=fr.height-xr&&qt.readPixels(gr,hr,yr,xr,Ke(Er.format),Ke(Er.type),_r):console.error('THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.')}finally{br&&qt.bindFramebuffer(qt.FRAMEBUFFER,vt)}}}},pe.WebGLRenderTarget=function(ue,fe,ge){this.uuid=pe.Math.generateUUID(),this.width=ue,this.height=fe,this.scissor=new pe.Vector4(0,0,ue,fe),this.scissorTest=!1,this.viewport=new pe.Vector4(0,0,ue,fe),ge=ge||{},ge.minFilter===void 0&&(ge.minFilter=pe.LinearFilter),this.texture=new pe.Texture(void 0,void 0,ge.wrapS,ge.wrapT,ge.magFilter,ge.minFilter,ge.format,ge.type,ge.anisotropy,ge.encoding),this.depthBuffer=!(ge.depthBuffer!==void 0)||ge.depthBuffer,this.stencilBuffer=!(ge.stencilBuffer!==void 0)||ge.stencilBuffer,this.depthTexture=null},le(pe.WebGLRenderTarget.prototype,pe.EventDispatcher.prototype,{setSize:function(fe,ge){(this.width!==fe||this.height!==ge)&&(this.width=fe,this.height=ge,this.dispose()),this.viewport.set(0,0,fe,ge),this.scissor.set(0,0,fe,ge)},clone:function(){return new this.constructor().copy(this)},copy:function(fe){return this.width=fe.width,this.height=fe.height,this.viewport.copy(fe.viewport),this.texture=fe.texture.clone(),this.depthBuffer=fe.depthBuffer,this.stencilBuffer=fe.stencilBuffer,this.depthTexture=fe.depthTexture,this},dispose:function(){this.dispatchEvent({type:'dispose'})}}),pe.WebGLRenderTargetCube=function(ue,fe,ge){pe.WebGLRenderTarget.call(this,ue,fe,ge),this.activeCubeFace=0,this.activeMipMapLevel=0},pe.WebGLRenderTargetCube.prototype=Object.create(pe.WebGLRenderTarget.prototype),pe.WebGLRenderTargetCube.prototype.constructor=pe.WebGLRenderTargetCube,pe.WebGLBufferRenderer=function(ue,fe,ge){var _e;this.setMode=function(ve){_e=ve},this.render=function(ve,Ee){ue.drawArrays(_e,ve,Ee),ge.calls++,ge.vertices+=Ee,_e===ue.TRIANGLES&&(ge.faces+=Ee/3)},this.renderInstances=function(ve){var Ee=fe.get('ANGLE_instanced_arrays');if(null===Ee)return void console.error('THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.');var Te=ve.attributes.position,Se=0;Te instanceof pe.InterleavedBufferAttribute?(Se=Te.data.count,Ee.drawArraysInstancedANGLE(_e,0,Se,ve.maxInstancedCount)):(Se=Te.count,Ee.drawArraysInstancedANGLE(_e,0,Se,ve.maxInstancedCount)),ge.calls++,ge.vertices+=Se*ve.maxInstancedCount,_e===ue.TRIANGLES&&(ge.faces+=ve.maxInstancedCount*Se/3)}},pe.WebGLClipping=function(){function ue(){Te.value!==he&&(Te.value=he,Te.needsUpdate=0<ye),ge.numPlanes=ye}function fe(Se,Me,Ae,Le){var Re=null===Se?0:Se.length,Ce=null;if(0!==Re){if(Ce=Te.value,!0!==Le||null===Ce){var we=Ae+4*Re,Pe=Me.matrixWorldInverse;Ee.getNormalMatrix(Pe),(null===Ce||Ce.length<we)&&(Ce=new Float32Array(we));for(var Fe=0,De=Ae;Fe!==Re;++Fe,De+=4)ve.copy(Se[Fe]).applyMatrix4(Pe,Ee),ve.normal.toArray(Ce,De),Ce[De+3]=ve.constant}Te.value=Ce,Te.needsUpdate=!0}return ge.numPlanes=Re,Ce}var ge=this,he=null,ye=0,xe=!1,_e=!1,ve=new pe.Plane,Ee=new pe.Matrix3,Te={value:null,needsUpdate:!1};this.uniform=Te,this.numPlanes=0,this.init=function(Se,Me,Ae){var Le=0!==Se.length||Me||0!=ye||xe;return xe=Me,he=fe(Se,Ae,0),ye=Se.length,Le},this.beginShadows=function(){_e=!0,fe(null)},this.endShadows=function(){_e=!1,ue()},this.setState=function(Se,Me,Ae,Le,Re){if(!xe||null===Se||0===Se.length||_e&&!Me)_e?fe(null):ue();else{var Ce=_e?0:ye,we=4*Ce,Pe=Le.clippingState||null;Te.value=Pe,Pe=fe(Se,Ae,we,Re);for(var Fe=0;Fe!==we;++Fe)Pe[Fe]=he[Fe];Le.clippingState=Pe,this.numPlanes+=Ce}}},pe.WebGLIndexedBufferRenderer=function(ue,fe,ge){var ve,Ee,Te;this.setMode=function(Se){ve=Se},this.setIndex=function(Se){Se.array instanceof Uint32Array&&fe.get('OES_element_index_uint')?(Ee=ue.UNSIGNED_INT,Te=4):(Ee=ue.UNSIGNED_SHORT,Te=2)},this.render=function(Se,Me){ue.drawElements(ve,Me,Ee,Se*Te),ge.calls++,ge.vertices+=Me,ve===ue.TRIANGLES&&(ge.faces+=Me/3)},this.renderInstances=function(Se,Me,Ae){var Le=fe.get('ANGLE_instanced_arrays');return null===Le?void console.error('THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.'):void(Le.drawElementsInstancedANGLE(ve,Ae,Ee,Me*Te,Se.maxInstancedCount),ge.calls++,ge.vertices+=Ae*Se.maxInstancedCount,ve===ue.TRIANGLES&&(ge.faces+=Se.maxInstancedCount*Ae/3))}},pe.WebGLExtensions=function(ue){var fe={};this.get=function(ge){if(void 0!==fe[ge])return fe[ge];var he;return he='WEBGL_depth_texture'===ge?ue.getExtension('WEBGL_depth_texture')||ue.getExtension('MOZ_WEBGL_depth_texture')||ue.getExtension('WEBKIT_WEBGL_depth_texture'):'EXT_texture_filter_anisotropic'===ge?ue.getExtension('EXT_texture_filter_anisotropic')||ue.getExtension('MOZ_EXT_texture_filter_anisotropic')||ue.getExtension('WEBKIT_EXT_texture_filter_anisotropic'):'WEBGL_compressed_texture_s3tc'===ge?ue.getExtension('WEBGL_compressed_texture_s3tc')||ue.getExtension('MOZ_WEBGL_compressed_texture_s3tc')||ue.getExtension('WEBKIT_WEBGL_compressed_texture_s3tc'):'WEBGL_compressed_texture_pvrtc'===ge?ue.getExtension('WEBGL_compressed_texture_pvrtc')||ue.getExtension('WEBKIT_WEBGL_compressed_texture_pvrtc'):'WEBGL_compressed_texture_etc1'===ge?ue.getExtension('WEBGL_compressed_texture_etc1'):ue.getExtension(ge),null===he&&console.warn('THREE.WebGLRenderer: '+ge+' extension not supported.'),fe[ge]=he,he}},pe.WebGLCapabilities=function(ue,fe,ge){function ye(ve){if('highp'===ve){if(0<ue.getShaderPrecisionFormat(ue.VERTEX_SHADER,ue.HIGH_FLOAT).precision&&0<ue.getShaderPrecisionFormat(ue.FRAGMENT_SHADER,ue.HIGH_FLOAT).precision)return'highp';ve='mediump'}return'mediump'===ve&&0<ue.getShaderPrecisionFormat(ue.VERTEX_SHADER,ue.MEDIUM_FLOAT).precision&&0<ue.getShaderPrecisionFormat(ue.FRAGMENT_SHADER,ue.MEDIUM_FLOAT).precision?'mediump':'lowp'}var xe;this.getMaxAnisotropy=function(){if(void 0!=xe)return xe;var ve=fe.get('EXT_texture_filter_anisotropic');return xe=null===ve?0:ue.getParameter(ve.MAX_TEXTURE_MAX_ANISOTROPY_EXT),xe},this.getMaxPrecision=ye,this.precision=ge.precision===void 0?'highp':ge.precision,this.logarithmicDepthBuffer=ge.logarithmicDepthBuffer!==void 0&&ge.logarithmicDepthBuffer,this.maxTextures=ue.getParameter(ue.MAX_TEXTURE_IMAGE_UNITS),this.maxVertexTextures=ue.getParameter(ue.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this.maxTextureSize=ue.getParameter(ue.MAX_TEXTURE_SIZE),this.maxCubemapSize=ue.getParameter(ue.MAX_CUBE_MAP_TEXTURE_SIZE),this.maxAttributes=ue.getParameter(ue.MAX_VERTEX_ATTRIBS),this.maxVertexUniforms=ue.getParameter(ue.MAX_VERTEX_UNIFORM_VECTORS),this.maxVaryings=ue.getParameter(ue.MAX_VARYING_VECTORS),this.maxFragmentUniforms=ue.getParameter(ue.MAX_FRAGMENT_UNIFORM_VECTORS),this.vertexTextures=0<this.maxVertexTextures,this.floatFragmentTextures=!!fe.get('OES_texture_float'),this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures;var _e=ye(this.precision);_e!==this.precision&&(console.warn('THREE.WebGLRenderer:',this.precision,'not supported, using',_e,'instead.'),this.precision=_e),this.logarithmicDepthBuffer&&(this.logarithmicDepthBuffer=!!fe.get('EXT_frag_depth'))},pe.WebGLGeometries=function(ue,fe,ge){function ye(Se){var Me=Se.target,Ae=Te[Me.id];null!==Ae.index&&_e(Ae.index),ve(Ae.attributes),Me.removeEventListener('dispose',ye),delete Te[Me.id];var Le=fe.get(Me);Le.wireframe&&_e(Le.wireframe),fe.delete(Me);var Re=fe.get(Ae);Re.wireframe&&_e(Re.wireframe),fe.delete(Ae),ge.memory.geometries--}function xe(Se){return Se instanceof pe.InterleavedBufferAttribute?fe.get(Se.data).__webglBuffer:fe.get(Se).__webglBuffer}function _e(Se){var Me=xe(Se);Me!==void 0&&(ue.deleteBuffer(Me),Ee(Se))}function ve(Se){for(var Me in Se)_e(Se[Me])}function Ee(Se){Se instanceof pe.InterleavedBufferAttribute?fe.delete(Se.data):fe.delete(Se)}var Te={};this.get=function(Se){var Me=Se.geometry;if(void 0!==Te[Me.id])return Te[Me.id];Me.addEventListener('dispose',ye);var Ae;return Me instanceof pe.BufferGeometry?Ae=Me:Me instanceof pe.Geometry&&(void 0===Me._bufferGeometry&&(Me._bufferGeometry=new pe.BufferGeometry().setFromObject(Se)),Ae=Me._bufferGeometry),Te[Me.id]=Ae,ge.memory.geometries++,Ae}},pe.WebGLLights=function(){var ue={};this.get=function(fe){if(void 0!==ue[fe.id])return ue[fe.id];var ge;switch(fe.type){case'DirectionalLight':ge={direction:new pe.Vector3,color:new pe.Color,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new pe.Vector2};break;case'SpotLight':ge={position:new pe.Vector3,direction:new pe.Vector3,color:new pe.Color,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new pe.Vector2};break;case'PointLight':ge={position:new pe.Vector3,color:new pe.Color,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new pe.Vector2};break;case'HemisphereLight':ge={direction:new pe.Vector3,skyColor:new pe.Color,groundColor:new pe.Color};}return ue[fe.id]=ge,ge}},pe.WebGLObjects=function(ue,fe,ge){function ye(Me,Ae){var Le=Me instanceof pe.InterleavedBufferAttribute?Me.data:Me,Re=fe.get(Le);Re.__webglBuffer===void 0?xe(Re,Le,Ae):Re.version!==Le.version&&_e(Re,Le,Ae)}function xe(Me,Ae,Le){Me.__webglBuffer=ue.createBuffer(),ue.bindBuffer(Le,Me.__webglBuffer);var Re=Ae.dynamic?ue.DYNAMIC_DRAW:ue.STATIC_DRAW;ue.bufferData(Le,Ae.array,Re),Me.version=Ae.version}function _e(Me,Ae,Le){ue.bindBuffer(Le,Me.__webglBuffer),!1===Ae.dynamic||-1===Ae.updateRange.count?ue.bufferSubData(Le,0,Ae.array):0===Ae.updateRange.count?console.error('THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.'):(ue.bufferSubData(Le,Ae.updateRange.offset*Ae.array.BYTES_PER_ELEMENT,Ae.array.subarray(Ae.updateRange.offset,Ae.updateRange.offset+Ae.updateRange.count)),Ae.updateRange.count=0),Me.version=Ae.version}function Te(Me,Ae,Le){if(Ae>Le){var Re=Ae;Ae=Le,Le=Re}var Ce=Me[Ae];return void 0===Ce?(Me[Ae]=[Le],!0):!(-1!==Ce.indexOf(Le))&&(Ce.push(Le),!0)}var Se=new pe.WebGLGeometries(ue,fe,ge);this.getAttributeBuffer=function(Me){return Me instanceof pe.InterleavedBufferAttribute?fe.get(Me.data).__webglBuffer:fe.get(Me).__webglBuffer},this.getWireframeAttribute=function(Me){var Ae=fe.get(Me);if(void 0!==Ae.wireframe)return Ae.wireframe;var Le=[],Re=Me.index,Ce=Me.attributes,we=Ce.position;if(null!==Re)for(var Pe={},Fe=Re.array,De=0,Ie=Fe.length;De<Ie;De+=3){var Be=Fe[De+0],Ue=Fe[De+1],Ne=Fe[De+2];Te(Pe,Be,Ue)&&Le.push(Be,Ue),Te(Pe,Ue,Ne)&&Le.push(Ue,Ne),Te(Pe,Ne,Be)&&Le.push(Ne,Be)}else for(var Fe=Ce.position.array,De=0,Ie=Fe.length/3-1;De<Ie;De+=3){var Be=De+0,Ue=De+1,Ne=De+2;Le.push(Be,Ue,Ue,Ne,Ne,Be)}var Ge=65535<we.count?Uint32Array:Uint16Array,Ve=new pe.BufferAttribute(new Ge(Le),1);return ye(Ve,ue.ELEMENT_ARRAY_BUFFER),Ae.wireframe=Ve,Ve},this.update=function(Me){var Ae=Se.get(Me);Me.geometry instanceof pe.Geometry&&Ae.updateFromObject(Me);var Le=Ae.index,Re=Ae.attributes;for(var Ce in null!==Le&&ye(Le,ue.ELEMENT_ARRAY_BUFFER),Re)ye(Re[Ce],ue.ARRAY_BUFFER);var we=Ae.morphAttributes;for(var Ce in we)for(var Pe=we[Ce],Fe=0,De=Pe.length;Fe<De;Fe++)ye(Pe[Fe],ue.ARRAY_BUFFER);return Ae}},pe.WebGLProgram=function(){function ue(Ae){switch(Ae){case pe.LinearEncoding:return['Linear','( value )'];case pe.sRGBEncoding:return['sRGB','( value )'];case pe.RGBEEncoding:return['RGBE','( value )'];case pe.RGBM7Encoding:return['RGBM','( value, 7.0 )'];case pe.RGBM16Encoding:return['RGBM','( value, 16.0 )'];case pe.RGBDEncoding:return['RGBD','( value, 256.0 )'];case pe.GammaEncoding:return['Gamma','( value, float( GAMMA_FACTOR ) )'];default:throw new Error('unsupported encoding: '+Ae);}}function fe(Ae,Le){var Re=ue(Le);return'vec4 '+Ae+'( vec4 value ) { return '+Re[0]+'ToLinear'+Re[1]+'; }'}function ge(Ae,Le){var Re=ue(Le);return'vec4 '+Ae+'( vec4 value ) { return LinearTo'+Re[0]+Re[1]+'; }'}function he(Ae,Le){var Re;switch(Le){case pe.LinearToneMapping:Re='Linear';break;case pe.ReinhardToneMapping:Re='Reinhard';break;case pe.Uncharted2ToneMapping:Re='Uncharted2';break;case pe.CineonToneMapping:Re='OptimizedCineon';break;default:throw new Error('unsupported toneMapping: '+Le);}return'vec3 '+Ae+'( vec3 color ) { return '+Re+'ToneMapping( color ); }'}function ye(Ae,Le,Re){Ae=Ae||{};var Ce=[Ae.derivatives||Le.envMapCubeUV||Le.bumpMap||Le.normalMap||Le.flatShading?'#extension GL_OES_standard_derivatives : enable':'',(Ae.fragDepth||Le.logarithmicDepthBuffer)&&Re.get('EXT_frag_depth')?'#extension GL_EXT_frag_depth : enable':'',Ae.drawBuffers&&Re.get('WEBGL_draw_buffers')?'#extension GL_EXT_draw_buffers : require':'',(Ae.shaderTextureLOD||Le.envMap)&&Re.get('EXT_shader_texture_lod')?'#extension GL_EXT_shader_texture_lod : enable':''];return Ce.filter(ve).join('\n')}function xe(Ae){var Le=[];for(var Re in Ae){var Ce=Ae[Re];!1===Ce||Le.push('#define '+Re+' '+Ce)}return Le.join('\n')}function _e(Ae,Le){for(var Ce={},we=Ae.getProgramParameter(Le,Ae.ACTIVE_ATTRIBUTES),Pe=0;Pe<we;Pe++){var Fe=Ae.getActiveAttrib(Le,Pe),De=Fe.name;Ce[De]=Ae.getAttribLocation(Le,De)}return Ce}function ve(Ae){return''!==Ae}function Ee(Ae,Le){return Ae.replace(/NUM_DIR_LIGHTS/g,Le.numDirLights).replace(/NUM_SPOT_LIGHTS/g,Le.numSpotLights).replace(/NUM_POINT_LIGHTS/g,Le.numPointLights).replace(/NUM_HEMI_LIGHTS/g,Le.numHemiLights)}function Te(Ae){var Re=/#include +<([\w\d.]+)>/g;return Ae.replace(Re,function(Ce,we){var Pe=pe.ShaderChunk[we];if(Pe===void 0)throw new Error('Can not resolve #include <'+we+'>');return Te(Pe)})}function Se(Ae){var Re=/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return Ae.replace(Re,function(Ce,we,Pe,Fe){for(var De='',Ie=parseInt(we);Ie<parseInt(Pe);Ie++)De+=Fe.replace(/\[ i \]/g,'[ '+Ie+' ]');return De})}var Me=0;return function(Le,Re,Ce,we){var Pe=Le.context,Fe=Ce.extensions,De=Ce.defines,Ie=Ce.__webglShader.vertexShader,Be=Ce.__webglShader.fragmentShader,Ue='SHADOWMAP_TYPE_BASIC';we.shadowMapType===pe.PCFShadowMap?Ue='SHADOWMAP_TYPE_PCF':we.shadowMapType===pe.PCFSoftShadowMap&&(Ue='SHADOWMAP_TYPE_PCF_SOFT');var Ne='ENVMAP_TYPE_CUBE',Ge='ENVMAP_MODE_REFLECTION',Ve='ENVMAP_BLENDING_MULTIPLY';if(we.envMap){switch(Ce.envMap.mapping){case pe.CubeReflectionMapping:case pe.CubeRefractionMapping:Ne='ENVMAP_TYPE_CUBE';break;case pe.CubeUVReflectionMapping:case pe.CubeUVRefractionMapping:Ne='ENVMAP_TYPE_CUBE_UV';break;case pe.EquirectangularReflectionMapping:case pe.EquirectangularRefractionMapping:Ne='ENVMAP_TYPE_EQUIREC';break;case pe.SphericalReflectionMapping:Ne='ENVMAP_TYPE_SPHERE';}switch(Ce.envMap.mapping){case pe.CubeRefractionMapping:case pe.EquirectangularRefractionMapping:Ge='ENVMAP_MODE_REFRACTION';}switch(Ce.combine){case pe.MultiplyOperation:Ve='ENVMAP_BLENDING_MULTIPLY';break;case pe.MixOperation:Ve='ENVMAP_BLENDING_MIX';break;case pe.AddOperation:Ve='ENVMAP_BLENDING_ADD';}}var ze=0<Le.gammaFactor?Le.gammaFactor:1,Oe=ye(Fe,we,Le.extensions),ke=xe(De),He=Pe.createProgram(),We,je;Ce instanceof pe.RawShaderMaterial?(We=[ke].filter(ve).join('\n'),je=[ke].filter(ve).join('\n')):(We=['precision '+we.precision+' float;','precision '+we.precision+' int;','#define SHADER_NAME '+Ce.__webglShader.name,ke,we.supportsVertexTextures?'#define VERTEX_TEXTURES':'','#define GAMMA_FACTOR '+ze,'#define MAX_BONES '+we.maxBones,we.map?'#define USE_MAP':'',we.envMap?'#define USE_ENVMAP':'',we.envMap?'#define '+Ge:'',we.lightMap?'#define USE_LIGHTMAP':'',we.aoMap?'#define USE_AOMAP':'',we.emissiveMap?'#define USE_EMISSIVEMAP':'',we.bumpMap?'#define USE_BUMPMAP':'',we.normalMap?'#define USE_NORMALMAP':'',we.displacementMap&&we.supportsVertexTextures?'#define USE_DISPLACEMENTMAP':'',we.specularMap?'#define USE_SPECULARMAP':'',we.roughnessMap?'#define USE_ROUGHNESSMAP':'',we.metalnessMap?'#define USE_METALNESSMAP':'',we.alphaMap?'#define USE_ALPHAMAP':'',we.vertexColors?'#define USE_COLOR':'',we.flatShading?'#define FLAT_SHADED':'',we.skinning?'#define USE_SKINNING':'',we.useVertexTexture?'#define BONE_TEXTURE':'',we.morphTargets?'#define USE_MORPHTARGETS':'',we.morphNormals&&!1===we.flatShading?'#define USE_MORPHNORMALS':'',we.doubleSided?'#define DOUBLE_SIDED':'',we.flipSided?'#define FLIP_SIDED':'','#define NUM_CLIPPING_PLANES '+we.numClippingPlanes,we.shadowMapEnabled?'#define USE_SHADOWMAP':'',we.shadowMapEnabled?'#define '+Ue:'',we.sizeAttenuation?'#define USE_SIZEATTENUATION':'',we.logarithmicDepthBuffer?'#define USE_LOGDEPTHBUF':'',we.logarithmicDepthBuffer&&Le.extensions.get('EXT_frag_depth')?'#define USE_LOGDEPTHBUF_EXT':'','uniform mat4 modelMatrix;','uniform mat4 modelViewMatrix;','uniform mat4 projectionMatrix;','uniform mat4 viewMatrix;','uniform mat3 normalMatrix;','uniform vec3 cameraPosition;','attribute vec3 position;','attribute vec3 normal;','attribute vec2 uv;','#ifdef USE_COLOR','\tattribute vec3 color;','#endif','#ifdef USE_MORPHTARGETS','\tattribute vec3 morphTarget0;','\tattribute vec3 morphTarget1;','\tattribute vec3 morphTarget2;','\tattribute vec3 morphTarget3;','\t#ifdef USE_MORPHNORMALS','\t\tattribute vec3 morphNormal0;','\t\tattribute vec3 morphNormal1;','\t\tattribute vec3 morphNormal2;','\t\tattribute vec3 morphNormal3;','\t#else','\t\tattribute vec3 morphTarget4;','\t\tattribute vec3 morphTarget5;','\t\tattribute vec3 morphTarget6;','\t\tattribute vec3 morphTarget7;','\t#endif','#endif','#ifdef USE_SKINNING','\tattribute vec4 skinIndex;','\tattribute vec4 skinWeight;','#endif','\n'].filter(ve).join('\n'),je=[Oe,'precision '+we.precision+' float;','precision '+we.precision+' int;','#define SHADER_NAME '+Ce.__webglShader.name,ke,we.alphaTest?'#define ALPHATEST '+we.alphaTest:'','#define GAMMA_FACTOR '+ze,we.useFog&&we.fog?'#define USE_FOG':'',we.useFog&&we.fogExp?'#define FOG_EXP2':'',we.map?'#define USE_MAP':'',we.envMap?'#define USE_ENVMAP':'',we.envMap?'#define '+Ne:'',we.envMap?'#define '+Ge:'',we.envMap?'#define '+Ve:'',we.lightMap?'#define USE_LIGHTMAP':'',we.aoMap?'#define USE_AOMAP':'',we.emissiveMap?'#define USE_EMISSIVEMAP':'',we.bumpMap?'#define USE_BUMPMAP':'',we.normalMap?'#define USE_NORMALMAP':'',we.specularMap?'#define USE_SPECULARMAP':'',we.roughnessMap?'#define USE_ROUGHNESSMAP':'',we.metalnessMap?'#define USE_METALNESSMAP':'',we.alphaMap?'#define USE_ALPHAMAP':'',we.vertexColors?'#define USE_COLOR':'',we.flatShading?'#define FLAT_SHADED':'',we.doubleSided?'#define DOUBLE_SIDED':'',we.flipSided?'#define FLIP_SIDED':'','#define NUM_CLIPPING_PLANES '+we.numClippingPlanes,we.shadowMapEnabled?'#define USE_SHADOWMAP':'',we.shadowMapEnabled?'#define '+Ue:'',we.premultipliedAlpha?'#define PREMULTIPLIED_ALPHA':'',we.physicallyCorrectLights?'#define PHYSICALLY_CORRECT_LIGHTS':'',we.logarithmicDepthBuffer?'#define USE_LOGDEPTHBUF':'',we.logarithmicDepthBuffer&&Le.extensions.get('EXT_frag_depth')?'#define USE_LOGDEPTHBUF_EXT':'',we.envMap&&Le.extensions.get('EXT_shader_texture_lod')?'#define TEXTURE_LOD_EXT':'','uniform mat4 viewMatrix;','uniform vec3 cameraPosition;',we.toneMapping===pe.NoToneMapping?'':'#define TONE_MAPPING',we.toneMapping===pe.NoToneMapping?'':pe.ShaderChunk.tonemapping_pars_fragment,we.toneMapping===pe.NoToneMapping?'':he('toneMapping',we.toneMapping),we.outputEncoding||we.mapEncoding||we.envMapEncoding||we.emissiveMapEncoding?pe.ShaderChunk.encodings_pars_fragment:'',we.mapEncoding?fe('mapTexelToLinear',we.mapEncoding):'',we.envMapEncoding?fe('envMapTexelToLinear',we.envMapEncoding):'',we.emissiveMapEncoding?fe('emissiveMapTexelToLinear',we.emissiveMapEncoding):'',we.outputEncoding?ge('linearToOutputTexel',we.outputEncoding):'',we.depthPacking?'#define DEPTH_PACKING '+Ce.depthPacking:'','\n'].filter(ve).join('\n')),Ie=Te(Ie,we),Ie=Ee(Ie,we),Be=Te(Be,we),Be=Ee(Be,we),!1==Ce instanceof pe.ShaderMaterial&&(Ie=Se(Ie),Be=Se(Be));var Xe=We+Ie,qe=je+Be,Ye=pe.WebGLShader(Pe,Pe.VERTEX_SHADER,Xe),Ze=pe.WebGLShader(Pe,Pe.FRAGMENT_SHADER,qe);Pe.attachShader(He,Ye),Pe.attachShader(He,Ze),void 0===Ce.index0AttributeName?!0===we.morphTargets&&Pe.bindAttribLocation(He,0,'position'):Pe.bindAttribLocation(He,0,Ce.index0AttributeName),Pe.linkProgram(He);var Ke=Pe.getProgramInfoLog(He),Qe=Pe.getShaderInfoLog(Ye),Je=Pe.getShaderInfoLog(Ze),$e=!0,et=!0;!1===Pe.getProgramParameter(He,Pe.LINK_STATUS)?($e=!1,console.error('THREE.WebGLProgram: shader error: ',Pe.getError(),'gl.VALIDATE_STATUS',Pe.getProgramParameter(He,Pe.VALIDATE_STATUS),'gl.getProgramInfoLog',Ke,Qe,Je)):''===Ke?(''===Qe||''===Je)&&(et=!1):console.warn('THREE.WebGLProgram: gl.getProgramInfoLog()',Ke),et&&(this.diagnostics={runnable:$e,material:Ce,programLog:Ke,vertexShader:{log:Qe,prefix:We},fragmentShader:{log:Je,prefix:je}}),Pe.deleteShader(Ye),Pe.deleteShader(Ze);var tt;this.getUniforms=function(){return void 0==tt&&(tt=new pe.WebGLUniforms(Pe,He,Le)),tt};var rt;return this.getAttributes=function(){return void 0==rt&&(rt=_e(Pe,He)),rt},this.destroy=function(){Pe.deleteProgram(He),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn('THREE.WebGLProgram: .uniforms is now .getUniforms().'),this.getUniforms()}},attributes:{get:function(){return console.warn('THREE.WebGLProgram: .attributes is now .getAttributes().'),this.getAttributes()}}}),this.id=Me++,this.code=Re,this.usedTimes=1,this.program=He,this.vertexShader=Ye,this.fragmentShader=Ze,this}}(),pe.WebGLPrograms=function(ue,fe){function ge(ve){if(fe.floatVertexTextures&&ve&&ve.skeleton&&ve.skeleton.useVertexTexture)return 1024;var Ee=fe.maxVertexUniforms,Te=Math.floor((Ee-20)/4),Se=Te;return void 0!==ve&&ve instanceof pe.SkinnedMesh&&(Se=Math.min(ve.skeleton.bones.length,Se),Se<ve.skeleton.bones.length&&console.warn('WebGLRenderer: too many bones - '+ve.skeleton.bones.length+', this GPU supports just '+Se+' (try OpenGL instead of ANGLE)')),Se}function he(ve,Ee){var Te;return ve?ve instanceof pe.Texture?Te=ve.encoding:ve instanceof pe.WebGLRenderTarget&&(console.warn('THREE.WebGLPrograms.getTextureEncodingFromMap: don\'t use render targets as textures. Use their .texture property instead.'),Te=ve.texture.encoding):Te=pe.LinearEncoding,Te===pe.LinearEncoding&&Ee&&(Te=pe.GammaEncoding),Te}var ye=[],xe={MeshDepthMaterial:'depth',MeshNormalMaterial:'normal',MeshBasicMaterial:'basic',MeshLambertMaterial:'lambert',MeshPhongMaterial:'phong',MeshStandardMaterial:'physical',MeshPhysicalMaterial:'physical',LineBasicMaterial:'basic',LineDashedMaterial:'dashed',PointsMaterial:'points'},_e=['precision','supportsVertexTextures','map','mapEncoding','envMap','envMapMode','envMapEncoding','lightMap','aoMap','emissiveMap','emissiveMapEncoding','bumpMap','normalMap','displacementMap','specularMap','roughnessMap','metalnessMap','alphaMap','combine','vertexColors','fog','useFog','fogExp','flatShading','sizeAttenuation','logarithmicDepthBuffer','skinning','maxBones','useVertexTexture','morphTargets','morphNormals','maxMorphTargets','maxMorphNormals','premultipliedAlpha','numDirLights','numPointLights','numSpotLights','numHemiLights','shadowMapEnabled','shadowMapType','toneMapping','physicallyCorrectLights','alphaTest','doubleSided','flipSided','numClippingPlanes','depthPacking'];this.getParameters=function(ve,Ee,Te,Se,Me){var Ae=xe[ve.type],Le=ge(Me),Re=ue.getPrecision();null!==ve.precision&&(Re=fe.getMaxPrecision(ve.precision),Re!==ve.precision&&console.warn('THREE.WebGLProgram.getParameters:',ve.precision,'not supported, using',Re,'instead.'));var Ce=ue.getCurrentRenderTarget(),we={shaderID:Ae,precision:Re,supportsVertexTextures:fe.vertexTextures,outputEncoding:he(Ce?Ce.texture:null,ue.gammaOutput),map:!!ve.map,mapEncoding:he(ve.map,ue.gammaInput),envMap:!!ve.envMap,envMapMode:ve.envMap&&ve.envMap.mapping,envMapEncoding:he(ve.envMap,ue.gammaInput),envMapCubeUV:!!ve.envMap&&(ve.envMap.mapping===pe.CubeUVReflectionMapping||ve.envMap.mapping===pe.CubeUVRefractionMapping),lightMap:!!ve.lightMap,aoMap:!!ve.aoMap,emissiveMap:!!ve.emissiveMap,emissiveMapEncoding:he(ve.emissiveMap,ue.gammaInput),bumpMap:!!ve.bumpMap,normalMap:!!ve.normalMap,displacementMap:!!ve.displacementMap,roughnessMap:!!ve.roughnessMap,metalnessMap:!!ve.metalnessMap,specularMap:!!ve.specularMap,alphaMap:!!ve.alphaMap,combine:ve.combine,vertexColors:ve.vertexColors,fog:Te,useFog:ve.fog,fogExp:Te instanceof pe.FogExp2,flatShading:ve.shading===pe.FlatShading,sizeAttenuation:ve.sizeAttenuation,logarithmicDepthBuffer:fe.logarithmicDepthBuffer,skinning:ve.skinning,maxBones:Le,useVertexTexture:fe.floatVertexTextures&&Me&&Me.skeleton&&Me.skeleton.useVertexTexture,morphTargets:ve.morphTargets,morphNormals:ve.morphNormals,maxMorphTargets:ue.maxMorphTargets,maxMorphNormals:ue.maxMorphNormals,numDirLights:Ee.directional.length,numPointLights:Ee.point.length,numSpotLights:Ee.spot.length,numHemiLights:Ee.hemi.length,numClippingPlanes:Se,shadowMapEnabled:ue.shadowMap.enabled&&Me.receiveShadow&&0<Ee.shadows.length,shadowMapType:ue.shadowMap.type,toneMapping:ue.toneMapping,physicallyCorrectLights:ue.physicallyCorrectLights,premultipliedAlpha:ve.premultipliedAlpha,alphaTest:ve.alphaTest,doubleSided:ve.side===pe.DoubleSide,flipSided:ve.side===pe.BackSide,depthPacking:ve.depthPacking!==void 0&&ve.depthPacking};return we},this.getProgramCode=function(ve,Ee){var Te=[];if(Ee.shaderID?Te.push(Ee.shaderID):(Te.push(ve.fragmentShader),Te.push(ve.vertexShader)),void 0!==ve.defines)for(var Se in ve.defines)Te.push(Se),Te.push(ve.defines[Se]);for(var Me=0;Me<_e.length;Me++)Te.push(Ee[_e[Me]]);return Te.join()},this.acquireProgram=function(ve,Ee,Te){for(var Me=0,Ae=ye.length,Se,Le;Me<Ae;Me++)if(Le=ye[Me],Le.code===Te){Se=Le,++Se.usedTimes;break}return void 0===Se&&(Se=new pe.WebGLProgram(ue,Te,ve,Ee),ye.push(Se)),Se},this.releaseProgram=function(ve){if(0==--ve.usedTimes){var Ee=ye.indexOf(ve);ye[Ee]=ye[ye.length-1],ye.pop(),ve.destroy()}},this.programs=ye},pe.WebGLProperties=function(){var ue={};this.get=function(fe){var ge=fe.uuid,he=ue[ge];return void 0===he&&(he={},ue[ge]=he),he},this.delete=function(fe){delete ue[fe.uuid]},this.clear=function(){ue={}}},pe.WebGLShader=function(){function ue(fe){for(var ge=fe.split('\n'),he=0;he<ge.length;he++)ge[he]=he+1+': '+ge[he];return ge.join('\n')}return function(ge,he,ye){var xe=ge.createShader(he);return ge.shaderSource(xe,ye),ge.compileShader(xe),!1===ge.getShaderParameter(xe,ge.COMPILE_STATUS)&&console.error('THREE.WebGLShader: Shader couldn\'t compile.'),''!==ge.getShaderInfoLog(xe)&&console.warn('THREE.WebGLShader: gl.getShaderInfoLog()',he===ge.VERTEX_SHADER?'vertex':'fragment',ge.getShaderInfoLog(xe),ue(ye)),xe}}(),pe.WebGLShadowMap=function(ue,fe,ge){function he(Xe,qe,Ye,Ze){var Ke=Xe.geometry,Qe=null,Je=Pe,$e=Xe.customDepthMaterial;if(Ye&&(Je=Fe,$e=Xe.customDistanceMaterial),!$e){var et=void 0!==Ke.morphTargets&&0<Ke.morphTargets.length&&qe.morphTargets,tt=Xe instanceof pe.SkinnedMesh&&qe.skinning,rt=0;et&&(rt|=Re),tt&&(rt|=Ce),Qe=Je[rt]}else Qe=$e;if(ue.localClippingEnabled&&!0===qe.clipShadows&&0!==qe.clippingPlanes.length){var ot=Qe.uuid,it=qe.uuid,nt=De[ot];void 0===nt&&(nt={},De[ot]=nt);var st=nt[it];void 0===st&&(st=Qe.clone(),nt[it]=st),Qe=st}Qe.visible=qe.visible,Qe.wireframe=qe.wireframe;var lt=qe.side;return je.renderSingleSided&&lt==pe.DoubleSide&&(lt=pe.FrontSide),je.renderReverseSided&&(lt===pe.FrontSide?lt=pe.BackSide:lt===pe.BackSide&&(lt=pe.FrontSide)),Qe.side=lt,Qe.clipShadows=qe.clipShadows,Qe.clippingPlanes=qe.clippingPlanes,Qe.wireframeLinewidth=qe.wireframeLinewidth,Qe.linewidth=qe.linewidth,Ye&&void 0!==Qe.uniforms.lightPos&&Qe.uniforms.lightPos.value.copy(Ze),Qe}function ye(Xe,qe,Ye){if(!1!==Xe.visible){if(Xe.layers.test(qe.layers)&&(Xe instanceof pe.Mesh||Xe instanceof pe.Line||Xe instanceof pe.Points)&&Xe.castShadow&&(!1===Xe.frustumCulled||!0===ve.intersectsObject(Xe))){var Ze=Xe.material;!0===Ze.visible&&(Xe.modelViewMatrix.multiplyMatrices(Ye.matrixWorldInverse,Xe.matrixWorld),Le.push(Xe))}for(var Ke=Xe.children,Qe=0,Je=Ke.length;Qe<Je;Qe++)ye(Ke[Qe],qe,Ye)}}var xe=ue.context,_e=ue.state,ve=new pe.Frustum,Ee=new pe.Matrix4,Te=fe.shadows,Se=new pe.Vector2,Me=new pe.Vector3,Ae=new pe.Vector3,Le=[],Re=1,Ce=2,Pe=[,,,,],Fe=[,,,,],De={},Ie=[new pe.Vector3(1,0,0),new pe.Vector3(-1,0,0),new pe.Vector3(0,0,1),new pe.Vector3(0,0,-1),new pe.Vector3(0,1,0),new pe.Vector3(0,-1,0)],Be=[new pe.Vector3(0,1,0),new pe.Vector3(0,1,0),new pe.Vector3(0,1,0),new pe.Vector3(0,1,0),new pe.Vector3(0,0,1),new pe.Vector3(0,0,-1)],Ue=[new pe.Vector4,new pe.Vector4,new pe.Vector4,new pe.Vector4,new pe.Vector4,new pe.Vector4],Ne=new pe.MeshDepthMaterial;Ne.depthPacking=pe.RGBADepthPacking,Ne.clipping=!0;for(var Ge=pe.ShaderLib.distanceRGBA,Ve=pe.UniformsUtils.clone(Ge.uniforms),ze=0;ze!==(Re|Ce)+1;++ze){var Oe=0!=(ze&Re),ke=0!=(ze&Ce),He=Ne.clone();He.morphTargets=Oe,He.skinning=ke,Pe[ze]=He;var We=new pe.ShaderMaterial({defines:{USE_SHADOWMAP:''},uniforms:Ve,vertexShader:Ge.vertexShader,fragmentShader:Ge.fragmentShader,morphTargets:Oe,skinning:ke,clipping:!0});Fe[ze]=We}var je=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=pe.PCFShadowMap,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(Xe,qe){if(!1!==je.enabled&&(!1!==je.autoUpdate||!1!==je.needsUpdate)&&0!==Te.length){_e.clearColor(1,1,1,1),_e.disable(xe.BLEND),_e.setDepthTest(!0),_e.setScissorTest(!1);for(var Ke=0,Qe=Te.length,Ye,Ze;Ke<Qe;Ke++){var Je=Te[Ke],$e=Je.shadow;if(void 0===$e){console.warn('THREE.WebGLShadowMap:',Je,'has no shadow.');continue}var et=$e.camera;if(Se.copy($e.mapSize),Je instanceof pe.PointLight){Ye=6,Ze=!0;var tt=Se.x,rt=Se.y;Ue[0].set(2*tt,rt,tt,rt),Ue[1].set(0,rt,tt,rt),Ue[2].set(3*tt,rt,tt,rt),Ue[3].set(tt,rt,tt,rt),Ue[4].set(3*tt,0,tt,rt),Ue[5].set(tt,0,tt,rt),Se.x*=4,Se.y*=2}else Ye=1,Ze=!1;if(null===$e.map){var ot={minFilter:pe.NearestFilter,magFilter:pe.NearestFilter,format:pe.RGBAFormat};$e.map=new pe.WebGLRenderTarget(Se.x,Se.y,ot),et.updateProjectionMatrix()}$e instanceof pe.SpotLightShadow&&$e.update(Je);var it=$e.map,nt=$e.matrix;Ae.setFromMatrixPosition(Je.matrixWorld),et.position.copy(Ae),ue.setRenderTarget(it),ue.clear();for(var st=0;st<Ye;st++){if(Ze){Me.copy(et.position),Me.add(Ie[st]),et.up.copy(Be[st]),et.lookAt(Me);var lt=Ue[st];_e.viewport(lt)}else Me.setFromMatrixPosition(Je.target.matrixWorld),et.lookAt(Me);et.updateMatrixWorld(),et.matrixWorldInverse.getInverse(et.matrixWorld),nt.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1),nt.multiply(et.projectionMatrix),nt.multiply(et.matrixWorldInverse),Ee.multiplyMatrices(et.projectionMatrix,et.matrixWorldInverse),ve.setFromMatrix(Ee),Le.length=0,ye(Xe,qe,et);for(var dt=0,ct=Le.length;dt<ct;dt++){var ut=Le[dt],mt=ge.update(ut),gt=ut.material;if(gt instanceof pe.MultiMaterial)for(var ht=mt.groups,yt=gt.materials,xt=0,_t=ht.length;xt<_t;xt++){var vt=ht[xt],Et=yt[vt.materialIndex];if(!0===Et.visible){var Tt=he(ut,Et,Ze,Ae);ue.renderBufferDirect(et,null,mt,Tt,ut,vt)}}else{var Tt=he(ut,gt,Ze,Ae);ue.renderBufferDirect(et,null,mt,Tt,ut,null)}}}}var St=ue.getClearColor(),Mt=ue.getClearAlpha();ue.setClearColor(St,Mt),je.needsUpdate=!1}}},pe.WebGLState=function(ue,fe,ge){function he(je,Xe,qe){var Ye=new Uint8Array(4),Ze=ue.createTexture();ue.bindTexture(je,Ze),ue.texParameteri(je,ue.TEXTURE_MIN_FILTER,ue.NEAREST),ue.texParameteri(je,ue.TEXTURE_MAG_FILTER,ue.NEAREST);for(var Ke=0;Ke<qe;Ke++)ue.texImage2D(Xe+Ke,0,ue.RGBA,1,1,0,ue.RGBA,ue.UNSIGNED_BYTE,Ye);return Ze}var ye=this;this.buffers={color:new pe.WebGLColorBuffer(ue,this),depth:new pe.WebGLDepthBuffer(ue,this),stencil:new pe.WebGLStencilBuffer(ue,this)};var xe=ue.getParameter(ue.MAX_VERTEX_ATTRIBS),_e=new Uint8Array(xe),ve=new Uint8Array(xe),Ee=new Uint8Array(xe),Te={},Se=null,Me=null,Ae=null,Le=null,Re=null,Ce=null,we=null,Pe=null,Fe=!1,De=null,Ie=null,Be=null,Ue=null,Ne=null,Ge=null,Ve=ue.getParameter(ue.MAX_TEXTURE_IMAGE_UNITS),ze=null,Oe={},ke=new pe.Vector4,He=new pe.Vector4,We={};We[ue.TEXTURE_2D]=he(ue.TEXTURE_2D,ue.TEXTURE_2D,1),We[ue.TEXTURE_CUBE_MAP]=he(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_CUBE_MAP_POSITIVE_X,6),this.init=function(){this.clearColor(0,0,0,1),this.clearDepth(1),this.clearStencil(0),this.enable(ue.DEPTH_TEST),this.setDepthFunc(pe.LessEqualDepth),this.setFlipSided(!1),this.setCullFace(pe.CullFaceBack),this.enable(ue.CULL_FACE),this.enable(ue.BLEND),this.setBlending(pe.NormalBlending)},this.initAttributes=function(){for(var je=0,Xe=_e.length;je<Xe;je++)_e[je]=0},this.enableAttribute=function(je){if(_e[je]=1,0===ve[je]&&(ue.enableVertexAttribArray(je),ve[je]=1),0!==Ee[je]){var Xe=fe.get('ANGLE_instanced_arrays');Xe.vertexAttribDivisorANGLE(je,0),Ee[je]=0}},this.enableAttributeAndDivisor=function(je,Xe,qe){_e[je]=1,0===ve[je]&&(ue.enableVertexAttribArray(je),ve[je]=1),Ee[je]!==Xe&&(qe.vertexAttribDivisorANGLE(je,Xe),Ee[je]=Xe)},this.disableUnusedAttributes=function(){for(var je=0,Xe=ve.length;je!==Xe;++je)ve[je]!==_e[je]&&(ue.disableVertexAttribArray(je),ve[je]=0)},this.enable=function(je){!0!==Te[je]&&(ue.enable(je),Te[je]=!0)},this.disable=function(je){!1!==Te[je]&&(ue.disable(je),Te[je]=!1)},this.getCompressedTextureFormats=function(){if(null==Se&&(Se=[],fe.get('WEBGL_compressed_texture_pvrtc')||fe.get('WEBGL_compressed_texture_s3tc')||fe.get('WEBGL_compressed_texture_etc1')))for(var je=ue.getParameter(ue.COMPRESSED_TEXTURE_FORMATS),Xe=0;Xe<je.length;Xe++)Se.push(je[Xe]);return Se},this.setBlending=function(je,Xe,qe,Ye,Ze,Ke,Qe,Je){if(je!==pe.NoBlending)this.enable(ue.BLEND);else return this.disable(ue.BLEND),void(Me=je);(je!==Me||Je!==Fe)&&(je===pe.AdditiveBlending?Je?(ue.blendEquationSeparate(ue.FUNC_ADD,ue.FUNC_ADD),ue.blendFuncSeparate(ue.ONE,ue.ONE,ue.ONE,ue.ONE)):(ue.blendEquation(ue.FUNC_ADD),ue.blendFunc(ue.SRC_ALPHA,ue.ONE)):je===pe.SubtractiveBlending?Je?(ue.blendEquationSeparate(ue.FUNC_ADD,ue.FUNC_ADD),ue.blendFuncSeparate(ue.ZERO,ue.ZERO,ue.ONE_MINUS_SRC_COLOR,ue.ONE_MINUS_SRC_ALPHA)):(ue.blendEquation(ue.FUNC_ADD),ue.blendFunc(ue.ZERO,ue.ONE_MINUS_SRC_COLOR)):je===pe.MultiplyBlending?Je?(ue.blendEquationSeparate(ue.FUNC_ADD,ue.FUNC_ADD),ue.blendFuncSeparate(ue.ZERO,ue.SRC_COLOR,ue.ZERO,ue.SRC_ALPHA)):(ue.blendEquation(ue.FUNC_ADD),ue.blendFunc(ue.ZERO,ue.SRC_COLOR)):Je?(ue.blendEquationSeparate(ue.FUNC_ADD,ue.FUNC_ADD),ue.blendFuncSeparate(ue.ONE,ue.ONE_MINUS_SRC_ALPHA,ue.ONE,ue.ONE_MINUS_SRC_ALPHA)):(ue.blendEquationSeparate(ue.FUNC_ADD,ue.FUNC_ADD),ue.blendFuncSeparate(ue.SRC_ALPHA,ue.ONE_MINUS_SRC_ALPHA,ue.ONE,ue.ONE_MINUS_SRC_ALPHA)),Me=je,Fe=Je),je===pe.CustomBlending?(Ze=Ze||Xe,Ke=Ke||qe,Qe=Qe||Ye,(Xe!==Ae||Ze!==Ce)&&(ue.blendEquationSeparate(ge(Xe),ge(Ze)),Ae=Xe,Ce=Ze),(qe!==Le||Ye!==Re||Ke!==we||Qe!==Pe)&&(ue.blendFuncSeparate(ge(qe),ge(Ye),ge(Ke),ge(Qe)),Le=qe,Re=Ye,we=Ke,Pe=Qe)):(Ae=null,Le=null,Re=null,Ce=null,we=null,Pe=null)},this.setColorWrite=function(je){this.buffers.color.setMask(je)},this.setDepthTest=function(je){this.buffers.depth.setTest(je)},this.setDepthWrite=function(je){this.buffers.depth.setMask(je)},this.setDepthFunc=function(je){this.buffers.depth.setFunc(je)},this.setStencilTest=function(je){this.buffers.stencil.setTest(je)},this.setStencilWrite=function(je){this.buffers.stencil.setMask(je)},this.setStencilFunc=function(je,Xe,qe){this.buffers.stencil.setFunc(je,Xe,qe)},this.setStencilOp=function(je,Xe,qe){this.buffers.stencil.setOp(je,Xe,qe)},this.setFlipSided=function(je){De!==je&&(je?ue.frontFace(ue.CW):ue.frontFace(ue.CCW),De=je)},this.setCullFace=function(je){je===pe.CullFaceNone?this.disable(ue.CULL_FACE):(this.enable(ue.CULL_FACE),je!==Ie&&(je===pe.CullFaceBack?ue.cullFace(ue.BACK):je===pe.CullFaceFront?ue.cullFace(ue.FRONT):ue.cullFace(ue.FRONT_AND_BACK))),Ie=je},this.setLineWidth=function(je){je!==Be&&(ue.lineWidth(je),Be=je)},this.setPolygonOffset=function(je,Xe,qe){je?(this.enable(ue.POLYGON_OFFSET_FILL),(Ue!==Xe||Ne!==qe)&&(ue.polygonOffset(Xe,qe),Ue=Xe,Ne=qe)):this.disable(ue.POLYGON_OFFSET_FILL)},this.getScissorTest=function(){return Ge},this.setScissorTest=function(je){Ge=je,je?this.enable(ue.SCISSOR_TEST):this.disable(ue.SCISSOR_TEST)},this.activeTexture=function(je){je===void 0&&(je=ue.TEXTURE0+Ve-1),ze!==je&&(ue.activeTexture(je),ze=je)},this.bindTexture=function(je,Xe){null===ze&&ye.activeTexture();var qe=Oe[ze];qe===void 0&&(qe={type:void 0,texture:void 0},Oe[ze]=qe),(qe.type!==je||qe.texture!==Xe)&&(ue.bindTexture(je,Xe||We[je]),qe.type=je,qe.texture=Xe)},this.compressedTexImage2D=function(){try{ue.compressedTexImage2D.apply(ue,arguments)}catch(je){console.error(je)}},this.texImage2D=function(){try{ue.texImage2D.apply(ue,arguments)}catch(je){console.error(je)}},this.clearColor=function(je,Xe,qe,Ye){this.buffers.color.setClear(je,Xe,qe,Ye)},this.clearDepth=function(je){this.buffers.depth.setClear(je)},this.clearStencil=function(je){this.buffers.stencil.setClear(je)},this.scissor=function(je){!1===ke.equals(je)&&(ue.scissor(je.x,je.y,je.z,je.w),ke.copy(je))},this.viewport=function(je){!1===He.equals(je)&&(ue.viewport(je.x,je.y,je.z,je.w),He.copy(je))},this.reset=function(){for(var je=0;je<ve.length;je++)1===ve[je]&&(ue.disableVertexAttribArray(je),ve[je]=0);Te={},Se=null,ze=null,Oe={},Me=null,De=null,Ie=null,this.buffers.color.reset(),this.buffers.depth.reset(),this.buffers.stencil.reset()}},pe.WebGLColorBuffer=function(ue){var ge=!1,he=new pe.Vector4,ye=null,xe=new pe.Vector4;this.setMask=function(_e){ye===_e||ge||(ue.colorMask(_e,_e,_e,_e),ye=_e)},this.setLocked=function(_e){ge=_e},this.setClear=function(_e,ve,Ee,Te){he.set(_e,ve,Ee,Te),!1===xe.equals(he)&&(ue.clearColor(_e,ve,Ee,Te),xe.copy(he))},this.reset=function(){ge=!1,ye=null,xe=new pe.Vector4}},pe.WebGLDepthBuffer=function(ue,fe){var ge=!1,he=null,ye=null,xe=null;this.setTest=function(_e){_e?fe.enable(ue.DEPTH_TEST):fe.disable(ue.DEPTH_TEST)},this.setMask=function(_e){he===_e||ge||(ue.depthMask(_e),he=_e)},this.setFunc=function(_e){ye!==_e&&(_e?_e===pe.NeverDepth?ue.depthFunc(ue.NEVER):_e===pe.AlwaysDepth?ue.depthFunc(ue.ALWAYS):_e===pe.LessDepth?ue.depthFunc(ue.LESS):_e===pe.LessEqualDepth?ue.depthFunc(ue.LEQUAL):_e===pe.EqualDepth?ue.depthFunc(ue.EQUAL):_e===pe.GreaterEqualDepth?ue.depthFunc(ue.GEQUAL):_e===pe.GreaterDepth?ue.depthFunc(ue.GREATER):_e===pe.NotEqualDepth?ue.depthFunc(ue.NOTEQUAL):ue.depthFunc(ue.LEQUAL):ue.depthFunc(ue.LEQUAL),ye=_e)},this.setLocked=function(_e){ge=_e},this.setClear=function(_e){xe!==_e&&(ue.clearDepth(_e),xe=_e)},this.reset=function(){ge=!1,he=null,ye=null,xe=null}},pe.WebGLStencilBuffer=function(ue,fe){var ge=!1,he=null,ye=null,xe=null,_e=null,ve=null,Ee=null,Te=null,Se=null;this.setTest=function(Me){Me?fe.enable(ue.STENCIL_TEST):fe.disable(ue.STENCIL_TEST)},this.setMask=function(Me){he===Me||ge||(ue.stencilMask(Me),he=Me)},this.setFunc=function(Me,Ae,Le){(ye!==Me||xe!==Ae||_e!==Le)&&(ue.stencilFunc(Me,Ae,Le),ye=Me,xe=Ae,_e=Le)},this.setOp=function(Me,Ae,Le){(ve!==Me||Ee!==Ae||Te!==Le)&&(ue.stencilOp(Me,Ae,Le),ve=Me,Ee=Ae,Te=Le)},this.setLocked=function(Me){ge=Me},this.setClear=function(Me){Se!==Me&&(ue.clearStencil(Me),Se=Me)},this.reset=function(){ge=!1,he=null,ye=null,xe=null,_e=null,ve=null,Ee=null,Te=null,Se=null}},pe.WebGLTextures=function(ue,fe,ge,he,ye,xe,_e){function ve(He,We){if(He.width>We||He.height>We){var je=We/Math.max(He.width,He.height),Xe=document.createElementNS('http://www.w3.org/1999/xhtml','canvas');Xe.width=Math.floor(He.width*je),Xe.height=Math.floor(He.height*je);var qe=Xe.getContext('2d');return qe.drawImage(He,0,0,He.width,He.height,0,0,Xe.width,Xe.height),console.warn('THREE.WebGLRenderer: image is too big ('+He.width+'x'+He.height+'). Resized to '+Xe.width+'x'+Xe.height,He),Xe}return He}function Ee(He){return pe.Math.isPowerOfTwo(He.width)&&pe.Math.isPowerOfTwo(He.height)}function Te(He){if(He instanceof HTMLImageElement||He instanceof HTMLCanvasElement){var We=document.createElementNS('http://www.w3.org/1999/xhtml','canvas');We.width=pe.Math.nearestPowerOfTwo(He.width),We.height=pe.Math.nearestPowerOfTwo(He.height);var je=We.getContext('2d');return je.drawImage(He,0,0,We.width,We.height),console.warn('THREE.WebGLRenderer: image is not power of two ('+He.width+'x'+He.height+'). Resized to '+We.width+'x'+We.height,He),We}return He}function Se(He){return He.wrapS!==pe.ClampToEdgeWrapping||He.wrapT!==pe.ClampToEdgeWrapping||He.minFilter!==pe.NearestFilter&&He.minFilter!==pe.LinearFilter}function Me(He){return He===pe.NearestFilter||He===pe.NearestMipMapNearestFilter||He===pe.NearestMipMapLinearFilter?ue.NEAREST:ue.LINEAR}function Ae(He){var We=He.target;We.removeEventListener('dispose',Ae),Re(We),Oe.textures--}function Le(He){var We=He.target;We.removeEventListener('dispose',Le),Ce(We),Oe.textures--}function Re(He){var We=he.get(He);if(He.image&&We.__image__webglTextureCube)ue.deleteTexture(We.__image__webglTextureCube);else{if(We.__webglInit===void 0)return;ue.deleteTexture(We.__webglTexture)}he.delete(He)}function Ce(He){var We=he.get(He),je=he.get(He.texture);if(He){if(void 0!==je.__webglTexture&&ue.deleteTexture(je.__webglTexture),He.depthTexture&&He.depthTexture.dispose(),He instanceof pe.WebGLRenderTargetCube)for(var Xe=0;6>Xe;Xe++)ue.deleteFramebuffer(We.__webglFramebuffer[Xe]),We.__webglDepthbuffer&&ue.deleteRenderbuffer(We.__webglDepthbuffer[Xe]);else ue.deleteFramebuffer(We.__webglFramebuffer),We.__webglDepthbuffer&&ue.deleteRenderbuffer(We.__webglDepthbuffer);he.delete(He.texture),he.delete(He)}}function we(He,We){var je=he.get(He);if(0<He.version&&je.__version!==He.version){var Xe=He.image;if(Xe===void 0)console.warn('THREE.WebGLRenderer: Texture marked for update but image is undefined',He);else if(!1===Xe.complete)console.warn('THREE.WebGLRenderer: Texture marked for update but image is incomplete',He);else return void Ie(je,He,We)}ge.activeTexture(ue.TEXTURE0+We),ge.bindTexture(ue.TEXTURE_2D,je.__webglTexture)}function De(He,We,je){var Xe;if(je?(ue.texParameteri(He,ue.TEXTURE_WRAP_S,xe(We.wrapS)),ue.texParameteri(He,ue.TEXTURE_WRAP_T,xe(We.wrapT)),ue.texParameteri(He,ue.TEXTURE_MAG_FILTER,xe(We.magFilter)),ue.texParameteri(He,ue.TEXTURE_MIN_FILTER,xe(We.minFilter))):(ue.texParameteri(He,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(He,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),(We.wrapS!==pe.ClampToEdgeWrapping||We.wrapT!==pe.ClampToEdgeWrapping)&&console.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.',We),ue.texParameteri(He,ue.TEXTURE_MAG_FILTER,Me(We.magFilter)),ue.texParameteri(He,ue.TEXTURE_MIN_FILTER,Me(We.minFilter)),We.minFilter!==pe.NearestFilter&&We.minFilter!==pe.LinearFilter&&console.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.',We)),Xe=fe.get('EXT_texture_filter_anisotropic'),Xe){if(We.type===pe.FloatType&&null===fe.get('OES_texture_float_linear'))return;if(We.type===pe.HalfFloatType&&null===fe.get('OES_texture_half_float_linear'))return;(1<We.anisotropy||he.get(We).__currentAnisotropy)&&(ue.texParameterf(He,Xe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(We.anisotropy,ye.getMaxAnisotropy())),he.get(We).__currentAnisotropy=We.anisotropy)}}function Ie(He,We,je){He.__webglInit===void 0&&(He.__webglInit=!0,We.addEventListener('dispose',Ae),He.__webglTexture=ue.createTexture(),Oe.textures++),ge.activeTexture(ue.TEXTURE0+je),ge.bindTexture(ue.TEXTURE_2D,He.__webglTexture),ue.pixelStorei(ue.UNPACK_FLIP_Y_WEBGL,We.flipY),ue.pixelStorei(ue.UNPACK_PREMULTIPLY_ALPHA_WEBGL,We.premultiplyAlpha),ue.pixelStorei(ue.UNPACK_ALIGNMENT,We.unpackAlignment);var Xe=ve(We.image,ye.maxTextureSize);Se(We)&&!1===Ee(Xe)&&(Xe=Te(Xe));var qe=Ee(Xe),Ye=xe(We.format),Ze=xe(We.type);De(ue.TEXTURE_2D,We,qe);var Qe=We.mipmaps,Ke;if(We instanceof pe.DepthTexture){var Je=ue.DEPTH_COMPONENT;if(We.type===pe.FloatType){if(!ke)throw new Error('Float Depth Texture only supported in WebGL2.0');Je=ue.DEPTH_COMPONENT32F}else ke&&(Je=ue.DEPTH_COMPONENT16);ge.texImage2D(ue.TEXTURE_2D,0,Je,Xe.width,Xe.height,0,Ye,Ze,null)}else if(We instanceof pe.DataTexture){if(0<Qe.length&&qe){for(var $e=0,et=Qe.length;$e<et;$e++)Ke=Qe[$e],ge.texImage2D(ue.TEXTURE_2D,$e,Ye,Ke.width,Ke.height,0,Ye,Ze,Ke.data);We.generateMipmaps=!1}else ge.texImage2D(ue.TEXTURE_2D,0,Ye,Xe.width,Xe.height,0,Ye,Ze,Xe.data);}else if(We instanceof pe.CompressedTexture)for(var $e=0,et=Qe.length;$e<et;$e++)Ke=Qe[$e],We.format!==pe.RGBAFormat&&We.format!==pe.RGBFormat?-1<ge.getCompressedTextureFormats().indexOf(Ye)?ge.compressedTexImage2D(ue.TEXTURE_2D,$e,Ye,Ke.width,Ke.height,0,Ke.data):console.warn('THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()'):ge.texImage2D(ue.TEXTURE_2D,$e,Ye,Ke.width,Ke.height,0,Ye,Ze,Ke.data);else if(0<Qe.length&&qe){for(var $e=0,et=Qe.length;$e<et;$e++)Ke=Qe[$e],ge.texImage2D(ue.TEXTURE_2D,$e,Ye,Ye,Ze,Ke);We.generateMipmaps=!1}else ge.texImage2D(ue.TEXTURE_2D,0,Ye,Ye,Ze,Xe);We.generateMipmaps&&qe&&ue.generateMipmap(ue.TEXTURE_2D),He.__version=We.version,We.onUpdate&&We.onUpdate(We)}function Be(He,We,je,Xe){var qe=xe(We.texture.format),Ye=xe(We.texture.type);ge.texImage2D(Xe,0,qe,We.width,We.height,0,qe,Ye,null),ue.bindFramebuffer(ue.FRAMEBUFFER,He),ue.framebufferTexture2D(ue.FRAMEBUFFER,je,Xe,he.get(We.texture).__webglTexture,0),ue.bindFramebuffer(ue.FRAMEBUFFER,null)}function Ue(He,We){ue.bindRenderbuffer(ue.RENDERBUFFER,He),We.depthBuffer&&!We.stencilBuffer?(ue.renderbufferStorage(ue.RENDERBUFFER,ue.DEPTH_COMPONENT16,We.width,We.height),ue.framebufferRenderbuffer(ue.FRAMEBUFFER,ue.DEPTH_ATTACHMENT,ue.RENDERBUFFER,He)):We.depthBuffer&&We.stencilBuffer?(ue.renderbufferStorage(ue.RENDERBUFFER,ue.DEPTH_STENCIL,We.width,We.height),ue.framebufferRenderbuffer(ue.FRAMEBUFFER,ue.DEPTH_STENCIL_ATTACHMENT,ue.RENDERBUFFER,He)):ue.renderbufferStorage(ue.RENDERBUFFER,ue.RGBA4,We.width,We.height),ue.bindRenderbuffer(ue.RENDERBUFFER,null)}function Ne(He,We){var je=We instanceof pe.WebGLRenderTargetCube;if(je)throw new Error('Depth Texture with cube render targets is not supported!');if(ue.bindFramebuffer(ue.FRAMEBUFFER,He),!(We.depthTexture instanceof pe.DepthTexture))throw new Error('renderTarget.depthTexture must be an instance of THREE.DepthTexture');he.get(We.depthTexture).__webglTexture&&We.depthTexture.image.width===We.width&&We.depthTexture.image.height===We.height||(We.depthTexture.image.width=We.width,We.depthTexture.image.height=We.height,We.depthTexture.needsUpdate=!0),we(We.depthTexture,0);var Xe=he.get(We.depthTexture).__webglTexture;ue.framebufferTexture2D(ue.FRAMEBUFFER,ue.DEPTH_ATTACHMENT,ue.TEXTURE_2D,Xe,0)}function Ge(He){var We=he.get(He),je=He instanceof pe.WebGLRenderTargetCube;if(He.depthTexture){if(je)throw new Error('target.depthTexture not supported in Cube render targets');Ne(We.__webglFramebuffer,He)}else if(je){We.__webglDepthbuffer=[];for(var Xe=0;6>Xe;Xe++)ue.bindFramebuffer(ue.FRAMEBUFFER,We.__webglFramebuffer[Xe]),We.__webglDepthbuffer[Xe]=ue.createRenderbuffer(),Ue(We.__webglDepthbuffer[Xe],He)}else ue.bindFramebuffer(ue.FRAMEBUFFER,We.__webglFramebuffer),We.__webglDepthbuffer=ue.createRenderbuffer(),Ue(We.__webglDepthbuffer,He);ue.bindFramebuffer(ue.FRAMEBUFFER,null)}var Oe=_e.memory,ke='undefined'!=typeof WebGL2RenderingContext&&ue instanceof WebGL2RenderingContext;this.setTexture2D=we,this.setTextureCube=function(He,We){var je=he.get(He);if(6===He.image.length)if(0<He.version&&je.__version!==He.version){je.__image__webglTextureCube||(He.addEventListener('dispose',Ae),je.__image__webglTextureCube=ue.createTexture(),Oe.textures++),ge.activeTexture(ue.TEXTURE0+We),ge.bindTexture(ue.TEXTURE_CUBE_MAP,je.__image__webglTextureCube),ue.pixelStorei(ue.UNPACK_FLIP_Y_WEBGL,He.flipY);for(var Xe=He instanceof pe.CompressedTexture,qe=He.image[0]instanceof pe.DataTexture,Ye=[],Ze=0;6>Ze;Ze++)Ye[Ze]=Xe||qe?qe?He.image[Ze].image:He.image[Ze]:ve(He.image[Ze],ye.maxCubemapSize);var Ke=Ye[0],Qe=Ee(Ke),Je=xe(He.format),$e=xe(He.type);De(ue.TEXTURE_CUBE_MAP,He,Qe);for(var Ze=0;6>Ze;Ze++)if(!Xe)qe?ge.texImage2D(ue.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,0,Je,Ye[Ze].width,Ye[Ze].height,0,Je,$e,Ye[Ze].data):ge.texImage2D(ue.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,0,Je,Je,$e,Ye[Ze]);else for(var tt=Ye[Ze].mipmaps,rt=0,ot=tt.length,et;rt<ot;rt++)et=tt[rt],He.format!==pe.RGBAFormat&&He.format!==pe.RGBFormat?-1<ge.getCompressedTextureFormats().indexOf(Je)?ge.compressedTexImage2D(ue.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,rt,Je,et.width,et.height,0,et.data):console.warn('THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()'):ge.texImage2D(ue.TEXTURE_CUBE_MAP_POSITIVE_X+Ze,rt,Je,et.width,et.height,0,Je,$e,et.data);He.generateMipmaps&&Qe&&ue.generateMipmap(ue.TEXTURE_CUBE_MAP),je.__version=He.version,He.onUpdate&&He.onUpdate(He)}else ge.activeTexture(ue.TEXTURE0+We),ge.bindTexture(ue.TEXTURE_CUBE_MAP,je.__image__webglTextureCube)},this.setTextureCubeDynamic=function(He,We){ge.activeTexture(ue.TEXTURE0+We),ge.bindTexture(ue.TEXTURE_CUBE_MAP,he.get(He).__webglTexture)},this.setupRenderTarget=function(He){var We=he.get(He),je=he.get(He.texture);He.addEventListener('dispose',Le),je.__webglTexture=ue.createTexture(),Oe.textures++;var Xe=He instanceof pe.WebGLRenderTargetCube,qe=Ee(He);if(Xe){We.__webglFramebuffer=[];for(var Ye=0;6>Ye;Ye++)We.__webglFramebuffer[Ye]=ue.createFramebuffer()}else We.__webglFramebuffer=ue.createFramebuffer();if(Xe){ge.bindTexture(ue.TEXTURE_CUBE_MAP,je.__webglTexture),De(ue.TEXTURE_CUBE_MAP,He.texture,qe);for(var Ye=0;6>Ye;Ye++)Be(We.__webglFramebuffer[Ye],He,ue.COLOR_ATTACHMENT0,ue.TEXTURE_CUBE_MAP_POSITIVE_X+Ye);He.texture.generateMipmaps&&qe&&ue.generateMipmap(ue.TEXTURE_CUBE_MAP),ge.bindTexture(ue.TEXTURE_CUBE_MAP,null)}else ge.bindTexture(ue.TEXTURE_2D,je.__webglTexture),De(ue.TEXTURE_2D,He.texture,qe),Be(We.__webglFramebuffer,He,ue.COLOR_ATTACHMENT0,ue.TEXTURE_2D),He.texture.generateMipmaps&&qe&&ue.generateMipmap(ue.TEXTURE_2D),ge.bindTexture(ue.TEXTURE_2D,null);He.depthBuffer&&Ge(He)},this.updateRenderTargetMipmap=function(He){var We=He.texture;if(We.generateMipmaps&&Ee(He)&&We.minFilter!==pe.NearestFilter&&We.minFilter!==pe.LinearFilter){var je=He instanceof pe.WebGLRenderTargetCube?ue.TEXTURE_CUBE_MAP:ue.TEXTURE_2D,Xe=he.get(We).__webglTexture;ge.bindTexture(je,Xe),ue.generateMipmap(je),ge.bindTexture(je,null)}}},pe.WebGLUniforms=function(){var ue=new pe.Texture,fe=new pe.CubeTexture,ge=function(){this.seq=[],this.map={}},he=[],ye=[],_e=function(tt,rt,ot){var it=tt[0];if(0>=it||0<it)return tt;var nt=rt*ot,st=he[nt];if(void 0===st&&(st=new Float32Array(nt),he[nt]=st),0!==rt){it.toArray(st,0);for(var lt=1,dt=0;lt!==rt;++lt)dt+=ot,tt[lt].toArray(st,dt)}return st},ve=function(tt,rt){var ot=ye[rt];void 0===ot&&(ot=new Int32Array(rt),ye[rt]=ot);for(var it=0;it!==rt;++it)ot[it]=tt.allocTextureUnit();return ot},Ee=function(tt,rt){tt.uniform1f(this.addr,rt)},Te=function(tt,rt){tt.uniform1i(this.addr,rt)},Se=function(tt,rt){void 0===rt.x?tt.uniform2fv(this.addr,rt):tt.uniform2f(this.addr,rt.x,rt.y)},Me=function(tt,rt){void 0===rt.x?void 0===rt.r?tt.uniform3fv(this.addr,rt):tt.uniform3f(this.addr,rt.r,rt.g,rt.b):tt.uniform3f(this.addr,rt.x,rt.y,rt.z)},Ae=function(tt,rt){void 0===rt.x?tt.uniform4fv(this.addr,rt):tt.uniform4f(this.addr,rt.x,rt.y,rt.z,rt.w)},Le=function(tt,rt){tt.uniformMatrix2fv(this.addr,!1,rt.elements||rt)},Re=function(tt,rt){tt.uniformMatrix3fv(this.addr,!1,rt.elements||rt)},Ce=function(tt,rt){tt.uniformMatrix4fv(this.addr,!1,rt.elements||rt)},we=function(tt,rt,ot){var it=ot.allocTextureUnit();tt.uniform1i(this.addr,it),ot.setTexture2D(rt||ue,it)},Pe=function(tt,rt,ot){var it=ot.allocTextureUnit();tt.uniform1i(this.addr,it),ot.setTextureCube(rt||fe,it)},Fe=function(tt,rt){tt.uniform2iv(this.addr,rt)},De=function(tt,rt){tt.uniform3iv(this.addr,rt)},Ie=function(tt,rt){tt.uniform4iv(this.addr,rt)},Be=function(tt){return 5126===tt?Ee:35664===tt?Se:35665===tt?Me:35666===tt?Ae:35674===tt?Le:35675===tt?Re:35676===tt?Ce:35678===tt?we:35680===tt?Pe:5124===tt||35670===tt?Te:35667===tt||35671===tt?Fe:35668===tt||35672===tt?De:35669===tt||35673===tt?Ie:void 0},Ue=function(tt,rt){tt.uniform1fv(this.addr,rt)},Ne=function(tt,rt){tt.uniform1iv(this.addr,rt)},Ge=function(tt,rt){tt.uniform2fv(this.addr,_e(rt,this.size,2))},Ve=function(tt,rt){tt.uniform3fv(this.addr,_e(rt,this.size,3))},ze=function(tt,rt){tt.uniform4fv(this.addr,_e(rt,this.size,4))},Oe=function(tt,rt){tt.uniformMatrix2fv(this.addr,!1,_e(rt,this.size,4))},ke=function(tt,rt){tt.uniformMatrix3fv(this.addr,!1,_e(rt,this.size,9))},He=function(tt,rt){tt.uniformMatrix4fv(this.addr,!1,_e(rt,this.size,16))},We=function(tt,rt,ot){var it=rt.length,nt=ve(ot,it);tt.uniform1iv(this.addr,nt);for(var st=0;st!==it;++st)ot.setTexture2D(rt[st]||ue,nt[st])},je=function(tt,rt,ot){var it=rt.length,nt=ve(ot,it);tt.uniform1iv(this.addr,nt);for(var st=0;st!==it;++st)ot.setTextureCube(rt[st]||fe,nt[st])},Xe=function(tt){return 5126===tt?Ue:35664===tt?Ge:35665===tt?Ve:35666===tt?ze:35674===tt?Oe:35675===tt?ke:35676===tt?He:35678===tt?We:35680===tt?je:5124===tt||35670===tt?Ne:35667===tt||35671===tt?Fe:35668===tt||35672===tt?De:35669===tt||35673===tt?Ie:void 0},qe=function(tt,rt,ot){this.id=tt,this.addr=ot,this.setValue=Be(rt.type)},Ye=function(tt,rt,ot){this.id=tt,this.addr=ot,this.size=rt.size,this.setValue=Xe(rt.type)},Ze=function(tt){this.id=tt,ge.call(this)};Ze.prototype.setValue=function(et,tt){for(var rt=this.seq,ot=0,it=rt.length,nt;ot!==it;++ot)nt=rt[ot],nt.setValue(et,tt[nt.id])};var Ke=/([\w\d_]+)(\])?(\[|\.)?/g,Qe=function(tt,rt){tt.seq.push(rt),tt.map[rt.id]=rt},Je=function(tt,rt,ot){var it=tt.name,nt=it.length;for(Ke.lastIndex=0;;){var st=Ke.exec(it),lt=Ke.lastIndex,dt=st[1],ct=']'===st[2],ut=st[3];if(ct&&(dt|=0),void 0===ut||'['===ut&&lt+2===nt){Qe(ot,void 0===ut?new qe(dt,tt,rt):new Ye(dt,tt,rt));break}else{var mt=ot.map,gt=mt[dt];void 0===gt&&(gt=new Ze(dt),Qe(ot,gt)),ot=gt}}},$e=function(tt,rt,ot){ge.call(this),this.renderer=ot;for(var it=tt.getProgramParameter(rt,tt.ACTIVE_UNIFORMS),nt=0;nt!==it;++nt){var st=tt.getActiveUniform(rt,nt),lt=st.name,dt=tt.getUniformLocation(rt,lt);Je(st,dt,this)}};return $e.prototype.setValue=function(et,tt,rt){var ot=this.map[tt];void 0!==ot&&ot.setValue(et,rt,this.renderer)},$e.prototype.set=function(et,tt,rt){var ot=this.map[rt];void 0!==ot&&ot.setValue(et,tt[rt],this.renderer)},$e.prototype.setOptional=function(et,tt,rt){var ot=tt[rt];void 0!==ot&&this.setValue(et,rt,ot)},$e.upload=function(et,tt,rt,ot){for(var it=0,nt=tt.length;it!==nt;++it){var st=tt[it],lt=rt[st.id];!1!==lt.needsUpdate&&st.setValue(et,lt.value,ot)}},$e.seqWithValue=function(et,tt){for(var rt=[],ot=0,it=et.length,nt;ot!==it;++ot)nt=et[ot],nt.id in tt&&rt.push(nt);return rt},$e.splitDynamic=function(et,tt){for(var rt=null,ot=et.length,it=0,nt=0;nt!==ot;++nt){var st=et[nt],lt=tt[st.id];lt&&!0===lt.dynamic?(null==rt&&(rt=[]),rt.push(st)):(it<nt&&(et[it]=st),++it)}return it<ot&&(et.length=it),rt},$e.evalDynamic=function(et,tt,rt,ot){for(var it=0,nt=et.length;it!==nt;++it){var st=tt[et[it].id],lt=st.onUpdateCallback;void 0!==lt&&lt.call(st,rt,ot)}},$e}(),pe.LensFlarePlugin=function(ue,fe){function ge(){var Re=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),Ce=new Uint16Array([0,1,2,0,2,3]);_e=ye.createBuffer(),ve=ye.createBuffer(),ye.bindBuffer(ye.ARRAY_BUFFER,_e),ye.bufferData(ye.ARRAY_BUFFER,Re,ye.STATIC_DRAW),ye.bindBuffer(ye.ELEMENT_ARRAY_BUFFER,ve),ye.bufferData(ye.ELEMENT_ARRAY_BUFFER,Ce,ye.STATIC_DRAW),Ae=ye.createTexture(),Le=ye.createTexture(),xe.bindTexture(ye.TEXTURE_2D,Ae),ye.texImage2D(ye.TEXTURE_2D,0,ye.RGB,16,16,0,ye.RGB,ye.UNSIGNED_BYTE,null),ye.texParameteri(ye.TEXTURE_2D,ye.TEXTURE_WRAP_S,ye.CLAMP_TO_EDGE),ye.texParameteri(ye.TEXTURE_2D,ye.TEXTURE_WRAP_T,ye.CLAMP_TO_EDGE),ye.texParameteri(ye.TEXTURE_2D,ye.TEXTURE_MAG_FILTER,ye.NEAREST),ye.texParameteri(ye.TEXTURE_2D,ye.TEXTURE_MIN_FILTER,ye.NEAREST),xe.bindTexture(ye.TEXTURE_2D,Le),ye.texImage2D(ye.TEXTURE_2D,0,ye.RGBA,16,16,0,ye.RGBA,ye.UNSIGNED_BYTE,null),ye.texParameteri(ye.TEXTURE_2D,ye.TEXTURE_WRAP_S,ye.CLAMP_TO_EDGE),ye.texParameteri(ye.TEXTURE_2D,ye.TEXTURE_WRAP_T,ye.CLAMP_TO_EDGE),ye.texParameteri(ye.TEXTURE_2D,ye.TEXTURE_MAG_FILTER,ye.NEAREST),ye.texParameteri(ye.TEXTURE_2D,ye.TEXTURE_MIN_FILTER,ye.NEAREST),Ee={vertexShader:['uniform lowp int renderType;','uniform vec3 screenPosition;','uniform vec2 scale;','uniform float rotation;','uniform sampler2D occlusionMap;','attribute vec2 position;','attribute vec2 uv;','varying vec2 vUV;','varying float vVisibility;','void main() {','vUV = uv;','vec2 pos = position;','if ( renderType == 2 ) {','vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );','visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );','visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );','visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );','visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );','visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );','visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );','visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );','visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );','vVisibility =        visibility.r / 9.0;','vVisibility *= 1.0 - visibility.g / 9.0;','vVisibility *=       visibility.b / 9.0;','vVisibility *= 1.0 - visibility.a / 9.0;','pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;','pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;','}','gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );','}'].join('\n'),fragmentShader:['uniform lowp int renderType;','uniform sampler2D map;','uniform float opacity;','uniform vec3 color;','varying vec2 vUV;','varying float vVisibility;','void main() {','if ( renderType == 0 ) {','gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );','} else if ( renderType == 1 ) {','gl_FragColor = texture2D( map, vUV );','} else {','vec4 texture = texture2D( map, vUV );','texture.a *= opacity * vVisibility;','gl_FragColor = texture;','gl_FragColor.rgb *= color;','}','}'].join('\n')},Te=he(Ee),Se={vertex:ye.getAttribLocation(Te,'position'),uv:ye.getAttribLocation(Te,'uv')},Me={renderType:ye.getUniformLocation(Te,'renderType'),map:ye.getUniformLocation(Te,'map'),occlusionMap:ye.getUniformLocation(Te,'occlusionMap'),opacity:ye.getUniformLocation(Te,'opacity'),color:ye.getUniformLocation(Te,'color'),scale:ye.getUniformLocation(Te,'scale'),rotation:ye.getUniformLocation(Te,'rotation'),screenPosition:ye.getUniformLocation(Te,'screenPosition')}}function he(Re){var Ce=ye.createProgram(),we=ye.createShader(ye.FRAGMENT_SHADER),Pe=ye.createShader(ye.VERTEX_SHADER),Fe='precision '+ue.getPrecision()+' float;\n';return ye.shaderSource(we,Fe+Re.fragmentShader),ye.shaderSource(Pe,Fe+Re.vertexShader),ye.compileShader(we),ye.compileShader(Pe),ye.attachShader(Ce,we),ye.attachShader(Ce,Pe),ye.linkProgram(Ce),Ce}var ye=ue.context,xe=ue.state,_e,ve,Ee,Te,Se,Me,Ae,Le;this.render=function(Re,Ce,we){if(0!==fe.length){var Pe=new pe.Vector3,Fe=we.w/we.z,De=0.5*we.z,Ie=0.5*we.w,Be=16/we.w,Ue=new pe.Vector2(Be*Fe,Be),Ne=new pe.Vector3(1,1,0),Ge=new pe.Vector2(1,1),Ve=new pe.Box2;Ve.min.set(0,0),Ve.max.set(we.z-16,we.w-16),void 0===Te&&ge(),ye.useProgram(Te),xe.initAttributes(),xe.enableAttribute(Se.vertex),xe.enableAttribute(Se.uv),xe.disableUnusedAttributes(),ye.uniform1i(Me.occlusionMap,0),ye.uniform1i(Me.map,1),ye.bindBuffer(ye.ARRAY_BUFFER,_e),ye.vertexAttribPointer(Se.vertex,2,ye.FLOAT,!1,16,0),ye.vertexAttribPointer(Se.uv,2,ye.FLOAT,!1,16,8),ye.bindBuffer(ye.ELEMENT_ARRAY_BUFFER,ve),xe.disable(ye.CULL_FACE),xe.setDepthWrite(!1);for(var ze=0,Oe=fe.length;ze<Oe;ze++){Be=16/we.w,Ue.set(Be*Fe,Be);var ke=fe[ze];if(Pe.set(ke.matrixWorld.elements[12],ke.matrixWorld.elements[13],ke.matrixWorld.elements[14]),Pe.applyMatrix4(Ce.matrixWorldInverse),Pe.applyProjection(Ce.projectionMatrix),Ne.copy(Pe),Ge.x=we.x+Ne.x*De+De-8,Ge.y=we.y+Ne.y*Ie+Ie-8,!0===Ve.containsPoint(Ge)){xe.activeTexture(ye.TEXTURE0),xe.bindTexture(ye.TEXTURE_2D,null),xe.activeTexture(ye.TEXTURE1),xe.bindTexture(ye.TEXTURE_2D,Ae),ye.copyTexImage2D(ye.TEXTURE_2D,0,ye.RGB,Ge.x,Ge.y,16,16,0),ye.uniform1i(Me.renderType,0),ye.uniform2f(Me.scale,Ue.x,Ue.y),ye.uniform3f(Me.screenPosition,Ne.x,Ne.y,Ne.z),xe.disable(ye.BLEND),xe.enable(ye.DEPTH_TEST),ye.drawElements(ye.TRIANGLES,6,ye.UNSIGNED_SHORT,0),xe.activeTexture(ye.TEXTURE0),xe.bindTexture(ye.TEXTURE_2D,Le),ye.copyTexImage2D(ye.TEXTURE_2D,0,ye.RGBA,Ge.x,Ge.y,16,16,0),ye.uniform1i(Me.renderType,1),xe.disable(ye.DEPTH_TEST),xe.activeTexture(ye.TEXTURE1),xe.bindTexture(ye.TEXTURE_2D,Ae),ye.drawElements(ye.TRIANGLES,6,ye.UNSIGNED_SHORT,0),ke.positionScreen.copy(Ne),ke.customUpdateCallback?ke.customUpdateCallback(ke):ke.updateLensFlares(),ye.uniform1i(Me.renderType,2),xe.enable(ye.BLEND);for(var He=0,We=ke.lensFlares.length,je;He<We;He++)je=ke.lensFlares[He],1e-3<je.opacity&&1e-3<je.scale&&(Ne.x=je.x,Ne.y=je.y,Ne.z=je.z,Be=je.size*je.scale/we.w,Ue.x=Be*Fe,Ue.y=Be,ye.uniform3f(Me.screenPosition,Ne.x,Ne.y,Ne.z),ye.uniform2f(Me.scale,Ue.x,Ue.y),ye.uniform1f(Me.rotation,je.rotation),ye.uniform1f(Me.opacity,je.opacity),ye.uniform3f(Me.color,je.color.r,je.color.g,je.color.b),xe.setBlending(je.blending,je.blendEquation,je.blendSrc,je.blendDst),ue.setTexture2D(je.texture,1),ye.drawElements(ye.TRIANGLES,6,ye.UNSIGNED_SHORT,0))}}xe.enable(ye.CULL_FACE),xe.enable(ye.DEPTH_TEST),xe.setDepthWrite(!0),ue.resetGLState()}}},pe.SpritePlugin=function(ue,fe){function ge(){var we=new Float32Array([-0.5,-0.5,0,0,0.5,-0.5,1,0,0.5,0.5,1,1,-0.5,0.5,0,1]),Pe=new Uint16Array([0,1,2,0,2,3]);ve=xe.createBuffer(),Ee=xe.createBuffer(),xe.bindBuffer(xe.ARRAY_BUFFER,ve),xe.bufferData(xe.ARRAY_BUFFER,we,xe.STATIC_DRAW),xe.bindBuffer(xe.ELEMENT_ARRAY_BUFFER,Ee),xe.bufferData(xe.ELEMENT_ARRAY_BUFFER,Pe,xe.STATIC_DRAW),Te=he(),Se={position:xe.getAttribLocation(Te,'position'),uv:xe.getAttribLocation(Te,'uv')},Me={uvOffset:xe.getUniformLocation(Te,'uvOffset'),uvScale:xe.getUniformLocation(Te,'uvScale'),rotation:xe.getUniformLocation(Te,'rotation'),scale:xe.getUniformLocation(Te,'scale'),color:xe.getUniformLocation(Te,'color'),map:xe.getUniformLocation(Te,'map'),opacity:xe.getUniformLocation(Te,'opacity'),modelViewMatrix:xe.getUniformLocation(Te,'modelViewMatrix'),projectionMatrix:xe.getUniformLocation(Te,'projectionMatrix'),fogType:xe.getUniformLocation(Te,'fogType'),fogDensity:xe.getUniformLocation(Te,'fogDensity'),fogNear:xe.getUniformLocation(Te,'fogNear'),fogFar:xe.getUniformLocation(Te,'fogFar'),fogColor:xe.getUniformLocation(Te,'fogColor'),alphaTest:xe.getUniformLocation(Te,'alphaTest')};var Fe=document.createElementNS('http://www.w3.org/1999/xhtml','canvas');Fe.width=8,Fe.height=8;var De=Fe.getContext('2d');De.fillStyle='white',De.fillRect(0,0,8,8),Ae=new pe.Texture(Fe),Ae.needsUpdate=!0}function he(){var we=xe.createProgram(),Pe=xe.createShader(xe.VERTEX_SHADER),Fe=xe.createShader(xe.FRAGMENT_SHADER);return xe.shaderSource(Pe,['precision '+ue.getPrecision()+' float;','uniform mat4 modelViewMatrix;','uniform mat4 projectionMatrix;','uniform float rotation;','uniform vec2 scale;','uniform vec2 uvOffset;','uniform vec2 uvScale;','attribute vec2 position;','attribute vec2 uv;','varying vec2 vUV;','void main() {','vUV = uvOffset + uv * uvScale;','vec2 alignedPosition = position * scale;','vec2 rotatedPosition;','rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;','rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;','vec4 finalPosition;','finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );','finalPosition.xy += rotatedPosition;','finalPosition = projectionMatrix * finalPosition;','gl_Position = finalPosition;','}'].join('\n')),xe.shaderSource(Fe,['precision '+ue.getPrecision()+' float;','uniform vec3 color;','uniform sampler2D map;','uniform float opacity;','uniform int fogType;','uniform vec3 fogColor;','uniform float fogDensity;','uniform float fogNear;','uniform float fogFar;','uniform float alphaTest;','varying vec2 vUV;','void main() {','vec4 texture = texture2D( map, vUV );','if ( texture.a < alphaTest ) discard;','gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );','if ( fogType > 0 ) {','float depth = gl_FragCoord.z / gl_FragCoord.w;','float fogFactor = 0.0;','if ( fogType == 1 ) {','fogFactor = smoothstep( fogNear, fogFar, depth );','} else {','const float LOG2 = 1.442695;','fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );','fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );','}','gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );','}','}'].join('\n')),xe.compileShader(Pe),xe.compileShader(Fe),xe.attachShader(we,Pe),xe.attachShader(we,Fe),xe.linkProgram(we),we}function ye(we,Pe){return we.renderOrder===Pe.renderOrder?we.z===Pe.z?Pe.id-we.id:Pe.z-we.z:we.renderOrder-Pe.renderOrder}var xe=ue.context,_e=ue.state,ve,Ee,Te,Se,Me,Ae,Le=new pe.Vector3,Re=new pe.Quaternion,Ce=new pe.Vector3;this.render=function(we,Pe){if(0!==fe.length){void 0===Te&&ge(),xe.useProgram(Te),_e.initAttributes(),_e.enableAttribute(Se.position),_e.enableAttribute(Se.uv),_e.disableUnusedAttributes(),_e.disable(xe.CULL_FACE),_e.enable(xe.BLEND),xe.bindBuffer(xe.ARRAY_BUFFER,ve),xe.vertexAttribPointer(Se.position,2,xe.FLOAT,!1,16,0),xe.vertexAttribPointer(Se.uv,2,xe.FLOAT,!1,16,8),xe.bindBuffer(xe.ELEMENT_ARRAY_BUFFER,Ee),xe.uniformMatrix4fv(Me.projectionMatrix,!1,Pe.projectionMatrix.elements),_e.activeTexture(xe.TEXTURE0),xe.uniform1i(Me.map,0);var Fe=0,De=0,Ie=we.fog;Ie?(xe.uniform3f(Me.fogColor,Ie.color.r,Ie.color.g,Ie.color.b),Ie instanceof pe.Fog?(xe.uniform1f(Me.fogNear,Ie.near),xe.uniform1f(Me.fogFar,Ie.far),xe.uniform1i(Me.fogType,1),Fe=1,De=1):Ie instanceof pe.FogExp2&&(xe.uniform1f(Me.fogDensity,Ie.density),xe.uniform1i(Me.fogType,2),Fe=2,De=2)):(xe.uniform1i(Me.fogType,0),Fe=0,De=0);for(var Be=0,Ue=fe.length,Ne;Be<Ue;Be++)Ne=fe[Be],Ne.modelViewMatrix.multiplyMatrices(Pe.matrixWorldInverse,Ne.matrixWorld),Ne.z=-Ne.modelViewMatrix.elements[14];fe.sort(ye);for(var Ge=[],Be=0,Ue=fe.length;Be<Ue;Be++){var Ne=fe[Be],Ve=Ne.material;xe.uniform1f(Me.alphaTest,Ve.alphaTest),xe.uniformMatrix4fv(Me.modelViewMatrix,!1,Ne.modelViewMatrix.elements),Ne.matrixWorld.decompose(Le,Re,Ce),Ge[0]=Ce.x,Ge[1]=Ce.y;var ze=0;we.fog&&Ve.fog&&(ze=De),Fe!=ze&&(xe.uniform1i(Me.fogType,ze),Fe=ze),null===Ve.map?(xe.uniform2f(Me.uvOffset,0,0),xe.uniform2f(Me.uvScale,1,1)):(xe.uniform2f(Me.uvOffset,Ve.map.offset.x,Ve.map.offset.y),xe.uniform2f(Me.uvScale,Ve.map.repeat.x,Ve.map.repeat.y)),xe.uniform1f(Me.opacity,Ve.opacity),xe.uniform3f(Me.color,Ve.color.r,Ve.color.g,Ve.color.b),xe.uniform1f(Me.rotation,Ve.rotation),xe.uniform2fv(Me.scale,Ge),_e.setBlending(Ve.blending,Ve.blendEquation,Ve.blendSrc,Ve.blendDst),_e.setDepthTest(Ve.depthTest),_e.setDepthWrite(Ve.depthWrite),Ve.map?ue.setTexture2D(Ve.map,0):ue.setTexture2D(Ae,0),xe.drawElements(xe.TRIANGLES,6,xe.UNSIGNED_SHORT,0)}_e.enable(xe.CULL_FACE),ue.resetGLState()}}},le(pe,{Face4:function(fe,ge,he,ye,xe,_e,ve){return console.warn('THREE.Face4 has been removed. A THREE.Face3 will be created instead.'),new pe.Face3(fe,ge,he,xe,_e,ve)},LineStrip:0,LinePieces:1,MeshFaceMaterial:pe.MultiMaterial,PointCloud:function(fe,ge){return console.warn('THREE.PointCloud has been renamed to THREE.Points.'),new pe.Points(fe,ge)},Particle:pe.Sprite,ParticleSystem:function(fe,ge){return console.warn('THREE.ParticleSystem has been renamed to THREE.Points.'),new pe.Points(fe,ge)},PointCloudMaterial:function(fe){return console.warn('THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.'),new pe.PointsMaterial(fe)},ParticleBasicMaterial:function(fe){return console.warn('THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.'),new pe.PointsMaterial(fe)},ParticleSystemMaterial:function(fe){return console.warn('THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.'),new pe.PointsMaterial(fe)},Vertex:function(fe,ge,he){return console.warn('THREE.Vertex has been removed. Use THREE.Vector3 instead.'),new pe.Vector3(fe,ge,he)}}),le(pe.Box2.prototype,{empty:function(){return console.warn('THREE.Box2: .empty() has been renamed to .isEmpty().'),this.isEmpty()},isIntersectionBox:function(fe){return console.warn('THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().'),this.intersectsBox(fe)}}),le(pe.Box3.prototype,{empty:function(){return console.warn('THREE.Box3: .empty() has been renamed to .isEmpty().'),this.isEmpty()},isIntersectionBox:function(fe){return console.warn('THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().'),this.intersectsBox(fe)},isIntersectionSphere:function(fe){return console.warn('THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().'),this.intersectsSphere(fe)}}),le(pe.Matrix3.prototype,{multiplyVector3:function(fe){return console.warn('THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.'),fe.applyMatrix3(this)},multiplyVector3Array:function(fe){return console.warn('THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.'),this.applyToVector3Array(fe)}}),le(pe.Matrix4.prototype,{extractPosition:function(fe){return console.warn('THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().'),this.copyPosition(fe)},setRotationFromQuaternion:function(fe){return console.warn('THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().'),this.makeRotationFromQuaternion(fe)},multiplyVector3:function(fe){return console.warn('THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.'),fe.applyProjection(this)},multiplyVector4:function(fe){return console.warn('THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.'),fe.applyMatrix4(this)},multiplyVector3Array:function(fe){return console.warn('THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.'),this.applyToVector3Array(fe)},rotateAxis:function(fe){console.warn('THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.'),fe.transformDirection(this)},crossVector:function(fe){return console.warn('THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.'),fe.applyMatrix4(this)},translate:function(){console.error('THREE.Matrix4: .translate() has been removed.')},rotateX:function(){console.error('THREE.Matrix4: .rotateX() has been removed.')},rotateY:function(){console.error('THREE.Matrix4: .rotateY() has been removed.')},rotateZ:function(){console.error('THREE.Matrix4: .rotateZ() has been removed.')},rotateByAxis:function(){console.error('THREE.Matrix4: .rotateByAxis() has been removed.')}}),le(pe.Plane.prototype,{isIntersectionLine:function(fe){return console.warn('THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().'),this.intersectsLine(fe)}}),le(pe.Quaternion.prototype,{multiplyVector3:function(fe){return console.warn('THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.'),fe.applyQuaternion(this)}}),le(pe.Ray.prototype,{isIntersectionBox:function(fe){return console.warn('THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().'),this.intersectsBox(fe)},isIntersectionPlane:function(fe){return console.warn('THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().'),this.intersectsPlane(fe)},isIntersectionSphere:function(fe){return console.warn('THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().'),this.intersectsSphere(fe)}}),le(pe.Vector3.prototype,{setEulerFromRotationMatrix:function(){console.error('THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.')},setEulerFromQuaternion:function(){console.error('THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.')},getPositionFromMatrix:function(fe){return console.warn('THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().'),this.setFromMatrixPosition(fe)},getScaleFromMatrix:function(fe){return console.warn('THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().'),this.setFromMatrixScale(fe)},getColumnFromMatrix:function(fe,ge){return console.warn('THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().'),this.setFromMatrixColumn(ge,fe)}}),le(pe.Object3D.prototype,{getChildByName:function(fe){return console.warn('THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().'),this.getObjectByName(fe)},renderDepth:function(){console.warn('THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.')},translate:function(fe,ge){return console.warn('THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.'),this.translateOnAxis(ge,fe)}}),Object.defineProperties(pe.Object3D.prototype,{eulerOrder:{get:function(){return console.warn('THREE.Object3D: .eulerOrder is now .rotation.order.'),this.rotation.order},set:function(fe){console.warn('THREE.Object3D: .eulerOrder is now .rotation.order.'),this.rotation.order=fe}},useQuaternion:{get:function(){console.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.')},set:function(){console.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.')}}}),Object.defineProperties(pe.LOD.prototype,{objects:{get:function(){return console.warn('THREE.LOD: .objects has been renamed to .levels.'),this.levels}}}),pe.PerspectiveCamera.prototype.setLens=function(ue,fe){console.warn('THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.'),fe!==void 0&&(this.filmGauge=fe),this.setFocalLength(ue)},Object.defineProperties(pe.Light.prototype,{onlyShadow:{set:function(){console.warn('THREE.Light: .onlyShadow has been removed.')}},shadowCameraFov:{set:function(fe){console.warn('THREE.Light: .shadowCameraFov is now .shadow.camera.fov.'),this.shadow.camera.fov=fe}},shadowCameraLeft:{set:function(fe){console.warn('THREE.Light: .shadowCameraLeft is now .shadow.camera.left.'),this.shadow.camera.left=fe}},shadowCameraRight:{set:function(fe){console.warn('THREE.Light: .shadowCameraRight is now .shadow.camera.right.'),this.shadow.camera.right=fe}},shadowCameraTop:{set:function(fe){console.warn('THREE.Light: .shadowCameraTop is now .shadow.camera.top.'),this.shadow.camera.top=fe}},shadowCameraBottom:{set:function(fe){console.warn('THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.'),this.shadow.camera.bottom=fe}},shadowCameraNear:{set:function(fe){console.warn('THREE.Light: .shadowCameraNear is now .shadow.camera.near.'),this.shadow.camera.near=fe}},shadowCameraFar:{set:function(fe){console.warn('THREE.Light: .shadowCameraFar is now .shadow.camera.far.'),this.shadow.camera.far=fe}},shadowCameraVisible:{set:function(){console.warn('THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.')}},shadowBias:{set:function(fe){console.warn('THREE.Light: .shadowBias is now .shadow.bias.'),this.shadow.bias=fe}},shadowDarkness:{set:function(){console.warn('THREE.Light: .shadowDarkness has been removed.')}},shadowMapWidth:{set:function(fe){console.warn('THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.'),this.shadow.mapSize.width=fe}},shadowMapHeight:{set:function(fe){console.warn('THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.'),this.shadow.mapSize.height=fe}}}),Object.defineProperties(pe.BufferAttribute.prototype,{length:{get:function(){return console.warn('THREE.BufferAttribute: .length has been deprecated. Please use .count.'),this.array.length}}}),le(pe.BufferGeometry.prototype,{addIndex:function(fe){console.warn('THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().'),this.setIndex(fe)},addDrawCall:function(fe,ge,he){he!==void 0&&console.warn('THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.'),console.warn('THREE.BufferGeometry: .addDrawCall() is now .addGroup().'),this.addGroup(fe,ge)},clearDrawCalls:function(){console.warn('THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().'),this.clearGroups()},computeTangents:function(){console.warn('THREE.BufferGeometry: .computeTangents() has been removed.')},computeOffsets:function(){console.warn('THREE.BufferGeometry: .computeOffsets() has been removed.')}}),Object.defineProperties(pe.BufferGeometry.prototype,{drawcalls:{get:function(){return console.error('THREE.BufferGeometry: .drawcalls has been renamed to .groups.'),this.groups}},offsets:{get:function(){return console.warn('THREE.BufferGeometry: .offsets has been renamed to .groups.'),this.groups}}}),Object.defineProperties(pe.Material.prototype,{wrapAround:{get:function(){console.warn('THREE.'+this.type+': .wrapAround has been removed.')},set:function(){console.warn('THREE.'+this.type+': .wrapAround has been removed.')}},wrapRGB:{get:function(){return console.warn('THREE.'+this.type+': .wrapRGB has been removed.'),new pe.Color}}}),Object.defineProperties(pe.MeshPhongMaterial.prototype,{metal:{get:function(){return console.warn('THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.'),!1},set:function(){console.warn('THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead')}}}),Object.defineProperties(pe.ShaderMaterial.prototype,{derivatives:{get:function(){return console.warn('THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.'),this.extensions.derivatives},set:function(fe){console.warn('THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.'),this.extensions.derivatives=fe}}}),pe.EventDispatcher.prototype=le(Object.create({constructor:pe.EventDispatcher,apply:function(fe){console.warn('THREE.EventDispatcher: .apply is deprecated, just inherit or Object.assign the prototype to mix-in.'),le(fe,this)}}),pe.EventDispatcher.prototype),le(pe.WebGLRenderer.prototype,{supportsFloatTextures:function(){return console.warn('THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( \'OES_texture_float\' ).'),this.extensions.get('OES_texture_float')},supportsHalfFloatTextures:function(){return console.warn('THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( \'OES_texture_half_float\' ).'),this.extensions.get('OES_texture_half_float')},supportsStandardDerivatives:function(){return console.warn('THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( \'OES_standard_derivatives\' ).'),this.extensions.get('OES_standard_derivatives')},supportsCompressedTextureS3TC:function(){return console.warn('THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( \'WEBGL_compressed_texture_s3tc\' ).'),this.extensions.get('WEBGL_compressed_texture_s3tc')},supportsCompressedTexturePVRTC:function(){return console.warn('THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( \'WEBGL_compressed_texture_pvrtc\' ).'),this.extensions.get('WEBGL_compressed_texture_pvrtc')},supportsBlendMinMax:function(){return console.warn('THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( \'EXT_blend_minmax\' ).'),this.extensions.get('EXT_blend_minmax')},supportsVertexTextures:function(){return this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn('THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( \'ANGLE_instanced_arrays\' ).'),this.extensions.get('ANGLE_instanced_arrays')},enableScissorTest:function(fe){console.warn('THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().'),this.setScissorTest(fe)},initMaterial:function(){console.warn('THREE.WebGLRenderer: .initMaterial() has been removed.')},addPrePlugin:function(){console.warn('THREE.WebGLRenderer: .addPrePlugin() has been removed.')},addPostPlugin:function(){console.warn('THREE.WebGLRenderer: .addPostPlugin() has been removed.')},updateShadowMap:function(){console.warn('THREE.WebGLRenderer: .updateShadowMap() has been removed.')}}),Object.defineProperties(pe.WebGLRenderer.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(fe){console.warn('THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.'),this.shadowMap.enabled=fe}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(fe){console.warn('THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.'),this.shadowMap.type=fe}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(fe){console.warn('THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace.'),this.shadowMap.cullFace=fe}}}),Object.defineProperties(pe.WebGLShadowMap.prototype,{cullFace:{get:function(){return this.renderReverseSided?pe.CullFaceFront:pe.CullFaceBack},set:function(fe){var ge=fe!==pe.CullFaceBack;console.warn('WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to '+ge+'.'),this.renderReverseSided=ge}}}),Object.defineProperties(pe.WebGLRenderTarget.prototype,{wrapS:{get:function(){return console.warn('THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.'),this.texture.wrapS},set:function(fe){console.warn('THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.'),this.texture.wrapS=fe}},wrapT:{get:function(){return console.warn('THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.'),this.texture.wrapT},set:function(fe){console.warn('THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.'),this.texture.wrapT=fe}},magFilter:{get:function(){return console.warn('THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.'),this.texture.magFilter},set:function(fe){console.warn('THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.'),this.texture.magFilter=fe}},minFilter:{get:function(){return console.warn('THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.'),this.texture.minFilter},set:function(fe){console.warn('THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.'),this.texture.minFilter=fe}},anisotropy:{get:function(){return console.warn('THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.'),this.texture.anisotropy},set:function(fe){console.warn('THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.'),this.texture.anisotropy=fe}},offset:{get:function(){return console.warn('THREE.WebGLRenderTarget: .offset is now .texture.offset.'),this.texture.offset},set:function(fe){console.warn('THREE.WebGLRenderTarget: .offset is now .texture.offset.'),this.texture.offset=fe}},repeat:{get:function(){return console.warn('THREE.WebGLRenderTarget: .repeat is now .texture.repeat.'),this.texture.repeat},set:function(fe){console.warn('THREE.WebGLRenderTarget: .repeat is now .texture.repeat.'),this.texture.repeat=fe}},format:{get:function(){return console.warn('THREE.WebGLRenderTarget: .format is now .texture.format.'),this.texture.format},set:function(fe){console.warn('THREE.WebGLRenderTarget: .format is now .texture.format.'),this.texture.format=fe}},type:{get:function(){return console.warn('THREE.WebGLRenderTarget: .type is now .texture.type.'),this.texture.type},set:function(fe){console.warn('THREE.WebGLRenderTarget: .type is now .texture.type.'),this.texture.type=fe}},generateMipmaps:{get:function(){return console.warn('THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.'),this.texture.generateMipmaps},set:function(fe){console.warn('THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.'),this.texture.generateMipmaps=fe}}}),le(pe.Audio.prototype,{load:function(fe){console.warn('THREE.Audio: .load has been deprecated. Please use THREE.AudioLoader.');var ge=this,he=new pe.AudioLoader;return he.load(fe,function(ye){ge.setBuffer(ye)}),this}}),le(pe.AudioAnalyser.prototype,{getData:function(){return console.warn('THREE.AudioAnalyser: .getData() is now .getFrequencyData().'),this.getFrequencyData()}}),pe.GeometryUtils={merge:function(fe,ge,he){console.warn('THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.');var ye;ge instanceof pe.Mesh&&(ge.matrixAutoUpdate&&ge.updateMatrix(),ye=ge.matrix,ge=ge.geometry),fe.merge(ge,ye,he)},center:function(fe){return console.warn('THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.'),fe.center()}},pe.ImageUtils={crossOrigin:void 0,loadTexture:function(fe,ge,he,ye){console.warn('THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.');var xe=new pe.TextureLoader;xe.setCrossOrigin(this.crossOrigin);var _e=xe.load(fe,he,void 0,ye);return ge&&(_e.mapping=ge),_e},loadTextureCube:function(fe,ge,he,ye){console.warn('THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.');var xe=new pe.CubeTextureLoader;xe.setCrossOrigin(this.crossOrigin);var _e=xe.load(fe,he,void 0,ye);return ge&&(_e.mapping=ge),_e},loadCompressedTexture:function(){console.error('THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.')},loadCompressedTextureCube:function(){console.error('THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.')}},pe.Projector=function(){console.error('THREE.Projector has been moved to /examples/js/renderers/Projector.js.'),this.projectVector=function(ue,fe){console.warn('THREE.Projector: .projectVector() is now vector.project().'),ue.project(fe)},this.unprojectVector=function(ue,fe){console.warn('THREE.Projector: .unprojectVector() is now vector.unproject().'),ue.unproject(fe)},this.pickingRay=function(){console.error('THREE.Projector: .pickingRay() is now raycaster.setFromCamera().')}},pe.CanvasRenderer=function(){console.error('THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js'),this.domElement=document.createElementNS('http://www.w3.org/1999/xhtml','canvas'),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},pe.CurveUtils={tangentQuadraticBezier:function(fe,ge,he,ye){return 2*(1-fe)*(he-ge)+2*fe*(ye-he)},tangentCubicBezier:function(fe,ge,he,ye,xe){return-3*ge*(1-fe)*(1-fe)+3*he*(1-fe)*(1-fe)-6*fe*he*(1-fe)+6*fe*ye*(1-fe)-3*fe*fe*ye+3*fe*fe*xe},tangentSpline:function(fe){return 6*fe*fe-6*fe+(3*fe*fe-4*fe+1)+(-6*fe*fe+6*fe)+(3*fe*fe-2*fe)},interpolate:function(fe,ge,he,ye,xe){var _e=0.5*(he-fe),ve=0.5*(ye-ge),Ee=xe*xe;return(2*ge-2*he+_e+ve)*(xe*Ee)+(-3*ge+3*he-2*_e-ve)*Ee+_e*xe+ge}},pe.SceneUtils={createMultiMaterialObject:function(fe,ge){for(var he=new pe.Group,ye=0,xe=ge.length;ye<xe;ye++)he.add(new pe.Mesh(fe,ge[ye]));return he},detach:function(fe,ge,he){fe.applyMatrix(ge.matrixWorld),ge.remove(fe),he.add(fe)},attach:function(fe,ge,he){var ye=new pe.Matrix4;ye.getInverse(he.matrixWorld),fe.applyMatrix(ye),ge.remove(fe),he.add(fe)}},pe.ShapeUtils={area:function(fe){for(var ge=fe.length,he=0,ye=ge-1,xe=0;xe<ge;ye=xe++)he+=fe[ye].x*fe[xe].y-fe[xe].x*fe[ye].y;return 0.5*he},triangulate:function(){function ue(fe,ge,he,ye,xe,_e){var ve,Ee,Te,Se,Me,Ae,Le,Re,Ce;if(Ee=fe[_e[ge]].x,Te=fe[_e[ge]].y,Se=fe[_e[he]].x,Me=fe[_e[he]].y,Ae=fe[_e[ye]].x,Le=fe[_e[ye]].y,Number.EPSILON>(Se-Ee)*(Le-Te)-(Me-Te)*(Ae-Ee))return!1;var we,Pe,Fe,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe,ke,He,We;for(we=Ae-Se,Pe=Le-Me,Fe=Ee-Ae,De=Te-Le,Ie=Se-Ee,Be=Me-Te,ve=0;ve<xe;ve++)if(Re=fe[_e[ve]].x,Ce=fe[_e[ve]].y,(Re!==Ee||Ce!==Te)&&(Re!==Se||Ce!==Me)&&(Re!==Ae||Ce!==Le)&&(Ue=Re-Ee,Ne=Ce-Te,Ge=Re-Se,Ve=Ce-Me,ze=Re-Ae,Oe=Ce-Le,We=we*Ve-Pe*Ge,ke=Ie*Ne-Be*Ue,He=Fe*Oe-De*ze,We>=-Number.EPSILON&&He>=-Number.EPSILON&&ke>=-Number.EPSILON))return!1;return!0}return function(ge,he){var ye=ge.length;if(3>ye)return null;var xe=[],_e=[],ve=[],Ee,Te,Se;if(0<pe.ShapeUtils.area(ge))for(Te=0;Te<ye;Te++)_e[Te]=Te;else for(Te=0;Te<ye;Te++)_e[Te]=ye-1-Te;var Me=ye,Ae=2*Me;for(Te=Me-1;2<Me;){if(0>=Ae--)return console.warn('THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()'),he?ve:xe;if(Ee=Te,Me<=Ee&&(Ee=0),Te=Ee+1,Me<=Te&&(Te=0),Se=Te+1,Me<=Se&&(Se=0),ue(ge,Ee,Te,Se,Me,_e)){var Le,Re,Ce,we,Pe;for(Le=_e[Ee],Re=_e[Te],Ce=_e[Se],xe.push([ge[Le],ge[Re],ge[Ce]]),ve.push([_e[Ee],_e[Te],_e[Se]]),(we=Te,Pe=Te+1);Pe<Me;we++,Pe++)_e[we]=_e[Pe];Me--,Ae=2*Me}}return he?ve:xe}}(),triangulateShape:function(fe,ge){function he(De,Ie,Be){return De.x===Ie.x?De.y<Ie.y?De.y<=Be.y&&Be.y<=Ie.y:Ie.y<=Be.y&&Be.y<=De.y:De.x<Ie.x?De.x<=Be.x&&Be.x<=Ie.x:Ie.x<=Be.x&&Be.x<=De.x}function ye(De,Ie,Be,Ue,Ne){var Ge=Ie.x-De.x,Ve=Ie.y-De.y,ze=Ue.x-Be.x,Oe=Ue.y-Be.y,ke=De.x-Be.x,He=De.y-Be.y,We=Ve*ze-Ge*Oe,je=Ve*ke-Ge*He;if(Math.abs(We)>Number.EPSILON){var Xe;if(0<We){if(0>je||je>We)return[];if(Xe=Oe*ke-ze*He,0>Xe||Xe>We)return[]}else{if(0<je||je<We)return[];if(Xe=Oe*ke-ze*He,0<Xe||Xe<We)return[]}if(0===Xe)return Ne&&(0==je||je==We)?[]:[De];if(Xe===We)return Ne&&(0==je||je==We)?[]:[Ie];if(0==je)return[Be];if(je==We)return[Ue];var qe=Xe/We;return[{x:De.x+qe*Ge,y:De.y+qe*Ve}]}if(0!=je||Oe*ke!=ze*He)return[];var Ye=0==Ge&&0==Ve,Ze=0==ze&&0==Oe;if(Ye&&Ze)return De.x!==Be.x||De.y!==Be.y?[]:[De];if(Ye)return he(Be,Ue,De)?[De]:[];if(Ze)return he(De,Ie,Be)?[Be]:[];var Ke,Qe,Je,$e,et,tt,rt,ot;return 0==Ge?(De.y<Ie.y?(Ke=De,Je=De.y,Qe=Ie,$e=Ie.y):(Ke=Ie,Je=Ie.y,Qe=De,$e=De.y),Be.y<Ue.y?(et=Be,rt=Be.y,tt=Ue,ot=Ue.y):(et=Ue,rt=Ue.y,tt=Be,ot=Be.y)):(De.x<Ie.x?(Ke=De,Je=De.x,Qe=Ie,$e=Ie.x):(Ke=Ie,Je=Ie.x,Qe=De,$e=De.x),Be.x<Ue.x?(et=Be,rt=Be.x,tt=Ue,ot=Ue.x):(et=Ue,rt=Ue.x,tt=Be,ot=Be.x)),Je<=rt?$e<rt?[]:$e===rt?Ne?[]:[et]:$e<=ot?[et,Qe]:[et,tt]:Je>ot?[]:Je===ot?Ne?[]:[Ke]:$e<=ot?[Ke,Qe]:[Ke,tt]}function xe(De,Ie,Be,Ue){var Ne=Ie.x-De.x,Ge=Ie.y-De.y,Ve=Be.x-De.x,ze=Be.y-De.y,Oe=Ue.x-De.x,ke=Ue.y-De.y,He=Ne*ze-Ge*Ve,We=Ne*ke-Ge*Oe;if(Math.abs(He)>Number.EPSILON){var je=Oe*ze-ke*Ve;return 0<He?0<=We&&0<=je:0<=We||0<=je}return 0<We}for(var Le={},Re=fe.concat(),Ce=0,we=ge.length,ve,Ee,Te,Se,Me,Ae;Ce<we;Ce++)Array.prototype.push.apply(Re,ge[Ce]);for(ve=0,Ee=Re.length;ve<Ee;ve++)Me=Re[ve].x+':'+Re[ve].y,void 0!==Le[Me]&&console.warn('THREE.Shape: Duplicate point',Me),Le[Me]=ve;var Pe=function(De,Ie){function Be(ot,it){var nt=Ge.length-1,st=ot-1;0>st&&(st=nt);var lt=ot+1;lt>nt&&(lt=0);var dt=xe(Ge[ot],Ge[st],Ge[lt],Ve[it]);if(!dt)return!1;var ct=Ve.length-1,ut=it-1;0>ut&&(ut=ct);var mt=it+1;return mt>ct&&(mt=0),dt=xe(Ve[it],Ve[ut],Ve[mt],Ge[ot]),!!dt}function Ue(ot,it){var nt,st,lt;for(nt=0;nt<Ge.length;nt++)if(st=nt+1,st%=Ge.length,lt=ye(ot,it,Ge[nt],Ge[st],!0),0<lt.length)return!0;return!1}function Ne(ot,it){var nt,st,lt,dt,ct;for(nt=0;nt<ze.length;nt++)for(st=Ie[ze[nt]],lt=0;lt<st.length;lt++)if(dt=lt+1,dt%=st.length,ct=ye(ot,it,st[lt],st[dt],!0),0<ct.length)return!0;return!1}for(var Ge=De.concat(),ze=[],qe=[],Je=0,$e=Ie.length,Ve,Oe,ke,He,We,je,Xe,Ye,Ze,Ke,Qe;Je<$e;Je++)ze.push(Je);for(var et=0,tt=2*ze.length;0<ze.length;){if(tt--,0>tt){console.log('Infinite Loop! Holes left:'+ze.length+', Probably Hole outside Shape!');break}for(ke=et;ke<Ge.length;ke++){He=Ge[ke],Oe=-1;for(var Je=0;Je<ze.length;Je++)if(je=ze[Je],Xe=He.x+':'+He.y+':'+je,void 0===qe[Xe]){Ve=Ie[je];for(var rt=0;rt<Ve.length;rt++)if(We=Ve[rt],Be(ke,rt)&&!Ue(He,We)&&!Ne(He,We)){Oe=rt,ze.splice(Je,1),Ye=Ge.slice(0,ke+1),Ze=Ge.slice(ke),Ke=Ve.slice(Oe),Qe=Ve.slice(0,Oe+1),Ge=Ye.concat(Ke).concat(Qe).concat(Ze),et=ke;break}if(0<=Oe)break;qe[Xe]=!0}if(0<=Oe)break}}return Ge}(fe,ge),Fe=pe.ShapeUtils.triangulate(Pe,!1);for(ve=0,Ee=Fe.length;ve<Ee;ve++)for(Se=Fe[ve],Te=0;3>Te;Te++)Me=Se[Te].x+':'+Se[Te].y,Ae=Le[Me],void 0!==Ae&&(Se[Te]=Ae);return Fe.concat()},isClockWise:function(fe){return 0>pe.ShapeUtils.area(fe)},b2:function(){function ue(he,ye){var xe=1-he;return xe*xe*ye}function fe(he,ye){return 2*(1-he)*he*ye}function ge(he,ye){return he*he*ye}return function(ye,xe,_e,ve){return ue(ye,xe)+fe(ye,_e)+ge(ye,ve)}}(),b3:function(){function ue(ye,xe){var _e=1-ye;return _e*_e*_e*xe}function fe(ye,xe){var _e=1-ye;return 3*_e*_e*ye*xe}function ge(ye,xe){return 3*(1-ye)*ye*ye*xe}function he(ye,xe){return ye*ye*ye*xe}return function(xe,_e,ve,Ee,Te){return ue(xe,_e)+fe(xe,ve)+ge(xe,Ee)+he(xe,Te)}}()},pe.Curve=function(){},pe.Curve.prototype={constructor:pe.Curve,getPoint:function(){return console.warn('THREE.Curve: Warning, getPoint() not implemented!'),null},getPointAt:function(fe){var ge=this.getUtoTmapping(fe);return this.getPoint(ge)},getPoints:function(fe){fe||(fe=5);var he=[],ge;for(ge=0;ge<=fe;ge++)he.push(this.getPoint(ge/fe));return he},getSpacedPoints:function(fe){fe||(fe=5);var he=[],ge;for(ge=0;ge<=fe;ge++)he.push(this.getPointAt(ge/fe));return he},getLength:function(){var fe=this.getLengths();return fe[fe.length-1]},getLengths:function(fe){if(fe||(fe=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===fe+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var ge=[],ye=this.getPoint(0),_e=0,he,xe;for(ge.push(0),xe=1;xe<=fe;xe++)he=this.getPoint(xe/fe),_e+=he.distanceTo(ye),ge.push(_e),ye=he;return this.cacheArcLengths=ge,ge},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(fe,ge){var he=this.getLengths(),ye=0,xe=he.length,_e;_e=ge?ge:fe*he[xe-1];for(var ve=0,Ee=xe-1,Te;ve<=Ee;)if(ye=Math.floor(ve+(Ee-ve)/2),Te=he[ye]-_e,0>Te)ve=ye+1;else if(0<Te)Ee=ye-1;else{Ee=ye;break}if(ye=Ee,he[ye]===_e){var Se=ye/(xe-1);return Se}var Me=he[ye],Ae=he[ye+1],Re=(_e-Me)/(Ae-Me),Se=(ye+Re)/(xe-1);return Se},getTangent:function(fe){var ge=1e-4,he=fe-ge,ye=fe+ge;0>he&&(he=0),1<ye&&(ye=1);var xe=this.getPoint(he),_e=this.getPoint(ye),ve=_e.clone().sub(xe);return ve.normalize()},getTangentAt:function(fe){var ge=this.getUtoTmapping(fe);return this.getTangent(ge)}},pe.Curve.create=function(ue,fe){return ue.prototype=Object.create(pe.Curve.prototype),ue.prototype.constructor=ue,ue.prototype.getPoint=fe,ue},pe.CurvePath=function(){this.curves=[],this.autoClose=!1},pe.CurvePath.prototype=le(Object.create(pe.Curve.prototype),{constructor:pe.CurvePath,add:function(fe){this.curves.push(fe)},closePath:function(){var fe=this.curves[0].getPoint(0),ge=this.curves[this.curves.length-1].getPoint(1);fe.equals(ge)||this.curves.push(new pe.LineCurve(ge,fe))},getPoint:function(fe){for(var ge=fe*this.getLength(),he=this.getCurveLengths(),ye=0;ye<he.length;){if(he[ye]>=ge){var xe=he[ye]-ge,_e=this.curves[ye],ve=1-xe/_e.getLength();return _e.getPointAt(ve)}ye++}return null},getLength:function(){var fe=this.getCurveLengths();return fe[fe.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var fe=[],ge=0,he=0,ye=this.curves.length;he<ye;he++)ge+=this.curves[he].getLength(),fe.push(ge);return this.cacheLengths=fe,fe},createPointsGeometry:function(fe){var ge=this.getPoints(fe);return this.createGeometry(ge)},createSpacedPointsGeometry:function(fe){var ge=this.getSpacedPoints(fe);return this.createGeometry(ge)},createGeometry:function(fe){for(var ge=new pe.Geometry,he=0,ye=fe.length,xe;he<ye;he++)xe=fe[he],ge.vertices.push(new pe.Vector3(xe.x,xe.y,xe.z||0));return ge}}),pe.Font=function(ue){this.data=ue},le(pe.Font.prototype,{generateShapes:function(fe,ge,he){function ye(Me){for(var Ae=(Me+'').split(''),Le=ge/_e.resolution,Re=0,Ce=[],we=0,Pe;we<Ae.length;we++)Pe=xe(Ae[we],Le,Re),Re+=Pe.offset,Ce.push(Pe.path);return Ce}function xe(Me,Ae,Le){var Re=_e.glyphs[Me]||_e.glyphs['?'];if(Re){var Ce=new pe.Path,we=[],Pe=pe.ShapeUtils.b2,Fe=pe.ShapeUtils.b3,De,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe,ke,He;if(Re.o)for(var We=Re._cachedOutline||(Re._cachedOutline=Re.o.split(' ')),je=0,Xe=We.length,qe;je<Xe;)switch(qe=We[je++],qe){case'm':De=We[je++]*Ae+Le,Ie=We[je++]*Ae,Ce.moveTo(De,Ie);break;case'l':De=We[je++]*Ae+Le,Ie=We[je++]*Ae,Ce.lineTo(De,Ie);break;case'q':if(Be=We[je++]*Ae+Le,Ue=We[je++]*Ae,Ve=We[je++]*Ae+Le,ze=We[je++]*Ae,Ce.quadraticCurveTo(Ve,ze,Be,Ue),He=we[we.length-1],He){Ne=He.x,Ge=He.y;for(var Ye=1,Ze;Ye<=he;Ye++)Ze=Ye/he,Pe(Ze,Ne,Ve,Be),Pe(Ze,Ge,ze,Ue)}break;case'b':if(Be=We[je++]*Ae+Le,Ue=We[je++]*Ae,Ve=We[je++]*Ae+Le,ze=We[je++]*Ae,Oe=We[je++]*Ae+Le,ke=We[je++]*Ae,Ce.bezierCurveTo(Ve,ze,Oe,ke,Be,Ue),He=we[we.length-1],He){Ne=He.x,Ge=He.y;for(var Ye=1,Ze;Ye<=he;Ye++)Ze=Ye/he,Fe(Ze,Ne,Ve,Oe,Be),Fe(Ze,Ge,ze,ke,Ue)}}return{offset:Re.ha*Ae,path:Ce}}}ge===void 0&&(ge=100),he===void 0&&(he=4);for(var _e=this.data,ve=ye(fe),Ee=[],Te=0,Se=ve.length;Te<Se;Te++)Array.prototype.push.apply(Ee,ve[Te].toShapes());return Ee}}),pe.Path=function(ue){pe.CurvePath.call(this),this.actions=[],ue&&this.fromPoints(ue)},pe.Path.prototype=le(Object.create(pe.CurvePath.prototype),{constructor:pe.Path,fromPoints:function(fe){this.moveTo(fe[0].x,fe[0].y);for(var ge=1,he=fe.length;ge<he;ge++)this.lineTo(fe[ge].x,fe[ge].y)},moveTo:function(fe,ge){this.actions.push({action:'moveTo',args:[fe,ge]})},lineTo:function(fe,ge){var he=this.actions[this.actions.length-1].args,ye=he[he.length-2],xe=he[he.length-1],_e=new pe.LineCurve(new pe.Vector2(ye,xe),new pe.Vector2(fe,ge));this.curves.push(_e),this.actions.push({action:'lineTo',args:[fe,ge]})},quadraticCurveTo:function(fe,ge,he,ye){var xe=this.actions[this.actions.length-1].args,_e=xe[xe.length-2],ve=xe[xe.length-1],Ee=new pe.QuadraticBezierCurve(new pe.Vector2(_e,ve),new pe.Vector2(fe,ge),new pe.Vector2(he,ye));this.curves.push(Ee),this.actions.push({action:'quadraticCurveTo',args:[fe,ge,he,ye]})},bezierCurveTo:function(fe,ge,he,ye,xe,_e){var ve=this.actions[this.actions.length-1].args,Ee=ve[ve.length-2],Te=ve[ve.length-1],Se=new pe.CubicBezierCurve(new pe.Vector2(Ee,Te),new pe.Vector2(fe,ge),new pe.Vector2(he,ye),new pe.Vector2(xe,_e));this.curves.push(Se),this.actions.push({action:'bezierCurveTo',args:[fe,ge,he,ye,xe,_e]})},splineThru:function(fe){var ge=Array.prototype.slice.call(arguments),he=this.actions[this.actions.length-1].args,ye=he[he.length-2],xe=he[he.length-1],_e=[new pe.Vector2(ye,xe)];Array.prototype.push.apply(_e,fe);var ve=new pe.SplineCurve(_e);this.curves.push(ve);var Ee=fe[fe.length-1];ge.push(Ee.x),ge.push(Ee.y),this.actions.push({action:'splineThru',args:ge})},arc:function(fe,ge,he,ye,xe,_e){var ve=this.actions[this.actions.length-1].args,Ee=ve[ve.length-2],Te=ve[ve.length-1];this.absarc(fe+Ee,ge+Te,he,ye,xe,_e)},absarc:function(fe,ge,he,ye,xe,_e){this.absellipse(fe,ge,he,he,ye,xe,_e)},ellipse:function(fe,ge,he,ye,xe,_e,ve,Ee){var Te=this.actions[this.actions.length-1].args,Se=Te[Te.length-2],Me=Te[Te.length-1];this.absellipse(fe+Se,ge+Me,he,ye,xe,_e,ve,Ee)},absellipse:function(fe,ge,he,ye,xe,_e,ve,Ee){var Te=[fe,ge,he,ye,xe,_e,ve,Ee||0],Se=new pe.EllipseCurve(fe,ge,he,ye,xe,_e,ve,Ee);this.curves.push(Se);var Me=Se.getPoint(1);Te.push(Me.x),Te.push(Me.y),this.actions.push({action:'ellipse',args:Te})},getSpacedPoints:function(fe){fe||(fe=40);for(var ge=[],he=0;he<fe;he++)ge.push(this.getPoint(he/fe));return this.autoClose&&ge.push(ge[0]),ge},getPoints:function(fe){fe=fe||12;for(var ge=pe.ShapeUtils.b2,he=pe.ShapeUtils.b3,ye=[],we=0,Pe=this.actions.length,xe,_e,ve,Ee,Te,Se,Me,Ae,Le,Re,Ce;we<Pe;we++){var Fe=this.actions[we],De=Fe.action,Ie=Fe.args;switch(De){case'moveTo':ye.push(new pe.Vector2(Ie[0],Ie[1]));break;case'lineTo':ye.push(new pe.Vector2(Ie[0],Ie[1]));break;case'quadraticCurveTo':xe=Ie[2],_e=Ie[3],Te=Ie[0],Se=Ie[1],0<ye.length?(Le=ye[ye.length-1],Me=Le.x,Ae=Le.y):(Le=this.actions[we-1].args,Me=Le[Le.length-2],Ae=Le[Le.length-1]);for(var Be=1,Ue;Be<=fe;Be++)Ue=Be/fe,Re=ge(Ue,Me,Te,xe),Ce=ge(Ue,Ae,Se,_e),ye.push(new pe.Vector2(Re,Ce));break;case'bezierCurveTo':xe=Ie[4],_e=Ie[5],Te=Ie[0],Se=Ie[1],ve=Ie[2],Ee=Ie[3],0<ye.length?(Le=ye[ye.length-1],Me=Le.x,Ae=Le.y):(Le=this.actions[we-1].args,Me=Le[Le.length-2],Ae=Le[Le.length-1]);for(var Be=1,Ue;Be<=fe;Be++)Ue=Be/fe,Re=he(Ue,Me,Te,ve,xe),Ce=he(Ue,Ae,Se,Ee,_e),ye.push(new pe.Vector2(Re,Ce));break;case'splineThru':Le=this.actions[we-1].args;var Ne=new pe.Vector2(Le[Le.length-2],Le[Le.length-1]),Ge=[Ne],Ve=fe*Ie[0].length;Ge=Ge.concat(Ie[0]);for(var ze=new pe.SplineCurve(Ge),Be=1;Be<=Ve;Be++)ye.push(ze.getPointAt(Be/Ve));break;case'arc':for(var Oe=Ie[0],ke=Ie[1],He=Ie[2],We=Ie[3],je=Ie[4],Xe=!!Ie[5],qe=je-We,Ze=2*fe,Be=1,Ye,Ue;Be<=Ze;Be++)Ue=Be/Ze,Xe||(Ue=1-Ue),Ye=We+Ue*qe,Re=Oe+He*Math.cos(Ye),Ce=ke+He*Math.sin(Ye),ye.push(new pe.Vector2(Re,Ce));break;case'ellipse':var Oe=Ie[0],ke=Ie[1],Ke=Ie[2],Qe=Ie[3],We=Ie[4],je=Ie[5],Xe=!!Ie[6],Je=Ie[7],qe=je-We,Ze=2*fe,Ye,$e,et;0!==Je&&($e=Math.cos(Je),et=Math.sin(Je));for(var Be=1,Ue;Be<=Ze;Be++){if(Ue=Be/Ze,Xe||(Ue=1-Ue),Ye=We+Ue*qe,Re=Oe+Ke*Math.cos(Ye),Ce=ke+Qe*Math.sin(Ye),0!==Je){var tt=Re,rt=Ce;Re=(tt-Oe)*$e-(rt-ke)*et+Oe,Ce=(tt-Oe)*et+(rt-ke)*$e+ke}ye.push(new pe.Vector2(Re,Ce))}}}var ot=ye[ye.length-1];return Math.abs(ot.x-ye[0].x)<Number.EPSILON&&Math.abs(ot.y-ye[0].y)<Number.EPSILON&&ye.splice(ye.length-1,1),this.autoClose&&ye.push(ye[0]),ye},toShapes:function(fe,ge){function ye(qe){for(var Ye=[],Ze=0,Ke=qe.length;Ze<Ke;Ze++){var Qe=qe[Ze],Je=new pe.Shape;Je.actions=Qe.actions,Je.curves=Qe.curves,Ye.push(Je)}return Ye}function xe(qe,Ye){for(var Ze=Ye.length,Ke=!1,Qe=Ze-1,Je=0;Je<Ze;Qe=Je++){var $e=Ye[Qe],et=Ye[Je],tt=et.x-$e.x,rt=et.y-$e.y;if(Math.abs(rt)>Number.EPSILON){if(0>rt&&($e=Ye[Je],tt=-tt,et=Ye[Qe],rt=-rt),qe.y<$e.y||qe.y>et.y)continue;if(qe.y!==$e.y){var ot=rt*(qe.x-$e.x)-tt*(qe.y-$e.y);if(0==ot)return!0;if(0>ot)continue;Ke=!Ke}else if(qe.x===$e.x)return!0}else{if(qe.y!==$e.y)continue;if(et.x<=qe.x&&qe.x<=$e.x||$e.x<=qe.x&&qe.x<=et.x)return!0}}return Ke}var _e=pe.ShapeUtils.isClockWise,ve=function(qe){for(var Ye=[],Ze=new pe.Path,Ke=0,Qe=qe.length;Ke<Qe;Ke++){var Je=qe[Ke],$e=Je.args,et=Je.action;'moveTo'===et&&0!==Ze.actions.length&&(Ye.push(Ze),Ze=new pe.Path),Ze[et].apply(Ze,$e)}return 0!==Ze.actions.length&&Ye.push(Ze),Ye}(this.actions);if(0===ve.length)return[];if(!0===ge)return ye(ve);var Me=[],Ee,Te,Se;if(1===ve.length)return Te=ve[0],Se=new pe.Shape,Se.actions=Te.actions,Se.curves=Te.curves,Me.push(Se),Me;var Ae=!_e(ve[0].getPoints());Ae=fe?!Ae:Ae;var Le=[],Re=[],Ce=[],we=0,Pe;Re[we]=void 0,Ce[we]=[];for(var Fe=0,De=ve.length;Fe<De;Fe++)Te=ve[Fe],Pe=Te.getPoints(),Ee=_e(Pe),Ee=fe?!Ee:Ee,Ee?(!Ae&&Re[we]&&we++,Re[we]={s:new pe.Shape,p:Pe},Re[we].s.actions=Te.actions,Re[we].s.curves=Te.curves,Ae&&we++,Ce[we]=[]):Ce[we].push({h:Te,p:Pe[0]});if(!Re[0])return ye(ve);if(1<Re.length){for(var Ie=!1,Be=[],Ue=0,Ne=Re.length;Ue<Ne;Ue++)Le[Ue]=[];for(var Ue=0,Ne=Re.length,Ge;Ue<Ne;Ue++){Ge=Ce[Ue];for(var Ve=0;Ve<Ge.length;Ve++){for(var ze=Ge[Ve],Oe=!0,ke=0;ke<Re.length;ke++)xe(ze.p,Re[ke].p)&&(Ue!==ke&&Be.push({froms:Ue,tos:ke,hole:Ve}),Oe?(Oe=!1,Le[ke].push(ze)):Ie=!0);Oe&&Le[Ue].push(ze)}}0<Be.length&&!Ie&&(Ce=Le)}for(var Fe=0,We=Re.length,He;Fe<We;Fe++){Se=Re[Fe].s,Me.push(Se),He=Ce[Fe];for(var je=0,Xe=He.length;je<Xe;je++)Se.holes.push(He[je].h)}return Me}}),pe.Shape=function(){pe.Path.apply(this,arguments),this.holes=[]},pe.Shape.prototype=le(Object.create(pe.Path.prototype),{constructor:pe.Shape,extrude:function(fe){return new pe.ExtrudeGeometry(this,fe)},makeGeometry:function(fe){return new pe.ShapeGeometry(this,fe)},getPointsHoles:function(fe){for(var ge=[],he=0,ye=this.holes.length;he<ye;he++)ge[he]=this.holes[he].getPoints(fe);return ge},extractAllPoints:function(fe){return{shape:this.getPoints(fe),holes:this.getPointsHoles(fe)}},extractPoints:function(fe){return this.extractAllPoints(fe)}}),pe.LineCurve=function(ue,fe){this.v1=ue,this.v2=fe},pe.LineCurve.prototype=Object.create(pe.Curve.prototype),pe.LineCurve.prototype.constructor=pe.LineCurve,pe.LineCurve.prototype.getPoint=function(ue){var fe=this.v2.clone().sub(this.v1);return fe.multiplyScalar(ue).add(this.v1),fe},pe.LineCurve.prototype.getPointAt=function(ue){return this.getPoint(ue)},pe.LineCurve.prototype.getTangent=function(){var fe=this.v2.clone().sub(this.v1);return fe.normalize()},pe.QuadraticBezierCurve=function(ue,fe,ge){this.v0=ue,this.v1=fe,this.v2=ge},pe.QuadraticBezierCurve.prototype=Object.create(pe.Curve.prototype),pe.QuadraticBezierCurve.prototype.constructor=pe.QuadraticBezierCurve,pe.QuadraticBezierCurve.prototype.getPoint=function(ue){var fe=pe.ShapeUtils.b2;return new pe.Vector2(fe(ue,this.v0.x,this.v1.x,this.v2.x),fe(ue,this.v0.y,this.v1.y,this.v2.y))},pe.QuadraticBezierCurve.prototype.getTangent=function(ue){var fe=pe.CurveUtils.tangentQuadraticBezier;return new pe.Vector2(fe(ue,this.v0.x,this.v1.x,this.v2.x),fe(ue,this.v0.y,this.v1.y,this.v2.y)).normalize()},pe.CubicBezierCurve=function(ue,fe,ge,he){this.v0=ue,this.v1=fe,this.v2=ge,this.v3=he},pe.CubicBezierCurve.prototype=Object.create(pe.Curve.prototype),pe.CubicBezierCurve.prototype.constructor=pe.CubicBezierCurve,pe.CubicBezierCurve.prototype.getPoint=function(ue){var fe=pe.ShapeUtils.b3;return new pe.Vector2(fe(ue,this.v0.x,this.v1.x,this.v2.x,this.v3.x),fe(ue,this.v0.y,this.v1.y,this.v2.y,this.v3.y))},pe.CubicBezierCurve.prototype.getTangent=function(ue){var fe=pe.CurveUtils.tangentCubicBezier;return new pe.Vector2(fe(ue,this.v0.x,this.v1.x,this.v2.x,this.v3.x),fe(ue,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize()},pe.SplineCurve=function(ue){this.points=ue==void 0?[]:ue},pe.SplineCurve.prototype=Object.create(pe.Curve.prototype),pe.SplineCurve.prototype.constructor=pe.SplineCurve,pe.SplineCurve.prototype.getPoint=function(ue){var fe=this.points,ge=(fe.length-1)*ue,he=Math.floor(ge),ye=ge-he,xe=fe[0===he?he:he-1],_e=fe[he],ve=fe[he>fe.length-2?fe.length-1:he+1],Ee=fe[he>fe.length-3?fe.length-1:he+2],Te=pe.CurveUtils.interpolate;return new pe.Vector2(Te(xe.x,_e.x,ve.x,Ee.x,ye),Te(xe.y,_e.y,ve.y,Ee.y,ye))},pe.EllipseCurve=function(ue,fe,ge,he,ye,xe,_e,ve){this.aX=ue,this.aY=fe,this.xRadius=ge,this.yRadius=he,this.aStartAngle=ye,this.aEndAngle=xe,this.aClockwise=_e,this.aRotation=ve||0},pe.EllipseCurve.prototype=Object.create(pe.Curve.prototype),pe.EllipseCurve.prototype.constructor=pe.EllipseCurve,pe.EllipseCurve.prototype.getPoint=function(ue){var fe=this.aEndAngle-this.aStartAngle;0>fe&&(fe+=2*Math.PI),fe>2*Math.PI&&(fe-=2*Math.PI);var ge=!0===this.aClockwise?this.aEndAngle+(1-ue)*(2*Math.PI-fe):this.aStartAngle+ue*fe;var he=this.aX+this.xRadius*Math.cos(ge),ye=this.aY+this.yRadius*Math.sin(ge);if(0!==this.aRotation){var xe=Math.cos(this.aRotation),_e=Math.sin(this.aRotation),ve=he,Ee=ye;he=(ve-this.aX)*xe-(Ee-this.aY)*_e+this.aX,ye=(ve-this.aX)*_e+(Ee-this.aY)*xe+this.aY}return new pe.Vector2(he,ye)},pe.ArcCurve=function(ue,fe,ge,he,ye,xe){pe.EllipseCurve.call(this,ue,fe,ge,ge,he,ye,xe)},pe.ArcCurve.prototype=Object.create(pe.EllipseCurve.prototype),pe.ArcCurve.prototype.constructor=pe.ArcCurve,pe.LineCurve3=pe.Curve.create(function(ue,fe){this.v1=ue,this.v2=fe},function(ue){var fe=new pe.Vector3;return fe.subVectors(this.v2,this.v1),fe.multiplyScalar(ue),fe.add(this.v1),fe}),pe.QuadraticBezierCurve3=pe.Curve.create(function(ue,fe,ge){this.v0=ue,this.v1=fe,this.v2=ge},function(ue){var fe=pe.ShapeUtils.b2;return new pe.Vector3(fe(ue,this.v0.x,this.v1.x,this.v2.x),fe(ue,this.v0.y,this.v1.y,this.v2.y),fe(ue,this.v0.z,this.v1.z,this.v2.z))}),pe.CubicBezierCurve3=pe.Curve.create(function(ue,fe,ge,he){this.v0=ue,this.v1=fe,this.v2=ge,this.v3=he},function(ue){var fe=pe.ShapeUtils.b3;return new pe.Vector3(fe(ue,this.v0.x,this.v1.x,this.v2.x,this.v3.x),fe(ue,this.v0.y,this.v1.y,this.v2.y,this.v3.y),fe(ue,this.v0.z,this.v1.z,this.v2.z,this.v3.z))}),pe.SplineCurve3=pe.Curve.create(function(ue){console.warn('THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3'),this.points=ue==void 0?[]:ue},function(ue){var fe=this.points,ge=(fe.length-1)*ue,he=Math.floor(ge),ye=ge-he,xe=fe[0==he?he:he-1],_e=fe[he],ve=fe[he>fe.length-2?fe.length-1:he+1],Ee=fe[he>fe.length-3?fe.length-1:he+2],Te=pe.CurveUtils.interpolate;return new pe.Vector3(Te(xe.x,_e.x,ve.x,Ee.x,ye),Te(xe.y,_e.y,ve.y,Ee.y,ye),Te(xe.z,_e.z,ve.z,Ee.z,ye))}),pe.CatmullRomCurve3=function(){function ue(){}var fe=new pe.Vector3,ge=new ue,he=new ue,ye=new ue;return ue.prototype.init=function(xe,_e,ve,Ee){this.c0=xe,this.c1=ve,this.c2=-3*xe+3*_e-2*ve-Ee,this.c3=2*xe-2*_e+ve+Ee},ue.prototype.initNonuniformCatmullRom=function(xe,_e,ve,Ee,Te,Se,Me){var Ae=(_e-xe)/Te-(ve-xe)/(Te+Se)+(ve-_e)/Se,Le=(ve-_e)/Se-(Ee-_e)/(Se+Me)+(Ee-ve)/Me;Ae*=Se,Le*=Se,this.init(_e,ve,Ae,Le)},ue.prototype.initCatmullRom=function(xe,_e,ve,Ee,Te){this.init(_e,ve,Te*(ve-xe),Te*(Ee-_e))},ue.prototype.calc=function(xe){var _e=xe*xe;return this.c0+this.c1*xe+this.c2*_e+this.c3*(_e*xe)},pe.Curve.create(function(xe){this.points=xe||[],this.closed=!1},function(xe){var _e=this.points,ve,Ee,Te,Se;Se=_e.length,2>Se&&console.log('duh, you need at least 2 points'),ve=(Se-(this.closed?0:1))*xe,Ee=Math.floor(ve),Te=ve-Ee,this.closed?Ee+=0<Ee?0:(Math.floor(Math.abs(Ee)/_e.length)+1)*_e.length:0===Te&&Ee===Se-1&&(Ee=Se-2,Te=1);var Me,Ae,Le,Re;if(this.closed||0<Ee?Me=_e[(Ee-1)%Se]:(fe.subVectors(_e[0],_e[1]).add(_e[0]),Me=fe),Ae=_e[Ee%Se],Le=_e[(Ee+1)%Se],this.closed||Ee+2<Se?Re=_e[(Ee+2)%Se]:(fe.subVectors(_e[Se-1],_e[Se-2]).add(_e[Se-1]),Re=fe),void 0===this.type||'centripetal'===this.type||'chordal'===this.type){var Ce='chordal'===this.type?0.5:0.25,we=Math.pow(Me.distanceToSquared(Ae),Ce),Pe=Math.pow(Ae.distanceToSquared(Le),Ce),Fe=Math.pow(Le.distanceToSquared(Re),Ce);1e-4>Pe&&(Pe=1),1e-4>we&&(we=Pe),1e-4>Fe&&(Fe=Pe),ge.initNonuniformCatmullRom(Me.x,Ae.x,Le.x,Re.x,we,Pe,Fe),he.initNonuniformCatmullRom(Me.y,Ae.y,Le.y,Re.y,we,Pe,Fe),ye.initNonuniformCatmullRom(Me.z,Ae.z,Le.z,Re.z,we,Pe,Fe)}else if('catmullrom'===this.type){var De=void 0===this.tension?0.5:this.tension;ge.initCatmullRom(Me.x,Ae.x,Le.x,Re.x,De),he.initCatmullRom(Me.y,Ae.y,Le.y,Re.y,De),ye.initCatmullRom(Me.z,Ae.z,Le.z,Re.z,De)}var Ie=new pe.Vector3(ge.calc(Te),he.calc(Te),ye.calc(Te));return Ie})}(),pe.ClosedSplineCurve3=function(ue){console.warn('THREE.ClosedSplineCurve3 has been deprecated. Please use THREE.CatmullRomCurve3.'),pe.CatmullRomCurve3.call(this,ue),this.type='catmullrom',this.closed=!0},pe.ClosedSplineCurve3.prototype=Object.create(pe.CatmullRomCurve3.prototype),pe.BoxGeometry=function(ue,fe,ge,he,ye,xe){pe.Geometry.call(this),this.type='BoxGeometry',this.parameters={width:ue,height:fe,depth:ge,widthSegments:he,heightSegments:ye,depthSegments:xe},this.fromBufferGeometry(new pe.BoxBufferGeometry(ue,fe,ge,he,ye,xe)),this.mergeVertices()},pe.BoxGeometry.prototype=Object.create(pe.Geometry.prototype),pe.BoxGeometry.prototype.constructor=pe.BoxGeometry,pe.CubeGeometry=pe.BoxGeometry,pe.BoxBufferGeometry=function(ue,fe,ge,he,ye,xe){function Ee(Be,Ue,Ne,Ge,Ve,ze,Oe,ke,He,We,je){for(var Qe=He+1,$e=0,et=0,tt=new pe.Vector3,rt=0,ot;rt<We+1;rt++){ot=rt*(Oe/We)-Oe/2;for(var it=0,nt;it<Qe;it++)nt=it*(ze/He)-ze/2,tt[Be]=nt*Ge,tt[Ue]=ot*Ve,tt[Ne]=ke/2,Le[we]=tt.x,Le[we+1]=tt.y,Le[we+2]=tt.z,tt[Be]=0,tt[Ue]=0,tt[Ne]=0<ke?1:-1,Re[we]=tt.x,Re[we+1]=tt.y,Re[we+2]=tt.z,Ce[Pe]=it/He,Ce[Pe+1]=1-rt/We,we+=3,Pe+=2,$e+=1}for(rt=0;rt<We;rt++)for(it=0;it<He;it++){var st=De+it+Qe*rt,lt=De+it+Qe*(rt+1),dt=De+(it+1)+Qe*(rt+1),ct=De+(it+1)+Qe*rt;Ae[Fe]=st,Ae[Fe+1]=lt,Ae[Fe+2]=ct,Ae[Fe+3]=lt,Ae[Fe+4]=dt,Ae[Fe+5]=ct,Fe+=6,et+=6}Te.addGroup(Ie,et,je),Ie+=et,De+=$e}pe.BufferGeometry.call(this),this.type='BoxBufferGeometry',this.parameters={width:ue,height:fe,depth:ge,widthSegments:he,heightSegments:ye,depthSegments:xe};var Te=this;he=Math.floor(he)||1,ye=Math.floor(ye)||1,xe=Math.floor(xe)||1;var Se=function(Be,Ue,Ne){var Ge=0;return Ge+=2*((Be+1)*(Ue+1)),Ge+=2*((Be+1)*(Ne+1)),Ge+=2*((Ne+1)*(Ue+1)),Ge}(he,ye,xe),Me=function(Be,Ue,Ne){var Ge=0;return Ge+=2*(Be*Ue),Ge+=2*(Be*Ne),Ge+=2*(Ne*Ue),6*Ge}(he,ye,xe),Ae=new(65535<Me?Uint32Array:Uint16Array)(Me),Le=new Float32Array(3*Se),Re=new Float32Array(3*Se),Ce=new Float32Array(2*Se),we=0,Pe=0,Fe=0,De=0,Ie=0;Ee('z','y','x',-1,-1,ge,fe,ue,xe,ye,0),Ee('z','y','x',1,-1,ge,fe,-ue,xe,ye,1),Ee('x','z','y',1,1,ue,ge,fe,he,xe,2),Ee('x','z','y',1,-1,ue,ge,-fe,he,xe,3),Ee('x','y','z',1,-1,ue,fe,ge,he,ye,4),Ee('x','y','z',-1,-1,ue,fe,-ge,he,ye,5),this.setIndex(new pe.BufferAttribute(Ae,1)),this.addAttribute('position',new pe.BufferAttribute(Le,3)),this.addAttribute('normal',new pe.BufferAttribute(Re,3)),this.addAttribute('uv',new pe.BufferAttribute(Ce,2))},pe.BoxBufferGeometry.prototype=Object.create(pe.BufferGeometry.prototype),pe.BoxBufferGeometry.prototype.constructor=pe.BoxBufferGeometry,pe.CircleGeometry=function(ue,fe,ge,he){pe.Geometry.call(this),this.type='CircleGeometry',this.parameters={radius:ue,segments:fe,thetaStart:ge,thetaLength:he},this.fromBufferGeometry(new pe.CircleBufferGeometry(ue,fe,ge,he))},pe.CircleGeometry.prototype=Object.create(pe.Geometry.prototype),pe.CircleGeometry.prototype.constructor=pe.CircleGeometry,pe.CircleBufferGeometry=function(ue,fe,ge,he){pe.BufferGeometry.call(this),this.type='CircleBufferGeometry',this.parameters={radius:ue,segments:fe,thetaStart:ge,thetaLength:he},ue=ue||50,fe=fe===void 0?8:Math.max(3,fe),ge=ge===void 0?0:ge,he=he===void 0?2*Math.PI:he;var ye=fe+2,xe=new Float32Array(3*ye),_e=new Float32Array(3*ye),ve=new Float32Array(2*ye);_e[2]=1,ve[0]=0.5,ve[1]=0.5;for(var Ee=0,Te=3,Se=2,Me;Ee<=fe;Ee++,Te+=3,Se+=2)Me=ge+Ee/fe*he,xe[Te]=ue*Math.cos(Me),xe[Te+1]=ue*Math.sin(Me),_e[Te+2]=1,ve[Se]=(xe[Te]/ue+1)/2,ve[Se+1]=(xe[Te+1]/ue+1)/2;for(var Ae=[],Te=1;Te<=fe;Te++)Ae.push(Te,Te+1,0);this.setIndex(new pe.BufferAttribute(new Uint16Array(Ae),1)),this.addAttribute('position',new pe.BufferAttribute(xe,3)),this.addAttribute('normal',new pe.BufferAttribute(_e,3)),this.addAttribute('uv',new pe.BufferAttribute(ve,2)),this.boundingSphere=new pe.Sphere(new pe.Vector3(),ue)},pe.CircleBufferGeometry.prototype=Object.create(pe.BufferGeometry.prototype),pe.CircleBufferGeometry.prototype.constructor=pe.CircleBufferGeometry,pe.CylinderBufferGeometry=function(ue,fe,ge,he,ye,xe,_e,ve){function Me(Ve){var ze,Oe,ke,He=new pe.Vector2,We=new pe.Vector3,je=0,Xe=!0===Ve?ue:fe,qe=!0===Ve?1:-1;for(Oe=Ie,ze=1;ze<=he;ze++)Pe.setXYZ(Ie,0,Ne*qe,0),Fe.setXYZ(Ie,0,qe,0),He.x=0.5,He.y=0.5,De.setXY(Ie,He.x,He.y),Ie++;for(ke=Ie,ze=0;ze<=he;ze++){var Ye=ze/he,Ze=Ye*ve+_e,Ke=Math.cos(Ze),Qe=Math.sin(Ze);We.x=Xe*Qe,We.y=Ne*qe,We.z=Xe*Ke,Pe.setXYZ(Ie,We.x,We.y,We.z),Fe.setXYZ(Ie,0,qe,0),He.x=0.5*Ke+0.5,He.y=0.5*Qe*qe+0.5,De.setXY(Ie,He.x,He.y),Ie++}for(ze=0;ze<he;ze++){var Je=Oe+ze,$e=ke+ze;!0===Ve?(we.setX(Be,$e),Be++,we.setX(Be,$e+1),Be++,we.setX(Be,Je),Be++):(we.setX(Be,$e+1),Be++,we.setX(Be,$e),Be++,we.setX(Be,Je),Be++),je+=3}Ae.addGroup(Ge,je,!0===Ve?1:2),Ge+=je}pe.BufferGeometry.call(this),this.type='CylinderBufferGeometry',this.parameters={radiusTop:ue,radiusBottom:fe,height:ge,radialSegments:he,heightSegments:ye,openEnded:xe,thetaStart:_e,thetaLength:ve};var Ae=this;ue=ue===void 0?20:ue,fe=fe===void 0?20:fe,ge=ge===void 0?100:ge,he=Math.floor(he)||8,ye=Math.floor(ye)||1,xe=xe!==void 0&&xe,_e=_e===void 0?0:_e,ve=ve===void 0?2*Math.PI:ve;var Le=0;!1===xe&&(0<ue&&Le++,0<fe&&Le++);var Re=function(){var Ve=(he+1)*(ye+1);return!1===xe&&(Ve+=(he+1)*Le+he*Le),Ve}(),Ce=function(){var Ve=3*(2*(he*ye));return!1===xe&&(Ve+=3*(he*Le)),Ve}(),we=new pe.BufferAttribute(new(65535<Ce?Uint32Array:Uint16Array)(Ce),1),Pe=new pe.BufferAttribute(new Float32Array(3*Re),3),Fe=new pe.BufferAttribute(new Float32Array(3*Re),3),De=new pe.BufferAttribute(new Float32Array(2*Re),2),Ie=0,Be=0,Ue=[],Ne=ge/2,Ge=0;(function(){var Ve,ze,Oe=new pe.Vector3,ke=new pe.Vector3,He=0,We=(fe-ue)/ge;for(ze=0;ze<=ye;ze++){var je=[],Xe=ze/ye,qe=Xe*(fe-ue)+ue;for(Ve=0;Ve<=he;Ve++){var Ye=Ve/he;ke.x=qe*Math.sin(Ye*ve+_e),ke.y=-Xe*ge+Ne,ke.z=qe*Math.cos(Ye*ve+_e),Pe.setXYZ(Ie,ke.x,ke.y,ke.z),Oe.copy(ke),(0===ue&&0===ze||0===fe&&ze===ye)&&(Oe.x=Math.sin(Ye*ve+_e),Oe.z=Math.cos(Ye*ve+_e)),Oe.setY(Math.sqrt(Oe.x*Oe.x+Oe.z*Oe.z)*We).normalize(),Fe.setXYZ(Ie,Oe.x,Oe.y,Oe.z),De.setXY(Ie,Ye,1-Xe),je.push(Ie),Ie++}Ue.push(je)}for(Ve=0;Ve<he;Ve++)for(ze=0;ze<ye;ze++){var Ze=Ue[ze][Ve],Ke=Ue[ze+1][Ve],Qe=Ue[ze+1][Ve+1],Je=Ue[ze][Ve+1];we.setX(Be,Ze),Be++,we.setX(Be,Ke),Be++,we.setX(Be,Je),Be++,we.setX(Be,Ke),Be++,we.setX(Be,Qe),Be++,we.setX(Be,Je),Be++,He+=6}Ae.addGroup(Ge,He,0),Ge+=He})(),!1===xe&&(0<ue&&Me(!0),0<fe&&Me(!1)),this.setIndex(we),this.addAttribute('position',Pe),this.addAttribute('normal',Fe),this.addAttribute('uv',De)},pe.CylinderBufferGeometry.prototype=Object.create(pe.BufferGeometry.prototype),pe.CylinderBufferGeometry.prototype.constructor=pe.CylinderBufferGeometry,pe.CylinderGeometry=function(ue,fe,ge,he,ye,xe,_e,ve){pe.Geometry.call(this),this.type='CylinderGeometry',this.parameters={radiusTop:ue,radiusBottom:fe,height:ge,radialSegments:he,heightSegments:ye,openEnded:xe,thetaStart:_e,thetaLength:ve},this.fromBufferGeometry(new pe.CylinderBufferGeometry(ue,fe,ge,he,ye,xe,_e,ve)),this.mergeVertices()},pe.CylinderGeometry.prototype=Object.create(pe.Geometry.prototype),pe.CylinderGeometry.prototype.constructor=pe.CylinderGeometry,pe.ConeBufferGeometry=function(ue,fe,ge,he,ye,xe,_e){pe.CylinderBufferGeometry.call(this,0,ue,fe,ge,he,ye,xe,_e),this.type='ConeBufferGeometry',this.parameters={radius:ue,height:fe,radialSegments:ge,heightSegments:he,thetaStart:xe,thetaLength:_e}},pe.ConeBufferGeometry.prototype=Object.create(pe.BufferGeometry.prototype),pe.ConeBufferGeometry.prototype.constructor=pe.ConeBufferGeometry,pe.ConeGeometry=function(ue,fe,ge,he,ye,xe,_e){pe.CylinderGeometry.call(this,0,ue,fe,ge,he,ye,xe,_e),this.type='ConeGeometry',this.parameters={radius:ue,height:fe,radialSegments:ge,heightSegments:he,openEnded:ye,thetaStart:xe,thetaLength:_e}},pe.ConeGeometry.prototype=Object.create(pe.CylinderGeometry.prototype),pe.ConeGeometry.prototype.constructor=pe.ConeGeometry,pe.EdgesGeometry=function(ue,fe){function ge(Fe,De){return Fe-De}pe.BufferGeometry.call(this),fe=fe===void 0?1:fe;var he=Math.cos(pe.Math.DEG2RAD*fe),ye=[0,0],xe={},_e=['a','b','c'],ve;ue instanceof pe.BufferGeometry?(ve=new pe.Geometry,ve.fromBufferGeometry(ue)):ve=ue.clone(),ve.mergeVertices(),ve.computeFaceNormals();for(var Ee=ve.vertices,Te=ve.faces,Se=0,Me=Te.length,Ae;Se<Me;Se++){Ae=Te[Se];for(var Le=0;3>Le;Le++){ye[0]=Ae[_e[Le]],ye[1]=Ae[_e[(Le+1)%3]],ye.sort(ge);var Re=ye.toString();xe[Re]===void 0?xe[Re]={vert1:ye[0],vert2:ye[1],face1:Se,face2:void 0}:xe[Re].face2=Se}}var Ce=[];for(var Re in xe){var we=xe[Re];if(we.face2===void 0||Te[we.face1].normal.dot(Te[we.face2].normal)<=he){var Pe=Ee[we.vert1];Ce.push(Pe.x),Ce.push(Pe.y),Ce.push(Pe.z),Pe=Ee[we.vert2],Ce.push(Pe.x),Ce.push(Pe.y),Ce.push(Pe.z)}}this.addAttribute('position',new pe.BufferAttribute(new Float32Array(Ce),3))},pe.EdgesGeometry.prototype=Object.create(pe.BufferGeometry.prototype),pe.EdgesGeometry.prototype.constructor=pe.EdgesGeometry,pe.ExtrudeGeometry=function(ue,fe){return'undefined'==typeof ue?void(ue=[]):void(pe.Geometry.call(this),this.type='ExtrudeGeometry',ue=Array.isArray(ue)?ue:[ue],this.addShapeList(ue,fe),this.computeFaceNormals())},pe.ExtrudeGeometry.prototype=Object.create(pe.Geometry.prototype),pe.ExtrudeGeometry.prototype.constructor=pe.ExtrudeGeometry,pe.ExtrudeGeometry.prototype.addShapeList=function(ue,fe){for(var ge=ue.length,he=0,ye;he<ge;he++)ye=ue[he],this.addShape(ye,fe)},pe.ExtrudeGeometry.prototype.addShape=function(ue,fe){function ge(ht,yt,xt){return yt||console.error('THREE.ExtrudeGeometry: vec does not exist'),yt.clone().multiplyScalar(xt).add(ht)}function he(ht,yt,xt){var Et=1,_t,vt,Tt=ht.x-yt.x,St=ht.y-yt.y,Mt=xt.x-ht.x,At=xt.y-ht.y,Lt=Tt*Tt+St*St;if(Math.abs(Tt*At-St*Mt)>Number.EPSILON){var Ct=Math.sqrt(Lt),wt=Math.sqrt(Mt*Mt+At*At),Pt=yt.x-St/Ct,Ft=yt.y+Tt/Ct,Dt=xt.x-At/wt,It=xt.y+Mt/wt,Bt=((Dt-Pt)*At-(It-Ft)*Mt)/(Tt*At-St*Mt);_t=Pt+Tt*Bt-ht.x,vt=Ft+St*Bt-ht.y;var Ut=_t*_t+vt*vt;if(2>=Ut)return new pe.Vector2(_t,vt);Et=Math.sqrt(Ut/2)}else{var Nt=!1;Tt>Number.EPSILON?Mt>Number.EPSILON&&(Nt=!0):Tt<-Number.EPSILON?Mt<-Number.EPSILON&&(Nt=!0):Math.sign(St)===Math.sign(At)&&(Nt=!0),Nt?(_t=-St,vt=Tt,Et=Math.sqrt(Lt)):(_t=Tt,vt=St,Et=Math.sqrt(Lt/2))}return new pe.Vector2(_t/Et,vt/Et)}function _e(ht,yt){var xt,_t;for(nt=ht.length;0<=--nt;){xt=nt,_t=nt-1,0>_t&&(_t=ht.length-1);var vt=0,Et=we+2*Le;for(vt=0;vt<Et;vt++){var Tt=tt*vt,St=tt*(vt+1),Mt=yt+xt+Tt,At=yt+_t+Tt,Lt=yt+_t+St,Rt=yt+xt+St;Te(Mt,At,Lt,Rt,ht,vt,Et,xt,_t)}}}function ve(ht,yt,xt){ke.vertices.push(new pe.Vector3(ht,yt,xt))}function Ee(ht,yt,xt){ht+=He,yt+=He,xt+=He,ke.faces.push(new pe.Face3(ht,yt,xt,null,null,0));var _t=Ie.generateTopUV(ke,ht,yt,xt);ke.faceVertexUvs[0].push(_t)}function Te(ht,yt,xt,_t){ht+=He,yt+=He,xt+=He,_t+=He,ke.faces.push(new pe.Face3(ht,yt,_t,null,null,1)),ke.faces.push(new pe.Face3(yt,xt,_t,null,null,1));var At=Ie.generateSideWallUV(ke,ht,yt,xt,_t);ke.faceVertexUvs[0].push([At[0],At[1],At[3]]),ke.faceVertexUvs[0].push([At[1],At[2],At[3]])}var Se=fe.amount===void 0?100:fe.amount,Me=fe.bevelThickness===void 0?6:fe.bevelThickness,Ae=fe.bevelSize===void 0?Me-2:fe.bevelSize,Le=fe.bevelSegments===void 0?3:fe.bevelSegments,Re=!(fe.bevelEnabled!==void 0)||fe.bevelEnabled,Ce=fe.curveSegments===void 0?12:fe.curveSegments,we=fe.steps===void 0?1:fe.steps,Pe=fe.extrudePath,Fe,De=!1,Ie=fe.UVGenerator===void 0?pe.ExtrudeGeometry.WorldUVGenerator:fe.UVGenerator,Be,Ue,Ne,Ge;Pe&&(Fe=Pe.getSpacedPoints(we),De=!0,Re=!1,Be=fe.frames===void 0?new pe.TubeGeometry.FrenetFrames(Pe,we,!1):fe.frames,Ue=new pe.Vector3,Ne=new pe.Vector3,Ge=new pe.Vector3),Re||(Le=0,Me=0,Ae=0);var Ve,ze,Oe,ke=this,He=this.vertices.length,We=ue.extractPoints(Ce),je=We.shape,Xe=We.holes,qe=!pe.ShapeUtils.isClockWise(je);if(qe){for(je=je.reverse(),ze=0,Oe=Xe.length;ze<Oe;ze++)Ve=Xe[ze],pe.ShapeUtils.isClockWise(Ve)&&(Xe[ze]=Ve.reverse());qe=!1}var Ye=pe.ShapeUtils.triangulateShape(je,Xe),Ze=je;for(ze=0,Oe=Xe.length;ze<Oe;ze++)Ve=Xe[ze],je=je.concat(Ve);for(var tt=je.length,ot=Ye.length,it=[],nt=0,st=Ze.length,lt=st-1,dt=nt+1,Ke,Qe,Je,$e,et,rt;nt<st;nt++,lt++,dt++)lt===st&&(lt=0),dt===st&&(dt=0),it[nt]=he(Ze[nt],Ze[lt],Ze[dt]);var ct=[],mt=it.concat(),ut;for(ze=0,Oe=Xe.length;ze<Oe;ze++){for(Ve=Xe[ze],ut=[],(nt=0,st=Ve.length,lt=st-1,dt=nt+1);nt<st;nt++,lt++,dt++)lt===st&&(lt=0),dt===st&&(dt=0),ut[nt]=he(Ve[nt],Ve[lt],Ve[dt]);ct.push(ut),mt=mt.concat(ut)}for(Ke=0;Ke<Le;Ke++){for(Je=Ke/Le,$e=Me*(1-Je),Qe=Ae*Math.sin(Je*Math.PI/2),(nt=0,st=Ze.length);nt<st;nt++)et=ge(Ze[nt],it[nt],Qe),ve(et.x,et.y,-$e);for(ze=0,Oe=Xe.length;ze<Oe;ze++)for(Ve=Xe[ze],ut=ct[ze],(nt=0,st=Ve.length);nt<st;nt++)et=ge(Ve[nt],ut[nt],Qe),ve(et.x,et.y,-$e)}for(Qe=Ae,nt=0;nt<tt;nt++)et=Re?ge(je[nt],mt[nt],Qe):je[nt],De?(Ne.copy(Be.normals[0]).multiplyScalar(et.x),Ue.copy(Be.binormals[0]).multiplyScalar(et.y),Ge.copy(Fe[0]).add(Ne).add(Ue),ve(Ge.x,Ge.y,Ge.z)):ve(et.x,et.y,0);var gt;for(gt=1;gt<=we;gt++)for(nt=0;nt<tt;nt++)et=Re?ge(je[nt],mt[nt],Qe):je[nt],De?(Ne.copy(Be.normals[gt]).multiplyScalar(et.x),Ue.copy(Be.binormals[gt]).multiplyScalar(et.y),Ge.copy(Fe[gt]).add(Ne).add(Ue),ve(Ge.x,Ge.y,Ge.z)):ve(et.x,et.y,Se/we*gt);for(Ke=Le-1;0<=Ke;Ke--){for(Je=Ke/Le,$e=Me*(1-Je),Qe=Ae*Math.sin(Je*Math.PI/2),(nt=0,st=Ze.length);nt<st;nt++)et=ge(Ze[nt],it[nt],Qe),ve(et.x,et.y,Se+$e);for(ze=0,Oe=Xe.length;ze<Oe;ze++)for(Ve=Xe[ze],ut=ct[ze],(nt=0,st=Ve.length);nt<st;nt++)et=ge(Ve[nt],ut[nt],Qe),De?ve(et.x,et.y+Fe[we-1].y,Fe[we-1].x+$e):ve(et.x,et.y,Se+$e)}(function(){if(Re){var ht=0,yt=tt*ht;for(nt=0;nt<ot;nt++)rt=Ye[nt],Ee(rt[2]+yt,rt[1]+yt,rt[0]+yt);for(ht=we+2*Le,yt=tt*ht,nt=0;nt<ot;nt++)rt=Ye[nt],Ee(rt[0]+yt,rt[1]+yt,rt[2]+yt)}else{for(nt=0;nt<ot;nt++)rt=Ye[nt],Ee(rt[2],rt[1],rt[0]);for(nt=0;nt<ot;nt++)rt=Ye[nt],Ee(rt[0]+tt*we,rt[1]+tt*we,rt[2]+tt*we)}})(),function(){var ht=0;for(_e(Ze,ht),ht+=Ze.length,(ze=0,Oe=Xe.length);ze<Oe;ze++)Ve=Xe[ze],_e(Ve,ht),ht+=Ve.length}()},pe.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(fe,ge,he,ye){var xe=fe.vertices,_e=xe[ge],ve=xe[he],Ee=xe[ye];return[new pe.Vector2(_e.x,_e.y),new pe.Vector2(ve.x,ve.y),new pe.Vector2(Ee.x,Ee.y)]},generateSideWallUV:function(fe,ge,he,ye,xe){var _e=fe.vertices,ve=_e[ge],Ee=_e[he],Te=_e[ye],Se=_e[xe];return 0.01>Math.abs(ve.y-Ee.y)?[new pe.Vector2(ve.x,1-ve.z),new pe.Vector2(Ee.x,1-Ee.z),new pe.Vector2(Te.x,1-Te.z),new pe.Vector2(Se.x,1-Se.z)]:[new pe.Vector2(ve.y,1-ve.z),new pe.Vector2(Ee.y,1-Ee.z),new pe.Vector2(Te.y,1-Te.z),new pe.Vector2(Se.y,1-Se.z)]}},pe.ShapeGeometry=function(ue,fe){pe.Geometry.call(this),this.type='ShapeGeometry',!1===Array.isArray(ue)&&(ue=[ue]),this.addShapeList(ue,fe),this.computeFaceNormals()},pe.ShapeGeometry.prototype=Object.create(pe.Geometry.prototype),pe.ShapeGeometry.prototype.constructor=pe.ShapeGeometry,pe.ShapeGeometry.prototype.addShapeList=function(ue,fe){for(var ge=0,he=ue.length;ge<he;ge++)this.addShape(ue[ge],fe);return this},pe.ShapeGeometry.prototype.addShape=function(ue,fe){fe===void 0&&(fe={});var ge=fe.curveSegments===void 0?12:fe.curveSegments,he=fe.material,ye=fe.UVGenerator===void 0?pe.ExtrudeGeometry.WorldUVGenerator:fe.UVGenerator,xe,_e,ve,Ee=this.vertices.length,Te=ue.extractPoints(ge),Se=Te.shape,Me=Te.holes,Ae=!pe.ShapeUtils.isClockWise(Se);if(Ae){for(Se=Se.reverse(),xe=0,_e=Me.length;xe<_e;xe++)ve=Me[xe],pe.ShapeUtils.isClockWise(ve)&&(Me[xe]=ve.reverse());Ae=!1}var Le=pe.ShapeUtils.triangulateShape(Se,Me);for(xe=0,_e=Me.length;xe<_e;xe++)ve=Me[xe],Se=Se.concat(ve);var Ce=Se.length,Re,we,Pe=Le.length;for(xe=0;xe<Ce;xe++)Re=Se[xe],this.vertices.push(new pe.Vector3(Re.x,Re.y,0));for(xe=0;xe<Pe;xe++){we=Le[xe];var Fe=we[0]+Ee,De=we[1]+Ee,Ie=we[2]+Ee;this.faces.push(new pe.Face3(Fe,De,Ie,null,null,he)),this.faceVertexUvs[0].push(ye.generateTopUV(this,Fe,De,Ie))}},pe.LatheBufferGeometry=function(ue,fe,ge,he){pe.BufferGeometry.call(this),this.type='LatheBufferGeometry',this.parameters={points:ue,segments:fe,phiStart:ge,phiLength:he},fe=Math.floor(fe)||12,ge=ge||0,he=he||2*Math.PI,he=pe.Math.clamp(he,0,2*Math.PI);var ye=(fe+1)*ue.length,xe=3*(2*(fe*ue.length)),_e=new pe.BufferAttribute(new(65535<xe?Uint32Array:Uint16Array)(xe),1),ve=new pe.BufferAttribute(new Float32Array(3*ye),3),Ee=new pe.BufferAttribute(new Float32Array(2*ye),2),Te=0,Se=0,Ae=1/(ue.length-1),Le=1/fe,Re=new pe.Vector3,Ce=new pe.Vector2,Me,we,Pe;for(we=0;we<=fe;we++){var Fe=ge+we*Le*he,De=Math.sin(Fe),Ie=Math.cos(Fe);for(Pe=0;Pe<=ue.length-1;Pe++)Re.x=ue[Pe].x*De,Re.y=ue[Pe].y,Re.z=ue[Pe].x*Ie,ve.setXYZ(Te,Re.x,Re.y,Re.z),Ce.x=we/fe,Ce.y=Pe/(ue.length-1),Ee.setXY(Te,Ce.x,Ce.y),Te++}for(we=0;we<fe;we++)for(Pe=0;Pe<ue.length-1;Pe++){Me=Pe+we*ue.length;var Be=Me,Ue=Me+ue.length,Ne=Me+ue.length+1,Ge=Me+1;_e.setX(Se,Be),Se++,_e.setX(Se,Ue),Se++,_e.setX(Se,Ge),Se++,_e.setX(Se,Ue),Se++,_e.setX(Se,Ne),Se++,_e.setX(Se,Ge),Se++}if(this.setIndex(_e),this.addAttribute('position',ve),this.addAttribute('uv',Ee),this.computeVertexNormals(),he===2*Math.PI){var Ve=this.attributes.normal.array,ze=new pe.Vector3,Oe=new pe.Vector3,ke=new pe.Vector3;for(Me=3*(fe*ue.length),we=0,Pe=0;we<ue.length;we++,Pe+=3)ze.x=Ve[Pe+0],ze.y=Ve[Pe+1],ze.z=Ve[Pe+2],Oe.x=Ve[Me+Pe+0],Oe.y=Ve[Me+Pe+1],Oe.z=Ve[Me+Pe+2],ke.addVectors(ze,Oe).normalize(),Ve[Pe+0]=Ve[Me+Pe+0]=ke.x,Ve[Pe+1]=Ve[Me+Pe+1]=ke.y,Ve[Pe+2]=Ve[Me+Pe+2]=ke.z}},pe.LatheBufferGeometry.prototype=Object.create(pe.BufferGeometry.prototype),pe.LatheBufferGeometry.prototype.constructor=pe.LatheBufferGeometry,pe.LatheGeometry=function(ue,fe,ge,he){pe.Geometry.call(this),this.type='LatheGeometry',this.parameters={points:ue,segments:fe,phiStart:ge,phiLength:he},this.fromBufferGeometry(new pe.LatheBufferGeometry(ue,fe,ge,he)),this.mergeVertices()},pe.LatheGeometry.prototype=Object.create(pe.Geometry.prototype),pe.LatheGeometry.prototype.constructor=pe.LatheGeometry,pe.PlaneGeometry=function(ue,fe,ge,he){pe.Geometry.call(this),this.type='PlaneGeometry',this.parameters={width:ue,height:fe,widthSegments:ge,heightSegments:he},this.fromBufferGeometry(new pe.PlaneBufferGeometry(ue,fe,ge,he))},pe.PlaneGeometry.prototype=Object.create(pe.Geometry.prototype),pe.PlaneGeometry.prototype.constructor=pe.PlaneGeometry,pe.PlaneBufferGeometry=function(ue,fe,ge,he){pe.BufferGeometry.call(this),this.type='PlaneBufferGeometry',this.parameters={width:ue,height:fe,widthSegments:ge,heightSegments:he};for(var _e=Math.floor(ge)||1,ve=Math.floor(he)||1,Ee=_e+1,Te=ve+1,Ae=new Float32Array(3*(Ee*Te)),Le=new Float32Array(3*(Ee*Te)),Re=new Float32Array(2*(Ee*Te)),Ce=0,we=0,Pe=0,Fe;Pe<Te;Pe++){Fe=Pe*(fe/ve)-fe/2;for(var De=0,Ie;De<Ee;De++)Ie=De*(ue/_e)-ue/2,Ae[Ce]=Ie,Ae[Ce+1]=-Fe,Le[Ce+2]=1,Re[we]=De/_e,Re[we+1]=1-Pe/ve,Ce+=3,we+=2}Ce=0;for(var Be=new(65535<Ae.length/3?Uint32Array:Uint16Array)(6*(_e*ve)),Pe=0;Pe<ve;Pe++)for(var De=0;De<_e;De++){var Ue=De+Ee*Pe,Ne=De+Ee*(Pe+1),Ge=De+1+Ee*(Pe+1),Ve=De+1+Ee*Pe;Be[Ce]=Ue,Be[Ce+1]=Ne,Be[Ce+2]=Ve,Be[Ce+3]=Ne,Be[Ce+4]=Ge,Be[Ce+5]=Ve,Ce+=6}this.setIndex(new pe.BufferAttribute(Be,1)),this.addAttribute('position',new pe.BufferAttribute(Ae,3)),this.addAttribute('normal',new pe.BufferAttribute(Le,3)),this.addAttribute('uv',new pe.BufferAttribute(Re,2))},pe.PlaneBufferGeometry.prototype=Object.create(pe.BufferGeometry.prototype),pe.PlaneBufferGeometry.prototype.constructor=pe.PlaneBufferGeometry,pe.RingBufferGeometry=function(ue,fe,ge,he,ye,xe){pe.BufferGeometry.call(this),this.type='RingBufferGeometry',this.parameters={innerRadius:ue,outerRadius:fe,thetaSegments:ge,phiSegments:he,thetaStart:ye,thetaLength:xe},ue=ue||20,fe=fe||50,ye=ye===void 0?0:ye,xe=xe===void 0?2*Math.PI:xe,ge=ge===void 0?8:Math.max(3,ge),he=he===void 0?1:Math.max(1,he);var _e=(ge+1)*(he+1),ve=3*(2*(ge*he)),Ee=new pe.BufferAttribute(new(65535<ve?Uint32Array:Uint16Array)(ve),1),Te=new pe.BufferAttribute(new Float32Array(3*_e),3),Se=new pe.BufferAttribute(new Float32Array(3*_e),3),Me=new pe.BufferAttribute(new Float32Array(2*_e),2),Ae=0,Le=0,Re,Ce=ue,we=(fe-ue)/he,Pe=new pe.Vector3,Fe=new pe.Vector2,De,Ie;for(De=0;De<=he;De++){for(Ie=0;Ie<=ge;Ie++)Re=ye+Ie/ge*xe,Pe.x=Ce*Math.cos(Re),Pe.y=Ce*Math.sin(Re),Te.setXYZ(Ae,Pe.x,Pe.y,Pe.z),Se.setXYZ(Ae,0,0,1),Fe.x=(Pe.x/fe+1)/2,Fe.y=(Pe.y/fe+1)/2,Me.setXY(Ae,Fe.x,Fe.y),Ae++;Ce+=we}for(De=0;De<he;De++){var Be=De*(ge+1);for(Ie=0;Ie<ge;Ie++){Re=Ie+Be;var Ue=Re,Ne=Re+ge+1,Ge=Re+ge+2,Ve=Re+1;Ee.setX(Le,Ue),Le++,Ee.setX(Le,Ne),Le++,Ee.setX(Le,Ge),Le++,Ee.setX(Le,Ue),Le++,Ee.setX(Le,Ge),Le++,Ee.setX(Le,Ve),Le++}}this.setIndex(Ee),this.addAttribute('position',Te),this.addAttribute('normal',Se),this.addAttribute('uv',Me)},pe.RingBufferGeometry.prototype=Object.create(pe.BufferGeometry.prototype),pe.RingBufferGeometry.prototype.constructor=pe.RingBufferGeometry,pe.RingGeometry=function(ue,fe,ge,he,ye,xe){pe.Geometry.call(this),this.type='RingGeometry',this.parameters={innerRadius:ue,outerRadius:fe,thetaSegments:ge,phiSegments:he,thetaStart:ye,thetaLength:xe},this.fromBufferGeometry(new pe.RingBufferGeometry(ue,fe,ge,he,ye,xe))},pe.RingGeometry.prototype=Object.create(pe.Geometry.prototype),pe.RingGeometry.prototype.constructor=pe.RingGeometry,pe.SphereGeometry=function(ue,fe,ge,he,ye,xe,_e){pe.Geometry.call(this),this.type='SphereGeometry',this.parameters={radius:ue,widthSegments:fe,heightSegments:ge,phiStart:he,phiLength:ye,thetaStart:xe,thetaLength:_e},this.fromBufferGeometry(new pe.SphereBufferGeometry(ue,fe,ge,he,ye,xe,_e))},pe.SphereGeometry.prototype=Object.create(pe.Geometry.prototype),pe.SphereGeometry.prototype.constructor=pe.SphereGeometry,pe.SphereBufferGeometry=function(ue,fe,ge,he,ye,xe,_e){pe.BufferGeometry.call(this),this.type='SphereBufferGeometry',this.parameters={radius:ue,widthSegments:fe,heightSegments:ge,phiStart:he,phiLength:ye,thetaStart:xe,thetaLength:_e},ue=ue||50,fe=Math.max(3,Math.floor(fe)||8),ge=Math.max(2,Math.floor(ge)||6),he=he===void 0?0:he,ye=ye===void 0?2*Math.PI:ye,xe=xe===void 0?0:xe,_e=_e===void 0?Math.PI:_e;for(var ve=xe+_e,Ee=(fe+1)*(ge+1),Te=new pe.BufferAttribute(new Float32Array(3*Ee),3),Se=new pe.BufferAttribute(new Float32Array(3*Ee),3),Me=new pe.BufferAttribute(new Float32Array(2*Ee),2),Ae=0,Le=[],Re=new pe.Vector3,Ce=0;Ce<=ge;Ce++){for(var we=[],Pe=Ce/ge,Fe=0;Fe<=fe;Fe++){var De=Fe/fe,Ie=-ue*Math.cos(he+De*ye)*Math.sin(xe+Pe*_e),Be=ue*Math.cos(xe+Pe*_e),Ue=ue*Math.sin(he+De*ye)*Math.sin(xe+Pe*_e);Re.set(Ie,Be,Ue).normalize(),Te.setXYZ(Ae,Ie,Be,Ue),Se.setXYZ(Ae,Re.x,Re.y,Re.z),Me.setXY(Ae,De,1-Pe),we.push(Ae),Ae++}Le.push(we)}for(var Ne=[],Ce=0;Ce<ge;Ce++)for(var Fe=0;Fe<fe;Fe++){var Ge=Le[Ce][Fe+1],Ve=Le[Ce][Fe],ze=Le[Ce+1][Fe],Oe=Le[Ce+1][Fe+1];(0!==Ce||0<xe)&&Ne.push(Ge,Ve,Oe),(Ce!==ge-1||ve<Math.PI)&&Ne.push(Ve,ze,Oe)}this.setIndex(new(65535<Te.count?pe.Uint32Attribute:pe.Uint16Attribute)(Ne,1)),this.addAttribute('position',Te),this.addAttribute('normal',Se),this.addAttribute('uv',Me),this.boundingSphere=new pe.Sphere(new pe.Vector3(),ue)},pe.SphereBufferGeometry.prototype=Object.create(pe.BufferGeometry.prototype),pe.SphereBufferGeometry.prototype.constructor=pe.SphereBufferGeometry,pe.TextGeometry=function(ue,fe){fe=fe||{};var ge=fe.font;if(!1==ge instanceof pe.Font)return console.error('THREE.TextGeometry: font parameter is not an instance of THREE.Font.'),new pe.Geometry;var he=ge.generateShapes(ue,fe.size,fe.curveSegments);fe.amount=fe.height===void 0?50:fe.height,fe.bevelThickness===void 0&&(fe.bevelThickness=10),fe.bevelSize===void 0&&(fe.bevelSize=8),fe.bevelEnabled===void 0&&(fe.bevelEnabled=!1),pe.ExtrudeGeometry.call(this,he,fe),this.type='TextGeometry'},pe.TextGeometry.prototype=Object.create(pe.ExtrudeGeometry.prototype),pe.TextGeometry.prototype.constructor=pe.TextGeometry,pe.TorusBufferGeometry=function(ue,fe,ge,he,ye){pe.BufferGeometry.call(this),this.type='TorusBufferGeometry',this.parameters={radius:ue,tube:fe,radialSegments:ge,tubularSegments:he,arc:ye},ue=ue||100,fe=fe||40,ge=Math.floor(ge)||8,he=Math.floor(he)||6,ye=ye||2*Math.PI;var xe=(ge+1)*(he+1),_e=3*(2*(ge*he)),ve=new(65535<_e?Uint32Array:Uint16Array)(_e),Ee=new Float32Array(3*xe),Te=new Float32Array(3*xe),Se=new Float32Array(2*xe),Me=0,Ae=0,Le=0,Re=new pe.Vector3,Ce=new pe.Vector3,we=new pe.Vector3,Pe,Fe;for(Pe=0;Pe<=ge;Pe++)for(Fe=0;Fe<=he;Fe++){var De=Fe/he*ye,Ie=2*(Pe/ge*Math.PI);Ce.x=(ue+fe*Math.cos(Ie))*Math.cos(De),Ce.y=(ue+fe*Math.cos(Ie))*Math.sin(De),Ce.z=fe*Math.sin(Ie),Ee[Me]=Ce.x,Ee[Me+1]=Ce.y,Ee[Me+2]=Ce.z,Re.x=ue*Math.cos(De),Re.y=ue*Math.sin(De),we.subVectors(Ce,Re).normalize(),Te[Me]=we.x,Te[Me+1]=we.y,Te[Me+2]=we.z,Se[Ae]=Fe/he,Se[Ae+1]=Pe/ge,Me+=3,Ae+=2}for(Pe=1;Pe<=ge;Pe++)for(Fe=1;Fe<=he;Fe++){var Be=(he+1)*Pe+Fe-1,Ue=(he+1)*(Pe-1)+Fe-1,Ne=(he+1)*(Pe-1)+Fe,Ge=(he+1)*Pe+Fe;ve[Le]=Be,ve[Le+1]=Ue,ve[Le+2]=Ge,ve[Le+3]=Ue,ve[Le+4]=Ne,ve[Le+5]=Ge,Le+=6}this.setIndex(new pe.BufferAttribute(ve,1)),this.addAttribute('position',new pe.BufferAttribute(Ee,3)),this.addAttribute('normal',new pe.BufferAttribute(Te,3)),this.addAttribute('uv',new pe.BufferAttribute(Se,2))},pe.TorusBufferGeometry.prototype=Object.create(pe.BufferGeometry.prototype),pe.TorusBufferGeometry.prototype.constructor=pe.TorusBufferGeometry,pe.TorusGeometry=function(ue,fe,ge,he,ye){pe.Geometry.call(this),this.type='TorusGeometry',this.parameters={radius:ue,tube:fe,radialSegments:ge,tubularSegments:he,arc:ye},this.fromBufferGeometry(new pe.TorusBufferGeometry(ue,fe,ge,he,ye))},pe.TorusGeometry.prototype=Object.create(pe.Geometry.prototype),pe.TorusGeometry.prototype.constructor=pe.TorusGeometry,pe.TorusKnotBufferGeometry=function(ue,fe,ge,he,ye,xe){function _e(qe,Ye,Ze,Ke,Qe){var Je=Math.cos(qe),$e=Math.sin(qe),et=Ze/Ye*qe,tt=Math.cos(et);Qe.x=0.5*(Ke*(2+tt))*Je,Qe.y=0.5*(Ke*(2+tt)*$e),Qe.z=0.5*(Ke*Math.sin(et))}pe.BufferGeometry.call(this),this.type='TorusKnotBufferGeometry',this.parameters={radius:ue,tube:fe,tubularSegments:ge,radialSegments:he,p:ye,q:xe},ue=ue||100,fe=fe||40,ge=Math.floor(ge)||64,he=Math.floor(he)||8,ye=ye||2,xe=xe||3;var ve=(he+1)*(ge+1),Ee=3*(2*(he*ge)),Te=new pe.BufferAttribute(new(65535<Ee?Uint32Array:Uint16Array)(Ee),1),Se=new pe.BufferAttribute(new Float32Array(3*ve),3),Me=new pe.BufferAttribute(new Float32Array(3*ve),3),Ae=new pe.BufferAttribute(new Float32Array(2*ve),2),Le,Re,Ce=0,we=0,Pe=new pe.Vector3,Fe=new pe.Vector3,De=new pe.Vector2,Ie=new pe.Vector3,Be=new pe.Vector3,Ue=new pe.Vector3,Ne=new pe.Vector3,Ge=new pe.Vector3;for(Le=0;Le<=ge;++Le){var Ve=2*(Le/ge*ye*Math.PI);for(_e(Ve,ye,xe,ue,Ie),_e(Ve+0.01,ye,xe,ue,Be),Ne.subVectors(Be,Ie),Ge.addVectors(Be,Ie),Ue.crossVectors(Ne,Ge),Ge.crossVectors(Ue,Ne),Ue.normalize(),Ge.normalize(),Re=0;Re<=he;++Re){var ze=2*(Re/he*Math.PI),Oe=-fe*Math.cos(ze),ke=fe*Math.sin(ze);Pe.x=Ie.x+(Oe*Ge.x+ke*Ue.x),Pe.y=Ie.y+(Oe*Ge.y+ke*Ue.y),Pe.z=Ie.z+(Oe*Ge.z+ke*Ue.z),Se.setXYZ(Ce,Pe.x,Pe.y,Pe.z),Fe.subVectors(Pe,Ie).normalize(),Me.setXYZ(Ce,Fe.x,Fe.y,Fe.z),De.x=Le/ge,De.y=Re/he,Ae.setXY(Ce,De.x,De.y),Ce++}}for(Re=1;Re<=ge;Re++)for(Le=1;Le<=he;Le++){var He=(he+1)*(Re-1)+(Le-1),We=(he+1)*Re+(Le-1),je=(he+1)*Re+Le,Xe=(he+1)*(Re-1)+Le;Te.setX(we,He),we++,Te.setX(we,We),we++,Te.setX(we,Xe),we++,Te.setX(we,We),we++,Te.setX(we,je),we++,Te.setX(we,Xe),we++}this.setIndex(Te),this.addAttribute('position',Se),this.addAttribute('normal',Me),this.addAttribute('uv',Ae)},pe.TorusKnotBufferGeometry.prototype=Object.create(pe.BufferGeometry.prototype),pe.TorusKnotBufferGeometry.prototype.constructor=pe.TorusKnotBufferGeometry,pe.TorusKnotGeometry=function(ue,fe,ge,he,ye,xe,_e){pe.Geometry.call(this),this.type='TorusKnotGeometry',this.parameters={radius:ue,tube:fe,tubularSegments:ge,radialSegments:he,p:ye,q:xe},_e!==void 0&&console.warn('THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.'),this.fromBufferGeometry(new pe.TorusKnotBufferGeometry(ue,fe,ge,he,ye,xe)),this.mergeVertices()},pe.TorusKnotGeometry.prototype=Object.create(pe.Geometry.prototype),pe.TorusKnotGeometry.prototype.constructor=pe.TorusKnotGeometry,pe.TubeGeometry=function(ue,fe,ge,he,ye,xe){function _e(Ke,Qe,Je){return Ee.vertices.push(new pe.Vector3(Ke,Qe,Je))-1}pe.Geometry.call(this),this.type='TubeGeometry',this.parameters={path:ue,segments:fe,radius:ge,radialSegments:he,closed:ye,taper:xe},fe=fe||64,ge=ge||1,he=he||8,ye=ye||!1,xe=xe||pe.TubeGeometry.NoTaper;var ve=[],Ee=this,Te,Se,Me,Ae=fe+1,Le,Re,Ce,we,Pe,Fe,De=new pe.Vector3,Ie,Be,Ue,Ne,Ge,Ve,ze,Oe,ke,He,We,je,Xe=new pe.TubeGeometry.FrenetFrames(ue,fe,ye),qe=Xe.tangents,Ye=Xe.normals,Ze=Xe.binormals;for(this.tangents=qe,this.normals=Ye,this.binormals=Ze,Ie=0;Ie<Ae;Ie++)for(ve[Ie]=[],Le=Ie/(Ae-1),Fe=ue.getPointAt(Le),Te=qe[Ie],Se=Ye[Ie],Me=Ze[Ie],Ce=ge*xe(Le),Be=0;Be<he;Be++)Re=2*(Be/he)*Math.PI,we=-Ce*Math.cos(Re),Pe=Ce*Math.sin(Re),De.copy(Fe),De.x+=we*Se.x+Pe*Me.x,De.y+=we*Se.y+Pe*Me.y,De.z+=we*Se.z+Pe*Me.z,ve[Ie][Be]=_e(De.x,De.y,De.z);for(Ie=0;Ie<fe;Ie++)for(Be=0;Be<he;Be++)Ue=ye?(Ie+1)%fe:Ie+1,Ne=(Be+1)%he,Ge=ve[Ie][Be],Ve=ve[Ue][Be],ze=ve[Ue][Ne],Oe=ve[Ie][Ne],ke=new pe.Vector2(Ie/fe,Be/he),He=new pe.Vector2((Ie+1)/fe,Be/he),We=new pe.Vector2((Ie+1)/fe,(Be+1)/he),je=new pe.Vector2(Ie/fe,(Be+1)/he),this.faces.push(new pe.Face3(Ge,Ve,Oe)),this.faceVertexUvs[0].push([ke,He,je]),this.faces.push(new pe.Face3(Ve,ze,Oe)),this.faceVertexUvs[0].push([He.clone(),We,je.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},pe.TubeGeometry.prototype=Object.create(pe.Geometry.prototype),pe.TubeGeometry.prototype.constructor=pe.TubeGeometry,pe.TubeGeometry.NoTaper=function(){return 1},pe.TubeGeometry.SinusoidalTaper=function(ue){return Math.sin(Math.PI*ue)},pe.TubeGeometry.FrenetFrames=function(ue,fe,ge){function he(){_e[0]=new pe.Vector3,ve[0]=new pe.Vector3,Ae=Number.MAX_VALUE,Le=Math.abs(xe[0].x),Re=Math.abs(xe[0].y),Ce=Math.abs(xe[0].z),Le<=Ae&&(Ae=Le,ye.set(1,0,0)),Re<=Ae&&(Ae=Re,ye.set(0,1,0)),Ce<=Ae&&ye.set(0,0,1),Ee.crossVectors(xe[0],ye).normalize(),_e[0].crossVectors(xe[0],Ee),ve[0].crossVectors(xe[0],_e[0])}var ye=new pe.Vector3,xe=[],_e=[],ve=[],Ee=new pe.Vector3,Te=new pe.Matrix4,Se=fe+1,Me,Ae,Le,Re,Ce,we,Pe;for(this.tangents=xe,this.normals=_e,this.binormals=ve,we=0;we<Se;we++)Pe=we/(Se-1),xe[we]=ue.getTangentAt(Pe),xe[we].normalize();for(he(),we=1;we<Se;we++)_e[we]=_e[we-1].clone(),ve[we]=ve[we-1].clone(),Ee.crossVectors(xe[we-1],xe[we]),Ee.length()>Number.EPSILON&&(Ee.normalize(),Me=Math.acos(pe.Math.clamp(xe[we-1].dot(xe[we]),-1,1)),_e[we].applyMatrix4(Te.makeRotationAxis(Ee,Me))),ve[we].crossVectors(xe[we],_e[we]);if(ge)for(Me=Math.acos(pe.Math.clamp(_e[0].dot(_e[Se-1]),-1,1)),Me/=Se-1,0<xe[0].dot(Ee.crossVectors(_e[0],_e[Se-1]))&&(Me=-Me),we=1;we<Se;we++)_e[we].applyMatrix4(Te.makeRotationAxis(xe[we],Me*we)),ve[we].crossVectors(xe[we],_e[we])},pe.PolyhedronGeometry=function(ue,fe,ge,he){function ye(ze){var Oe=ze.normalize().clone();Oe.index=Se.vertices.push(Oe)-1;var ke=ve(ze)/2/Math.PI+0.5,He=Ee(ze)/Math.PI+0.5;return Oe.uv=new pe.Vector2(ke,1-He),Oe}function xe(ze,Oe,ke){var He=new pe.Face3(ze.index,Oe.index,ke.index,[ze.clone(),Oe.clone(),ke.clone()]);Se.faces.push(He),De.copy(ze).add(Oe).add(ke).divideScalar(3);var We=ve(De);Se.faceVertexUvs[0].push([Te(ze.uv,ze,We),Te(Oe.uv,Oe,We),Te(ke.uv,ke,We)])}function _e(ze,Oe){for(var ke=Math.pow(2,Oe),He=ye(Se.vertices[ze.a]),We=ye(Se.vertices[ze.b]),je=ye(Se.vertices[ze.c]),Xe=[],qe=0;qe<=ke;qe++){Xe[qe]=[];for(var Ye=ye(He.clone().lerp(je,qe/ke)),Ze=ye(We.clone().lerp(je,qe/ke)),Ke=ke-qe,Qe=0;Qe<=Ke;Qe++)Xe[qe][Qe]=0===Qe&&qe===ke?Ye:ye(Ye.clone().lerp(Ze,Qe/Ke))}for(var qe=0;qe<ke;qe++)for(var Qe=0,Je;Qe<2*(ke-qe)-1;Qe++)Je=Math.floor(Qe/2),0==Qe%2?xe(Xe[qe][Je+1],Xe[qe+1][Je],Xe[qe][Je]):xe(Xe[qe][Je+1],Xe[qe+1][Je+1],Xe[qe+1][Je])}function ve(ze){return Math.atan2(ze.z,-ze.x)}function Ee(ze){return Math.atan2(-ze.y,Math.sqrt(ze.x*ze.x+ze.z*ze.z))}function Te(ze,Oe,ke){return 0>ke&&1===ze.x&&(ze=new pe.Vector2(ze.x-1,ze.y)),0===Oe.x&&0===Oe.z&&(ze=new pe.Vector2(ke/2/Math.PI+0.5,ze.y)),ze.clone()}pe.Geometry.call(this),this.type='PolyhedronGeometry',this.parameters={vertices:ue,indices:fe,radius:ge,detail:he},ge=ge||1,he=he||0;for(var Se=this,Me=0,Ae=ue.length;Me<Ae;Me+=3)ye(new pe.Vector3(ue[Me],ue[Me+1],ue[Me+2]));for(var Le=this.vertices,Re=[],Me=0,Ce=0,Ae=fe.length;Me<Ae;Me+=3,Ce++){var we=Le[fe[Me]],Pe=Le[fe[Me+1]],Fe=Le[fe[Me+2]];Re[Ce]=new pe.Face3(we.index,Pe.index,Fe.index,[we.clone(),Pe.clone(),Fe.clone()])}for(var De=new pe.Vector3,Me=0,Ae=Re.length;Me<Ae;Me++)_e(Re[Me],he);for(var Me=0,Ae=this.faceVertexUvs[0].length;Me<Ae;Me++){var Ie=this.faceVertexUvs[0][Me],Be=Ie[0].x,Ue=Ie[1].x,Ne=Ie[2].x,Ge=Math.max(Be,Ue,Ne),Ve=Math.min(Be,Ue,Ne);0.9<Ge&&0.1>Ve&&(0.2>Be&&(Ie[0].x+=1),0.2>Ue&&(Ie[1].x+=1),0.2>Ne&&(Ie[2].x+=1))}for(var Me=0,Ae=this.vertices.length;Me<Ae;Me++)this.vertices[Me].multiplyScalar(ge);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new pe.Sphere(new pe.Vector3(),ge)},pe.PolyhedronGeometry.prototype=Object.create(pe.Geometry.prototype),pe.PolyhedronGeometry.prototype.constructor=pe.PolyhedronGeometry,pe.DodecahedronGeometry=function(ue,fe){var ge=(1+Math.sqrt(5))/2,he=1/ge;pe.PolyhedronGeometry.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-he,-ge,0,-he,ge,0,he,-ge,0,he,ge,-he,-ge,0,-he,ge,0,he,-ge,0,he,ge,0,-ge,0,-he,ge,0,-he,-ge,0,he,ge,0,he],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],ue,fe),this.type='DodecahedronGeometry',this.parameters={radius:ue,detail:fe}},pe.DodecahedronGeometry.prototype=Object.create(pe.PolyhedronGeometry.prototype),pe.DodecahedronGeometry.prototype.constructor=pe.DodecahedronGeometry,pe.IcosahedronGeometry=function(ue,fe){var ge=(1+Math.sqrt(5))/2;pe.PolyhedronGeometry.call(this,[-1,ge,0,1,ge,0,-1,-ge,0,1,-ge,0,0,-1,ge,0,1,ge,0,-1,-ge,0,1,-ge,ge,0,-1,ge,0,1,-ge,0,-1,-ge,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],ue,fe),this.type='IcosahedronGeometry',this.parameters={radius:ue,detail:fe}},pe.IcosahedronGeometry.prototype=Object.create(pe.PolyhedronGeometry.prototype),pe.IcosahedronGeometry.prototype.constructor=pe.IcosahedronGeometry,pe.OctahedronGeometry=function(ue,fe){pe.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],ue,fe),this.type='OctahedronGeometry',this.parameters={radius:ue,detail:fe}},pe.OctahedronGeometry.prototype=Object.create(pe.PolyhedronGeometry.prototype),pe.OctahedronGeometry.prototype.constructor=pe.OctahedronGeometry,pe.TetrahedronGeometry=function(ue,fe){pe.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],ue,fe),this.type='TetrahedronGeometry',this.parameters={radius:ue,detail:fe}},pe.TetrahedronGeometry.prototype=Object.create(pe.PolyhedronGeometry.prototype),pe.TetrahedronGeometry.prototype.constructor=pe.TetrahedronGeometry,pe.ParametricGeometry=function(ue,fe,ge){pe.Geometry.call(this),this.type='ParametricGeometry',this.parameters={func:ue,slices:fe,stacks:ge};var he=this.vertices,ye=this.faces,xe=this.faceVertexUvs[0],_e,ve,Ee,Te,Se,Me=fe+1;for(_e=0;_e<=ge;_e++)for(Se=_e/ge,ve=0;ve<=fe;ve++)Te=ve/fe,Ee=ue(Te,Se),he.push(Ee);var Ae,Le,Re,Ce,we,Pe,Fe,De;for(_e=0;_e<ge;_e++)for(ve=0;ve<fe;ve++)Ae=_e*Me+ve,Le=_e*Me+ve+1,Re=(_e+1)*Me+ve+1,Ce=(_e+1)*Me+ve,we=new pe.Vector2(ve/fe,_e/ge),Pe=new pe.Vector2((ve+1)/fe,_e/ge),Fe=new pe.Vector2((ve+1)/fe,(_e+1)/ge),De=new pe.Vector2(ve/fe,(_e+1)/ge),ye.push(new pe.Face3(Ae,Le,Ce)),xe.push([we,Pe,De]),ye.push(new pe.Face3(Le,Re,Ce)),xe.push([Pe.clone(),Fe,De.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},pe.ParametricGeometry.prototype=Object.create(pe.Geometry.prototype),pe.ParametricGeometry.prototype.constructor=pe.ParametricGeometry,pe.WireframeGeometry=function(ue){function fe(ke,He){return ke-He}pe.BufferGeometry.call(this);var ge=[0,0],he={},ye=['a','b','c'];if(ue instanceof pe.Geometry){for(var xe=ue.vertices,_e=ue.faces,ve=0,Ee=new Uint32Array(6*_e.length),Te=0,Se=_e.length,Me;Te<Se;Te++){Me=_e[Te];for(var Ae=0;3>Ae;Ae++){ge[0]=Me[ye[Ae]],ge[1]=Me[ye[(Ae+1)%3]],ge.sort(fe);var Le=ge.toString();he[Le]===void 0&&(Ee[2*ve]=ge[0],Ee[2*ve+1]=ge[1],he[Le]=!0,ve++)}}for(var Re=new Float32Array(3*(2*ve)),Te=0,Se=ve;Te<Se;Te++)for(var Ae=0;2>Ae;Ae++){var Ce=xe[Ee[2*Te+Ae]],we=6*Te+3*Ae;Re[we+0]=Ce.x,Re[we+1]=Ce.y,Re[we+2]=Ce.z}this.addAttribute('position',new pe.BufferAttribute(Re,3))}else if(ue instanceof pe.BufferGeometry)if(null!==ue.index){var Pe=ue.index.array,xe=ue.attributes.position,Fe=ue.groups,ve=0;0===Fe.length&&ue.addGroup(0,Pe.length);for(var Ee=new Uint32Array(2*Pe.length),De=0,Ie=Fe.length;De<Ie;++De)for(var Be=Fe[De],Ue=Be.start,Ne=Be.count,Te=Ue;Te<Ue+Ne;Te+=3)for(var Ae=0;3>Ae;Ae++){ge[0]=Pe[Te+Ae],ge[1]=Pe[Te+(Ae+1)%3],ge.sort(fe);var Le=ge.toString();void 0===he[Le]&&(Ee[2*ve]=ge[0],Ee[2*ve+1]=ge[1],he[Le]=!0,ve++)}for(var Re=new Float32Array(3*(2*ve)),Te=0,Se=ve;Te<Se;Te++)for(var Ae=0;2>Ae;Ae++){var we=6*Te+3*Ae,Ve=Ee[2*Te+Ae];Re[we+0]=xe.getX(Ve),Re[we+1]=xe.getY(Ve),Re[we+2]=xe.getZ(Ve)}this.addAttribute('position',new pe.BufferAttribute(Re,3))}else{for(var xe=ue.attributes.position.array,ve=xe.length/3,ze=ve/3,Re=new Float32Array(3*(2*ve)),Te=0,Se=ze;Te<Se;Te++)for(var Ae=0;3>Ae;Ae++){var we=18*Te+6*Ae,Oe=9*Te+3*Ae;Re[we+0]=xe[Oe],Re[we+1]=xe[Oe+1],Re[we+2]=xe[Oe+2];var Ve=9*Te+3*((Ae+1)%3);Re[we+3]=xe[Ve],Re[we+4]=xe[Ve+1],Re[we+5]=xe[Ve+2]}this.addAttribute('position',new pe.BufferAttribute(Re,3))}},pe.WireframeGeometry.prototype=Object.create(pe.BufferGeometry.prototype),pe.WireframeGeometry.prototype.constructor=pe.WireframeGeometry,pe.AxisHelper=function(ue){ue=ue||1;var fe=new Float32Array([0,0,0,ue,0,0,0,0,0,0,ue,0,0,0,0,0,0,ue]),ge=new Float32Array([1,0,0,1,0.6,0,0,1,0,0.6,1,0,0,0,1,0,0.6,1]),he=new pe.BufferGeometry;he.addAttribute('position',new pe.BufferAttribute(fe,3)),he.addAttribute('color',new pe.BufferAttribute(ge,3));var ye=new pe.LineBasicMaterial({vertexColors:pe.VertexColors});pe.LineSegments.call(this,he,ye)},pe.AxisHelper.prototype=Object.create(pe.LineSegments.prototype),pe.AxisHelper.prototype.constructor=pe.AxisHelper,pe.ArrowHelper=function(){var ue=new pe.BufferGeometry;ue.addAttribute('position',new pe.Float32Attribute([0,0,0,0,1,0],3));var fe=new pe.CylinderBufferGeometry(0,0.5,1,5,1);return fe.translate(0,-0.5,0),function(he,ye,xe,_e,ve,Ee){pe.Object3D.call(this),void 0===_e&&(_e=16776960),void 0===xe&&(xe=1),void 0===ve&&(ve=0.2*xe),void 0===Ee&&(Ee=0.2*ve),this.position.copy(ye),this.line=new pe.Line(ue,new pe.LineBasicMaterial({color:_e})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new pe.Mesh(fe,new pe.MeshBasicMaterial({color:_e})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(he),this.setLength(xe,ve,Ee)}}(),pe.ArrowHelper.prototype=Object.create(pe.Object3D.prototype),pe.ArrowHelper.prototype.constructor=pe.ArrowHelper,pe.ArrowHelper.prototype.setDirection=function(){var ue=new pe.Vector3,fe;return function(he){0.99999<he.y?this.quaternion.set(0,0,0,1):-0.99999>he.y?this.quaternion.set(1,0,0,0):(ue.set(he.z,0,-he.x).normalize(),fe=Math.acos(he.y),this.quaternion.setFromAxisAngle(ue,fe))}}(),pe.ArrowHelper.prototype.setLength=function(ue,fe,ge){fe===void 0&&(fe=0.2*ue),ge===void 0&&(ge=0.2*fe),this.line.scale.set(1,Math.max(0,ue-fe),1),this.line.updateMatrix(),this.cone.scale.set(ge,fe,ge),this.cone.position.y=ue,this.cone.updateMatrix()},pe.ArrowHelper.prototype.setColor=function(ue){this.line.material.color.copy(ue),this.cone.material.color.copy(ue)},pe.BoxHelper=function(ue,fe){fe===void 0&&(fe=16776960);var ge=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),he=new Float32Array(24),ye=new pe.BufferGeometry;ye.setIndex(new pe.BufferAttribute(ge,1)),ye.addAttribute('position',new pe.BufferAttribute(he,3)),pe.LineSegments.call(this,ye,new pe.LineBasicMaterial({color:fe})),ue!==void 0&&this.update(ue)},pe.BoxHelper.prototype=Object.create(pe.LineSegments.prototype),pe.BoxHelper.prototype.constructor=pe.BoxHelper,pe.BoxHelper.prototype.update=function(){var ue=new pe.Box3;return function(ge){if(ge instanceof pe.Box3?ue.copy(ge):ue.setFromObject(ge),!ue.isEmpty()){var he=ue.min,ye=ue.max,xe=this.geometry.attributes.position,_e=xe.array;_e[0]=ye.x,_e[1]=ye.y,_e[2]=ye.z,_e[3]=he.x,_e[4]=ye.y,_e[5]=ye.z,_e[6]=he.x,_e[7]=he.y,_e[8]=ye.z,_e[9]=ye.x,_e[10]=he.y,_e[11]=ye.z,_e[12]=ye.x,_e[13]=ye.y,_e[14]=he.z,_e[15]=he.x,_e[16]=ye.y,_e[17]=he.z,_e[18]=he.x,_e[19]=he.y,_e[20]=he.z,_e[21]=ye.x,_e[22]=he.y,_e[23]=he.z,xe.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),pe.BoundingBoxHelper=function(ue,fe){var ge=fe===void 0?8947848:fe;this.object=ue,this.box=new pe.Box3,pe.Mesh.call(this,new pe.BoxGeometry(1,1,1),new pe.MeshBasicMaterial({color:ge,wireframe:!0}))},pe.BoundingBoxHelper.prototype=Object.create(pe.Mesh.prototype),pe.BoundingBoxHelper.prototype.constructor=pe.BoundingBoxHelper,pe.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},pe.CameraHelper=function(ue){function fe(Me,Ae,Le){ge(Me,Le),ge(Ae,Le)}function ge(Me,Ae){he.vertices.push(new pe.Vector3),he.colors.push(new pe.Color(Ae)),xe[Me]===void 0&&(xe[Me]=[]),xe[Me].push(he.vertices.length-1)}var he=new pe.Geometry,ye=new pe.LineBasicMaterial({color:16777215,vertexColors:pe.FaceColors}),xe={},_e=16755200,ve=16711680,Ee=43775,Se=3355443;fe('n1','n2',_e),fe('n2','n4',_e),fe('n4','n3',_e),fe('n3','n1',_e),fe('f1','f2',_e),fe('f2','f4',_e),fe('f4','f3',_e),fe('f3','f1',_e),fe('n1','f1',_e),fe('n2','f2',_e),fe('n3','f3',_e),fe('n4','f4',_e),fe('p','n1',ve),fe('p','n2',ve),fe('p','n3',ve),fe('p','n4',ve),fe('u1','u2',Ee),fe('u2','u3',Ee),fe('u3','u1',Ee),fe('c','t',16777215),fe('p','c',Se),fe('cn1','cn2',Se),fe('cn3','cn4',Se),fe('cf1','cf2',Se),fe('cf3','cf4',Se),pe.LineSegments.call(this,he,ye),this.camera=ue,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=ue.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=xe,this.update()},pe.CameraHelper.prototype=Object.create(pe.LineSegments.prototype),pe.CameraHelper.prototype.constructor=pe.CameraHelper,pe.CameraHelper.prototype.update=function(){function ue(xe,_e,ve,Ee){he.set(_e,ve,Ee).unproject(ye);var Te=ge[xe];if(Te!==void 0)for(var Se=0,Me=Te.length;Se<Me;Se++)fe.vertices[Te[Se]].copy(he)}var fe,ge,he=new pe.Vector3,ye=new pe.Camera;return function(){fe=this.geometry,ge=this.pointMap;var _e=1,ve=1;ye.projectionMatrix.copy(this.camera.projectionMatrix),ue('c',0,0,-1),ue('t',0,0,1),ue('n1',-_e,-ve,-1),ue('n2',_e,-ve,-1),ue('n3',-_e,ve,-1),ue('n4',_e,ve,-1),ue('f1',-_e,-ve,1),ue('f2',_e,-ve,1),ue('f3',-_e,ve,1),ue('f4',_e,ve,1),ue('u1',0.7*_e,1.1*ve,-1),ue('u2',0.7*-_e,1.1*ve,-1),ue('u3',0,2*ve,-1),ue('cf1',-_e,0,1),ue('cf2',_e,0,1),ue('cf3',0,-ve,1),ue('cf4',0,ve,1),ue('cn1',-_e,0,-1),ue('cn2',_e,0,-1),ue('cn3',0,-ve,-1),ue('cn4',0,ve,-1),fe.verticesNeedUpdate=!0}}(),pe.DirectionalLightHelper=function(ue,fe){pe.Object3D.call(this),this.light=ue,this.light.updateMatrixWorld(),this.matrix=ue.matrixWorld,this.matrixAutoUpdate=!1,fe===void 0&&(fe=1);var ge=new pe.BufferGeometry;ge.addAttribute('position',new pe.Float32Attribute([-fe,fe,0,fe,fe,0,fe,-fe,0,-fe,-fe,0,-fe,fe,0],3));var he=new pe.LineBasicMaterial({fog:!1});this.add(new pe.Line(ge,he)),ge=new pe.BufferGeometry,ge.addAttribute('position',new pe.Float32Attribute([0,0,0,0,0,1],3)),this.add(new pe.Line(ge,he)),this.update()},pe.DirectionalLightHelper.prototype=Object.create(pe.Object3D.prototype),pe.DirectionalLightHelper.prototype.constructor=pe.DirectionalLightHelper,pe.DirectionalLightHelper.prototype.dispose=function(){var ue=this.children[0],fe=this.children[1];ue.geometry.dispose(),ue.material.dispose(),fe.geometry.dispose(),fe.material.dispose()},pe.DirectionalLightHelper.prototype.update=function(){var ue=new pe.Vector3,fe=new pe.Vector3,ge=new pe.Vector3;return function(){ue.setFromMatrixPosition(this.light.matrixWorld),fe.setFromMatrixPosition(this.light.target.matrixWorld),ge.subVectors(fe,ue);var ye=this.children[0],xe=this.children[1];ye.lookAt(ge),ye.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),xe.lookAt(ge),xe.scale.z=ge.length()}}(),pe.EdgesHelper=function(ue,fe,ge){var he=fe===void 0?16777215:fe;pe.LineSegments.call(this,new pe.EdgesGeometry(ue.geometry,ge),new pe.LineBasicMaterial({color:he})),this.matrix=ue.matrixWorld,this.matrixAutoUpdate=!1},pe.EdgesHelper.prototype=Object.create(pe.LineSegments.prototype),pe.EdgesHelper.prototype.constructor=pe.EdgesHelper,pe.FaceNormalsHelper=function(ue,fe,ge,he){this.object=ue,this.size=fe===void 0?1:fe;var ye=ge===void 0?16776960:ge,xe=he===void 0?1:he,_e=0,ve=this.object.geometry;ve instanceof pe.Geometry?_e=ve.faces.length:console.warn('THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.');var Ee=new pe.BufferGeometry,Te=new pe.Float32Attribute(3*(2*_e),3);Ee.addAttribute('position',Te),pe.LineSegments.call(this,Ee,new pe.LineBasicMaterial({color:ye,linewidth:xe})),this.matrixAutoUpdate=!1,this.update()},pe.FaceNormalsHelper.prototype=Object.create(pe.LineSegments.prototype),pe.FaceNormalsHelper.prototype.constructor=pe.FaceNormalsHelper,pe.FaceNormalsHelper.prototype.update=function(){var ue=new pe.Vector3,fe=new pe.Vector3,ge=new pe.Matrix3;return function(){this.object.updateMatrixWorld(!0),ge.getNormalMatrix(this.object.matrixWorld);for(var ye=this.object.matrixWorld,xe=this.geometry.attributes.position,_e=this.object.geometry,ve=_e.vertices,Ee=_e.faces,Te=0,Se=0,Me=Ee.length;Se<Me;Se++){var Ae=Ee[Se],Le=Ae.normal;ue.copy(ve[Ae.a]).add(ve[Ae.b]).add(ve[Ae.c]).divideScalar(3).applyMatrix4(ye),fe.copy(Le).applyMatrix3(ge).normalize().multiplyScalar(this.size).add(ue),xe.setXYZ(Te,ue.x,ue.y,ue.z),++Te,xe.setXYZ(Te,fe.x,fe.y,fe.z),++Te}return xe.needsUpdate=!0,this}}(),pe.GridHelper=function(ue,fe,ge,he){ge=new pe.Color(ge===void 0?4473924:ge),he=new pe.Color(he===void 0?8947848:he);for(var ye=[],xe=[],_e=-ue,ve=0;_e<=ue;_e+=fe){ye.push(-ue,0,_e,ue,0,_e),ye.push(_e,0,-ue,_e,0,ue);var Ee=0===_e?ge:he;Ee.toArray(xe,ve),ve+=3,Ee.toArray(xe,ve),ve+=3,Ee.toArray(xe,ve),ve+=3,Ee.toArray(xe,ve),ve+=3}var Te=new pe.BufferGeometry;Te.addAttribute('position',new pe.Float32Attribute(ye,3)),Te.addAttribute('color',new pe.Float32Attribute(xe,3));var Se=new pe.LineBasicMaterial({vertexColors:pe.VertexColors});pe.LineSegments.call(this,Te,Se)},pe.GridHelper.prototype=Object.create(pe.LineSegments.prototype),pe.GridHelper.prototype.constructor=pe.GridHelper,pe.GridHelper.prototype.setColors=function(){console.error('THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.')},pe.HemisphereLightHelper=function(ue,fe){pe.Object3D.call(this),this.light=ue,this.light.updateMatrixWorld(),this.matrix=ue.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new pe.Color,new pe.Color];var ge=new pe.SphereGeometry(fe,4,2);ge.rotateX(-Math.PI/2);for(var he=0;he<8;he++)ge.faces[he].color=this.colors[4>he?0:1];var xe=new pe.MeshBasicMaterial({vertexColors:pe.FaceColors,wireframe:!0});this.lightSphere=new pe.Mesh(ge,xe),this.add(this.lightSphere),this.update()},pe.HemisphereLightHelper.prototype=Object.create(pe.Object3D.prototype),pe.HemisphereLightHelper.prototype.constructor=pe.HemisphereLightHelper,pe.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},pe.HemisphereLightHelper.prototype.update=function(){var ue=new pe.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(ue.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),pe.PointLightHelper=function(ue,fe){this.light=ue,this.light.updateMatrixWorld();var ge=new pe.SphereBufferGeometry(fe,4,2),he=new pe.MeshBasicMaterial({wireframe:!0,fog:!1});he.color.copy(this.light.color).multiplyScalar(this.light.intensity),pe.Mesh.call(this,ge,he),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},pe.PointLightHelper.prototype=Object.create(pe.Mesh.prototype),pe.PointLightHelper.prototype.constructor=pe.PointLightHelper,pe.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},pe.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},pe.SkeletonHelper=function(ue){this.bones=this.getBoneList(ue);for(var fe=new pe.Geometry,ge=0,he;ge<this.bones.length;ge++)he=this.bones[ge],he.parent instanceof pe.Bone&&(fe.vertices.push(new pe.Vector3),fe.vertices.push(new pe.Vector3),fe.colors.push(new pe.Color(0,0,1)),fe.colors.push(new pe.Color(0,1,0)));fe.dynamic=!0;var ye=new pe.LineBasicMaterial({vertexColors:pe.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});pe.LineSegments.call(this,fe,ye),this.root=ue,this.matrix=ue.matrixWorld,this.matrixAutoUpdate=!1,this.update()},pe.SkeletonHelper.prototype=Object.create(pe.LineSegments.prototype),pe.SkeletonHelper.prototype.constructor=pe.SkeletonHelper,pe.SkeletonHelper.prototype.getBoneList=function(ue){var fe=[];ue instanceof pe.Bone&&fe.push(ue);for(var ge=0;ge<ue.children.length;ge++)fe.push.apply(fe,this.getBoneList(ue.children[ge]));return fe},pe.SkeletonHelper.prototype.update=function(){for(var ue=this.geometry,fe=new pe.Matrix4().getInverse(this.root.matrixWorld),ge=new pe.Matrix4,he=0,ye=0,xe;ye<this.bones.length;ye++)xe=this.bones[ye],xe.parent instanceof pe.Bone&&(ge.multiplyMatrices(fe,xe.matrixWorld),ue.vertices[he].setFromMatrixPosition(ge),ge.multiplyMatrices(fe,xe.parent.matrixWorld),ue.vertices[he+1].setFromMatrixPosition(ge),he+=2);ue.verticesNeedUpdate=!0,ue.computeBoundingSphere()},pe.SpotLightHelper=function(ue){pe.Object3D.call(this),this.light=ue,this.light.updateMatrixWorld(),this.matrix=ue.matrixWorld,this.matrixAutoUpdate=!1;for(var fe=new pe.BufferGeometry,ge=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],he=0,ye=1,xe=32;he<xe;he++,ye++){var _e=2*(he/xe*Math.PI),ve=2*(ye/xe*Math.PI);ge.push(Math.cos(_e),Math.sin(_e),1,Math.cos(ve),Math.sin(ve),1)}fe.addAttribute('position',new pe.Float32Attribute(ge,3));var Ee=new pe.LineBasicMaterial({fog:!1});this.cone=new pe.LineSegments(fe,Ee),this.add(this.cone),this.update()},pe.SpotLightHelper.prototype=Object.create(pe.Object3D.prototype),pe.SpotLightHelper.prototype.constructor=pe.SpotLightHelper,pe.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},pe.SpotLightHelper.prototype.update=function(){var ue=new pe.Vector3,fe=new pe.Vector3;return function(){var he=this.light.distance?this.light.distance:1e3,ye=he*Math.tan(this.light.angle);this.cone.scale.set(ye,ye,he),ue.setFromMatrixPosition(this.light.matrixWorld),fe.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(fe.sub(ue)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),pe.VertexNormalsHelper=function(ue,fe,ge,he){this.object=ue,this.size=fe===void 0?1:fe;var ye=ge===void 0?16711680:ge,xe=he===void 0?1:he,_e=0,ve=this.object.geometry;ve instanceof pe.Geometry?_e=3*ve.faces.length:ve instanceof pe.BufferGeometry&&(_e=ve.attributes.normal.count);var Ee=new pe.BufferGeometry,Te=new pe.Float32Attribute(3*(2*_e),3);Ee.addAttribute('position',Te),pe.LineSegments.call(this,Ee,new pe.LineBasicMaterial({color:ye,linewidth:xe})),this.matrixAutoUpdate=!1,this.update()},pe.VertexNormalsHelper.prototype=Object.create(pe.LineSegments.prototype),pe.VertexNormalsHelper.prototype.constructor=pe.VertexNormalsHelper,pe.VertexNormalsHelper.prototype.update=function(){var ue=new pe.Vector3,fe=new pe.Vector3,ge=new pe.Matrix3;return function(){var ye=['a','b','c'];this.object.updateMatrixWorld(!0),ge.getNormalMatrix(this.object.matrixWorld);var xe=this.object.matrixWorld,_e=this.geometry.attributes.position,ve=this.object.geometry;if(ve instanceof pe.Geometry)for(var Ee=ve.vertices,Te=ve.faces,Se=0,Me=0,Ae=Te.length,Le;Me<Ae;Me++){Le=Te[Me];for(var Re=0,Ce=Le.vertexNormals.length;Re<Ce;Re++){var we=Ee[Le[ye[Re]]],Pe=Le.vertexNormals[Re];ue.copy(we).applyMatrix4(xe),fe.copy(Pe).applyMatrix3(ge).normalize().multiplyScalar(this.size).add(ue),_e.setXYZ(Se,ue.x,ue.y,ue.z),++Se,_e.setXYZ(Se,fe.x,fe.y,fe.z),++Se}}else if(ve instanceof pe.BufferGeometry)for(var Fe=ve.attributes.position,De=ve.attributes.normal,Se=0,Re=0,Ce=Fe.count;Re<Ce;Re++)ue.set(Fe.getX(Re),Fe.getY(Re),Fe.getZ(Re)).applyMatrix4(xe),fe.set(De.getX(Re),De.getY(Re),De.getZ(Re)),fe.applyMatrix3(ge).normalize().multiplyScalar(this.size).add(ue),_e.setXYZ(Se,ue.x,ue.y,ue.z),++Se,_e.setXYZ(Se,fe.x,fe.y,fe.z),++Se;return _e.needsUpdate=!0,this}}(),pe.WireframeHelper=function(ue,fe){var ge=fe===void 0?16777215:fe;pe.LineSegments.call(this,new pe.WireframeGeometry(ue.geometry),new pe.LineBasicMaterial({color:ge})),this.matrix=ue.matrixWorld,this.matrixAutoUpdate=!1},pe.WireframeHelper.prototype=Object.create(pe.LineSegments.prototype),pe.WireframeHelper.prototype.constructor=pe.WireframeHelper,pe.ImmediateRenderObject=function(ue){pe.Object3D.call(this),this.material=ue,this.render=function(){}},pe.ImmediateRenderObject.prototype=Object.create(pe.Object3D.prototype),pe.ImmediateRenderObject.prototype.constructor=pe.ImmediateRenderObject,pe.MorphBlendMesh=function(ue,fe){pe.Mesh.call(this,ue,fe),this.animationsMap={},this.animationsList=[];var ge=this.geometry.morphTargets.length,he='__default';this.createAnimation(he,0,ge-1,ge/1),this.setAnimationWeight(he,1)},pe.MorphBlendMesh.prototype=Object.create(pe.Mesh.prototype),pe.MorphBlendMesh.prototype.constructor=pe.MorphBlendMesh,pe.MorphBlendMesh.prototype.createAnimation=function(ue,fe,ge,he){var ye={start:fe,end:ge,length:ge-fe+1,fps:he,duration:(ge-fe)/he,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[ue]=ye,this.animationsList.push(ye)},pe.MorphBlendMesh.prototype.autoCreateAnimations=function(ue){for(var fe=/([a-z]+)_?(\d+)/i,he={},ye=this.geometry,xe=0,_e=ye.morphTargets.length,ge;xe<_e;xe++){var ve=ye.morphTargets[xe],Ee=ve.name.match(fe);if(Ee&&1<Ee.length){var Te=Ee[1];he[Te]||(he[Te]={start:Infinity,end:-Infinity});var Se=he[Te];xe<Se.start&&(Se.start=xe),xe>Se.end&&(Se.end=xe),ge||(ge=Te)}}for(var Te in he){var Se=he[Te];this.createAnimation(Te,Se.start,Se.end,ue)}this.firstAnimation=ge},pe.MorphBlendMesh.prototype.setAnimationDirectionForward=function(ue){var fe=this.animationsMap[ue];fe&&(fe.direction=1,fe.directionBackwards=!1)},pe.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(ue){var fe=this.animationsMap[ue];fe&&(fe.direction=-1,fe.directionBackwards=!0)},pe.MorphBlendMesh.prototype.setAnimationFPS=function(ue,fe){var ge=this.animationsMap[ue];ge&&(ge.fps=fe,ge.duration=(ge.end-ge.start)/ge.fps)},pe.MorphBlendMesh.prototype.setAnimationDuration=function(ue,fe){var ge=this.animationsMap[ue];ge&&(ge.duration=fe,ge.fps=(ge.end-ge.start)/ge.duration)},pe.MorphBlendMesh.prototype.setAnimationWeight=function(ue,fe){var ge=this.animationsMap[ue];ge&&(ge.weight=fe)},pe.MorphBlendMesh.prototype.setAnimationTime=function(ue,fe){var ge=this.animationsMap[ue];ge&&(ge.time=fe)},pe.MorphBlendMesh.prototype.getAnimationTime=function(ue){var fe=0,ge=this.animationsMap[ue];return ge&&(fe=ge.time),fe},pe.MorphBlendMesh.prototype.getAnimationDuration=function(ue){var fe=-1,ge=this.animationsMap[ue];return ge&&(fe=ge.duration),fe},pe.MorphBlendMesh.prototype.playAnimation=function(ue){var fe=this.animationsMap[ue];fe?(fe.time=0,fe.active=!0):console.warn('THREE.MorphBlendMesh: animation['+ue+'] undefined in .playAnimation()')},pe.MorphBlendMesh.prototype.stopAnimation=function(ue){var fe=this.animationsMap[ue];fe&&(fe.active=!1)},pe.MorphBlendMesh.prototype.update=function(ue){for(var fe=0,ge=this.animationsList.length,he;fe<ge;fe++)if(he=this.animationsList[fe],he.active){var ye=he.duration/he.length;he.time+=he.direction*ue,he.mirroredLoop?(he.time>he.duration||0>he.time)&&(he.direction*=-1,he.time>he.duration&&(he.time=he.duration,he.directionBackwards=!0),0>he.time&&(he.time=0,he.directionBackwards=!1)):(he.time%=he.duration,0>he.time&&(he.time+=he.duration));var xe=he.start+pe.Math.clamp(Math.floor(he.time/ye),0,he.length-1),_e=he.weight;xe!==he.currentFrame&&(this.morphTargetInfluences[he.lastFrame]=0,this.morphTargetInfluences[he.currentFrame]=1*_e,this.morphTargetInfluences[xe]=0,he.lastFrame=he.currentFrame,he.currentFrame=xe);var ve=he.time%ye/ye;he.directionBackwards&&(ve=1-ve),he.currentFrame===he.lastFrame?this.morphTargetInfluences[he.currentFrame]=_e:(this.morphTargetInfluences[he.currentFrame]=ve*_e,this.morphTargetInfluences[he.lastFrame]=(1-ve)*_e)}}},function(){},function(){},function(){THREE.FresnelShader={uniforms:{mRefractionRatio:{value:1.02},mFresnelBias:{value:0.1},mFresnelPower:{value:2},mFresnelScale:{value:1},tCube:{value:null}},vertexShader:['uniform float mRefractionRatio;','uniform float mFresnelBias;','uniform float mFresnelScale;','uniform float mFresnelPower;','varying vec3 vReflect;','varying vec3 vRefract[3];','varying float vReflectionFactor;','void main() {','vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );','vec4 worldPosition = modelMatrix * vec4( position, 1.0 );','vec3 worldNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );','vec3 I = worldPosition.xyz - cameraPosition;','vReflect = reflect( I, worldNormal );','vRefract[0] = refract( normalize( I ), worldNormal, mRefractionRatio );','vRefract[1] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.99 );','vRefract[2] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.98 );','vReflectionFactor = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( I ), worldNormal ), mFresnelPower );','gl_Position = projectionMatrix * mvPosition;','}'].join('\n'),fragmentShader:['uniform samplerCube tCube;','varying vec3 vReflect;','varying vec3 vRefract[3];','varying float vReflectionFactor;','void main() {','vec4 reflectedColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );','vec4 refractedColor = vec4( 1.0 );','refractedColor.r = textureCube( tCube, vec3( -vRefract[0].x, vRefract[0].yz ) ).r;','refractedColor.g = textureCube( tCube, vec3( -vRefract[1].x, vRefract[1].yz ) ).g;','refractedColor.b = textureCube( tCube, vec3( -vRefract[2].x, vRefract[2].yz ) ).b;','gl_FragColor = mix( refractedColor, reflectedColor, clamp( vReflectionFactor, 0.0, 1.0 ) );','}'].join('\n')}},function(){THREE.DDSLoader=function(){this._parser=THREE.DDSLoader.parse},THREE.DDSLoader.prototype=Object.create(THREE.CompressedTextureLoader.prototype),THREE.DDSLoader.prototype.constructor=THREE.DDSLoader,THREE.DDSLoader.parse=function(ie,ne){function se(Lt){return Lt.charCodeAt(0)+(Lt.charCodeAt(1)<<8)+(Lt.charCodeAt(2)<<16)+(Lt.charCodeAt(3)<<24)}function le(Lt){return String.fromCharCode(255&Lt,255&Lt>>8,255&Lt>>16,255&Lt>>24)}function pe(Lt,Rt,Ct,wt){for(var Pt=4*(Ct*wt),Ft=new Uint8Array(Lt,Rt,Pt),Dt=new Uint8Array(Pt),It=0,Bt=0,Ut=0;Ut<wt;Ut++)for(var Nt=0,Gt;Nt<Ct;Nt++){Gt=Ft[Bt],Bt++;var Vt=Ft[Bt];Bt++;var zt=Ft[Bt];Bt++;var Ot=Ft[Bt];Bt++,Dt[It]=zt,It++,Dt[It]=Vt,It++,Dt[It]=Gt,It++,Dt[It]=Ot,It++}return Dt}var ue={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},Oe=se('DXT1'),ke=se('DXT3'),He=se('DXT5'),We=se('ETC1'),ct=new Int32Array(ie,0,31);if(ct[0]!==542327876)return console.error('THREE.DDSLoader.parse: Invalid magic number in DDS header.'),ue;if(!ct[20]&4)return console.error('THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code.'),ue;var mt=ct[21],gt=!1,ut;switch(mt){case Oe:ut=8,ue.format=THREE.RGB_S3TC_DXT1_Format;break;case ke:ut=16,ue.format=THREE.RGBA_S3TC_DXT3_Format;break;case He:ut=16,ue.format=THREE.RGBA_S3TC_DXT5_Format;break;case We:ut=8,ue.format=THREE.RGB_ETC1_Format;break;default:if(32===ct[22]&&16711680&ct[23]&&65280&ct[24]&&255&ct[25]&&4278190080&ct[26])gt=!0,ut=64,ue.format=THREE.RGBAFormat;else return console.error('THREE.DDSLoader.parse: Unsupported FourCC code ',le(mt)),ue;}ue.mipmapCount=1,ct[2]&131072&&!1!==ne&&(ue.mipmapCount=Math.max(1,ct[7]));var ht=ct[28];if(ue.isCubemap=!!(ht&512),ue.isCubemap&&(!(ht&1024)||!(ht&2048)||!(ht&4096)||!(ht&8192)||!(ht&16384)||!(ht&32768)))return console.error('THREE.DDSLoader.parse: Incomplete cubemap faces'),ue;ue.width=ct[4],ue.height=ct[3];for(var yt=ct[1]+4,xt=ue.isCubemap?6:1,_t=0;_t<xt;_t++)for(var vt=ue.width,Et=ue.height,Tt=0;Tt<ue.mipmapCount;Tt++){if(gt)var St=pe(ie,yt,vt,Et),Mt=St.length;else var Mt=Math.max(4,vt)/4*Math.max(4,Et)/4*ut,St=new Uint8Array(ie,yt,Mt);var At={data:St,width:vt,height:Et};ue.mipmaps.push(At),yt+=Mt,vt=Math.max(vt>>1,1),Et=Math.max(Et>>1,1)}return ue}},function(){THREE.PVRLoader=function(ie){this.manager=ie===void 0?THREE.DefaultLoadingManager:ie,this._parser=THREE.PVRLoader.parse},THREE.PVRLoader.prototype=Object.create(THREE.CompressedTextureLoader.prototype),THREE.PVRLoader.prototype.constructor=THREE.PVRLoader,THREE.PVRLoader.parse=function(ie,ne){var le=new Uint32Array(ie,0,13),pe={buffer:ie,header:le,loadMipmaps:ne};if(55727696===le[0])return THREE.PVRLoader._parseV3(pe);if(559044176===le[11])return THREE.PVRLoader._parseV2(pe);throw new Error('[THREE.PVRLoader] Unknown PVR format')},THREE.PVRLoader._parseV3=function(ie){var ne=ie.header,pe=ne[12],ue=ne[2],fe=ne[6],ge=ne[7],he=ne[9],ye=ne[10],xe=ne[11],se,le;switch(ue){case 0:se=2,le=THREE.RGB_PVRTC_2BPPV1_Format;break;case 1:se=2,le=THREE.RGBA_PVRTC_2BPPV1_Format;break;case 2:se=4,le=THREE.RGB_PVRTC_4BPPV1_Format;break;case 3:se=4,le=THREE.RGBA_PVRTC_4BPPV1_Format;break;default:throw new Error('pvrtc - unsupported PVR format '+ue);}return ie.dataPtr=52+pe,ie.bpp=se,ie.format=le,ie.width=ge,ie.height=fe,ie.numSurfaces=ye,ie.numMipmaps=xe,ie.isCubemap=6===ye,THREE.PVRLoader._extract(ie)},THREE.PVRLoader._parseV2=function(ie){var ne=ie.header,se=ne[0],le=ne[1],pe=ne[2],ue=ne[3],fe=ne[4],ge=ne[5],he=ne[6],ye=ne[7],xe=ne[8],_e=ne[9],ve=ne[10],Ee=ne[11],Te=ne[12],Le=fe&255,Ce=0<ve,he,Re;if(Le==25)Re=Ce?THREE.RGBA_PVRTC_4BPPV1_Format:THREE.RGB_PVRTC_4BPPV1_Format,he=4;else if(Le==24)Re=Ce?THREE.RGBA_PVRTC_2BPPV1_Format:THREE.RGB_PVRTC_2BPPV1_Format,he=2;else throw new Error('pvrtc - unknown format '+Le);return ie.dataPtr=se,ie.bpp=he,ie.format=Re,ie.width=pe,ie.height=le,ie.numSurfaces=Te,ie.numMipmaps=ue+1,ie.isCubemap=6===Te,THREE.PVRLoader._extract(ie)},THREE.PVRLoader._extract=function(ie){var ne={mipmaps:[],width:ie.width,height:ie.height,format:ie.format,mipmapCount:ie.numMipmaps,isCubemap:ie.isCubemap},se=ie.buffer,le=ie.dataPtr,pe=ie.bpp,ue=ie.numSurfaces,fe=0,ge=0,he=0,ye=0,xe=0,_e=0;2===pe?(he=8,ye=4):(he=4,ye=4),ge=he*ye*pe/8,ne.mipmaps.length=ie.numMipmaps*ue;for(var ve=0;ve<ie.numMipmaps;){var Ee=ie.width>>ve,Te=ie.height>>ve;xe=Ee/he,_e=Te/ye,2>xe&&(xe=2),2>_e&&(_e=2),fe=xe*_e*ge;for(var Se=0;Se<ue;Se++){var Me=new Uint8Array(se,le,fe);ne.mipmaps[Se*ie.numMipmaps+ve]={data:Me,width:Ee,height:Te},le+=fe}ve++}return ne}},function(){},function(ee,oe){(function(){var ie,ne;ne='undefined'!=typeof oe&&null!==oe?oe:this,ne.CompressedTextureTest=ie=function(){function se(){Detector.webgl||Detector.addGetWebGLMessage(),this.tests=[],this.tests.push(new le(sender.getID())),this.tests.push(new pe(sender.getID()))}var le,pe,ue,fe,ge,he,ye,xe;return ye='js/webgl/tests/three/textures/compressed',fe=new THREE.BoxGeometry(150,150,150),ge=-400,xe=Math.abs(ge),he=-200,ue=250,le=function(){function _e(ve){var Ee,Te,Se,Me,Ae,Le,Re,Ce,we,Pe,Fe,De,Ie,Be,Ue,Ne,Ge;for(this.id=ve,this.camera=new THREE.PerspectiveCamera(60,1,1,2e3),this.camera.position.z=1e3,this.scene=new THREE.Scene,this.materials=[],Le=new THREE.DDSLoader,Re=Le.load(ye+'/disturb_dxt1_nomip.dds'),Re.minFilter=Re.magFilter=THREE.LinearFilter,Re.anisotropy=4,Ce=Le.load(ye+'/disturb_dxt1_mip.dds'),Ce.anisotropy=4,we=Le.load(ye+'/hepatica_dxt3_mip.dds'),we.anisotropy=4,Pe=Le.load(ye+'/explosion_dxt5_mip.dds'),Pe.anisotropy=4,Fe=Le.load(ye+'/disturb_argb_nomip.dds'),Fe.minFilter=Fe.magFilter=THREE.LinearFilter,Fe.anisotropy=4,De=Le.load(ye+'/disturb_argb_mip.dds'),De.anisotropy=4,Ee=Le.load(ye+'/Mountains.dds',function(Ve){return function(ze){return ze.magFilter=THREE.LinearFilter,ze.minFilter=THREE.LinearFilter,ze.mapping=THREE.CubeReflectionMapping,Ve.materials[0].needsUpdate=!0}}(this)),Te=Le.load(ye+'/Mountains_argb_mip.dds',function(Ve){return function(ze){return ze.magFilter=THREE.LinearFilter,ze.minFilter=THREE.LinearFilter,ze.mapping=THREE.CubeReflectionMapping,Ve.materials[1].needsUpdate=!0}}(this)),Se=Le.load(ye+'/Mountains_argb_nomip.dds',function(Ve){return function(ze){return ze.magFilter=THREE.LinearFilter,ze.minFilter=THREE.LinearFilter,ze.mapping=THREE.CubeReflectionMapping,Ve.materials[2].needsUpdate=!0}}(this)),this.materials.push(new THREE.MeshBasicMaterial({map:Re,envMap:Ee})),this.materials.push(new THREE.MeshBasicMaterial({envMap:Te})),this.materials.push(new THREE.MeshBasicMaterial({envMap:Se})),this.materials.push(new THREE.MeshBasicMaterial({map:Ce})),this.materials.push(new THREE.MeshBasicMaterial({map:we,alphaTest:0.5,side:THREE.DoubleSide})),this.materials.push(new THREE.MeshBasicMaterial({map:Pe,side:THREE.DoubleSide,blending:THREE.AdditiveBlending,depthTest:!1,transparent:!0})),this.materials.push(new THREE.MeshBasicMaterial({map:Fe})),this.materials.push(new THREE.MeshBasicMaterial({map:De})),this.meshes=[],Ne=ge,Ge=he,Ue=this.materials,(Me=0,Ae=Ue.length);Me<Ae;Me++)Ie=Ue[Me],Be=new THREE.Mesh(fe,Ie),Be.position.x=Ne,Be.position.y=Ge,this.scene.add(Be),this.meshes.push(Be),Ne+=ue,Ne>xe&&(Ge+=ue,Ne=ge)}return _e.prototype.begin=function(ve,Ee){var Te;return this.cb=Ee,this.renderer=new THREE.WebGLRenderer({context:getGL(ve),canvas:ve},!1),this.renderer.setClearColor('#050505'),this.renderer.setPixelRatio(1),this.renderer.setSize(ve.width,ve.height),this.counter=0,Te=function(Se){return function(){var Me,Ae,Le,Re,Ce,we;for(Me=raf(Te),we=0.01*Se.counter++,Ce=Se.meshes,(Ae=0,Le=Ce.length);Ae<Le;Ae++)Re=Ce[Ae],Re.rotation.x=we,Re.rotation.y=we;if(Se.renderer.render(Se.scene,Se.camera),10===Se.counter)return caf(Me),sender.getData(Se.renderer.getContext(),ve,Se.id),Se.cb()}}(this),raf(Te)},_e}(),pe=function(){function _e(ve){var Ee,Te,Se,Me,Ae,Le,Re,Ce,we,Pe,Fe,De,Ie,Be,Ue,Ne;for(this.id=ve,this.camera=new THREE.PerspectiveCamera(60,1,1,2e3),this.camera.position.z=1500,this.scene=new THREE.Scene,this.materials=[],we=new THREE.PVRLoader,Te=we.load(ye+'/disturb_4bpp_rgb.pvr'),Me=we.load(ye+'/disturb_4bpp_rgb_v3.pvr'),Se=we.load(ye+'/disturb_4bpp_rgb_mips.pvr'),Ee=we.load(ye+'/disturb_2bpp_rgb.pvr'),Le=we.load(ye+'/flare_4bpp_rgba.pvr'),Ae=we.load(ye+'/flare_2bpp_rgba.pvr'),Ie=we.load(ye+'/park3_cube_nomip_4bpp_rgb.pvr',function(Ge){return function(Ve){return Ve.magFilter=THREE.LinearFilter,Ve.minFilter=THREE.LinearFilter,Ve.mapping=THREE.CubeReflectionMapping,Ge.meshes[0].needsUpdate=!0}}(this)),De=we.load(ye+'/park3_cube_mip_2bpp_rgb_v3.pvr',function(Ge){return function(Ve){return Ve.magFilter=THREE.LinearFilter,Ve.minFilter=THREE.LinearFilter,Ve.mapping=THREE.CubeReflectionMapping,Ge.meshes[1].needsUpdate=!0}}(this)),Ee.minFilter=Ee.magFilter=Le.minFilter=Le.magFilter=Te.minFilter=Te.magFilter=Me.minFilter=Me.magFilter=Ae.minFilter=Ae.magFilter=THREE.LinearFilter,this.materials.push(new THREE.MeshBasicMaterial({envMap:Ie})),this.materials.push(new THREE.MeshBasicMaterial({envMap:De})),this.materials.push(new THREE.MeshBasicMaterial({map:Te})),this.materials.push(new THREE.MeshBasicMaterial({map:Se})),this.materials.push(new THREE.MeshBasicMaterial({map:Ee})),this.materials.push(new THREE.MeshBasicMaterial({map:Le,side:THREE.DoubleSide,depthTest:!1,transparent:!0})),this.materials.push(new THREE.MeshBasicMaterial({map:Ae,side:THREE.DoubleSide,depthTest:!1,transparent:!0})),this.materials.push(new THREE.MeshBasicMaterial({map:Me})),this.meshes=[],Ue=ge,Ne=he,Be=this.materials,(Re=0,Ce=Be.length);Re<Ce;Re++)Pe=Be[Re],Fe=new THREE.Mesh(fe,Pe),Fe.position.x=Ue,Fe.position.y=Ne,this.scene.add(Fe),this.meshes.push(Fe),Ue+=ue,Ue>xe&&(Ne+=ue,Ue=ge)}return _e.prototype.begin=function(ve,Ee){var Te;return this.cb=Ee,this.renderer=new THREE.WebGLRenderer({context:getGL(ve),canvas:ve},!1),this.renderer.setClearColor('#050505'),this.renderer.setPixelRatio(1),this.renderer.setSize(ve.width,ve.height),this.counter=0,Te=function(Se){return function(){var Me,Ae,Le,Re,Ce,we;for(Me=raf(Te),we=1e-3*Se.counter++,Ce=Se.meshes,(Ae=0,Le=Ce.length);Ae<Le;Ae++)Re=Ce[Ae],Re.rotation.x=we,Re.rotation.y=we;if(Se.renderer.render(Se.scene,Se.camera),10===Se.counter)return caf(Me),sender.getData(Se.renderer.getContext(),ve,Se.id),Se.cb()}}(this),raf(Te)},_e}(),se.prototype.begin=function(_e,ve){var Ee;return this.canvas=_e,this.cb=ve,this.index=0,Ee=function(Te){return function(){return Te.index===Te.tests.length?Te.cb():Te.tests[Te.index++].begin(Te.canvas,Ee)}}(this),Ee()},se}()}).call(this)},function(ee,oe,ie){(function(ne){var se='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(pe){return typeof pe}:function(pe){return pe&&'function'==typeof Symbol&&pe.constructor===Symbol&&pe!==Symbol.prototype?'symbol':typeof pe},le={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var pe=document.createElement('canvas');return!!(window.WebGLRenderingContext&&(pe.getContext('webgl')||pe.getContext('experimental-webgl')))}catch(ue){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var ue=document.createElement('div');return ue.id='webgl-error-message',ue.style.fontFamily='monospace',ue.style.fontSize='13px',ue.style.fontWeight='normal',ue.style.textAlign='center',ue.style.background='#fff',ue.style.color='#000',ue.style.padding='1.5em',ue.style.width='400px',ue.style.margin='5em auto 0',this.webgl||(ue.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join('\n'):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join('\n')),ue},addGetWebGLMessage:function(ue){var fe,ge,he;ue=ue||{},fe=ue.parent===void 0?document.body:ue.parent,ge=ue.id===void 0?'oldie':ue.id,he=le.getWebGLErrorMessage(),he.id=ge,fe.appendChild(he)}};'object'===se(ne)&&(ne.exports=le)}).call(oe,ie(0)(ee))},function(ee,oe){'use strict';ip_address='lab.songli.io/uniquemachine/';var se=function(){this.finalized=!1,this.postData={flashFonts:'No Flash',fonts:'',WebGL:!1,inc:'Undefined',gpu:'Undefined',timezone:'Undefined',resolution:'Undefined',plugins:'Undefined',cookie:'Undefined',localstorage:'Undefined',manufacturer:'Undefined',gpuImgs:{},adBlock:'Undefined',cpu_cores:'Undefined',canvas_test:'Undefined',audio:'Undefined',langsDetected:[],video:[],cc_audio:[],hybrid_audio:[]},this.flashFontsDetection=function(ge){if('undefined'==typeof window.swfobject)return console.log('No flash available'),'';if(!swfobject.hasFlashPlayerVersion('9.0.0'))return console.log('Insufficient flash version: need at least 9.0.0'),'';var he='___fp_swf_loaded';window[he]=function(Ee){for(var Te=0;Te<Ee.length;++Te)Ee[Te]=Ee[Te].replace(/,/g,' '),Ee[Te]=Ee[Te].replace(/[^\x00-\xFF]/g,'?');ge.postData.flashFonts=Ee.join('_'),ge.flashFontsDetectionFinished()};var ye='flashfontfp',xe=document.createElement('div');xe.setAttribute('id',ye),document.body.appendChild(xe);swfobject.embedSWF('static/FontList.swf',ye,'1','1','9.0.0',!1,{onReady:he},{allowScriptAccess:'always',menu:'false'},{})},this.audioFingerPrinting=function(){try{var he=new(window.AudioContext||window.webkitAudioContext),ye=he.createOscillator(),xe=he.createAnalyser(),_e=he.createGain(),ve=he.createScriptProcessor(4096,1,1),Ee=he.destination;return he.sampleRate.toString()+'_'+Ee.maxChannelCount+'_'+Ee.numberOfInputs+'_'+Ee.numberOfOutputs+'_'+Ee.channelCount+'_'+Ee.channelCountMode+'_'+Ee.channelInterpretation}catch(Te){return'not supported'}},this.getResolution=function(){var ge=detectZoom.device(),he=window.screen.width*ge,ye=window.screen.height*ge,xe=Math.round(he)+'_'+Math.round(ye)+'_'+ge+'_'+window.screen.width+'_'+window.screen.height+'_'+window.screen.colorDepth+'_'+window.screen.availWidth+'_'+window.screen.availHeight+'_'+window.screen.left+'_'+window.screen.top+'_'+window.screen.availLeft+'_'+window.screen.availTop+'_'+window.innerWidth+'_'+window.outerWidth+'_'+detectZoom.zoom();return xe},this.getPlugins=function(){for(var ge=navigator.plugins.length,he=[],ye=0;ye<ge;ye++)he.push(navigator.plugins[ye].name);he.sort();var xe=he.join('~');return xe=xe.replace(/[^a-zA-Z~ ]/g,''),xe},this.checkLocalStorage=function(){try{return localStorage.setItem('test','test'),localStorage.removeItem('test'),!0}catch(ge){return!1}},this.getCPUCores=function(){return navigator.hardwareConcurrency?navigator.hardwareConcurrency:'-1'},this.getWebGL=function(){canvas=getCanvas('tmp_canvas');var ge=getGL(canvas);return ge},this.getInc=function(ge){var he=ge.getExtension('WEBGL_debug_renderer_info');return he?ge.getParameter(he.UNMASKED_VENDOR_WEBGL):'No Debug Info'},this.getGpu=function(ge){var he=ge.getExtension('WEBGL_debug_renderer_info');return he?ge.getParameter(he.UNMASKED_RENDERER_WEBGL):'No Debug Info'};var pe=function(){return canvasData='Not supported',canvas=$('<canvas height=\'60\' width=\'400\'></canvas>')[0],canvasContext=canvas.getContext('2d'),canvas.style.display='inline',canvasContext.textBaseline='alphabetic',canvasContext.fillStyle='#f60',canvasContext.fillRect(125,1,62,20),canvasContext.fillStyle='#069',canvasContext.font='11pt no-real-font-123',canvasContext.fillText('Cwm fjordbank glyphs vext quiz, \uD83D\uDE03',2,15),canvasContext.fillStyle='rgba(102, 204, 0, 0.7)',canvasContext.font='18pt Arial',canvasContext.fillText('Cwm fjordbank glyphs vext quiz, \uD83D\uDE03',4,45),canvas};this.finished=!1;var ue=function(he){var ye=[],xe=new(window.AudioContext||window.webkitAudioContext),_e=xe.createOscillator(),ve=xe.createAnalyser(),Ee=xe.createGain(),Te=xe.createScriptProcessor(4096,1,1);Ee.gain.value=0,_e.type='triangle',_e.connect(ve),ve.connect(Te),Te.connect(Ee),Ee.connect(xe.destination);var Se=[];return Te.onaudioprocess=function(Me){Me=new Float32Array(ve.frequencyBinCount),ve.getFloatFrequencyData(Me);for(var Ae=0;Ae<Me.length;++Ae)ye.push(Me[Ae]);ve.disconnect(),Te.disconnect(),Ee.disconnect(),console.log('Hello'),Se=ye.slice(0,30),console.log(Se),he.runCcFpFinished(Se)},_e.start(0),console.log('Test'),console.log(Se),Se},fe=function(he){var ye=[],xe=new(window.AudioContext||window.webkitAudioContext),_e=xe.createOscillator(),ve=xe.createAnalyser(),Ee=xe.createGain(),Te=xe.createScriptProcessor(4096,1,1);return compressor=xe.createDynamicsCompressor(),compressor.threshold&&(compressor.threshold.value=-50),compressor.knee&&(compressor.knee.value=40),compressor.ratio&&(compressor.ratio.value=12),compressor.reduction&&(compressor.reduction.value=-20),compressor.attack&&(compressor.attack.value=0),compressor.release&&(compressor.release.value=.25),Ee.gain.value=0,_e.type='triangle',_e.connect(compressor),compressor.connect(ve),ve.connect(Te),Te.connect(Ee),Ee.connect(xe.destination),Te.onaudioprocess=function(Se){Se=new Float32Array(ve.frequencyBinCount),ve.getFloatFrequencyData(Se);for(var Me=0;Me<Se.length;++Me)ye.push(Se[Me]);ve.disconnect(),Te.disconnect(),Ee.disconnect(),he.runHybridFpFinished(ye.slice(0,30))},_e.start(0),ye.slice(0,30)};this.nextID=0,this.getID=function(){if(this.finished){throw'Can\'t  generate ID anymore'}return this.nextID++},this.getIDs=function(ge){for(var he=[],ye=0;ye<ge;++ye)he.push(this.getID());return he},this.getData=function(ge,he,ye){debugger;var xe=he.toDataURL('image/png',1);this.setGPUTestPostData(calcSHA1(xe),ye,'testtest')},this.setGPUTestPostData=function(ge,he,ye){this.postData.gpuImgs[he]=ye+'_'+ge},this.getPostData=function(){this.postData.timezone=new Date().getTimezoneOffset(),this.postData.resolution=this.getResolution(),this.postData.plugins=this.getPlugins(),this.postData.cookie=navigator.cookieEnabled,this.postData.localstorage=this.checkLocalStorage(),this.postData.adBlock=null==$('#ad')[0]?'Yes':'No',cvs_test=pe(),this.getData(null,cvs_test,28);var ge=cvs_test.toDataURL('image/png',1);this.postData.canvas_test=Base64EncodeUrlSafe(calcSHA1(ge.substring(22,ge.length))),this.postData.cpu_cores=this.getCPUCores(),this.postData.audio=this.audioFingerPrinting(),this.postData.langsDetected=get_writing_scripts(),this.testGL=this.getWebGL(),this.postData.WebGL=!!this.testGL,this.postData.inc='Not Supported',this.postData.gpu='Not Supported',this.postData.WebGL&&(this.postData.inc=this.getInc(this.testGL),this.postData.gpu=this.getGpu(this.testGL)),this.webglFinished=function(){this.flashFontsDetection(this)},this.flashFontsDetectionFinished=function(){ue(this)},this.runCcFpFinished=function(he){this.postData.cc_audio=he.join('_'),fe(this)},this.runHybridFpFinished=function(he){this.postData.hybrid_audio=he.join('_'),console.log(this.postData),this.startSend()},webGLTest(this),console.log(this.postData),this.startSend=function(){$.ajax({url:'http://'+ip_address+'/features',dataType:'json',contentType:'application/json',type:'POST',data:JSON.stringify(this.postData),success:function(ye){console.log(ye),parent.postMessage(ye,'http://lab.songli.io/site/test_site/')},error:function(ye,xe,_e){alert(_e)}})}}};Base64EncodeUrlSafe=function(pe){return pe.replace(/\+/g,'-').replace(/\//g,'_').replace(/\=+$/,'')},stringify=function(pe){for(var ue='',fe=0,ge=pe.length;fe<ge;fe+=4)ue+=String.fromCharCode(pe[fe+0]),ue+=String.fromCharCode(pe[fe+1]),ue+=String.fromCharCode(pe[fe+2]);var he=window.btoa(ue);return Base64EncodeUrlSafe(he)},oe.a=function(){var le=new se;le.getPostData()}}]);
//# sourceMappingURL=index.min.js.map